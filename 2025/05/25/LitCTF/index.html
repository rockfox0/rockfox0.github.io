

<!DOCTYPE html>
<html lang="zh-CN en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/OIP-C.jpg">
  <link rel="icon" href="/img/OIP-C.jpg">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="fox">
  <meta name="keywords" content="菜菜的密码劳弟">
  
    <meta name="description" content="LitCTFez_math简单的矩阵rsa，原理见论文  https:&#x2F;&#x2F;www.gcsu.edu&#x2F;sites&#x2F;files&#x2F;page-assets&#x2F;node-808&#x2F;attachments&#x2F;pangia.pdf#:~:text&#x3D;We%20propose%20a%20variation%20on%20the%20RSA%20Cryptosystem%3A,methods%20to%20matrix%">
<meta property="og:type" content="article">
<meta property="og:title" content="LitCTF复现">
<meta property="og:url" content="http://example.com/2025/05/25/LitCTF/index.html">
<meta property="og:site_name" content="Rockfox的密码记录">
<meta property="og:description" content="LitCTFez_math简单的矩阵rsa，原理见论文  https:&#x2F;&#x2F;www.gcsu.edu&#x2F;sites&#x2F;files&#x2F;page-assets&#x2F;node-808&#x2F;attachments&#x2F;pangia.pdf#:~:text&#x3D;We%20propose%20a%20variation%20on%20the%20RSA%20Cryptosystem%3A,methods%20to%20matrix%">
<meta property="og:locale">
<meta property="article:published_time" content="2025-05-25T04:00:00.000Z">
<meta property="article:modified_time" content="2025-05-29T10:13:51.749Z">
<meta property="article:author" content="fox">
<meta property="article:tag" content="crypto">
<meta property="article:tag" content="复现">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>LitCTF复现 - Rockfox的密码记录</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":40,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 150vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>fox的密码学习记录</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>Links</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/xulun.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="LitCTF复现"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-05-25 12:00" pubdate>
          May 25, 2025 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          1.1k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          10 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
        <div class="scroll-down-bar">
          <i class="iconfont icon-arrowdown"></i>
        </div>
      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">LitCTF复现</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="LitCTF"><a href="#LitCTF" class="headerlink" title="LitCTF"></a>LitCTF</h1><h2 id="ez-math"><a href="#ez-math" class="headerlink" title="ez_math"></a>ez_math</h2><p>简单的矩阵rsa，原理见论文</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.gcsu.edu/sites/files/page-assets/node-808/attachments/pangia.pdf#:~:text=We%20propose%20a%20variation%20on%20the%20RSA%20Cryptosystem%3A,methods%20to%20matrix%20values%20in%20addition%20to%20scalars">https://www.gcsu.edu/sites/files/page-assets/node-808/attachments/pangia.pdf#:~:text=We%20propose%20a%20variation%20on%20the%20RSA%20Cryptosystem%3A,methods%20to%20matrix%20values%20in%20addition%20to%20scalars</a>.</li>
</ul>
<p>​       </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> uuid <span class="hljs-keyword">import</span> uuid4<br><br>flag = <span class="hljs-string">b&#x27;LitCTF&#123;&#x27;</span>+ <span class="hljs-built_in">str</span>(uuid4()).encode() + <span class="hljs-string">b&#x27;&#125;&#x27;</span><br>flag = bytes_to_long(flag)<br>len_flag = flag.bit_length()<br>e = <span class="hljs-number">65537</span><br>p = getPrime(<span class="hljs-number">512</span>)<br>P = GF(p)<br>A = [[flag,                 getPrime(len_flag)],<br>     [getPrime(len_flag),   getPrime(len_flag)]]<br>A = matrix(P, A)<br>B = A ** e<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;B = <span class="hljs-subst">&#123;<span class="hljs-built_in">list</span>(B)&#125;</span>&quot;</span>.replace(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;[&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;]&#x27;</span>))<br><br><span class="hljs-comment"># e = 65537</span><br><span class="hljs-comment"># p = 8147594556101158967571180945694180896742294483544853070485096002084187305007965554901340220135102394516080775084644243545680089670612459698730714507241869</span><br><span class="hljs-comment"># B = [[2155477851953408309667286450183162647077775173298899672730310990871751073331268840697064969968224381692698267285466913831393859280698670494293432275120170, 4113196339199671283644050914377933292797783829068402678379946926727565560805246629977929420627263995348168282358929186302526949449679561299204123214741547], [3652128051559825585352835887172797117251184204957364197630337114276860638429451378581133662832585442502338145987792778148110514594776496633267082169998598, 2475627430652911131017666156879485088601207383028954405788583206976605890994185119936790889665919339591067412273564551745588770370229650653217822472440992]]</span><br></code></pre></td></tr></table></figure>

<p>​       解题代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e = <span class="hljs-number">65537</span><br>p = <span class="hljs-number">8147594556101158967571180945694180896742294483544853070485096002084187305007965554901340220135102394516080775084644243545680089670612459698730714507241869</span><br>P=GF(p)<br>B = Matrix(P,[[<span class="hljs-number">2155477851953408309667286450183162647077775173298899672730310990871751073331268840697064969968224381692698267285466913831393859280698670494293432275120170</span>, <span class="hljs-number">4113196339199671283644050914377933292797783829068402678379946926727565560805246629977929420627263995348168282358929186302526949449679561299204123214741547</span>], [<span class="hljs-number">3652128051559825585352835887172797117251184204957364197630337114276860638429451378581133662832585442502338145987792778148110514594776496633267082169998598</span>, <span class="hljs-number">2475627430652911131017666156879485088601207383028954405788583206976605890994185119936790889665919339591067412273564551745588770370229650653217822472440992</span>]])<br>                                                                                                                                                                                                                                                                                                           <br>gp=(p^<span class="hljs-number">2</span>-p)*(p^<span class="hljs-number">2</span>-<span class="hljs-number">1</span>)<br>d = <span class="hljs-built_in">int</span>(inverse(e,gp))<br><span class="hljs-built_in">print</span>(d)<br>M=B^d<br><span class="hljs-built_in">print</span>(M)<br>m=<span class="hljs-built_in">int</span>(M[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>

<h2 id="baby"><a href="#baby" class="headerlink" title="baby"></a>baby</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> enc <span class="hljs-keyword">import</span> flag<br><br><br>m = bytes_to_long(flag)<br>g = getPrime(<span class="hljs-number">512</span>)<br>t = getPrime(<span class="hljs-number">150</span>)<br>data = (t * gmpy2.invert(m, g)) % g<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;g = <span class="hljs-subst">&#123;g&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;data = <span class="hljs-subst">&#123;data&#125;</span>&#x27;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">g = 7835965640896798834809247993719156202474265737048568647376673642017466116106914666363462292416077666356578469725971587858259708356557157689066968453881547</span><br><span class="hljs-string">data = 2966297990428234518470018601566644093790837230283136733660201036837070852272380968379055636436886428180671888655884680666354402224746495312632530221228498</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>简单的格密码。需要推理一下。设d_1是data%g的逆元</p>
<p>那么$data<em>m(mod g)&#x3D;t(mod g),那么m&#x3D;d_1</em>t-kg$</p>
<p>由此构造格</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>g = <span class="hljs-number">7835965640896798834809247993719156202474265737048568647376673642017466116106914666363462292416077666356578469725971587858259708356557157689066968453881547</span><br>d_1=<span class="hljs-number">361604276948326501762250287716016338622906218631144152645999375100275741878714167153966876463816425975791307247683233886856162923152653346318817853658709</span><br><br>M=Matrix(ZZ,[[<span class="hljs-number">2</span>^<span class="hljs-number">200</span>,d_1],[<span class="hljs-number">0</span>,g]])<br>L=M.LLL()<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(L[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>])))<br></code></pre></td></tr></table></figure>

<h2 id="new-bag"><a href="#new-bag" class="headerlink" title="new_bag"></a>new_bag</h2><p>这个背包按理说密度是不够的，不够因为我们已经知道前缀是Litctf{后缀}排除几个还是轻松的。<br>$$</p>
<p>$$</p>
<p>$$<br>U&#x3D;\begin{bmatrix}<br>2&amp;0&amp;…&amp;0&amp;Na_{11}&amp;Na_{21}&amp;…&amp;Na_{m1}\<br>0&amp;2&amp;…&amp;0&amp;Na_{12}&amp;Na_{22}&amp;…&amp;Na_{m2}\<br>⋮&amp; &amp;…&amp; ⋮&amp;⋮ &amp;⋮ &amp;…&amp;⋮\<br>1&amp;1&amp;…&amp;1&amp;Ns_1 &amp;NS_2 &amp;…&amp;NS_m\</p>
<p>\end{bmatrix}<br>$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># sage10.6</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">173537234562263850990112795836487093439</span><br>pubkey = [<span class="hljs-number">184316235755254907483728080281053515467</span>, <span class="hljs-number">301753295242660201987730522100674059399</span>, <span class="hljs-number">214746865948159247109907445342727086153</span>, <span class="hljs-number">190710765981032078577562674498245824397</span>, <span class="hljs-number">331594659178887289573546882792969306963</span>, <span class="hljs-number">325241251857446530306000904015122540537</span>, <span class="hljs-number">183138087354043440402018216471847480597</span>, <span class="hljs-number">184024660891182404534278014517267677121</span>, <span class="hljs-number">221852419056451630727726571924370029193</span>, <span class="hljs-number">252122782233143392994310666727549089119</span>, <span class="hljs-number">175886223097788623718858806338121455451</span>, <span class="hljs-number">275410728642596840638045777234465661687</span>, <span class="hljs-number">251664694235514793799312335012668142813</span>, <span class="hljs-number">218645272462591891220065928162159215543</span>, <span class="hljs-number">312223630454310643034351163568776055567</span>, <span class="hljs-number">246969281206041998865813427647656760287</span>, <span class="hljs-number">314861458279166374375088099707870061461</span>, <span class="hljs-number">264293021895772608566300156292334238719</span>, <span class="hljs-number">300802209357110221724717494354120213867</span>, <span class="hljs-number">293825386566202476683406032420716750733</span>, <span class="hljs-number">280164880535680245461599240490036536891</span>, <span class="hljs-number">223138633045675121340315815489781884671</span>, <span class="hljs-number">194958151408670059556476901479795911187</span>, <span class="hljs-number">180523100489259027750075460231138785329</span>, <span class="hljs-number">180425435626797251881104654861163883059</span>, <span class="hljs-number">313871202884226454316190668965524324023</span>, <span class="hljs-number">184833541398593696671625353250714719537</span>, <span class="hljs-number">217497008601504809464374671355532403921</span>, <span class="hljs-number">246589067140439936215888566305171004301</span>, <span class="hljs-number">289015788017956436490096615142465503023</span>, <span class="hljs-number">301775305365100149653555500258867275677</span>, <span class="hljs-number">185893637147914858767269807046039030871</span>, <span class="hljs-number">319328260264390422708186053639594729851</span>, <span class="hljs-number">196198701308135383224057395173059054757</span>, <span class="hljs-number">231185775704496628532348037721799493511</span>, <span class="hljs-number">243973313872552840389840048418558528537</span>, <span class="hljs-number">213140279661565397451805047456032832611</span>, <span class="hljs-number">310386296949148370235845491986451639013</span>, <span class="hljs-number">228492979916155878048849684460007011451</span>, <span class="hljs-number">240557187581619139147592264130657066299</span>, <span class="hljs-number">187388364905654342761169670127101032713</span>, <span class="hljs-number">305292765113810142043496345097024570233</span>, <span class="hljs-number">303823809595161213886303993298011013599</span>, <span class="hljs-number">227663140954563126349665813092551336597</span>, <span class="hljs-number">257833881948992845466919654910838972461</span>, <span class="hljs-number">291249161813309696736659661907363469657</span>, <span class="hljs-number">228470133121759300620143703381920625589</span>, <span class="hljs-number">337912208888617180835513160742872043511</span>, <span class="hljs-number">252639095930536359128379880984347614689</span>, <span class="hljs-number">306613178720695137374121633131944714277</span>, <span class="hljs-number">328627523443531702430603855075960220403</span>, <span class="hljs-number">283995291614222889691668376952473718279</span>, <span class="hljs-number">185992200035693404743830210660606140043</span>, <span class="hljs-number">175575945935802771832062328390060568381</span>, <span class="hljs-number">239709736751531517044198331233711541211</span>, <span class="hljs-number">325191992201185112802734343474281930993</span>, <span class="hljs-number">285825734319916654888050222626163129503</span>, <span class="hljs-number">260820892372814862728958615462018022903</span>, <span class="hljs-number">271109638409686342632742230596810197399</span>, <span class="hljs-number">195432366301516284662210689868561107229</span>, <span class="hljs-number">252351678712166898804432075801905414141</span>, <span class="hljs-number">175869608753229067314866329908981554323</span>, <span class="hljs-number">212291732707466211705141589249474157597</span>, <span class="hljs-number">299891357045144243959903067354676661051</span>, <span class="hljs-number">271237385422923460052644584552894282763</span>, <span class="hljs-number">268702576849722796315440463412052409241</span>, <span class="hljs-number">198273535005705777854651218089804228523</span>, <span class="hljs-number">177684355989910045168511400849036259973</span>, <span class="hljs-number">189237944200991357454773904466163557789</span>, <span class="hljs-number">175427967765368330787115337317676160499</span>, <span class="hljs-number">270446056495616077936737430232108222303</span>, <span class="hljs-number">243318639972702711024520926308402316247</span>, <span class="hljs-number">223872107662231922057872197123261908053</span>, <span class="hljs-number">268995355861070998347238198063073079851</span>, <span class="hljs-number">244478236168888494353493404999149985963</span>, <span class="hljs-number">230731375083676409248450208772518041369</span>, <span class="hljs-number">231630208287176700035265642824425872113</span>, <span class="hljs-number">187649298194887119502654724235771449423</span>, <span class="hljs-number">264924369987111619306245625770849264491</span>, <span class="hljs-number">327092811483332202721992798797117253283</span>, <span class="hljs-number">274967838920225995524024619709213673571</span>, <span class="hljs-number">313836314009366857157961838519499192671</span>, <span class="hljs-number">181860768653760352435352944732117309357</span>, <span class="hljs-number">184011200837375425882494435177626368109</span>, <span class="hljs-number">246455975565763627776562816894916143559</span>, <span class="hljs-number">262208917125258935991543552004318662109</span>, <span class="hljs-number">334006940602786701813813048552124976177</span>, <span class="hljs-number">241119397420390120456580389194328607351</span>, <span class="hljs-number">255370083166310325724283692646412327547</span>, <span class="hljs-number">280056982387584554076672702548437488901</span>, <span class="hljs-number">190822826881447578202544631446213911541</span>, <span class="hljs-number">206119293866065537243159766877834200177</span>, <span class="hljs-number">289535246575130471484249052043282790337</span>, <span class="hljs-number">222004375767927951747133364917437739627</span>, <span class="hljs-number">186041951615746748538744491355290007923</span>, <span class="hljs-number">299120276948597373232905692530626175519</span>, <span class="hljs-number">268645812049699572580085139845553457511</span>, <span class="hljs-number">231990902203442306941381714523426756489</span>, <span class="hljs-number">259677531562170067444672097354970172129</span>, <span class="hljs-number">232573792063456357545735601063504090387</span>, <span class="hljs-number">268451806037215206985127877726665463011</span>, <span class="hljs-number">324266632324016349795115268035757999593</span>, <span class="hljs-number">323952615081869295386415078624753400501</span>, <span class="hljs-number">302316593553669781596237136546083536339</span>, <span class="hljs-number">235576231941572491681115931798290883659</span>, <span class="hljs-number">202271277470197960243533508432663735031</span>, <span class="hljs-number">172391954991101354275650988921310984563</span>, <span class="hljs-number">215333185856183701105529790905068832303</span>, <span class="hljs-number">335916893044781805453250006520700519353</span>, <span class="hljs-number">217268288923298532517983372665872329797</span>, <span class="hljs-number">265455575922780577837866687874732212733</span>, <span class="hljs-number">182194442259001995170676842797322170297</span>, <span class="hljs-number">180222796978664332193987060700843734759</span>, <span class="hljs-number">332629077640484670095070754759241249101</span>, <span class="hljs-number">238815683708676274248277883404136375767</span>, <span class="hljs-number">246167709707533867216616011486975023679</span>, <span class="hljs-number">188375282015595301232040104228085154549</span>, <span class="hljs-number">230675799347049231846866057019582889423</span>, <span class="hljs-number">290911573230654740468234181613682439691</span>, <span class="hljs-number">173178956820933028868714760884278201561</span>, <span class="hljs-number">340087079300305236498945763514358009773</span>, <span class="hljs-number">215775253913162994758086261347636015049</span>, <span class="hljs-number">286306008278685809877266756697807931889</span>, <span class="hljs-number">175231652202310718229276393280541484041</span>, <span class="hljs-number">230887015177563361309867021497576716609</span>, <span class="hljs-number">306478031708687513424095160106047572447</span>, <span class="hljs-number">172289054804425429042492673052057816187</span>]<br>enc = <span class="hljs-number">82516114905258351634653446232397085739</span><br><br>known = <span class="hljs-string">b&#x27;LitCTF&#123;&#x27;</span> + <span class="hljs-string">b&#x27;\x00&#x27;</span>*<span class="hljs-number">8</span> + <span class="hljs-string">b&#x27;&#125;&#x27;</span><br>bin_known = <span class="hljs-built_in">bin</span>(bytes_to_long(known))[<span class="hljs-number">2</span>:]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(bin_known)):<br>    enc -= pubkey[i] * <span class="hljs-built_in">int</span>(bin_known[i])<br>    enc %= p<br><br>new_pubkey = pubkey[-<span class="hljs-number">72</span>:-<span class="hljs-number">8</span>]<br><span class="hljs-built_in">print</span>(new_pubkey)<br>n = <span class="hljs-built_in">len</span>(new_pubkey)<br>d = n / log(<span class="hljs-built_in">max</span>(new_pubkey), <span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(CDF(d))<br><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> trange(<span class="hljs-number">256</span>):<br>    S = enc + k*p<br>    L = Matrix(ZZ,n+<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        L[i,i] = <span class="hljs-number">2</span><br>        L[-<span class="hljs-number">1</span>,i] = <span class="hljs-number">1</span><br>        L[i,-<span class="hljs-number">1</span>] = new_pubkey[i]<br>    L[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>] = S<br>    L[:,-<span class="hljs-number">1</span>] *= <span class="hljs-number">2</span><br><br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> L.LLL():<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">set</span>(line[:-<span class="hljs-number">1</span>]).issubset(&#123;-<span class="hljs-number">1</span>,<span class="hljs-number">1</span>&#125;):<br>            m = <span class="hljs-string">&#x27;&#x27;</span><br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> line[:-<span class="hljs-number">1</span>]:<br>                <span class="hljs-keyword">if</span> i == <span class="hljs-number">1</span>:<br>                    m += <span class="hljs-string">&#x27;0&#x27;</span><br>                <span class="hljs-keyword">else</span>:<br>                    m += <span class="hljs-string">&#x27;1&#x27;</span><br>            flag = <span class="hljs-string">b&#x27;LitCTF&#123;&#x27;</span> + long_to_bytes(<span class="hljs-built_in">int</span>(m,<span class="hljs-number">2</span>)) + <span class="hljs-string">b&#x27;&#125;&#x27;</span><br>            <span class="hljs-built_in">print</span>(flag)<br>            <span class="hljs-comment"># LitCTF&#123;Am3xItsT&#125;</span><br><span class="hljs-built_in">print</span>(L)<br></code></pre></td></tr></table></figure>

<h2 id="math"><a href="#math" class="headerlink" title="math"></a>math</h2><p>这里很容易就能查到noise在factordb上利用n-hint&#x3D;noise*()</p>
<p>之后就很简单了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"> <span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> enc <span class="hljs-keyword">import</span> flag<br><br>m = bytes_to_long(flag)<br>e = <span class="hljs-number">65537</span><br>p,q = getPrime(<span class="hljs-number">1024</span>),getPrime(<span class="hljs-number">1024</span>)<br>n = p*q<br>noise = getPrime(<span class="hljs-number">40</span>)<br>tmp1 = noise*p+noise*q<br>tmp2 = noise*noise<br>hint = p*q+tmp1+tmp2<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;hint = <span class="hljs-subst">&#123;hint&#125;</span>&quot;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 17532490684844499573962335739488728447047570856216948961588440767955512955473651897333925229174151614695264324340730480776786566348862857891246670588649327068340567882240999607182345833441113636475093894425780004013793034622954182148283517822177334733794951622433597634369648913113258689335969565066224724927142875488372745811265526082952677738164529563954987228906850399133238995317510054164641775620492640261304545177255239344267408541100183257566363663184114386155791750269054370153318333985294770328952530538998873255288249682710758780563400912097941615526239960620378046855974566511497666396320752739097426013141</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 1443781085228809103260687286964643829663045712724558803386592638665188285978095387180863161962724216167963654290035919557593637853286347618612161170407578261345832596144085802169614820425769327958192208423842665197938979924635782828703591528369967294598450115818251812197323674041438116930949452107918727347915177319686431081596379288639254670818653338903424232605790442382455868513646425376462921686391652158186913416425784854067607352211587156772930311563002832095834548323381414409747899386887578746299577314595641345032692386684834362470575165392266454078129135668153486829723593489194729482511596288603515252196</span><br><span class="hljs-string">hint = 17532490684844499573962335739488728447047570856216948961588440767955512955473651897333925229174151614695264324340730480776786566348862857891246670588649327068340567882240999607182345833441113636475093894425780004013793034622954182148283517822177334733794951622433597634369648913113258689335969565315879035806034866363781260326863226820493638303543900551786806420978685834963920605455531498816171226961859405498825422799670404315599803610007692517859020686506546933013150302023167306580068646104886750772590407299332549746317286972954245335810093049085813683948329319499796034424103981702702886662008367017860043529164</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<h2 id="leak"><a href="#leak" class="headerlink" title="leak"></a>leak</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>flag=<span class="hljs-string">b&#x27;114514f0xsad&#x27;</span><br><br>m = bytes_to_long(flag)<br>p,q,e = getPrime(<span class="hljs-number">1024</span>),getPrime(<span class="hljs-number">1024</span>),getPrime(<span class="hljs-number">101</span>)<br>n = p*q<br>temp = gmpy2.invert(e,p-<span class="hljs-number">1</span>)<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br>hint = temp&gt;&gt;<span class="hljs-number">180</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;hint = <span class="hljs-subst">&#123;hint&#125;</span>&quot;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">e = 1915595112993511209389477484497</span><br><span class="hljs-string">n = 12058282950596489853905564906853910576358068658769384729579819801721022283769030646360180235232443948894906791062870193314816321865741998147649422414431603039299616924238070704766273248012723702232534461910351418959616424998310622248291946154911467931964165973880496792299684212854214808779137819098357856373383337861864983040851365040402759759347175336660743115085194245075677724908400670513472707204162448675189436121439485901172477676082718531655089758822272217352755724670977397896215535981617949681898003148122723643223872440304852939317937912373577272644460885574430666002498233608150431820264832747326321450951</span><br><span class="hljs-string">c = 5408361909232088411927098437148101161537011991636129516591281515719880372902772811801912955227544956928232819204513431590526561344301881618680646725398384396780493500649993257687034790300731922993696656726802653808160527651979428360536351980573727547243033796256983447267916371027899350378727589926205722216229710593828255704443872984334145124355391164297338618851078271620401852146006797653957299047860900048265940437555113706268887718422744645438627302494160620008862694047022773311552492738928266138774813855752781598514642890074854185464896060598268009621985230517465300289580941739719020511078726263797913582399</span><br><span class="hljs-string">hint = 10818795142327948869191775315599184514916408553660572070587057895748317442312635789407391509205135808872509326739583930473478654752295542349813847128992385262182771143444612586369461112374487380427668276692719788567075889405245844775441364204657098142930</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>推导一下设hint&#x3D;dp<br>$$<br>e(d_p+x)&#x3D;k(p-1)+1<br>$$<br>模p之后有为什么可以由mod p推断到mod n看这个你就懂了。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> Crypto.Util.number import bytes_to_long, getPrime, inverse<br><br><span class="hljs-attribute">e</span>=0x10001<br>p,<span class="hljs-attribute">q</span>=getPrime(10),getPrime(10)<br><span class="hljs-attribute">n</span>=p*q<br><span class="hljs-built_in">print</span>(inverse(e,n))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(2*<span class="hljs-number">*10</span>):<br>    <span class="hljs-keyword">if</span> (e*i+11451)%<span class="hljs-attribute">p</span>==0&amp;(e*i+11451)%n==0:<br>        <span class="hljs-built_in">print</span>(i)<br></code></pre></td></tr></table></figure>

<p>$$<br>e(d_p+x)+k-1&#x3D;0 mod p<br>$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># sage10.6</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> itertools<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">small_roots</span>(<span class="hljs-params">f, bounds, m=<span class="hljs-number">1</span>, d=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> d:<br>        d = f.degree()<br>        <span class="hljs-built_in">print</span>(d)<br>    R = f.base_ring()<br>    N = R.cardinality()<br>    f /= f.coefficients().pop(<span class="hljs-number">0</span>)<br>    f = f.change_ring(ZZ)<br>    G = <span class="hljs-type">Sequence</span>([], f.parent())<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m + <span class="hljs-number">1</span>):<br>        base = N ^ (m - i) * f ^ i<br>        <span class="hljs-keyword">for</span> shifts <span class="hljs-keyword">in</span> itertools.product(<span class="hljs-built_in">range</span>(d), repeat=f.nvariables()):<br>            g = base * prod(<span class="hljs-built_in">map</span>(power, f.variables(), shifts))<br>            G.append(g)<br>    B, monomials = G.coefficient_matrix()<br>    monomials = vector(monomials)<br>    factors = [monomial(*bounds) <span class="hljs-keyword">for</span> monomial <span class="hljs-keyword">in</span> monomials]<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, factor)<br>    B = B.dense_matrix().LLL()<br>    B = B.change_ring(QQ)<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, <span class="hljs-number">1</span> / factor)<br>    H = <span class="hljs-type">Sequence</span>([], f.parent().change_ring(QQ))<br>    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">filter</span>(<span class="hljs-literal">None</span>, B * monomials):<br>        H.append(h)<br>        I = H.ideal()<br>        <span class="hljs-keyword">if</span> I.dimension() == -<span class="hljs-number">1</span>:<br>            H.pop()<br>        <span class="hljs-keyword">elif</span> I.dimension() == <span class="hljs-number">0</span>:<br>            roots = []<br>            <span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> I.variety(ring=ZZ):<br>                root = <span class="hljs-built_in">tuple</span>(R(root[var]) <span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> f.variables())<br>                roots.append(root)<br>            <span class="hljs-keyword">return</span> roots<br>    <span class="hljs-keyword">return</span> []<br><br>e = <span class="hljs-number">1915595112993511209389477484497</span><br>n = <span class="hljs-number">12058282950596489853905564906853910576358068658769384729579819801721022283769030646360180235232443948894906791062870193314816321865741998147649422414431603039299616924238070704766273248012723702232534461910351418959616424998310622248291946154911467931964165973880496792299684212854214808779137819098357856373383337861864983040851365040402759759347175336660743115085194245075677724908400670513472707204162448675189436121439485901172477676082718531655089758822272217352755724670977397896215535981617949681898003148122723643223872440304852939317937912373577272644460885574430666002498233608150431820264832747326321450951</span><br>c = <span class="hljs-number">5408361909232088411927098437148101161537011991636129516591281515719880372902772811801912955227544956928232819204513431590526561344301881618680646725398384396780493500649993257687034790300731922993696656726802653808160527651979428360536351980573727547243033796256983447267916371027899350378727589926205722216229710593828255704443872984334145124355391164297338618851078271620401852146006797653957299047860900048265940437555113706268887718422744645438627302494160620008862694047022773311552492738928266138774813855752781598514642890074854185464896060598268009621985230517465300289580941739719020511078726263797913582399</span><br>leak = <span class="hljs-number">10818795142327948869191775315599184514916408553660572070587057895748317442312635789407391509205135808872509326739583930473478654752295542349813847128992385262182771143444612586369461112374487380427668276692719788567075889405245844775441364204657098142930</span><br>leak &lt;&lt;= <span class="hljs-number">180</span><br>R.&lt;x,y&gt; = PolynomialRing(Zmod(n),implementation=<span class="hljs-string">&#x27;generic&#x27;</span>)<br>f = e * (leak + x) + (y - <span class="hljs-number">1</span>)<br>res = small_roots(f,(<span class="hljs-number">2</span>^<span class="hljs-number">180</span>,<span class="hljs-number">2</span>^<span class="hljs-number">101</span>),m=<span class="hljs-number">2</span>,d=<span class="hljs-number">4</span>)<br><span class="hljs-built_in">print</span>(res)<br><span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> res:<br>    dp_low = root[<span class="hljs-number">0</span>]<br>    dp = leak + dp_low<br>    tmp = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,e*dp,n) - <span class="hljs-number">2</span><br>    p = gmpy2.gcd(tmp,n)<br>    q = n // p<br>    d = inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>    m = <span class="hljs-built_in">pow</span>(c,d,n)<br>    <span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment"># LitCTF&#123;03ecda15d1a89b06454c6050c1bd489f&#125;</span><br></code></pre></td></tr></table></figure>

<p>最后一步，证明:<br>$$<br>tmp&#x3D;2^{e<em>d_p}mod n -2\equiv 2^{k_1(p-1)+1}-k_2</em>n-2\equiv 2+k_3<em>p-k_2</em>n-2&#x3D;p(k_3-k_2*q)<br>$$</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/crypto/" class="category-chain-item">crypto</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/crypto/" class="print-no-link">#crypto</a>
      
        <a href="/tags/%E5%A4%8D%E7%8E%B0/" class="print-no-link">#复现</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>LitCTF复现</div>
      <div>http://example.com/2025/05/25/LitCTF/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>fox</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>May 25, 2025</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/05/30/%E7%BE%A4%E8%AE%BA/" title="一篇文章速通群论">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">一篇文章速通群论</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/03/30/%E9%80%86%E5%90%91%E6%A2%85%E6%A3%AE%E7%AE%97%E6%B3%95/" title="梅森旋转生成随机数">
                        <span class="hidden-mobile">梅森旋转生成随机数</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
