

<!DOCTYPE html>
<html lang="zh-CN en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/OIP-C.jpg">
  <link rel="icon" href="/img/OIP-C.jpg">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="fox">
  <meta name="keywords" content="菜菜的密码劳弟">
  
    <meta name="description" content="feistel和spn结构的差分分析前言以下内容仅仅作为个人对差分分析的理解,或许具备一定的参考但是不多哈哈哈,如果发现问题师傅可以私信交流一下 差分分析介绍引入&#x3D;&#x3D;为什么要在分组密码之中差分&#x3D;&#x3D;  我们在通常的加密解密过程中,存在一些场景密钥是会被复用的.有时我们能获得一个加密装置,通过控制输入M得到输出C.如果是以最朴素的方式$C&#x3D;M\oplu">
<meta property="og:type" content="article">
<meta property="og:title" content="feistel和spn结构的差分分析">
<meta property="og:url" content="http://example.com/2025/11/26/feistel%E7%BB%93%E6%9E%84%E5%92%8Cspn%E7%BB%93%E6%9E%84%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%AE%E5%88%86%E5%88%86%E6%9E%90/index.html">
<meta property="og:site_name" content="Rockfox的密码记录">
<meta property="og:description" content="feistel和spn结构的差分分析前言以下内容仅仅作为个人对差分分析的理解,或许具备一定的参考但是不多哈哈哈,如果发现问题师傅可以私信交流一下 差分分析介绍引入&#x3D;&#x3D;为什么要在分组密码之中差分&#x3D;&#x3D;  我们在通常的加密解密过程中,存在一些场景密钥是会被复用的.有时我们能获得一个加密装置,通过控制输入M得到输出C.如果是以最朴素的方式$C&#x3D;M\oplu">
<meta property="og:locale">
<meta property="og:image" content="https://rockfox0.github.io/picx-images-hosting/Pasted-image-20251125173918.8l0ivxj8il.webp">
<meta property="og:image" content="https://rockfox0.github.io/picx-images-hosting/Pasted-image-20251125174238.1lc9e16xbi.webp">
<meta property="og:image" content="https://rockfox0.github.io/picx-images-hosting/Pasted-image-20251125160336.6pny3b6oin.webp">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Lyhappig/images/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0:%E5%AF%86%E7%A0%81%E5%AD%A6:%E5%AF%86%E7%A0%81%E5%88%86%E6%9E%90:%E5%B7%AE%E5%88%86%E5%88%86%E6%9E%90:DES%E5%B7%AE%E5%88%86%E5%88%86%E6%9E%90-7.png">
<meta property="og:image" content="https://rockfox0.github.io/picx-images-hosting/Pasted-image-20251124203354.4qrrcz10ac.webp">
<meta property="article:published_time" content="2025-11-25T16:00:00.000Z">
<meta property="article:modified_time" content="2025-11-26T16:01:02.015Z">
<meta property="article:author" content="fox">
<meta property="article:tag" content="crypto">
<meta property="article:tag" content="algorithm">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://rockfox0.github.io/picx-images-hosting/Pasted-image-20251125173918.8l0ivxj8il.webp">
  
  
  
  <title>feistel和spn结构的差分分析 - Rockfox的密码记录</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":40,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 100vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>fox的密码学习记录</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>Links</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/syc.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="feistel和spn结构的差分分析"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-11-26 00:00" pubdate>
          November 26, 2025 am
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          3.7k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          31 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
        <div class="scroll-down-bar">
          <i class="iconfont icon-arrowdown"></i>
        </div>
      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">feistel和spn结构的差分分析</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="feistel和spn结构的差分分析"><a href="#feistel和spn结构的差分分析" class="headerlink" title="feistel和spn结构的差分分析"></a>feistel和spn结构的差分分析</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p><strong>以下内容仅仅作为个人对差分分析的理解,或许具备一定的参考但是不多哈哈哈,如果发现问题师傅可以私信交流一下</strong></p>
<h2 id="差分分析介绍"><a href="#差分分析介绍" class="headerlink" title="差分分析介绍"></a>差分分析介绍</h2><h3 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h3><p>&#x3D;&#x3D;为什么要在分组密码之中差分&#x3D;&#x3D;</p>
<blockquote>
<p>我们在通常的加密解密过程中,存在一些场景密钥是会被复用的.有时我们能获得一个加密装置,通过控制输入M得到输出C.如果是以最朴素的方式<br>$C&#x3D;M\oplus Key$ 那么我们控制输入m1和得到输出c1就能得到$Key&#x3D;m_{1}\oplus c_{1}$<br>为了防止这种事情的发生我们在分组密码中引入了多个一些线性和非线性的操作..让我们在每轮次线性和非线性的操作中无法轻易的得到key利用明文和密文.<br>或许只有一轮次这种操作,如图他的线性操作都可以逆,并且S盒的非线性操作都是6bit一组你可以轻松爆破,但是一旦轮次增加,就不可能利用单独的爆破对破解效率有足够的提升.<br><img src="https://rockfox0.github.io/picx-images-hosting/Pasted-image-20251125173918.8l0ivxj8il.webp" srcset="/img/loading.gif" lazyload></p>
</blockquote>
<p>]</p>
<blockquote>
<p>因为中间每一轮次都会有key的影响,或是在s盒前或是在S盒后进行与key 异或<br><img src="https://rockfox0.github.io/picx-images-hosting/Pasted-image-20251125174238.1lc9e16xbi.webp" srcset="/img/loading.gif" lazyload></p>
</blockquote>
<p>对于多轮次的这种操作,我们需要利用差分分析来解决经过key对Sbox输入的影响,需要构造输入差分和输出差分.</p>
<h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h3><blockquote>
<p>异或运算是线性的。所以如果我们知道了一对明文，(p1,p2)和一堆密文(c1,c2)</p>
<p>$c_1&#x3D;p_1\oplus k…..c_2&#x3D;p_2\oplus k$</p>
<p>$c_1\oplus c_2&#x3D;p_1\oplus k_1\oplus p_2\oplus k_2&#x3D;p_1\oplus p_2$</p>
<p>所以单纯的异或这样的线性运算，如果我们 知道了一堆密文，想恢复明文是很轻易的</p>
</blockquote>
<ol>
<li>差分值。</li>
</ol>
<blockquote>
<p>设X,X^’’^  ∈{0,1}^n^ 这个表示X是n bit的二进制数。则X和X^’’^ 的差分值的定义为$\Delta X&#x3D;X\oplus X^{‘’}$ </p>
</blockquote>
<ol start="2">
<li>差分对</li>
</ol>
<blockquote>
<p>$设\alpha 和\beta∈[0,1]^{n} 假设\alpha 表示输入对(X,X^{‘’} ) X\oplus X^{“} &#x3D;\alpha$   </p>
<p>$经过某种i轮运算得到的输出Y_i&#x3D;F(X),Y_i^{‘’}&#x3D; F(X^{‘’}) 得到的\beta &#x3D;Y\oplus Y^{‘’} 那么我们称(\alpha,\beta) 为到第i轮的差分对$</p>
</blockquote>
<ol start="3">
<li>差分特征</li>
</ol>
<blockquote>
<p>迭代分组密码的一条i轮差分特征<br>$差分特征\Omega&#x3D;({\beta_0,\beta_1,..,\beta_{i-1},\beta_i})  用输入差分值X \oplus X^{‘’}&#x3D;\alpha &#x3D;\beta_0 ,\在i轮加密过程中，中间状态(Y_j,Y_j^{‘’}) 的差分值为Y_J \oplus Y_J^{‘’}&#x3D;\beta_j，差分特征表示的是整轮每个的数据这也是跟差分对的区别$</p>
</blockquote>
<ol start="4">
<li>差分概率</li>
</ol>
<blockquote>
<p>$当输入差分值为\alpha 经过i轮运算得到输出的\beta的概率表示(\alpha,\beta)的差分概率DP(\alpha,\beta)$</p>
</blockquote>
<ol start="5">
<li>差分特征概率</li>
</ol>
<blockquote>
<p>$迭代分组密码一组差分特征\Omega&#x3D;(\beta_0,\beta_1,..,\beta_{i-1},\beta_i) ,差分特征概率DP(\Omega)&#x3D;DP(\beta_0,\beta_1)*DP(\beta_1,\beta_2)….DP(\beta_{i-1},\beta{i})$</p>
<p>可以看出，差分特征概率会在意过程中得到的差分值</p>
</blockquote>
<ol start="6">
<li><p><strong>活跃S盒（Active S-box）</strong>：<br>在密码算法的某一轮（或某一步骤）中，若某个S盒的​<strong>​输入差分（或线性掩码）不为零​</strong>​，则该S盒被称为​<strong>​活跃S盒​</strong>​。活跃S盒会对输出的差分（或线性特性）产生直接影响。</p>
</li>
<li><p><strong>非活跃S盒（Inactive S-box）</strong>：<br>若某个S盒的​<strong>​输入差分（或线性掩码）为零​</strong>​，则该S盒被称为​<strong>​非活跃S盒​</strong>​。此时，S盒的输出差分也为零（假设S盒是双射的），因此不会对后续轮次的差分传播产生贡献。</p>
</li>
<li><p>正确对与错误对<br> 我们选择合适的路径作为区分之后堆叠数量自动过滤</p>
</li>
</ol>
<h2 id="DES-差分分析"><a href="#DES-差分分析" class="headerlink" title="DES 差分分析"></a>DES 差分分析</h2><h3 id="feistel结构"><a href="#feistel结构" class="headerlink" title="feistel结构"></a>feistel结构</h3><blockquote>
<p>feistel cipher是用来构建分组加密算法的对称结构，很多经典的分组加密都会用到这个比如这里的DES</p>
<p>这个算法中将一直的明文分成两半，一半先保留(L),另一半R被加密。存在一个轮函数f用于加密。F(L,k)用来计算后与R异或用于加密每一轮的R，然后R再与L交换位置一次类推。在传统的DES中这样的计算要进行16次</p>
</blockquote>
<p>这样做解密时也十分方便，将过程反过来即可。<br>为什么可以直接解密,<strong>原理非常简单网上到处都是这里不过多追述</strong><br><img src="https://rockfox0.github.io/picx-images-hosting/Pasted-image-20251125160336.6pny3b6oin.webp" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>DES的过程不过多赘述,相信详情可以网上自查</li>
</ul>
<h3 id="S盒分析"><a href="#S盒分析" class="headerlink" title="S盒分析"></a>S盒分析</h3><ul>
<li>接下来我们对S盒子中第一个表进行分析；</li>
</ul>
<blockquote>
<p>我们回顾一下DES中的S盒加密过程</p>
</blockquote>
<p>在与密钥k异或置换，再S盒压缩</p>
<p>我们现在想要知道密钥Ki，已经知道了E盒扩展后的输入(p1,p2)，p经过k异或后记作b1和b2,p和S盒压缩后的输出(c1,c2)。</p>
<blockquote>
<p>我们记$p1\oplus p2&#x3D;b1\oplus b2&#x3D;P,c1\oplus c2&#x3D;C。$</p>
<p>P是最多6bit的数，C最多是4bit。</p>
</blockquote>
<ul>
<li>解释一下S盒分析的定义:</li>
</ul>
<blockquote>
<p>对于输入的P，有64中可能，对于输出的C有16种可能，并且S盒是非线性的。分布的对应XOR,P和C往往是不规律的。</p>
</blockquote>
<p>例如这里我们可以对S1盒进行分析</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">[ <span class="hljs-comment"># S1</span><br><br>[<span class="hljs-number">14</span>, <span class="hljs-number">4</span>,<span class="hljs-number">13</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>,<span class="hljs-number">15</span>,<span class="hljs-number">11</span>, <span class="hljs-number">8</span>, <span class="hljs-number">3</span>,<span class="hljs-number">10</span>, <span class="hljs-number">6</span>,<span class="hljs-number">12</span>, <span class="hljs-number">5</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>],<br><br>[ <span class="hljs-number">0</span>,<span class="hljs-number">15</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>,<span class="hljs-number">14</span>, <span class="hljs-number">2</span>,<span class="hljs-number">13</span>, <span class="hljs-number">1</span>,<span class="hljs-number">10</span>, <span class="hljs-number">6</span>,<span class="hljs-number">12</span>,<span class="hljs-number">11</span>, <span class="hljs-number">9</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">8</span>],<br><br>[ <span class="hljs-number">4</span>, <span class="hljs-number">1</span>,<span class="hljs-number">14</span>, <span class="hljs-number">8</span>,<span class="hljs-number">13</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>,<span class="hljs-number">11</span>,<span class="hljs-number">15</span>,<span class="hljs-number">12</span>, <span class="hljs-number">9</span>, <span class="hljs-number">7</span>, <span class="hljs-number">3</span>,<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">0</span>],<br><br>[<span class="hljs-number">15</span>,<span class="hljs-number">12</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>,<span class="hljs-number">11</span>, <span class="hljs-number">3</span>,<span class="hljs-number">14</span>,<span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>,<span class="hljs-number">13</span>],<br><br>],<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">S_delta</span>(<span class="hljs-params">S</span>):<br>    B=[]<br>    <span class="hljs-keyword">for</span> S <span class="hljs-keyword">in</span> S_BOXES:<br>        N=&#123;(j,i):[] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)&#125;<br>        <span class="hljs-keyword">for</span> delta_x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):  <span class="hljs-comment"># 输入差分 Δx (0-63)</span><br>            <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):    <span class="hljs-comment"># 遍历所有可能的输入 x</span><br>                x_prime = x ^ delta_x  <span class="hljs-comment"># 计算 x&#x27; = x ⊕ Δx</span><br>                <span class="hljs-keyword">if</span> x_prime &lt; <span class="hljs-number">64</span>:  <span class="hljs-comment"># 确保 x&#x27; 在有效范围内</span><br>                    y = S_ex(x,S)<br>                    y_prime = S_ex(x_prime,S)<br>                    delta_y = y ^ y_prime  <span class="hljs-comment"># 输出差分 Δy</span><br>                    <span class="hljs-comment"># 将输入 x 添加到对应的差分对列表中</span><br>                    N[(delta_x,delta_y)].append(x)<br>        B.append(N)<br>    <span class="hljs-keyword">return</span> B<br><br><br></code></pre></td></tr></table></figure>

<p>我们便可以得到S1盒的相关差分分析，并且我们这里还能得到每一个对应XOR可能的输入B。</p>
<ul>
<li>接下来我们尝试恢复经过S盒前的Key</li>
</ul>
<blockquote>
<p>p1–&gt;key—&gt;B–&gt;[S盒]–&gt;key;</p>
</blockquote>
<p>假设我们知道两对数据。p1和p2以及p_1和p_2。</p>
<blockquote>
<p>P1&#x3D;p1^p_2,</p>
<p>P2&#x3D;p_1^p_2。</p>
<p>B&#x3D;p1^key B*&#x3D;p2^key。</p>
<p>B^B*&#x3D;P1。</p>
<p>B2&#x3D;p_1^key</p>
<p>B2*&#x3D;p_2^key&gt;</p>
<p>B2^B2*&#x3D;P2。。。 </p>
<p>C1&#x3D;S_x(B)^S_x(B*),C2&#x3D;S_x(B2 )^S_x(B2 *)</p>
</blockquote>
<p>我们需要先利用最开始求到的每一对XOR对应的B求出可能的B，讲B和对应的p1异或得到可能的key。真正满足要求的key，会会同时满足两对数据的要求。不过一般情况下两对恢复的精确度是不够的，我这里代码使用了5对这样的数据。</p>
<p>find_key。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_key</span>(<span class="hljs-params">C,P,P1,n,q</span>):<br>    K=[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<br>    N=S_delta(S_BOXES)[q]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        p=split48(P[i])[q]<br>        p1=split48(P1[i])[q]<br>        c=split32(C[i])[q]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(N[(p,c)])):<br>            p2=N[(p,c)][j]<br>            k=p2^p1<br>            K[k]=K[k]+<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> K.index(<span class="hljs-built_in">max</span>(K))<br></code></pre></td></tr></table></figure>

<p>利用所有可能的输入找到key。</p>
<h4 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h4><p>类似这种只对S_box分析的讨论是无意义的,我们更多的是必须在如何更好的爆破被多轮次混淆过后的代码上来.和后面的1轮次和二轮次的DES差分攻击一样,因为其实可以利用爆破的方法恢复出一轮次的key无法体现出需要差分的必要性</p>
<h3 id="三轮次的DES差分分析3轮差分分析其实和一轮二轮差不多，都是对S盒进行的分析。"><a href="#三轮次的DES差分分析3轮差分分析其实和一轮二轮差不多，都是对S盒进行的分析。" class="headerlink" title="三轮次的DES差分分析3轮差分分析其实和一轮二轮差不多，都是对S盒进行的分析。"></a>三轮次的DES差分分析3轮差分分析其实和一轮二轮差不多，都是对S盒进行的分析。</h3><p>示例我们选择的一段明文，</p>
<blockquote>
<p>(R,L)   (R’,L’)</p>
</blockquote>
<img src="https://cdn.jsdelivr.net/gh/Lyhappig/images/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0:%E5%AF%86%E7%A0%81%E5%AD%A6:%E5%AF%86%E7%A0%81%E5%88%86%E6%9E%90:%E5%B7%AE%E5%88%86%E5%88%86%E6%9E%90:DES%E5%B7%AE%E5%88%86%E5%88%86%E6%9E%90-7.png" srcset="/img/loading.gif" lazyload style="zoom: 33%;" />



<p>我们假设R0&#x3D;R0’,</p>
<p>输出$R3&#x3D;L2\oplus f(R2,k2)&#x3D;R1\oplus f(R2,K2)&#x3D;L_0\oplus f(R0,k1)\oplus f(R2,k3)$ ,</p>
<p>$R3’&#x3D;L2\oplus f (R2’k2)&#x3D;R1’\oplus f(R2’,K2)&#x3D;L_0’\oplus f(R0’,k1)\oplus f(R2’,k3)$</p>
<p>那么可以得到,$R3^*&#x3D;R3\oplus R3’&#x3D; L0^* \oplus f(R_2, K_3) \oplus f(R_2’, K_3)$</p>
<p>我们在三轮中已知(R0,L0)   (R0’,L0’)所以 ，输出差分$R3^*&#x3D;L0^* \oplus f(R_2, K_3) \oplus f(R_2’, K_3)$</p>
<p>并且R2&#x3D;L3，R2’&#x3D;L3’，所以我们可以得到输入差分与输出差分的关系。</p>
<p>$R3^<em>\oplus L0^</em>&#x3D; f(L3,k3)\oplus f(L3’,K3)$</p>
<p>我们可以，将L3&#x2F;L3’被E盒转化之后视作S盒的输入。将$R3^<em>\oplus L0^</em>$  逆P盒之后视作输出的异或。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long<br><span class="hljs-keyword">from</span> DIFF.DES <span class="hljs-keyword">import</span> *<br><br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_key3</span>(<span class="hljs-params">M,M1,C</span>):<br>    KEY=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        k=find_key(C,M,M1,<span class="hljs-number">10</span>,i)<br>        KEY.append(k)<br>    <span class="hljs-keyword">return</span> KEY<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    key = <span class="hljs-string">b&quot;8bytekey&quot;</span>  <span class="hljs-comment"># 8 字节密钥</span><br>    MSG=[]<br>    MSG1=[]<br>    Cip=[]<br>    key2=split48(<span class="hljs-number">251738618860716</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        M=urandom(<span class="hljs-number">4</span>)+<span class="hljs-string">b&quot;\00\00\00\00&quot;</span><br>        M1=urandom(<span class="hljs-number">8</span>)<br>        M2=bytes_xor(M,M1)<br>        C1=des_ecb_encrypt1(key,M1,<span class="hljs-number">3</span>)<br>        C2=des_ecb_encrypt1(key,M2,<span class="hljs-number">3</span>)<br>        C=bytes_xor(C1,C2)<br>        L3_1=C1[<span class="hljs-number">4</span>:]<br>        L3_2=C2[<span class="hljs-number">4</span>:]<br>        MSG1.append(permute(bytes_to_long(L3_1),E,<span class="hljs-number">32</span>))<br>        MSG.append(permute(bytes_to_long(bytes_xor(L3_1,L3_2)),E,<span class="hljs-number">32</span>))<br>        L0_1=M1[:<span class="hljs-number">4</span>]<br>        L0_2=M2[:<span class="hljs-number">4</span>]<br>        L0=bytes_xor(L0_1,L0_2)<br>        R3=bytes_xor(C1[:<span class="hljs-number">4</span>],C2[:<span class="hljs-number">4</span>])<br>        Cip.append(permute(bytes_to_long(bytes_xor(R3,L0)),P_INV,<span class="hljs-number">32</span>))<br>    KEY=find_key3(MSG,MSG1,Cip)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Cip=<span class="hljs-subst">&#123;Cip&#125;</span>&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(KEY)<br>    <span class="hljs-built_in">print</span>(key2)<br></code></pre></td></tr></table></figure>

<h3 id="6轮次DES差分分析"><a href="#6轮次DES差分分析" class="headerlink" title="6轮次DES差分分析"></a>6轮次DES差分分析</h3><p>差分分析采用的差分特征如图 7 所示：</p>
<p><img src="https://rockfox0.github.io/picx-images-hosting/Pasted-image-20251124203354.4qrrcz10ac.webp" srcset="/img/loading.gif" lazyload></p>
<center><text><b>图7</b></text></center>

<p>选择明文满足 $L_0’&#x3D;40080000_x$ 和 $R_0’&#x3D;04000000_x$ 的明密文对 $(L_0R_0, L_6R_6)$ 和 $(L_0^<em>R_0^</em>, L_6^<em>R_6^</em>)$，$R_6$ 和 $R_6^*$ 可分别表示为：</p>
<p>$R_6 &#x3D; L_5 \oplus f(R_5, K_6)&#x3D;R_4 \oplus f(R_5, K_6)&#x3D;L_3 \oplus f(R_3, K_4) \oplus f(R_5, K_6) \ R_6^* &#x3D; L_5^* \oplus f(R_5^*, K_6)&#x3D;R_4^* \oplus f(R_5^*, K_6)&#x3D;L_3^* \oplus f(R_3^*, K_4) \oplus f(R_5^*, K_6)$</p>
<p>因此有：</p>
<p>$R_6’&#x3D;L_3’ \oplus f(R_3, K_4) \oplus f(R_3^*, K_4) \oplus f(R_5, K_6)  \oplus f(R_5^*, K_6)$</p>
<p>$R_6’$ 是密文差分的左半部分，从上述构造的差分特征 $\Omega$ 中，由给定明文差分得到第 3 轮的密文差分的概率为 $1&#x2F;16$。如果情况确实如此，那么第 4 轮 $S$ 盒的输入差分可以通过轮函数扩展 $E$ 计算得到：$001000 | 000000|000001|010000 |000000 |000000 |000000 |000000 $</p>
<p>观察到 $S_2, S_5, S_6, S_7, S_8$ 的输入差分全为 0，因此在第 4 轮中这五个 $S$ 盒的输出差分全为0。根据 $P(C_6’)&#x3D;f(R_5, K_6)  \oplus f(R_5^*, K_6), P(C_4’)&#x3D;f(R_3, K_4) \oplus f(R_3^*, K_4)$，代入 $R_6’$，可以得到：</p>
<p>$P(C_6’)&#x3D;R_6’ \oplus L_3’ \oplus P(C_4’)$</p>
<p>故 $C_6’&#x3D;P^{-1}(R_6’ \oplus 04000000_x) \oplus (*0**0000_x)$</p>
<p>据此我们得到第 6 轮轮函数五个非活跃 $S$ 盒的输出差分，而其输入差分可以通过 $B_6&#x3D;E(L_6),B_6^*&#x3D;E(L_6^*)$ 计算出来，这样我们得到了攻击 $S$ 盒的三元组 $(B_6,B_6^*, C_6’)$，然后我们采用如下攻击流程来攻击第 6 轮轮函数的 5 个 $S$ 盒：</p>
<ol>
<li>计算 $C_6’&#x3D;P^{-1}(R_6’ \oplus 04000000_x)$</li>
<li>计算 $B_6 &#x3D; E(L_6), B_6^*&#x3D;E(L_6^*)$，然后计算 $B_6’&#x3D;B_6 \oplus B_6^*$</li>
<li>对于 $i \in {2, 5, 6, 7, 8}$，计算子密钥部分比特 $J_i \in KJ_i, KJ_i &#x3D; IN_S(B_{6,i}’, C_{6,i}’) \oplus B_{6,i}$<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long<br><span class="hljs-keyword">from</span> DES <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_key3</span>(<span class="hljs-params">M,M1,C</span>):<br>    KEY=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        k=find_key(C,M,M1,<span class="hljs-built_in">len</span>(M),i)<br>        KEY.append(k)<br>    <span class="hljs-keyword">return</span> KEY<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    key = <span class="hljs-string">b&quot;8bytekey&quot;</span>  <span class="hljs-comment"># 8 字节密钥</span><br>    MSG=[]<br>    MSG1=[]<br>    Cip=[]<br>    l=<span class="hljs-number">0</span><br>    key2=split48(<span class="hljs-number">193047425125744</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>)):<br>        M=<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&quot;4008000004000000&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(M))<br>        M1=urandom(<span class="hljs-number">8</span>)<br>        M2=bytes_xor(M,M1)<br>        C1=des_ecb_encrypt1(key,M1,<span class="hljs-number">6</span>)<br>        C2=des_ecb_encrypt1(key,M2,<span class="hljs-number">6</span>)<br>        C=bytes_xor(C1,C2)<br>        L3_1=C1[<span class="hljs-number">4</span>:]<br>        L3_2=C2[<span class="hljs-number">4</span>:]<br>        a=<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&quot;04000000&quot;</span>)<br>        MSG1.append(permute(bytes_to_long(L3_1),E,<span class="hljs-number">32</span>))<br>        MSG.append(permute(bytes_to_long(bytes_xor(L3_1,L3_2)),E,<span class="hljs-number">32</span>))<br>        R3=bytes_xor(C1[:<span class="hljs-number">4</span>],C2[:<span class="hljs-number">4</span>])<br>        Cip.append(permute(bytes_to_long((bytes_xor(R3,a))),P_INV,<span class="hljs-number">32</span>))<br>    KEY=find_key3(MSG,MSG1,Cip)<br>    <span class="hljs-built_in">print</span>(KEY)<br>    <span class="hljs-built_in">print</span>(l/<span class="hljs-number">100</span>)<br>    <span class="hljs-built_in">print</span>(key2)<br><br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="SPN-Substitution-Permutation-Network-结构的差分分析"><a href="#SPN-Substitution-Permutation-Network-结构的差分分析" class="headerlink" title="SPN(Substitution-Permutation Network)结构的差分分析"></a>SPN(Substitution-Permutation Network)结构的差分分析</h2><p>SPN结构这里我们参考AES设定了一个Sbox[0-256] 依次打乱顺序,然后P盒用于置换,其实就是SPN意思的来源,</p>
<blockquote>
<p><strong>SPN结构（代换-置换网络）</strong>是一种常见的分组密码加密算法结构，主要用于实现加密和解密过程。其基本思想是将明文分成若干个固定长度的块，然后对每个块进行加密。SPN结构包含三个主要部分：</p>
</blockquote>
<ul>
<li><p><strong>代换层</strong>：通过S盒（Substitution Box）实现明文的代换操作，将明文的每个字节替换成另一个字节。</p>
</li>
<li><p><strong>置换层</strong>：通过P盒（Permutation Box）实现明文的置换操作，将明文的每个字节的位置进行置换。</p>
</li>
<li><p><strong>密钥加层</strong>：将密钥与中间结果进行异或操作，以增强安全性。<br>  SPN结构的代表算法是IDEA（IBM的高级加密标准），它使用64位长度的块和128位长度的密钥，并进行了8.5轮迭代运算<br>这里我们<br>输入M-&gt;P(代换)-&gt;S(置换)-&gt;KEY异或 –…….重复几轮次</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">f_cry</span>(<span class="hljs-params">key,M</span>):<br>    <br>    M=P_ex(M)<br>    M=S_all(M)<br>    M=key^ M<br>    <span class="hljs-keyword">return</span> M<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">M,KEY</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>        M=f_cry(KEY[i],M)<br>    <span class="hljs-keyword">return</span> M<br>    <br><br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="三轮次SPN结构的差分分析"><a href="#三轮次SPN结构的差分分析" class="headerlink" title="三轮次SPN结构的差分分析"></a>三轮次SPN结构的差分分析</h2><p>spn这种结构其实对于差分抗性非常好,如果是AES的Sbox四轮就爆破不了了,aes的S盒子的差分分析表每个输入对应的每个输出分布的非常平均.这里我自己设定了一个十分不安全的Sbox,<br>因为SPN结构和feiste结构的区别,我们的解密分析的方式有点区别<br>我们获取$M$作为一对输入的差分,$C_{1},C_{2}$,分别作为输出差分$C&#x3D;C_{1}\oplus C_{2}$</p>
<p>我们通过寻找一条合理的路径固定第三轮的输入差分为$M$ ,$C_{1},C_{2}$ ,<br>通过测试每个可能的某个字节的key<br>$M&#x3D;INV_S(C_{1}\oplus key)\oplus INV_S(C_{2} \oplus key)$ 这个进行判断来筛选出最可能key<br>不过差分分析最艰难的过程其实是找到一组合适的差分路径.长度越长,找出合适的差分路径难度越大,并且找出概率比较高,所需数据数量少的也会变难</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad,unpad<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> AES_test <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_key</span>(<span class="hljs-params">C,C1,C2,M,B,q</span>):<br>    Key=[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>)]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(C)):<br>        c=C[i][q]<br>        c1=C1[i][q]<br>        c2=C2[i][q]<br>        m=M[i][q]<br>        <span class="hljs-comment">#print(f&#x27;m=&#123;m&#125;,c=&#123;c&#125;,b=&#123;c1&#125;&#x27;,B[(m,c)])</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            y1=S_ex(i^c1,INV_S_BOX)<br>            y2=S_ex(i^c2,INV_S_BOX)<br>            <span class="hljs-keyword">if</span>(y1^y2==m):<br>                Key[i]+=<span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">return</span> Key.index(<span class="hljs-built_in">max</span>(Key))<br>key=[getrandbits(<span class="hljs-number">128</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;key=<span class="hljs-subst">&#123;key&#125;</span>&#x27;</span>)<br><br>MM=[]<br>CC=[]<br>CC1=[]<br>CC2=[]<br>B = S_delta(S_BOX)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    M=<span class="hljs-number">0x8000000000</span><br>    IN=P_inv_ex(M)<br>    M1=getrandbits(<span class="hljs-number">128</span>)<br>    M2=M^M1<br>    C1=encrypt(M1,key)<br>    C2=encrypt(M2,key)<br>    M1=S_all(P_ex(M1))<br>    M2=S_all(P_ex(M2))<br>    C=C1^C2<br>    MM.append(int_to_byte_array(P_ex(<span class="hljs-number">160</span>)))<br>    CC.append(int_to_byte_array(C))<br>    CC1.append(int_to_byte_array(C1))<br>    CC2.append(int_to_byte_array(C2))<br><br>K=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>    k=find_key(CC,CC1,CC2,MM,B,i)<br>    K.append(k)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Key=&quot;</span>,K)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Real Key=&quot;</span>,int_to_byte_array(key[<span class="hljs-number">2</span>]))<br>print_B_max(B)<br><span class="hljs-keyword">if</span>(K==int_to_byte_array(key[<span class="hljs-number">2</span>])):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Success!&quot;</span>)<br><br><br>u=int_to_byte_array(P_ex(<span class="hljs-number">192</span>))<br>w=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> u:<br>    t=[]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        t.append(<span class="hljs-built_in">len</span>(B[(i,j)]))<br>    m=<span class="hljs-built_in">max</span>(t)<br>    jj=t.index(m)<br>    w.append(m)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;i=<span class="hljs-subst">&#123;i&#125;</span>,max=<span class="hljs-subst">&#123;<span class="hljs-built_in">max</span>(t)/<span class="hljs-number">256</span>&#125;</span>,j=<span class="hljs-subst">&#123;jj&#125;</span>&#x27;</span>)<br>        <br>T=[]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;u=<span class="hljs-subst">&#123;u&#125;</span>&#x27;</span>)<br>u1=[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">80</span>, <span class="hljs-number">0</span>, <span class="hljs-number">40</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<br>c3=P_ex(byte_array_to_int(u1))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c3=<span class="hljs-subst">&#123;int_to_byte_array(c3)&#125;</span>&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(B[(i,j)])&gt;<span class="hljs-number">50</span>):<br>            T.append((i,j,<span class="hljs-built_in">len</span>(B[(i,j)])))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;差分对大于75的有：&quot;</span>,T)<br><br></code></pre></td></tr></table></figure>
<p>代码详情见<a target="_blank" rel="noopener" href="https://github.com/rockfox0/Differential-Analysis">https://github.com/rockfox0/Differential-Analysis</a></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a target="_blank" rel="noopener" href="https://www.ioactive.com/wp-content/uploads/2015/07/ldc_tutorial.pdf">https://www.ioactive.com/wp-content/uploads/2015/07/ldc_tutorial.pdf</a><br><a target="_blank" rel="noopener" href="https://link.springer.com/article/10.1007/BF00630563">https://link.springer.com/article/10.1007/BF00630563</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/crypto/" class="category-chain-item">crypto</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/crypto/" class="print-no-link">#crypto</a>
      
        <a href="/tags/algorithm/" class="print-no-link">#algorithm</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>feistel和spn结构的差分分析</div>
      <div>http://example.com/2025/11/26/feistel结构和spn结构分组密码差分分析/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>fox</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>November 26, 2025</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/11/19/RCTF-wp/" title="RCTF-2025部分题目">
                        <span class="hidden-mobile">RCTF-2025部分题目</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
