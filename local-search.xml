<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>docker-desktop ä»£ç†å†²çªé—®é¢˜è§£å†³æ–¹å¼</title>
    <link href="/2025/08/08/docker/"/>
    <url>/2025/08/08/docker/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="docker-ä»£ç†å†²çªé—®é¢˜çš„è§£å†³"><a href="#docker-ä»£ç†å†²çªé—®é¢˜çš„è§£å†³" class="headerlink" title="docker ä»£ç†å†²çªé—®é¢˜çš„è§£å†³"></a>docker ä»£ç†å†²çªé—®é¢˜çš„è§£å†³</h1><p>dockerçš„é…ç½®åœ¨ç½‘ä¸Šå·²ç»æœ‰å¾ˆå¤šï¼Œå¤§å¤šæ•°ç”¨çš„æ˜¯é…ç½®é•œåƒçš„æ–¹æ³•ï¼Œä½†æ˜¯æœ‰çš„ç›†å‹å¯èƒ½å’Œæˆ‘ä¸€æ ·å‘ç°ä¸å¼€ä»£ç†ç™»å½•ä¸ä¸Šå»dockerâ€“desktopï¼Œç™»å½•ä¸Šå»ä¹‹åå‘¢ï¼Œæ‹‰å»é•œåƒä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">docker pull nginx<br>Using default tag: latest<br>Error response <span class="hljs-keyword">from</span> daemon: failed to resolve reference <span class="hljs-string">&quot;docker.io/library/nginx:latest&quot;</span>: failed to do request: Head <span class="hljs-string">&quot;https://hub-mirror.c.163.com/v2/library/nginx/manifests/latest?ns=docker.io&quot;</span>: proxyconnect tcp: dial tcp <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">7897</span>: connect: connection refused<br></code></pre></td></tr></table></figure><p>å› ä¸ºç”¨clash-vergeè¿™æ ·çš„è½¯ä»¶è¿›å…¥ä»£ç†ä¹‹åï¼Œä¼šè‡ªåŠ¨è®¾ç½®</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">HTTP_PROXY</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">7897</span><br><br><span class="hljs-attr">HTTP_PROXYs</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">7897</span><br></code></pre></td></tr></table></figure><p>ç„¶é¹…è¿™æ ·æ˜¯æ‹‰å»ä¸äº†é•œåƒçš„ï¼Œä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ³•æ˜¯ï¼Œ</p><ul><li><p>å…³æ‰ç³»ç»Ÿä»£ç†ï¼Œå¼€å¯è™šæ‹Ÿç½‘å¡æ¨¡å¼ï¼Œè¿™æ ·çš„åå¤„å¯èƒ½å°±æ˜¯ä¸‹ä¸œè¥¿å¡äº†ç‚¹ã€‚</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-08-08-220336.7lkb75nvtm.png" alt="image-20250808221124189"></p></li></ul><p>åœ¨clashvergeé‡Œé¢å¯ä»¥è°ƒæ•´ã€‚</p><p>ä¹‹åå°±å¯ä»¥æ‹‰å»äº†</p>]]></content>
    
    
    <categories>
      
      <category>docker</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å·¥å…·é…ç½®</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CVE-2021-3711çš„åŸç†è§£æä»¥åŠç®€å•å¤ç°</title>
    <link href="/2025/07/20/%E8%BF%87%E7%A8%8B%E8%A7%A3%E6%9E%90/"/>
    <url>/2025/07/20/%E8%BF%87%E7%A8%8B%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="CVE-2021-3711æ¼æ´è§£æ"><a href="#CVE-2021-3711æ¼æ´è§£æ" class="headerlink" title="CVE-2021-3711æ¼æ´è§£æ"></a>CVE-2021-3711æ¼æ´è§£æ</h1><ul><li>è¿™ä¸ªæ–‡ä»¶ä½ç½®åœ¨1.1.1ä¸åŒçš„ç‰ˆæœ¬ä½ç½®å¯èƒ½ä¹Ÿæœ‰å˜åŒ–ï¼Œå…·ä½“å¯ä»¥gptæˆ–è€…å®˜æ–¹æ–‡æ¡£çœ‹çœ‹è¿™é‡Œç¤ºä¾‹çš„æ˜¯)</li></ul><p>åœ¨crypto&#x2F;pkcs7&#x2F;pk7_doit.cï¼Œæœ‰è¿™ä¸ªå‡½æ•°ï¼Œæ˜¯å¯¹è¢«åŒ…è£…çš„å¯†æ–‡è¿›è¡Œè§£å¯†çš„å‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">pkcs7_decrypt_rinfo</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> **pek, <span class="hljs-type">int</span> *peklen,</span><br><span class="hljs-params">                               PKCS7_RECIP_INFO *ri, EVP_PKEY *pkey)</span><br>&#123;<br>    EVP_PKEY_CTX *pctx = <span class="hljs-literal">NULL</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *ek = <span class="hljs-literal">NULL</span>;<br>    <span class="hljs-type">size_t</span> eklen;<br><br>    <span class="hljs-type">int</span> ret = <span class="hljs-number">-1</span>;<br><br>    pctx = EVP_PKEY_CTX_new(pkey, <span class="hljs-literal">NULL</span>);<br>    <span class="hljs-keyword">if</span> (!pctx)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br><br>    <span class="hljs-keyword">if</span> (EVP_PKEY_decrypt_init(pctx) &lt;= <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">goto</span> err;<br><br>    <span class="hljs-keyword">if</span> (EVP_PKEY_CTX_ctrl(pctx, <span class="hljs-number">-1</span>, EVP_PKEY_OP_DECRYPT,<br>                          EVP_PKEY_CTRL_PKCS7_DECRYPT, <span class="hljs-number">0</span>, ri) &lt;= <span class="hljs-number">0</span>) &#123;<br>        PKCS7err(PKCS7_F_PKCS7_DECRYPT_RINFO, PKCS7_R_CTRL_ERROR);<br>        <span class="hljs-keyword">goto</span> err;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (EVP_PKEY_decrypt(pctx, <span class="hljs-literal">NULL</span>, &amp;eklen,<br>                         ri-&gt;enc_key-&gt;data, ri-&gt;enc_key-&gt;length) &lt;= <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">goto</span> err;<br><br>    ek = OPENSSL_malloc(eklen);<br><br>    <span class="hljs-keyword">if</span> (ek == <span class="hljs-literal">NULL</span>) &#123;<br>        PKCS7err(PKCS7_F_PKCS7_DECRYPT_RINFO, ERR_R_MALLOC_FAILURE);<br>        <span class="hljs-keyword">goto</span> err;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (EVP_PKEY_decrypt(pctx, ek, &amp;eklen,<br>                         ri-&gt;enc_key-&gt;data, ri-&gt;enc_key-&gt;length) &lt;= <span class="hljs-number">0</span>) &#123;<br>        ret = <span class="hljs-number">0</span>;<br>        PKCS7err(PKCS7_F_PKCS7_DECRYPT_RINFO, ERR_R_EVP_LIB);<br>        <span class="hljs-keyword">goto</span> err;<br>    &#125;<br><br>    ret = <span class="hljs-number">1</span>;<br><br>    OPENSSL_clear_free(*pek, *peklen);<br>    *pek = ek;<br>    *peklen = eklen;<br><br> err:<br>    EVP_PKEY_CTX_free(pctx);<br>    <span class="hljs-keyword">if</span> (!ret)<br>        OPENSSL_free(ek);<br><br>    <span class="hljs-keyword">return</span> ret;<br>&#125;<br></code></pre></td></tr></table></figure><p>EVP_PKEY_decrypt()æ˜¯è§£å¯†å‡½æ•°ï¼Œæ ¹æ®ä¼ å…¥å†…å®¹ä¼šè‡ªè¡Œåˆ¤æ–­è§£æç»“æ„ä½“å†…çš„å“ªä¸ªè§£å¯†å‡½æ•°ï¼Œé‡Œé¢å°±åŒ…å«SM2çš„è§£å¯†å‡½æ•°ã€‚</p><p>æˆ‘ä»¬æœ€å¼€å§‹ä¹Ÿä¸çŸ¥é“outlenæœ‰å¤šé•¿ï¼Œè¿™ä¸ªoutlené¢„å…ˆåˆ†é…ç»™å¯†æ–‡çš„ç¼“å†²åŒºé•¿åº¦ã€‚æ˜¯å¦‚ä½•åˆ†é…çš„å‘¢ï¼Œæˆ‘ä»¬å¾—å…ˆè·³è½¬ä¸€ä¸‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">pkey_sm2_decrypt</span><span class="hljs-params">(EVP_PKEY_CTX *ctx,</span><br><span class="hljs-params">                            <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *out, <span class="hljs-type">size_t</span> *outlen,</span><br><span class="hljs-params">                            <span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *in, <span class="hljs-type">size_t</span> inlen)</span><br>&#123;<br>    EC_KEY *ec = ctx-&gt;pkey-&gt;pkey.ec;<br>    SM2_PKEY_CTX *dctx = ctx-&gt;data;<br>    <span class="hljs-type">const</span> EVP_MD *md = (dctx-&gt;md == <span class="hljs-literal">NULL</span>) ? EVP_sm3() : dctx-&gt;md;<br><br>    <span class="hljs-keyword">if</span> (out == <span class="hljs-literal">NULL</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!sm2_plaintext_size(ec, md, inlen, outlen))<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>        <span class="hljs-keyword">else</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> sm2_decrypt(ec, md, in, inlen, out, outlen);<br>&#125;<br><br><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">pkey_sm2_ctrl</span><span class="hljs-params">(EVP_PKEY_CTX *ctx, <span class="hljs-type">int</span> type, <span class="hljs-type">int</span> p1, <span class="hljs-type">void</span> *p2)</span><br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€æ¬¡ä¼ å…¥out&#x3D;NULL,ä½¿ç”¨sm2_plaintext_size(ec, md, inlen, outlen)å‡½æ•°ï¼Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> <span class="hljs-title function_">sm2_plaintext_size</span><span class="hljs-params">(<span class="hljs-type">const</span> EC_KEY *key, <span class="hljs-type">const</span> EVP_MD *digest, <span class="hljs-type">size_t</span> msg_len,</span><br><span class="hljs-params">                       <span class="hljs-type">size_t</span> *pt_size)</span><br>    <br>&#123;<br>    <span class="hljs-type">const</span> <span class="hljs-type">size_t</span> field_size = ec_field_size(EC_KEY_get0_group(key));<br>    <span class="hljs-type">const</span> <span class="hljs-type">int</span> md_size = EVP_MD_size(digest);<br>    <span class="hljs-type">size_t</span> overhead;<br><br>    <span class="hljs-keyword">if</span> (md_size &lt; <span class="hljs-number">0</span>) &#123;<br>        SM2err(SM2_F_SM2_PLAINTEXT_SIZE, SM2_R_INVALID_DIGEST);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (field_size == <span class="hljs-number">0</span>) &#123;<br>        SM2err(SM2_F_SM2_PLAINTEXT_SIZE, SM2_R_INVALID_FIELD);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br><br>    overhead = <span class="hljs-number">10</span> + <span class="hljs-number">2</span> * field_size + (<span class="hljs-type">size_t</span>)md_size;<br>    <span class="hljs-keyword">if</span> (msg_len &lt;= overhead) &#123;<br>        SM2err(SM2_F_SM2_PLAINTEXT_SIZE, SM2_R_INVALID_ENCODING);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br><br>    *pt_size = msg_len - overhead;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">const</span> <span class="hljs-type">size_t</span> field_size = ec_field_size(EC_KEY_get0_group(key));<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°æ˜¯è·å–keyæ‰€åœ¨æ¤­åœ†æ›²çº¿çš„åŸŸçš„å¤§å°ï¼Œé‚£ä¹ˆè¿™ä¸ªåŸŸçš„å¤§å°å°±æ˜¯pï¼Œsm2å›ºå®šçš„åŸŸçš„å¤§å°æ˜¯32å­—èŠ‚ï¼Œè¿™é‡Œç”¨åŸŸçš„å¤§å°ä»£æ›¿äº†xå’Œyçš„å¤§å°ï¼Œä¸è¿‡è¿™é‡Œæ˜¯ä¸ä¸¥è°¨çš„ã€‚å› ä¸ºx,yçš„å¤§å°ä¹Ÿå¯èƒ½å°äº32å­—èŠ‚.</p><p>è¿™é‡Œå¾—åˆ°çš„</p><p> overhead &#x3D; 10 + 2 * field_size + (size_t)md_size;</p><p>  *pt_size &#x3D; msg_len - overhead;</p><p>å³å³å°†åˆ†é…çš„ç»™è¾“å‡ºæ˜æ–‡çš„ç¼“å†²åŒº(é€šè¿‡å¯†æ–‡çš„å¤§æ¦‚é•¿åº¦æ¨ç®—å‡ºæ˜æ–‡çš„)ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä»‹ç»ä¸€äº›ANS.1çš„å¤§æ¦‚ç»“æ„è§æ–‡æ¡£å¦ä¸€éƒ¨åˆ†ã€‚10å°±æ˜¯å‰é¢çš„TAGå’Œlenthå çš„</p><p>æˆ‘ä»¬è®¡ç®—å¾—å‡ºvalueæ˜¯*pt_sizeï¼Œä¸è¿‡å¦‚æœfield_silzeåå¤§ï¼Œé‚£ä¹ˆç¼“å†²åŒºå°±ä¼šåå°ï¼Œå¾—åˆ°æ˜æ–‡çš„æ—¶å€™å°±ä¼šå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚</p><p>æˆ‘ä»¬åªéœ€è¦ç”¨ç¼“å†²åŒºä¸º31bitçš„æ˜æ–‡åŠ å¯†ï¼Œåç»­è¿›è¡Œè§£å¯†çš„æ—¶å€™å°±ä¼šå‘ç°è§¦å‘äº†ç¼“å†²åŒºæº¢å‡ºçš„æ¼æ´ã€‚</p><ul><li><p>è¡¥å……ï¼Œç”±äºè¿™ä¸ªopenssl1.1.1ç³»åˆ—è¿˜æ²¡æœ‰å¯¹sm2åšä¸“é—¨çš„ç­¾åæ¥å£ï¼Œå‘½ä»¤ä¹Ÿåªèƒ½ç”¨äºç”Ÿæˆå…¬é’¥ç§é’¥ã€‚ä¸è¿‡å¯ä»¥å¤æ‚ä¸€ç‚¹çš„æ–¹å¼æ¥è°ƒç”¨evpæ¥è¿›è¡Œã€‚</p><p>è¯¥ä»£ç åœ¨openssl1.1.1-x64è¿è¡Œã€‚</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;openssl/ec.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;openssl/evp.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;openssl/bn.h&quot;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">sm2_encrypt</span><span class="hljs-params">(EVP_PKEY* pkey, <span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>* message, <span class="hljs-type">size_t</span> message_len,</span><br><span class="hljs-params">    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>** ciphertext, <span class="hljs-type">size_t</span>* ciphertext_len)</span><br>&#123;<br>    EVP_PKEY_CTX* ectx = <span class="hljs-literal">NULL</span>;<br>    <span class="hljs-type">int</span> ret = <span class="hljs-number">-1</span>;<br><br>    <span class="hljs-keyword">if</span> (!(ectx = EVP_PKEY_CTX_new(pkey, <span class="hljs-literal">NULL</span>))) <span class="hljs-keyword">goto</span> end;<br>    <span class="hljs-keyword">if</span> (EVP_PKEY_encrypt_init(ectx) != <span class="hljs-number">1</span>) <span class="hljs-keyword">goto</span> end;<br><br>    <span class="hljs-comment">// æŸ¥è¯¢å¯†æ–‡é•¿åº¦</span><br>    <span class="hljs-keyword">if</span> (EVP_PKEY_encrypt(ectx, <span class="hljs-literal">NULL</span>, ciphertext_len, message, message_len) != <span class="hljs-number">1</span>) <span class="hljs-keyword">goto</span> end;<br><br>    *ciphertext = (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>*)<span class="hljs-built_in">malloc</span>(*ciphertext_len);<br>    <span class="hljs-keyword">if</span> (!(*ciphertext)) <span class="hljs-keyword">goto</span> end;<br><br>    <span class="hljs-keyword">if</span> (EVP_PKEY_encrypt(ectx, *ciphertext, ciphertext_len, message, message_len) != <span class="hljs-number">1</span>) <span class="hljs-keyword">goto</span> end;<br><br>    ret = <span class="hljs-number">0</span>;<br><br>end:<br>    <span class="hljs-keyword">if</span> (ectx) EVP_PKEY_CTX_free(ectx);<br>    <span class="hljs-keyword">return</span> ret;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">sm2_decrypt</span><span class="hljs-params">(EVP_PKEY* pkey, <span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>* ciphertext, <span class="hljs-type">size_t</span> ciphertext_len,</span><br><span class="hljs-params">    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>** plaintext, <span class="hljs-type">size_t</span>* plaintext_len)</span><br>&#123;<br>    EVP_PKEY_CTX* dctx = <span class="hljs-literal">NULL</span>;<br>    <span class="hljs-type">int</span> ret = <span class="hljs-number">-1</span>;<br><br>    <span class="hljs-keyword">if</span> (!(dctx = EVP_PKEY_CTX_new(pkey, <span class="hljs-literal">NULL</span>))) <span class="hljs-keyword">goto</span> end;<br>    <span class="hljs-keyword">if</span> (EVP_PKEY_decrypt_init(dctx) != <span class="hljs-number">1</span>) <span class="hljs-keyword">goto</span> end;<br><br>    <span class="hljs-comment">// æŸ¥è¯¢æ˜æ–‡é•¿åº¦</span><br>    <span class="hljs-keyword">if</span> (EVP_PKEY_decrypt(dctx, <span class="hljs-literal">NULL</span>, plaintext_len, ciphertext, ciphertext_len) != <span class="hljs-number">1</span>) <span class="hljs-keyword">goto</span> end;<br><br>    *plaintext = (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>*)<span class="hljs-built_in">malloc</span>(*plaintext_len);<br>    <span class="hljs-keyword">if</span> (!(*plaintext)) <span class="hljs-keyword">goto</span> end;<br><br>    <span class="hljs-keyword">if</span> (EVP_PKEY_decrypt(dctx, *plaintext, plaintext_len, ciphertext, ciphertext_len) != <span class="hljs-number">1</span>) <span class="hljs-keyword">goto</span> end;<br><br>    ret = <span class="hljs-number">0</span>;<br><br>end:<br>    <span class="hljs-keyword">if</span> (dctx) EVP_PKEY_CTX_free(dctx);<br>    <span class="hljs-keyword">return</span> ret;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>    <span class="hljs-type">int</span> ret = <span class="hljs-number">-1</span>, i;<br>    EVP_PKEY_CTX* pctx = <span class="hljs-literal">NULL</span>;<br>    EVP_PKEY* pkey = <span class="hljs-literal">NULL</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> message[<span class="hljs-number">16</span>] = &#123; <span class="hljs-number">0x0</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x4</span>, <span class="hljs-number">0x5</span>, <span class="hljs-number">0x6</span>, <span class="hljs-number">0x7</span>,<br>                                  <span class="hljs-number">0x8</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xA</span>, <span class="hljs-number">0xB</span>, <span class="hljs-number">0xC</span>, <span class="hljs-number">0xD</span>, <span class="hljs-number">0xE</span>, <span class="hljs-number">0xF</span> &#125;;<br>    <span class="hljs-type">size_t</span> message_len = <span class="hljs-keyword">sizeof</span>(message);<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>* ciphertext = <span class="hljs-literal">NULL</span>, * plaintext = <span class="hljs-literal">NULL</span>;<br>    <span class="hljs-type">size_t</span> ciphertext_len, plaintext_len;<br><br>    <span class="hljs-comment">// ç”Ÿæˆ SM2 å¯†é’¥å¯¹</span><br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>&gt;<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-keyword">if</span> (!(pctx = EVP_PKEY_CTX_new_id(EVP_PKEY_EC, <span class="hljs-literal">NULL</span>))) <span class="hljs-keyword">goto</span> clean_up;<br>        <span class="hljs-keyword">if</span> (EVP_PKEY_paramgen_init(pctx) != <span class="hljs-number">1</span>) <span class="hljs-keyword">goto</span> clean_up;<br>        <span class="hljs-keyword">if</span> (EVP_PKEY_CTX_set_ec_paramgen_curve_nid(pctx, NID_sm2) &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">goto</span> clean_up;<br>        <span class="hljs-keyword">if</span> (EVP_PKEY_keygen_init(pctx) != <span class="hljs-number">1</span>) <span class="hljs-keyword">goto</span> clean_up;<br>        <span class="hljs-keyword">if</span> (EVP_PKEY_keygen(pctx, &amp;pkey) != <span class="hljs-number">1</span>) <span class="hljs-keyword">goto</span> clean_up;<br><br>        <span class="hljs-comment">// è®¾ç½® SM2 ç±»å‹</span><br>        <span class="hljs-keyword">if</span> (EVP_PKEY_set_alias_type(pkey, EVP_PKEY_SM2) != <span class="hljs-number">1</span>) <span class="hljs-keyword">goto</span> clean_up;<br><br>        <span class="hljs-comment">// åŠ å¯†</span><br>        <span class="hljs-keyword">if</span> (sm2_encrypt(pkey, message, message_len, &amp;ciphertext, &amp;ciphertext_len) != <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Encryption failed!\n&quot;</span>);<br>            <span class="hljs-keyword">goto</span> clean_up;<br>        &#125;<br><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Ciphertext length: %zu\nCiphertext (ASN.1 encoded):\n&quot;</span>, ciphertext_len);<br>        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; (<span class="hljs-type">int</span>)ciphertext_len; i++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;0x%02x &quot;</span>, ciphertext[i]);<br>        &#125;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n\n&quot;</span>);<br>        <span class="hljs-keyword">if</span> (ciphertext_len == <span class="hljs-number">121</span> ) &#123;<br>            <span class="hljs-keyword">break</span>;<span class="hljs-comment">//åˆ¤æ–­ï¼Œè®©ç”±äºå…¶ä»–ä¸¤ä¸ªC2å’ŒC3å¦‚æœåœ¨å¯†æ–‡ä¸å˜çš„æƒ…å†µä¸‹æ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦é™å®šå®ƒå°äºæ­£å¸¸ç”Ÿæˆé•¿åº¦çš„å°ä¸€äº›å°±è¡Œ</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// è§£å¯†</span><br>    <span class="hljs-keyword">if</span> (sm2_decrypt(pkey, ciphertext, ciphertext_len, &amp;plaintext, &amp;plaintext_len) != <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Decryption failed!\n&quot;</span>);<br>        <span class="hljs-keyword">goto</span> clean_up;<br>    &#125;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Decrypted plaintext length: %zu\nPlaintext:\n&quot;</span>, plaintext_len);<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; (<span class="hljs-type">int</span>)plaintext_len; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;0x%02x &quot;</span>, plaintext[i]);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n\n&quot;</span>);<br><br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;SM2 encryption and decryption succeeded.\n&quot;</span>);<br>    ret = <span class="hljs-number">0</span>;<br><br>clean_up:<br>    <span class="hljs-keyword">if</span> (pctx) EVP_PKEY_CTX_free(pctx);<br>    <span class="hljs-keyword">if</span> (pkey) EVP_PKEY_free(pkey);<br>    <span class="hljs-keyword">if</span> (ciphertext) <span class="hljs-built_in">free</span>(ciphertext);<br>    <span class="hljs-keyword">if</span> (plaintext) <span class="hljs-built_in">free</span>(plaintext);<br><br><span class="hljs-meta">#<span class="hljs-keyword">if</span> defined(_WIN32) || defined(_WIN64)</span><br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br><br>    <span class="hljs-keyword">return</span> ret;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>åŸç†å·²ç»è®²è§£è¿‡ï¼Œå…·ä½“å†…å®¹è§ä»£ç ã€‚</p><p>è¿è¡Œæˆªå›¾å¦‚ä¸‹</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-07-21-022651.2dozt8fp5d.webp"></p><ul><li><p>ä¸€äº›åæ§½</p><p>ç”±äºsmåœ¨openssl1.1.1åˆšåˆšå¼•å…¥opensslï¼Œæ‰€ä»¥sm2å¹¶æ²¡æœ‰åšé€‚é…çš„æ¥å£ï¼Œè¦ä»evpè°ƒç”¨ï¼Œè¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦ã€‚å¹¶ä¸”ç”Ÿæˆè¯ä¹¦çš„å‘½ä»¤ä¹Ÿæ²¡æœ‰ç»™ï¼Œåªèƒ½ç”Ÿæˆå…¬ç§é’¥ã€‚åŠ ä¸Šsmå…¶å®ç”¨çš„äººæœ¬æ¥ä¹Ÿä¸å¤šï¼Œåº”ç”¨èŒƒå›´å°±æ›´å°‘äº†ï¼Œéš¾æ€ªæ²¡ä»€ä¹ˆäººå¤ç°ï¼Œåº”ç”¨ä¹Ÿæ²¡ä»€ä¹ˆäººæœ‰ï¼Œåœ¨æœ¬åœ°è§¦å‘è¿™ä¸ªæ¼æ´ï¼Œå°±å½“ä½œå­¦ä¹ å§.2333ã€‚å¦‚æœæœ‰çˆ±æŠ˜è…¾çš„Pwnæ‰‹ä¹Ÿå¯ä»¥æœ¬åœ°æ­ä¸€ä¸ªä¼ å…¥dockeråšctfé¢˜ã€‚ä¹Ÿå¯ä»¥åœ¨webåšDOSã€‚è¿˜æ˜¯è¿™ä¸ªæ¼æ´åšäº†æ–­æ–­ç»­ç»­10å¤©ï¼Œemmï¼Œopensslçš„è¿˜æ˜¯æŒºæœ‰è¶£çš„ã€‚</p></li><li><p>å­¦å¯†ç ä¹Ÿ10ä¸ªæœˆäº†ï¼Œè¿˜æ˜¯æ¯”è¾ƒèœï¼Œå¦‚æœ‰é—®é¢˜è¿˜è¯·è°…è§£ã€‚å¦‚æœæœ‰äººæƒ³è®¨è®ºè¿™ä¸ªä¹Ÿå¯ä»¥ç§ä¿¡æˆ‘çš„é‚®ç®±<a href="mailto:&#x32;&#x34;&#x30;&#x35;&#x35;&#48;&#x38;&#x31;&#51;&#52;&#64;&#113;&#113;&#46;&#x63;&#x6f;&#109;">&#x32;&#x34;&#x30;&#x35;&#x35;&#48;&#x38;&#x31;&#51;&#52;&#64;&#113;&#113;&#46;&#x63;&#x6f;&#109;</a></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>tools</category>
      
      <category>crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
      <tag>openssl</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>opensslä½¿ç”¨-1</title>
    <link href="/2025/07/06/openssl/"/>
    <url>/2025/07/06/openssl/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Opensslä½¿ç”¨-1"><a href="#Opensslä½¿ç”¨-1" class="headerlink" title="Opensslä½¿ç”¨-1"></a>Opensslä½¿ç”¨-1</h1><p>è¿™ä¸€ç« ä»‹ç»ä¸€äº›åŸºç¡€çš„å‘½ä»¤ã€‚opensslç”¨çš„åœ°æ–¹æœ‰ç‚¹å¤šï¼Œåˆ†ä¸¤å¼ å†™</p><h2 id="opensslçš„å®‰è£…å’Œé…ç½®"><a href="#opensslçš„å®‰è£…å’Œé…ç½®" class="headerlink" title="opensslçš„å®‰è£…å’Œé…ç½®"></a>opensslçš„å®‰è£…å’Œé…ç½®</h2><p><a href="https://slproweb.com/products/Win32OpenSSL.html">Win32&#x2F;Win64 OpenSSL Installer for Windows - Shining Light Productions</a></p><p>ä¸‹è½½åœ°å€</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-07-07-000005.7i0nyoqjt3.webp"></p><p>ä½¿ç”¨è¿™é‡Œæ˜¯åˆ«äººé…ç½®å¥½çš„å®‰è£…åŒ…</p><p>ä¸‹å¥½ä¹‹åç‚¹å‡»å®‰è£…ï¼Œä¹‹åå°±å‚»ç“œå¼ç‚¹ç‚¹ç‚¹ã€‚</p><ul><li>é…ç½®ç¯å¢ƒå˜é‡</li></ul><p><img src="C:/Users/24055/AppData/Roaming/Typora/typora-user-images/image-20250707002024482.png" alt="image-20250707002024482"></p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-07-07-001850.icegseekn.webp" alt="image-20250707002030726"></p><p>è¿™æ ·å°±é…ç½®å¥½äº†</p><ul><li>lunixä¸‹é…ç½®</li></ul><p>Lunixé…ç½®æ¯”è¾ƒç®€å•è¿™é‡Œå°±çœç•¥äº†å˜¿å˜¿ã€‚ã€‚ã€‚</p><h2 id="ä½¿ç”¨æ•™ç¨‹"><a href="#ä½¿ç”¨æ•™ç¨‹" class="headerlink" title="ä½¿ç”¨æ•™ç¨‹"></a>ä½¿ç”¨æ•™ç¨‹</h2><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>OpenSSL æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å¼€æºå·¥å…·ï¼Œç”¨äºå®ç°å®‰å…¨é€šä¿¡çš„åŠ å¯†åè®®ã€‚å®ƒæä¾›äº† <strong>åŠ å¯†ç®—æ³•ã€å¯†é’¥ç”Ÿæˆã€è¯ä¹¦ç®¡ç†ã€SSL&#x2F;TLS åè®®å®ç°</strong> ç­‰ä¸€ç³»åˆ—åŠŸèƒ½ï¼Œå¹¿æ³›ç”¨äº Web æœåŠ¡å™¨ã€å®‰å…¨é‚®ä»¶ã€VPNã€ä»£ç ç­¾åç­‰é¢†åŸŸã€‚</p><h2 id="åŸºæœ¬å‘½ä»¤"><a href="#åŸºæœ¬å‘½ä»¤" class="headerlink" title="åŸºæœ¬å‘½ä»¤"></a>åŸºæœ¬å‘½ä»¤</h2><ol><li>æŸ¥çœ‹ç‰ˆæœ¬</li></ol><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">C</span>:\Users\<span class="hljs-number">24055</span>&gt;openssl version<br><span class="hljs-attribute">OpenSSL</span> <span class="hljs-number">3</span>.<span class="hljs-number">5</span>.<span class="hljs-number">1</span> <span class="hljs-number">1</span> Jul <span class="hljs-number">2025</span> (Library: OpenSSL <span class="hljs-number">3</span>.<span class="hljs-number">5</span>.<span class="hljs-number">1</span> <span class="hljs-number">1</span> Jul <span class="hljs-number">2025</span>)<br></code></pre></td></tr></table></figure><ol start="2"><li>ç”Ÿæˆéšæœºæ•°</li></ol><p>ç”¨ <code>openssl rand</code> å‘½ä»¤ç”Ÿæˆéšæœºå­—èŠ‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><br>openssl rand [é€‰é¡¹] <span class="hljs-tag">&lt;<span class="hljs-name">å­—èŠ‚æ•°</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œç”Ÿæˆ 16 å­—èŠ‚éšæœºæ•°æ®ï¼ˆä»¥äºŒè¿›åˆ¶è¾“å‡ºï¼‰ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><br><span class="hljs-attribute">openssl</span> rand <span class="hljs-number">16</span> &gt; random.bin<br></code></pre></td></tr></table></figure><p>ç”Ÿæˆ 16 å­—èŠ‚éšæœºæ•°æ®ï¼ˆä»¥åå…­è¿›åˆ¶è¾“å‡ºï¼‰ï¼š</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl">openssl <span class="hljs-keyword">rand</span> -<span class="hljs-keyword">hex</span> <span class="hljs-number">16</span><br></code></pre></td></tr></table></figure><hr><p>ç”Ÿæˆ Base64 ç¼–ç çš„éšæœºæ•°openssl rand -base64</p><p>è¾“å‡ºç±»ä¼¼ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">t3jv5Q9Qs9k1J9YTqxBfGQ</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><br></code></pre></td></tr></table></figure><ol start="3"><li>æ‘˜è¦å‡½æ•°</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">(openssl) fox@localhost:/mnt/c/Users/24055$ vi ms.txt<br>(openssl) fox@localhost:/mnt/c/Users/24055$ openssl dgst -SHA256 -hex ms.txt<br>SHA2-256(ms.txt)= e5e94ea36193df8f2b31f31cd50ab0db3affbf28cd8c0b6158355e5104a7b8d1<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨SHA-235å°†ms.txtå†…çš„æ–‡æœ¬è¿›è¡Œæ‘˜è¦å‡½æ•°è®¡ç®—ã€‚ä¹‹åè¿›è¡Œhexç¼–ç å°½ç®¡hexæ˜¯é»˜è®¤çš„ç¼–ç æ–¹å¼</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">(openssl) fox@localhost:/mnt/c/Users/24055$ openssl dgst -SHA256 -out dgst.d ms.txt<br>(openssl) fox@localhost:/mnt/c/Users/24055$ vi dgst.d<br></code></pre></td></tr></table></figure><p>hashåçš„å†…å®¹å†™å…¥æ–‡ä»¶dgst.dä¸­ -out <filename> æŒ‡å®šæ‘˜è¦è¾“å‡ºæ–‡ä»¶</p><h3 id="æ•°å­—ç­¾å"><a href="#æ•°å­—ç­¾å" class="headerlink" title="æ•°å­—ç­¾å"></a>æ•°å­—ç­¾å</h3><ol><li>ç”Ÿæˆrsaå…¬é’¥å’Œç§é’¥</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">openssl genpkey -algorithm RSA -out rsa.key -pkeyopt rsa_keygen_bits:2048<br></code></pre></td></tr></table></figure><p><code>openssl genpkey</code><br> OpenSSL ç”Ÿæˆç§é’¥çš„å‘½ä»¤ï¼Œæ˜¯æ¯”æ—§å‘½ä»¤ <code>genrsa</code> æ›´é€šç”¨ã€æ¨èçš„æ–°å‘½ä»¤ã€‚</p><p><code>-algorithm RSA</code><br> æŒ‡å®šç”Ÿæˆçš„æ˜¯ RSA ç®—æ³•çš„å¯†é’¥å¯¹ã€‚</p><p><code>-out rsa.key</code><br> å°†ç”Ÿæˆçš„ç§é’¥ä¿å­˜åˆ°åä¸º <code>rsa.key</code> çš„æ–‡ä»¶ä¸­ã€‚</p><p><code>-pkeyopt rsa_keygen_bits:2048</code><br> ç§é’¥ç”Ÿæˆå‚æ•°ï¼ŒæŒ‡å®šå¯†é’¥é•¿åº¦ä¸º 2048 ä½ï¼ˆ2048-bit RSA å¯†é’¥ï¼‰ã€‚</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-07-07-035712.73u87titiz.webp"></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">(openssl) fox@localhost:/mnt/c/Users/24055$ openssl dgst -sha256 -sign rsa.key -out signature.sign msg.txt<br>(openssl) fox@localhost:/mnt/c/Users/24055$ <span class="hljs-built_in">cat</span> signature.sign<br>ï¿½<span class="hljs-string">&quot;ï¿½eï¿½Eï¿½ï¿½l4ï¿½tCyRï¿½`ï¿½=@f</span><br><span class="hljs-string">                     ]ï¿½ï¿½ï¿½       Ü”ï¿½mï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½Ù£ï¿½?-</span><br><span class="hljs-string">ï¿½ï¿½ï¿½ï¿½Û’(ï¿½,&amp;ï¿½â¦5kï¿½ë¾‰ï¿½ï¿½_hï¿½-ï¿½ï¿½,?&amp;Kï¿½ï¿½NO9ï¿½ï¿½,sï¿½ï¿½7Bï¿½ï¿½oï¿½ï¿½wï¿½Ú‡v&#x27;ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½</span><br><span class="hljs-string">                                                         T9*]`)ï¿½Zï¿½Nï¿½ï¿½d8*P_ï¿½0Yï¿½BN5ï¿½ï¿½ï¿½Ä¸</span><br><span class="hljs-string">                                                                                     Nï¿½89ï¿½ï¿½</span><br><span class="hljs-string">                                                                                           ï¿½Qï¿½Uï¿½ï¿½ï¿½|Mï¿½ï¿½ï¿½@ï¿½LYÓºï¿½ï¿½T7ï¿½ï¿½ï¿½8uljÖ¯ï¿½dhï¿½Mï¿½@$ï¿½m/&amp;ï¿½ï¿½ï¿½+ï¿½ï¿½ï¿½ï¿½ï¿½Oï¿½ï¿½ï¿½Fï¿½      Bï¿½Pï¿½ï¿½ï¿½oPï¿½ï¿½ï¿½aIï¿½_NB(openssl) (openssl) fox@localhost:/mnt/c/Users/24055$</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ç”¨</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir">(openssl) fox<span class="hljs-variable">@localhost</span><span class="hljs-symbol">:/mnt/c/Users/</span><span class="hljs-number">24055</span><span class="hljs-variable">$ </span>openssl dgst -sha256 -sign rsa.key -out signature.sign msg.txt<br></code></pre></td></tr></table></figure><p>åŠ å¯†ç­¾åã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">(openssl) fox@localhost:/mnt/c/Users/24055$ openssl rsa -<span class="hljs-keyword">in</span> rsa.key -pubout -out rsa_pu<br>b.key<br><br></code></pre></td></tr></table></figure><p>ç”Ÿæˆå¯¹åº”çš„å…¬é’¥åœ¨rsa_pub.key</p><p>ç„¶åç”¨å®ƒéªŒè¯ç­¾åã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">(openssl) fox@localhost:/mnt/c/Users/24055$ openssl dgst -sha256 -verify rsa_pub.key -signature signature.sign msg.txt<br>Verified OK#éªŒè¯æˆåŠŸæ˜¾ç¤º<br></code></pre></td></tr></table></figure><p> ğŸ”¹ <code>openssl</code></p><p>è°ƒç”¨ OpenSSL å‘½ä»¤è¡Œå·¥å…·ã€‚</p><hr><p> ğŸ”¹ <code>dgst</code></p><p>æ˜¯ OpenSSL çš„â€œdigestâ€å­å‘½ä»¤ï¼Œç”¨äºå¤„ç†<strong>å“ˆå¸Œæ‘˜è¦ç›¸å…³æ“ä½œ</strong>ï¼ŒåŒ…æ‹¬è®¡ç®—ã€ç­¾åã€éªŒè¯ç­‰ã€‚</p><hr><p> ğŸ”¹ <code>-sha256</code></p><p>è¡¨ç¤ºç”¨ <strong>SHA-256 å“ˆå¸Œç®—æ³•</strong>å¯¹è¾“å…¥æ–‡ä»¶ <code>msg.txt</code> è¿›è¡Œæ‘˜è¦ã€‚<br> æ•°å­—ç­¾åçš„æµç¨‹ä¸­ä¸€èˆ¬å…ˆåšæ‘˜è¦ï¼Œæ‰€ä»¥å¿…é¡»æŒ‡å®šæ‘˜è¦ç®—æ³•ï¼ˆå’Œç­¾åæ—¶ç”¨çš„ä¸€è‡´ï¼‰ã€‚</p><hr><p> ğŸ”¹ <code>-verify rsa_pub.key</code></p><p>è¡¨ç¤ºä½¿ç”¨ <code>rsa_pub.key</code> è¿™ä¸ªæ–‡ä»¶ä¸­ä¿å­˜çš„<strong>RSAå…¬é’¥</strong>è¿›è¡ŒéªŒè¯ã€‚<br> å…¬é’¥çš„ä½œç”¨æ˜¯ï¼š<strong>éªŒè¯ç­¾åæ˜¯å¦åˆæ³•</strong>ï¼ˆä¹Ÿå°±æ˜¯éªŒè¯è¿™ä»½ç­¾åæ˜¯å¦æ˜¯ç”±ç§é’¥å¯¹ msg.txt çš„ SHA256 æ‘˜è¦ç­¾çš„åï¼‰</p><h3 id="å¯¹ç§°åŠ å¯†ç®—æ³•"><a href="#å¯¹ç§°åŠ å¯†ç®—æ³•" class="headerlink" title="å¯¹ç§°åŠ å¯†ç®—æ³•"></a>å¯¹ç§°åŠ å¯†ç®—æ³•</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">openssl enc -aes-128-cbc -e -a -p -pbkdf2 -<span class="hljs-keyword">in</span> msg.txt -out<br> cipher.enc<br></code></pre></td></tr></table></figure><p>ğŸ”¹ <code>enc</code></p><p>æ˜¯ OpenSSL çš„åŠ å¯†&#x2F;è§£å¯†æ¨¡å—ï¼Œæ”¯æŒå¯¹ç§°åŠ å¯†ç®—æ³•ï¼ˆAESã€DESã€BF ç­‰ï¼‰è¿›è¡ŒåŠ å¯†&#x2F;è§£å¯†æ“ä½œã€‚</p><hr><p> ğŸ”¹ <code>-aes-128-cbc</code></p><p>æŒ‡å®šåŠ å¯†ç®—æ³•ä¸º <strong>AESï¼ˆé«˜çº§åŠ å¯†æ ‡å‡†ï¼‰128ä½å¯†é’¥ï¼Œä½¿ç”¨ CBC æ¨¡å¼ï¼ˆCipher Block Chainingï¼‰</strong>ã€‚</p><ul><li><code>128</code>ï¼šè¡¨ç¤ºä½¿ç”¨ 128 ä½å¯†é’¥ï¼ˆ16 å­—èŠ‚ï¼‰ã€‚</li><li><code>cbc</code>ï¼šè¡¨ç¤ºä½¿ç”¨â€œå¯†æ–‡å—é“¾æ¥æ¨¡å¼â€ï¼Œéœ€è¦ IVï¼ˆåˆå§‹åŒ–å‘é‡ï¼‰ã€‚</li></ul><hr><p> ğŸ”¹ <code>-e</code></p><p>è¡¨ç¤º <strong>åŠ å¯†æ¨¡å¼</strong>ï¼ˆencryptï¼‰ï¼Œç›¸å¯¹åº”çš„è§£å¯†æ˜¯ <code>-d</code>ã€‚</p><hr><p> ğŸ”¹ <code>-a</code></p><p>è¡¨ç¤ºå¯¹åŠ å¯†ç»“æœè¿›è¡Œ <strong>Base64 ç¼–ç </strong>ï¼Œä½¿è¾“å‡ºæ˜¯å¯æ‰“å°å­—ç¬¦ï¼ˆæ–‡æœ¬æ–‡ä»¶ä¹Ÿèƒ½å­˜å‚¨ï¼‰ï¼Œå¦åˆ™é»˜è®¤æ˜¯äºŒè¿›åˆ¶æ ¼å¼ã€‚</p><hr><p> ğŸ”¹ <code>-p</code></p><p>åŠ ä¸Šè¿™ä¸ªå‚æ•°ä¼šåœ¨åŠ å¯†æ—¶<strong>æ‰“å°å‡ºæ‰€ç”¨çš„ key å’Œ IV</strong>ï¼ˆä»¥åå…­è¿›åˆ¶æ˜¾ç¤ºï¼‰ï¼Œç”¨äºè°ƒè¯•æˆ–è®°å½•ã€‚</p><hr><p> ğŸ”¹ <code>-pbkdf2</code></p><p>è¡¨ç¤ºä½¿ç”¨ <strong>PBKDF2 å¯†é’¥æ´¾ç”Ÿå‡½æ•°</strong>ä»å£ä»¤ä¸­æ´¾ç”Ÿå‡ºåŠ å¯†å¯†é’¥ï¼ˆè€Œä¸æ˜¯æ—§ç‰ˆé»˜è®¤çš„ EVP_BytesToKeyï¼Œå®ƒå·²ç»ä¸å®‰å…¨äº†ï¼‰ã€‚<strong>ç°ä»£ OpenSSL å»ºè®®å¼ºçƒˆåŠ ä¸Šè¿™ä¸ªé€‰é¡¹</strong>ã€‚</p><ul><li>ç®€å•æ¥è¯´ï¼Œå¦‚æœä½ è¾“å…¥å£ä»¤ <code>mypassword</code>ï¼ŒOpenSSL ä¸ä¼šç›´æ¥ç”¨å®ƒåšå¯†é’¥ï¼Œè€Œæ˜¯ç”¨ PBKDF2 åšæ‹‰ä¼¸ï¼ˆåŠ ç› + å¤šè½® hashï¼‰æ¥ç”Ÿæˆå¼ºå¯†ç ã€‚</li></ul><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-07-07-041814.51efjrkrhc.webp"></p><blockquote><p>åœ¨æ‰§è¡ŒåŠ å¯†æ—¶ï¼Œä¼šè®©è¾“å…¥passwordï¼Œå¹¶ä¸æ˜¯å®é™…åŠ å¯†çš„å¯†é’¥ã€‚å®é™…åŠ å¯†çš„å¯†é’¥æ˜¯æ ¹æ®è¾“å…¥çš„passwordï¼Œåˆ©ç”¨kdfç®—æ³•ï¼ˆå¦‚pbkdf2ï¼‰ç”Ÿæˆçš„ã€‚å®é™…å¯†é’¥å’Œåç§»å€¼å¯ä»¥ä½¿ç”¨-pé€‰é¡¹ï¼Œåœ¨åŠ å¯†åè¾“å‡ºã€‚</p><p>åŒæ—¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡-K keyæŒ‡å®šå®é™…ä½¿ç”¨çš„å¯†é’¥ã€‚</p><p>åœ¨åŠ å¯†çš„æ—¶å€™ä¼šé»˜è®¤åŠ å…¥éšæœºå€¼ç›saltï¼Œä½¿å¾—æ¯æ¬¡åŠ å¯†çš„ç”Ÿæˆå¯†é’¥å’ŒåŠ å¯†å€¼ä¸ä¸€è‡´ï¼Œå¢åŠ çˆ†ç ´éš¾åº¦ã€‚å¯ä»¥ä½¿ç”¨-nosalté€‰é¡¹ä¸ä½¿ç”¨ç›ï¼Œé€šè¿‡-på¯ä»¥å‘ç°ï¼Œpasswordä¸€è‡´æ—¶ï¼Œæ¯æ¬¡ç”Ÿæˆçš„keyéƒ½ä¸€æ ·çš„ã€‚</p><p>åŒæ ·çš„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨-S saltæŒ‡å®šä½¿ç”¨çš„ç›è€Œä¸ä½¿ç”¨éšæœºå€¼ã€‚</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">openssl enc -aes-128-cbc -d -a -p -pbkdf2 -<span class="hljs-keyword">in</span> cipher.enc -<br>out plain.d<br></code></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬ä½¿ç”¨-dæ¥è§£å¯†ï¼Œè§£å¯†è¿‡ç¨‹ä¸­æˆ‘ä»¬éœ€è¦è¾“å…¥æˆ‘ä»¬ä¹‹å‰è¾“å…¥çš„ã€‚</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-07-07-042322.8s3l509qhh.webp" alt="image-20250707042323266"></p><ul><li>-aes-128-cbcæŒ‡å®šè§£å¯†ç®—æ³•ã€‚</li><li>-dè¡¨ç¤ºè§£å¯†</li><li>-aæŒ‡å®šå…ˆè¿›è¡Œbase64è§£ç ï¼Œå†è¿›è¡Œè§£å¯†ã€‚</li><li>-pbkdf2è¡¨ç¤ºåŠ å¯†æ—¶çš„å¯†é’¥ä½¿ç”¨pbkdf2ç®—æ³•ç”Ÿæˆã€‚</li><li>-pè¡¨ç¤ºè§£å¯†åï¼Œè¾“å‡ºå®é™…ä½¿ç”¨çš„ç›ã€å¯†é’¥å’Œåç§»å€¼åˆ°æ ‡å‡†è¾“å‡ºã€‚</li></ul><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-07-07-042644.5c19cx072h.webp" alt="image-20250707042644981"></p><h3 id="å¯†é’¥å¤„ç†"><a href="#å¯†é’¥å¤„ç†" class="headerlink" title="å¯†é’¥å¤„ç†"></a>å¯†é’¥å¤„ç†</h3><ol><li>ç”Ÿæˆrsaå…¬ç§é’¥</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">openssl genrsa -out rsa.pem 1024<br></code></pre></td></tr></table></figure><ul><li>genrsa</li></ul><p>è¡¨ç¤ºç”Ÿæˆrsaç§é’¥</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-07-07-043657.9o02kgjrgw.webp" alt="image-20250707043659450"></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">openssl rsa -<span class="hljs-keyword">in</span> rsa.pem -pubout -out rsa_pub.pem<br></code></pre></td></tr></table></figure><p>å¯¼å‡ºå…¬é’¥</p><ul><li>-inæŒ‡å®šè¾“å…¥çš„ç§é’¥æ–‡ä»¶ã€‚</li><li>-puboutï¼šé»˜è®¤è¾“å‡ºä¸ºç§é’¥ï¼Œåˆ©ç”¨è¯¥é€‰é¡¹æŒ‡å®šè¾“å‡ºä¸ºå…¬é’¥ã€‚</li></ul><blockquote><p>-in -out é»˜è®¤éƒ½æ˜¯ç§é’¥ï¼Œå½“è¾“å…¥æˆ–è¾“å‡ºä¸ºå…¬é’¥æ—¶ï¼Œè¦åˆ†åˆ«åŠ ä¸Š-pubinã€-puboutã€‚è‹¥è¾“å…¥å·²ç»åŠ ä¸Š-pubinæ—¶ï¼Œè‹¥è¾“å‡ºä¹Ÿä¸ºå…¬é’¥-puboutä¸€èˆ¬ä¸ç”¨åŠ ï¼Œå› ä¸ºè¾“å…¥ä¸ºå…¬é’¥ï¼Œè¾“å‡ºé»˜è®¤ä¹Ÿä¸ºå…¬é’¥ã€‚</p><p>è¯¥åŸåˆ™é€‚ç”¨äºä»¥ä¸‹æ‰€æœ‰openssl rsaæŒ‡ä»¤ã€‚</p></blockquote><ol start="2"><li>å¯†é’¥æ ¼å¼è½¬åŒ–</li></ol><p>é»˜è®¤ç”Ÿæˆå’Œè¾“å…¥çš„éƒ½æ˜¯Pemæ ¼å¼ï¼Œä»–ä»¬ä¹‹é—´å’³å“Ÿè½¬åŒ–</p><blockquote><ol><li>PEMæ ¼å¼</li></ol><ul><li><p><strong>å…¨ç§°</strong>ï¼šPrivacy-Enhanced Mail</p></li><li><p><strong>æ–‡ä»¶å†…å®¹</strong>ï¼šæ˜¯ç»è¿‡Base64ç¼–ç çš„æ–‡æœ¬æ ¼å¼ï¼Œå†…å®¹æ˜¯å¯æ‰“å°çš„ASCIIå­—ç¬¦ã€‚</p></li><li><p><strong>ç»“æ„</strong>ï¼šæœ‰æ˜ç¡®çš„å¤´å°¾æ ‡è¯†ï¼Œæ¯”å¦‚ç§é’¥é€šå¸¸æ˜¯ï¼š</p></li></ul> <figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">-----BEGIN RSA <span class="hljs-keyword">PRIVATE</span> <span class="hljs-keyword">KEY</span>-----<br>ï¼ˆBase64ç¼–ç çš„æ•°æ®ï¼‰<br>-----<span class="hljs-keyword">END</span> RSA <span class="hljs-keyword">PRIVATE</span> <span class="hljs-keyword">KEY</span>-----<br></code></pre></td></tr></table></figure><ul><li><p><strong>ç”¨é€”</strong>ï¼šå¹¿æ³›ç”¨äºå„ç§è¯ä¹¦å’Œå¯†é’¥æ–‡ä»¶ï¼Œå°¤å…¶æ˜¯åœ¨Linuxã€OpenSSLç¯å¢ƒä¸­å¸¸è§ã€‚</p></li><li><p><strong>ä¼˜ç‚¹</strong>ï¼š</p></li><li><p>æ˜“äºåœ¨æ–‡æœ¬æ–‡ä»¶ä¸­ä¼ è¾“å’Œé˜…è¯»</p></li><li><p>æ”¯æŒæ·»åŠ æ³¨é‡Šã€åˆ†éš”ç¬¦</p></li><li><p><strong>æ–‡ä»¶æ‰©å±•å</strong>ï¼š<code>.pem</code>ã€<code>.crt</code>ã€<code>.cer</code>ã€<code>.key</code>ï¼ˆä¸å®Œå…¨ç»Ÿä¸€ï¼‰</p></li></ul><hr><ol start="2"><li>DERæ ¼å¼</li></ol><ul><li><strong>å…¨ç§°</strong>ï¼šDistinguished Encoding Rules</li><li><strong>æ–‡ä»¶å†…å®¹</strong>ï¼šäºŒè¿›åˆ¶æ ¼å¼ï¼Œæ²¡æœ‰ç»è¿‡Base64ç¼–ç ï¼Œç›´æ¥å­˜å‚¨äºŒè¿›åˆ¶æ•°æ®ã€‚</li><li><strong>ç»“æ„</strong>ï¼šçº¯äºŒè¿›åˆ¶ï¼Œä¸èƒ½ç›´æ¥ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€é˜…è¯»ã€‚</li><li><strong>ç”¨é€”</strong>ï¼šé€šå¸¸ç”¨äºJavaå¹³å°å’ŒæŸäº›äºŒè¿›åˆ¶ä¼ è¾“åè®®ï¼Œæˆ–è€…Windowsç³»ç»Ÿçš„æŸäº›è¯ä¹¦ã€‚</li><li><strong>ä¼˜ç‚¹</strong>ï¼š</li><li>ç´§å‡‘ï¼Œä¸éœ€è¦ç¼–ç ï¼Œæ–‡ä»¶ä½“ç§¯è¾ƒå°</li><li><strong>æ–‡ä»¶æ‰©å±•å</strong>ï¼š<code>.der</code>ã€<code>.cer</code>ï¼ˆä¹Ÿå¯èƒ½æ˜¯.pemçš„äºŒè¿›åˆ¶å½¢å¼ï¼‰</li></ul></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">openssl rsa -pubin -<span class="hljs-keyword">in</span> rsa_pub.pem -outform DER -out rsa_pub.der<br></code></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">openssl rsa -<span class="hljs-keyword">in</span> rsa.pem -outform DER -out rsa.der<br></code></pre></td></tr></table></figure><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-07-07-044805.6wr0cdvygr.webp" alt="image-20250707044822133"></p><ul><li>-outform æŒ‡å®šè¾“å‡ºæ ¼å¼ã€‚</li><li>-pubinï¼šé»˜è®¤è¾“å…¥ä¸ºç§é’¥ï¼Œåˆ©ç”¨è¯¥é€‰é¡¹æŒ‡å®šè¾“å…¥ä¸ºå…¬é’¥ã€‚</li></ul><ol start="3"><li>æŸ¥çœ‹å¯†é’¥å‚æ•°</li></ol><h3 id="RSAç§é’¥ä¸­çš„å…³é”®å‚æ•°è§£é‡Š"><a href="#RSAç§é’¥ä¸­çš„å…³é”®å‚æ•°è§£é‡Š" class="headerlink" title="RSAç§é’¥ä¸­çš„å…³é”®å‚æ•°è§£é‡Š"></a>RSAç§é’¥ä¸­çš„å…³é”®å‚æ•°è§£é‡Š</h3><table><thead><tr><th>å‚æ•°å</th><th>å«ä¹‰ä¸ä½œç”¨</th></tr></thead><tbody><tr><td><strong>Private-Key: (1024 bit, 2 primes)</strong></td><td>è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª1024ä½çš„RSAå¯†é’¥ï¼Œä½¿ç”¨äº†ä¸¤ä¸ªå¤§è´¨æ•°ï¼ˆRSAæ ‡å‡†ï¼‰</td></tr><tr><td><strong>modulus (n)</strong></td><td>æ¨¡æ•° n &#x3D; p Ã— qï¼Œæ˜¯RSAå…¬é’¥å’Œç§é’¥çš„æ ¸å¿ƒå‚æ•°ï¼Œæ‰€æœ‰åŠ è§£å¯†è®¡ç®—éƒ½å›´ç»•å®ƒè¿›è¡Œã€‚</td></tr><tr><td><strong>publicExponent (e)</strong></td><td>å…¬é’¥æŒ‡æ•° eï¼Œé€šå¸¸æ˜¯ 65537 (0x10001)ï¼Œæ˜¯å…¬é’¥åŠ å¯†å’Œç­¾åéªŒè¯æ—¶ä½¿ç”¨çš„æŒ‡æ•°ã€‚</td></tr><tr><td><strong>privateExponent (d)</strong></td><td>ç§é’¥æŒ‡æ•° dï¼Œç”¨äºç§é’¥è§£å¯†å’Œç­¾åï¼Œæ»¡è¶³ <code>(e Ã— d) mod Ï†(n) = 1</code>ï¼Œå…¶ä¸­Ï†æ˜¯æ¬§æ‹‰å‡½æ•°ã€‚</td></tr><tr><td><strong>prime1 (p)</strong></td><td>å¤§è´¨æ•° pï¼Œæ¨¡æ•° n çš„ä¸€ä¸ªè´¨å› å­ã€‚</td></tr><tr><td><strong>prime2 (q)</strong></td><td>å¤§è´¨æ•° qï¼Œæ¨¡æ•° n çš„å¦ä¸€ä¸ªè´¨å› å­ã€‚</td></tr><tr><td><strong>exponent1 (d mod (p-1))</strong></td><td>ç§é’¥æŒ‡æ•° d å¯¹ p-1 å–æ¨¡çš„ç»“æœã€‚ç”¨äºåŠ é€Ÿç§é’¥è¿ç®—ï¼ˆä¸­å›½å‰©ä½™å®šç†CRTä¼˜åŒ–ï¼‰</td></tr><tr><td><strong>exponent2 (d mod (q-1))</strong></td><td>ç§é’¥æŒ‡æ•° d å¯¹ q-1 å–æ¨¡çš„ç»“æœã€‚ä¹Ÿç”¨äºCRTä¼˜åŒ–ï¼Œæé«˜è¿ç®—æ•ˆç‡ã€‚</td></tr><tr><td><strong>coefficient (q^(-1) mod p)</strong></td><td>q å…³äº p çš„æ¨¡é€†ï¼Œå³ q çš„é€†å…ƒ mod pã€‚CRTè®¡ç®—æ—¶ç”¨åˆ°ï¼Œç”¨äºç»„åˆä¸¤ä¸ªæ¨¡è¿ç®—çš„ç»“æœï¼Œæå‡è§£å¯†é€Ÿåº¦ã€‚</td></tr></tbody></table><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-07-07-045136.3k8ai0hfmt.webp" alt="image-20250707045143443"></p><ul><li>-textæŒ‡æ˜è¾“å‡ºå¯†é’¥çš„ç»„ä»¶</li><li>-nooutæŒ‡æ˜ä¸è¾“å‡ºç¼–ç çš„å¯†é’¥</li></ul><h3 id="éå¯¹ç§°ç®—æ³•"><a href="#éå¯¹ç§°ç®—æ³•" class="headerlink" title="éå¯¹ç§°ç®—æ³•"></a>éå¯¹ç§°ç®—æ³•</h3><p>è¿™é‡Œä»¥rsaä¸ºä¾‹å­</p><ol><li>åŠ å¯†</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">openssl pkeyutl -encrypt -<span class="hljs-keyword">in</span> msg.txt -pubin -inkey rsa_pub.pem -out rsa_chiper.enc<br></code></pre></td></tr></table></figure><p>pkeyutl ä¸ä»…æ”¯æŒrsaï¼Œ OpenSSL çš„å…¬é’¥å®ç”¨å·¥å…·ï¼ˆç”¨äºå…¬é’¥åŠ å¯†&#x2F;è§£å¯†ç­‰æ“ä½œï¼‰</p><p>rsautlç›¸æ¯”è¿‡äºç®€å•è€æ—§</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">openssl pkeyutl -encrypt -<span class="hljs-keyword">in</span> msg.txt -pubin -inkey rsa_pub.pem -out rsa_chiper.enc -pkeyopt rsa_padding_mode:oaep -pkeyopt rsa_oaep_md:sha256<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯åŠ äº†æ–°çš„å¡«å……æ–¹å¼å’Œsha256</p><ul><li>encrypt è¡¨ç¤ºåŠ å¯†</li><li>in è¦åŠ å¯†çš„æ–‡ä»¶</li><li>pubinï¼šé»˜è®¤è¾“å…¥ç§æœ‰å¯†é’¥ï¼Œè¡¨ç¤ºè¾“å…¥å¯†é’¥ä¸ºå…¬é’¥</li><li>inkey æŒ‡æ˜åŠ å¯†çš„å…¬é’¥æ–‡ä»¶</li><li>outè¾“å‡ºçš„åŠ å¯†æ–‡ä»¶</li><li>-pkeyopt rsa_padding_mode:oaepæŒ‡æ˜å¡«å……æ¨¡å¼ä¸ºoaep</li><li>-pkeyopt rsa_oaep_md:sha256æŒ‡æ˜oaepä½¿ç”¨çš„æ‘˜è¦ç®—æ³•ä¸ºSHA256</li></ul><ol start="2"><li>è§£å¯†</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">(openssl) fox@localhost:~/fox/text$ openssl pkeyutl -decrypt -<span class="hljs-keyword">in</span> rsa_chiper.enc -inkey rsa.pem -out rsa_plain.d<br>(openssl) fox@localhost:~/fox/text$ <span class="hljs-built_in">cat</span> rsa_plain.d<br>Icandoit<br></code></pre></td></tr></table></figure><ul><li>decryptè¡¨ç¤ºè§£å¯†</li></ul><ol start="3"><li><p>ç­¾å</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">openssl dgst -sha256 -binary -out hash.dgst msg.txt<br></code></pre></td></tr></table></figure><p>å…ˆç”Ÿæˆhashæ–‡ä»¶ã€‚è¿™ä¸ªè¦æ±‚éªŒç­¾çš„é€‚åˆåªèƒ½æ˜¯binaryæ ¼å¼o</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">openssl pkeyutl -sign -inkey rsa.pem -<span class="hljs-keyword">in</span> hash.dgst -out signature.sign<br></code></pre></td></tr></table></figure><p>-sign</p><p>è¡¨ç¤ºç­¾åæ“ä½œ</p></li><li><p>éªŒç­¾</p></li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">openssl pkeyutl -verify -pubin -inkey rsa_pub.pem -<span class="hljs-keyword">in</span> hash.dgst -sigfile signature.sign<br><br></code></pre></td></tr></table></figure><ul><li>verify</li></ul><p>è¡¨ç¤ºéªŒç­¾ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>TLS</category>
      
      <category>crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
      <tag>algorithm</tag>
      
      <tag>tools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2025/06/03/%E7%BC%96%E7%A0%81%E5%9F%BA%E7%A1%80-jsfuck/"/>
    <url>/2025/06/03/%E7%BC%96%E7%A0%81%E5%9F%BA%E7%A1%80-jsfuck/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="æ‘©æ–¯ç”µç ï¼ˆMorse-Code"><a href="#æ‘©æ–¯ç”µç ï¼ˆMorse-Code" class="headerlink" title="æ‘©æ–¯ç”µç ï¼ˆMorse Code"></a>æ‘©æ–¯ç”µç ï¼ˆMorse Code</h1><h2 id="ğŸ“˜-ä¸€ã€ä»€ä¹ˆæ˜¯æ‘©æ–¯ç”µç ï¼Ÿ"><a href="#ğŸ“˜-ä¸€ã€ä»€ä¹ˆæ˜¯æ‘©æ–¯ç”µç ï¼Ÿ" class="headerlink" title="ğŸ“˜ ä¸€ã€ä»€ä¹ˆæ˜¯æ‘©æ–¯ç”µç ï¼Ÿ"></a>ğŸ“˜ ä¸€ã€ä»€ä¹ˆæ˜¯æ‘©æ–¯ç”µç ï¼Ÿ</h2><p>æ‘©æ–¯ç”µç æ˜¯ä¸€ç§åˆ©ç”¨ç‚¹ï¼ˆ<code>.</code>ï¼‰å’Œåˆ’ï¼ˆ<code>-</code>ï¼‰ç»„æˆçš„ç¼–ç æ–¹å¼ï¼Œç”¨äºè¡¨ç¤ºæ–‡æœ¬ä¿¡æ¯ã€‚æœ€åˆè®¾è®¡ç”¨äºç”µæŠ¥é€šä¿¡ï¼Œç°å¸¸ç”¨äºèˆªç©ºã€æ±‚æ•‘ä¿¡å·ï¼ˆå¦‚ â€œSOSâ€ï¼‰ã€æ— çº¿é€šä¿¡ç­‰åœºåˆã€‚</p><hr><h2 id="ğŸ§ -äºŒã€ç¼–ç åŸç†"><a href="#ğŸ§ -äºŒã€ç¼–ç åŸç†" class="headerlink" title="ğŸ§  äºŒã€ç¼–ç åŸç†"></a>ğŸ§  äºŒã€ç¼–ç åŸç†</h2><ul><li>æ¯ä¸ªå­—æ¯å’Œæ•°å­—ç”±ä¸€ç»„ç‚¹å’Œåˆ’æ„æˆï¼š<ul><li>ç‚¹ï¼ˆ<code>.</code>ï¼‰ï¼šçŸ­ä¿¡å·</li><li>åˆ’ï¼ˆ<code>-</code>ï¼‰ï¼šé•¿ä¿¡å·</li></ul></li><li>å­—ç¬¦é—´ç”¨ç©ºæ ¼åˆ†éš”</li><li>å•è¯é—´ç”¨ <code>/</code> åˆ†éš”</li></ul><h3 id="âœ…-ç¤ºä¾‹å¯¹åº”è¡¨ï¼š"><a href="#âœ…-ç¤ºä¾‹å¯¹åº”è¡¨ï¼š" class="headerlink" title="âœ… ç¤ºä¾‹å¯¹åº”è¡¨ï¼š"></a>âœ… ç¤ºä¾‹å¯¹åº”è¡¨ï¼š</h3><table><thead><tr><th>å­—ç¬¦</th><th>æ‘©æ–¯ç </th></tr></thead><tbody><tr><td>A</td><td>.-</td></tr><tr><td>B</td><td>-â€¦</td></tr><tr><td>C</td><td>-.-.</td></tr><tr><td>D</td><td>-..</td></tr><tr><td>E</td><td>.</td></tr><tr><td>F</td><td>..-.</td></tr><tr><td>G</td><td>â€“.</td></tr><tr><td>H</td><td>â€¦.</td></tr><tr><td>I</td><td>..</td></tr><tr><td>J</td><td>.â€”</td></tr><tr><td>K</td><td>-.-</td></tr><tr><td>L</td><td>.-..</td></tr><tr><td>M</td><td>â€“</td></tr><tr><td>N</td><td>-.</td></tr><tr><td>O</td><td>â€”</td></tr><tr><td>P</td><td>.â€“.</td></tr><tr><td>Q</td><td>â€“.-</td></tr><tr><td>R</td><td>.-.</td></tr><tr><td>S</td><td>â€¦</td></tr><tr><td>T</td><td>-</td></tr><tr><td>U</td><td>..-</td></tr><tr><td>V</td><td>â€¦-</td></tr><tr><td>W</td><td>.â€“</td></tr><tr><td>X</td><td>-..-</td></tr><tr><td>Y</td><td>-.â€“</td></tr><tr><td>Z</td><td>â€“..</td></tr></tbody></table><hr><h2 id="ğŸ”¨-ç¼–ç è¿‡ç¨‹ï¼ˆè‹±æ–‡-â†’-æ‘©æ–¯ï¼‰"><a href="#ğŸ”¨-ç¼–ç è¿‡ç¨‹ï¼ˆè‹±æ–‡-â†’-æ‘©æ–¯ï¼‰" class="headerlink" title="ğŸ”¨ ç¼–ç è¿‡ç¨‹ï¼ˆè‹±æ–‡ â†’ æ‘©æ–¯ï¼‰"></a>ğŸ”¨ ç¼–ç è¿‡ç¨‹ï¼ˆè‹±æ–‡ â†’ æ‘©æ–¯ï¼‰</h2><h3 id="ç¤ºä¾‹ï¼šç¼–ç -I-LOVE-YOU"><a href="#ç¤ºä¾‹ï¼šç¼–ç -I-LOVE-YOU" class="headerlink" title="ç¤ºä¾‹ï¼šç¼–ç  I LOVE YOU"></a>ç¤ºä¾‹ï¼šç¼–ç  <code>I LOVE YOU</code></h3><ol><li>å°†å­—æ¯å¤§å†™ï¼ˆæ‘©æ–¯ç”µç ä¸åŒºåˆ†å¤§å°å†™ï¼‰  </li><li>æŸ¥è¡¨è·å–æ¯ä¸ªå­—æ¯çš„æ‘©æ–¯è¡¨ç¤º  </li><li>ç”¨ç©ºæ ¼åˆ†éš”å­—ç¬¦ï¼Œç”¨ <code>/</code> åˆ†éš”å•è¯</li></ol><p><strong>ç»“æœï¼š</strong></p><blockquote><p>I     â†’ ..<br>LOVE  â†’ .-.. â€” â€¦- .<br>YOU   â†’ -.â€“ â€” ..-<br>æœ€ç»ˆç»“æœï¼š.. &#x2F; .-.. â€” â€¦- . &#x2F; -.â€“ â€” ..-</p></blockquote><hr><h2 id="ğŸ”“è§£ç è¿‡ç¨‹ï¼ˆæ‘©æ–¯-â†’-è‹±æ–‡ï¼‰"><a href="#ğŸ”“è§£ç è¿‡ç¨‹ï¼ˆæ‘©æ–¯-â†’-è‹±æ–‡ï¼‰" class="headerlink" title="ğŸ”“è§£ç è¿‡ç¨‹ï¼ˆæ‘©æ–¯ â†’ è‹±æ–‡ï¼‰"></a>ğŸ”“è§£ç è¿‡ç¨‹ï¼ˆæ‘©æ–¯ â†’ è‹±æ–‡ï¼‰</h2><h3 id="ç¤ºä¾‹ï¼šè§£ç "><a href="#ç¤ºä¾‹ï¼šè§£ç " class="headerlink" title="ç¤ºä¾‹ï¼šè§£ç  .... . .-.. .-.. ---"></a>ç¤ºä¾‹ï¼šè§£ç  <code>.... . .-.. .-.. ---</code></h3><ol><li>æŒ‰ç©ºæ ¼åˆ†éš”å­—ç¬¦ï¼ŒæŒ‰ <code>/</code> åˆ†éš”å•è¯  </li><li>æŸ¥è¡¨åå‘ç¿»è¯‘æ¯ç»„æ‘©æ–¯ç   </li><li>æ‹¼æ¥ç»“æœå­—ç¬¦ä¸²</li></ol><p><strong>ç»“æœï¼š</strong></p><blockquote><p>â€¦. â†’ H<br>.    â†’ E<br>.-.. â†’ L<br>.-.. â†’ L<br>â€”  â†’ O<br>è¾“å‡ºï¼šHELLO</p></blockquote><hr><h2 id="ğŸ-äº”ã€Python-ä»£ç å®ç°"><a href="#ğŸ-äº”ã€Python-ä»£ç å®ç°" class="headerlink" title="ğŸ äº”ã€Python ä»£ç å®ç°"></a>ğŸ äº”ã€Python ä»£ç å®ç°</h2><h3 id="1ï¸âƒ£-è‹±æ–‡-â†’-æ‘©æ–¯ï¼ˆç¼–ç ï¼‰"><a href="#1ï¸âƒ£-è‹±æ–‡-â†’-æ‘©æ–¯ï¼ˆç¼–ç ï¼‰" class="headerlink" title="1ï¸âƒ£ è‹±æ–‡ â†’ æ‘©æ–¯ï¼ˆç¼–ç ï¼‰"></a>1ï¸âƒ£ è‹±æ–‡ â†’ æ‘©æ–¯ï¼ˆç¼–ç ï¼‰</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">MORSE_CODE_DICT = &#123;<br>    <span class="hljs-string">&#x27;A&#x27;</span>: <span class="hljs-string">&#x27;.-&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>: <span class="hljs-string">&#x27;-...&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>: <span class="hljs-string">&#x27;-.-.&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>: <span class="hljs-string">&#x27;-..&#x27;</span>,  <span class="hljs-string">&#x27;E&#x27;</span>: <span class="hljs-string">&#x27;.&#x27;</span>,<br>    <span class="hljs-string">&#x27;F&#x27;</span>: <span class="hljs-string">&#x27;..-.&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>: <span class="hljs-string">&#x27;--.&#x27;</span>,  <span class="hljs-string">&#x27;H&#x27;</span>: <span class="hljs-string">&#x27;....&#x27;</span>,<span class="hljs-string">&#x27;I&#x27;</span>: <span class="hljs-string">&#x27;..&#x27;</span>,   <span class="hljs-string">&#x27;J&#x27;</span>: <span class="hljs-string">&#x27;.---&#x27;</span>,<br>    <span class="hljs-string">&#x27;K&#x27;</span>: <span class="hljs-string">&#x27;-.-&#x27;</span>,<span class="hljs-string">&#x27;L&#x27;</span>: <span class="hljs-string">&#x27;.-..&#x27;</span>, <span class="hljs-string">&#x27;M&#x27;</span>: <span class="hljs-string">&#x27;--&#x27;</span>,  <span class="hljs-string">&#x27;N&#x27;</span>: <span class="hljs-string">&#x27;-.&#x27;</span>,   <span class="hljs-string">&#x27;O&#x27;</span>: <span class="hljs-string">&#x27;---&#x27;</span>,<br>    <span class="hljs-string">&#x27;P&#x27;</span>: <span class="hljs-string">&#x27;.--.&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>: <span class="hljs-string">&#x27;--.-&#x27;</span>, <span class="hljs-string">&#x27;R&#x27;</span>: <span class="hljs-string">&#x27;.-.&#x27;</span>, <span class="hljs-string">&#x27;S&#x27;</span>: <span class="hljs-string">&#x27;...&#x27;</span>,  <span class="hljs-string">&#x27;T&#x27;</span>: <span class="hljs-string">&#x27;-&#x27;</span>,<br>    <span class="hljs-string">&#x27;U&#x27;</span>: <span class="hljs-string">&#x27;..-&#x27;</span>,<span class="hljs-string">&#x27;V&#x27;</span>: <span class="hljs-string">&#x27;...-&#x27;</span>, <span class="hljs-string">&#x27;W&#x27;</span>: <span class="hljs-string">&#x27;.--&#x27;</span>, <span class="hljs-string">&#x27;X&#x27;</span>: <span class="hljs-string">&#x27;-..-&#x27;</span>, <span class="hljs-string">&#x27;Y&#x27;</span>: <span class="hljs-string">&#x27;-.--&#x27;</span>,<br>    <span class="hljs-string">&#x27;Z&#x27;</span>: <span class="hljs-string">&#x27;--..&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>: <span class="hljs-string">&#x27;.----&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>: <span class="hljs-string">&#x27;..---&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>: <span class="hljs-string">&#x27;...--&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>: <span class="hljs-string">&#x27;....-&#x27;</span>,<br>    <span class="hljs-string">&#x27;5&#x27;</span>: <span class="hljs-string">&#x27;.....&#x27;</span>,<span class="hljs-string">&#x27;6&#x27;</span>: <span class="hljs-string">&#x27;-....&#x27;</span>,<span class="hljs-string">&#x27;7&#x27;</span>: <span class="hljs-string">&#x27;--...&#x27;</span>,<span class="hljs-string">&#x27;8&#x27;</span>: <span class="hljs-string">&#x27;---..&#x27;</span>,<span class="hljs-string">&#x27;9&#x27;</span>: <span class="hljs-string">&#x27;----.&#x27;</span>,<br>    <span class="hljs-string">&#x27;0&#x27;</span>: <span class="hljs-string">&#x27;-----&#x27;</span>,<span class="hljs-string">&#x27; &#x27;</span>: <span class="hljs-string">&#x27;/&#x27;</span><br>&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode_morse</span>(<span class="hljs-params">text</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27; &#x27;</span>.join(MORSE_CODE_DICT.get(ch.upper(), <span class="hljs-string">&#x27;&#x27;</span>) <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> text)<br>REVERSE_DICT = &#123;v: k <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> MORSE_CODE_DICT.items()&#125;<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_morse</span>(<span class="hljs-params">code</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27; &#x27;</span>.join(<br>        <span class="hljs-string">&#x27;&#x27;</span>.join(REVERSE_DICT.get(c, <span class="hljs-string">&#x27;&#x27;</span>) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> word.split())<br>        <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> code.split(<span class="hljs-string">&#x27; / &#x27;</span>))<br><span class="hljs-built_in">print</span>(encode_morse(<span class="hljs-string">&quot;HELLO WORLD&quot;</span>))<br><span class="hljs-built_in">print</span>(decode_morse(<span class="hljs-string">&#x27;.... . .-.. .-.. --- / .-- --- .-. .-.. -..&#x27;</span>))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2025/06/03/2025-6-1%20JQCTFone-line-crypto%20165730/"/>
    <url>/2025/06/03/2025-6-1%20JQCTFone-line-crypto%20165730/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="JQCTFone-line-crypto"><a href="#JQCTFone-line-crypto" class="headerlink" title="JQCTFone-line-crypto"></a>JQCTFone-line-crypto</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">assert</span> <span class="hljs-built_in">__import__</span>(<span class="hljs-string">&#x27;re&#x27;</span>).fullmatch(<span class="hljs-string">br&#x27;flag\&#123;[!-z]&#123;11&#125;\&#125;&#x27;</span>,flag:=os.getenvb(<span class="hljs-string">b&#x27;FLAG&#x27;</span>)) <span class="hljs-keyword">and</span> [is_prime(<span class="hljs-built_in">int</span>(flag.<span class="hljs-built_in">hex</span>(),<span class="hljs-number">16</span>)^^<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;ğŸŒŒ &#x27;</span>))) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>^<span class="hljs-number">7</span>)]<br></code></pre></td></tr></table></figure><p>è¿™æ˜¯é¢˜ç›®æºç ã€‚è¿™é“é¢˜ä¾§é‡ç‚¹åœ¨äºåˆ©ç”¨is_Primeå‡½æ•°çš„ç‰¹æ€§ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.misc.sageinspect <span class="hljs-keyword">import</span> sage_getsource<br><span class="hljs-built_in">print</span>(sage_getsource(Integer.is_prime))<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹sageçš„è¿™ä¸ªå‡½æ•°</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-06-01-153422.2obrpte89y.webp"></p><p>å‘ç°æ˜¯åŸºäºpari_is_primeçš„ï¼ŒæŸ¥çœ‹æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python">long<br>BPSW_psp(GEN N)<br>&#123;<br>  pari_sp av;<br>  <span class="hljs-keyword">if</span> (typ(N) != t_INT) pari_err_TYPE(<span class="hljs-string">&quot;BPSW_psp&quot;</span>,N);<br>  <span class="hljs-keyword">if</span> (signe(N) &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> (lgefint(N) == <span class="hljs-number">3</span>) <span class="hljs-keyword">return</span> uisprime(uel(N,<span class="hljs-number">2</span>));<br>  <span class="hljs-keyword">if</span> (!mod2(N)) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><span class="hljs-comment">#ifdef LONG_IS_64BIT</span><br>  /* <span class="hljs-number">16294579238595022365</span> = <span class="hljs-number">3</span>*<span class="hljs-number">5</span>*<span class="hljs-number">7</span>*<span class="hljs-number">11</span>*<span class="hljs-number">13</span>*<span class="hljs-number">17</span>*<span class="hljs-number">19</span>*<span class="hljs-number">23</span>*<span class="hljs-number">29</span>*<span class="hljs-number">31</span>*<span class="hljs-number">37</span>*<span class="hljs-number">41</span>*<span class="hljs-number">43</span>*<span class="hljs-number">47</span>*<span class="hljs-number">53</span><br>   *  <span class="hljs-number">7145393598349078859</span> = <span class="hljs-number">59</span>*<span class="hljs-number">61</span>*<span class="hljs-number">67</span>*<span class="hljs-number">71</span>*<span class="hljs-number">73</span>*<span class="hljs-number">79</span>*<span class="hljs-number">83</span>*<span class="hljs-number">89</span>*<span class="hljs-number">97</span>*<span class="hljs-number">101</span> */<br>  <span class="hljs-keyword">if</span> (!iu_coprime(N, 16294579238595022365UL) ||<br>      !iu_coprime(N,  7145393598349078859UL)) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><span class="hljs-comment">#else</span><br>  /* <span class="hljs-number">4127218095</span> = <span class="hljs-number">3</span>*<span class="hljs-number">5</span>*<span class="hljs-number">7</span>*<span class="hljs-number">11</span>*<span class="hljs-number">13</span>*<span class="hljs-number">17</span>*<span class="hljs-number">19</span>*<span class="hljs-number">23</span>*<span class="hljs-number">37</span><br>   * <span class="hljs-number">3948078067</span> = <span class="hljs-number">29</span>*<span class="hljs-number">31</span>*<span class="hljs-number">41</span>*<span class="hljs-number">43</span>*<span class="hljs-number">47</span>*<span class="hljs-number">53</span><br>   * <span class="hljs-number">4269855901</span> = <span class="hljs-number">59</span>*<span class="hljs-number">83</span>*<span class="hljs-number">89</span>*<span class="hljs-number">97</span>*<span class="hljs-number">101</span><br>   * <span class="hljs-number">1673450759</span> = <span class="hljs-number">61</span>*<span class="hljs-number">67</span>*<span class="hljs-number">71</span>*<span class="hljs-number">73</span>*<span class="hljs-number">79</span> */<br>  <span class="hljs-keyword">if</span> (!iu_coprime(N, 4127218095UL) ||<br>      !iu_coprime(N, 3948078067UL) ||<br>      !iu_coprime(N, 1673450759UL) ||<br>      !iu_coprime(N, 4269855901UL)) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><span class="hljs-comment">#endif</span><br>  /* no prime divisor &lt; <span class="hljs-number">103</span> */<br>  av = avma;<br>  <span class="hljs-keyword">return</span> gc_long(av, is2psp(N) &amp;&amp; islucaspsp(N));<br>&#125;<br></code></pre></td></tr></table></figure><p>æ˜æ˜¾çš„ï¼Œå¦‚æœè¾“å…¥çš„Nçš„æœ‰å°äº103çš„ç´ å› å­ï¼Œé‚£ä¹ˆå°±ä¸ä¼šè¿›å…¥çœŸæ­£çš„ç´ æ•°æ£€æµ‹ï¼Œè€Œæ˜¯ç›´æ¥return 0ã€‚</p><p><code>iu_coprime(N, 4127218095UL)</code>æ˜¯åˆ¤æ–­æ˜¯å¦äº’è´¨çš„å‡½æ•°ã€‚å¦‚æœæˆ‘ä»¬è¾“å…¥çš„Néå¸¸å¤§ï¼Œä½†æ˜¯å®ƒæ²¡æœ‰å°äº103çš„ç´ å› å­ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šè¿›å…¥ç´ æ•°æ£€æµ‹ï¼Œå› ä¸ºNå¾ˆå¤§ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°æ‰€éœ€è¦èŠ±è´¹çš„æ—¶é—´æ˜æ˜¾æ˜¯æ¯”æœ‰å°äº103çš„ç´ å› å­çš„æ•°N1èŠ±è´¹çš„æ—¶é—´å¤šï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹åšä¾§ä¿¡é“æ”»å‡»ã€‚</p><p>åˆ©ç”¨æ—¶é—´ä¸åŒæˆ‘ä»¬å¯ä»¥åˆ¤æ–­è¾“å…¥çš„N^int(fllag)æ˜¯å¦æœ‰å°äº103çš„ç´ å› å­.</p><p>ç„¶åæ§åˆ¶æˆ‘ä»¬çš„è¾“å…¥ï¼Œä¸€ç§int(flag)&lt;$2^{136}$  ,é‚£ä¹ˆè¾“å…¥N&#x3D;k*$2^{136}$ ,é‚£ä¹ˆN^int(flag)&#x3D;N+int(flag)ã€‚</p><p>å†åˆ©ç”¨(flag+N)%p&#x3D;0æ—¶ï¼Œ$flag\equiv -N mod p$ ã€‚ç„¶åé€šè¿‡ä¸­å›½å‰©ä½™å®šç†å°±èƒ½åšäº†</p><ul><li><strong>å·²çŸ¥æ¡ä»¶</strong></li></ul><p>primeâˆˆ{a|prime()&lt;103}</p><p>$flag\equiv N mod p$ ,pâˆˆ{3,5,..101}ã€‚æˆ‘ä»¬ä¸çŸ¥é“å…·ä½“çš„på’Œæ˜¯å¤šå°‘ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½é€šè¿‡ç­›é€‰å’Œä¸€å®šçš„çˆ†ç ´</p><ul><li><strong>ä¼˜åŒ–æ–¹æ³•</strong></li></ul><p>æˆ‘ä»¬çˆ†ç ´çš„æ—¶å€™ï¼Œå¯ä»¥éå†$r&#x3D;Nmodp,râˆˆ{1,p-1},N&#x3D;k*2^{136}$ï¼Œ</p><p>ä¸€æ—¦$r&#x3D;Nmodp$ä¸flagäº’ä¸ºé€†å…ƒ ,é‚£ä¹ˆä»»æ„æ»¡è¶³æ­¤æ¡ä»¶çš„Næ»¡è¶³(N+flag)%p&#x3D;0</p><p>ä¸ºäº†é˜²æ­¢è¿™ä¸ªNæ˜¯ä¸å…¶ä»–ä¸æ˜¯på•ä»æ˜¯å°äº103çš„ç´ æ•°æ•´é™¤ä¸º0ï¼Œæˆ‘ä»¬éœ€è¦æµ‹è¯•å¤šç»„æ»¡è¶³æ­¤æ¡ä»¶çš„Nã€‚å¦‚æœè¿ç»­å¤šç»„ä»ç„¶æ»¡è¶³ï¼Œåˆ™r&#x3D;-flag mod pã€‚æ³¨æ„å› ä¸ºNè‚¯å®šæ˜¯å¶æ•°æ‰€ä»¥æˆ‘ä»¬æ’é™¤æ‰2è¿™ä¸ªç´ æ•°ã€‚ç„¶åå› ä¸ºæœ€åä¸€ä½è‚¯å®šæ˜¯â€™}â€™</p><p>é‚£ä¹ˆ  </p><p>flag mod 256&#x3D;ord(â€˜}â€˜)</p><ul><li><strong>è§£é¢˜ä»£ç </strong></li></ul><p>å¹³å°ç¯å¢ƒå…³äº†ï¼Œè¿™é‡Œåšæœ¬åœ°æµ‹è¯•ï¼Œä¸ºäº†èŠ‚çº¦æ—¶é—´ï¼ŒæŠŠ$7^7$çš„å¾ªç¯æ¬¡æ•°æ”¹ä¸º$7 ^3$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">task</span>(<span class="hljs-params">input_num</span>):<br>    flag = <span class="hljs-string">b&quot;flag&#123;$c4^Cr7=w!N&#125;&quot;</span><br>    flag_num = <span class="hljs-built_in">int</span>(flag.<span class="hljs-built_in">hex</span>(), <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>**<span class="hljs-number">3</span>):<br>        is_prime(flag_num^^input_num)<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> prod<br><span class="hljs-keyword">import</span> time<br>primes_le_103 = [<br>    <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">17</span>, <span class="hljs-number">19</span>, <span class="hljs-number">23</span>, <span class="hljs-number">29</span>, <span class="hljs-number">31</span>, <span class="hljs-number">37</span>, <span class="hljs-number">41</span>, <span class="hljs-number">43</span>,<br>    <span class="hljs-number">47</span>, <span class="hljs-number">53</span>, <span class="hljs-number">59</span>, <span class="hljs-number">61</span>, <span class="hljs-number">67</span>, <span class="hljs-number">71</span>, <span class="hljs-number">73</span>, <span class="hljs-number">79</span>, <span class="hljs-number">83</span>, <span class="hljs-number">89</span>, <span class="hljs-number">97</span>, <span class="hljs-number">101</span><br>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">task</span>(<span class="hljs-params">input_num</span>):<br>    flag = <span class="hljs-string">b&quot;flag&#123;$c4^Cr7=w!N&#125;&quot;</span><br>    flag_num = <span class="hljs-built_in">int</span>(flag.<span class="hljs-built_in">hex</span>(), <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>**<span class="hljs-number">3</span>):<br>        is_prime(flag_num^^input_num)<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">server_side_channel_oracle</span>(<span class="hljs-params">input_num</span>):<br>    st = time.time()<br>    a=task(input_num)<br>    et = time.time()<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0.002</span>&lt;(et-st)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sample_mod_r_mod_p</span>(<span class="hljs-params">r, p, bit_length = <span class="hljs-number">32</span>, start_bit = <span class="hljs-number">136</span></span>):<br>    <span class="hljs-keyword">assert</span> p != <span class="hljs-number">2</span>, <span class="hljs-string">&quot;p=2&quot;</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        randnum = random.getrandbits(bit_length) &lt;&lt; start_bit<br>        <span class="hljs-keyword">if</span> randnum % p == r:<br>            <span class="hljs-keyword">yield</span> randnum<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">recover_flag</span>(<span class="hljs-params">n_sample = <span class="hljs-number">50</span></span>):<br>    moduli = &#123;&#125;<br>    moduli[<span class="hljs-number">256</span>] = <span class="hljs-built_in">ord</span>(<span class="hljs-string">&quot;&#125;&quot;</span>)<br>    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> primes_le_103[<span class="hljs-number">1</span>:]:<br>        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(p):<br>            count = <span class="hljs-number">0</span><br>            good_k = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">for</span> input_num <span class="hljs-keyword">in</span> sample_mod_r_mod_p(k, p):<br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> server_side_channel_oracle(input_num):<br>                    count += <span class="hljs-number">1</span><br>                    <span class="hljs-keyword">if</span> count == n_sample:<br>                        <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">else</span>:<br>                    good_k = <span class="hljs-literal">False</span><br>                    <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">if</span> good_k:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p: <span class="hljs-subst">&#123;p&#125;</span>, k: <span class="hljs-subst">&#123;k&#125;</span>&quot;</span>)<br>                moduli[p] = (-k) % p<br>                <span class="hljs-keyword">break</span><br><br>    primes = [<span class="hljs-number">256</span>] + primes_le_103[<span class="hljs-number">1</span>:]<br>    remainders = [moduli[p] <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> primes]<br>    x = <span class="hljs-built_in">int</span>(crt(remainders, primes))<br>    N = <span class="hljs-built_in">int</span>(prod(primes))<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        hex_str = <span class="hljs-built_in">hex</span>(x)[<span class="hljs-number">2</span>:]<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(hex_str) % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>:<br>            hex_str = <span class="hljs-string">&#x27;0&#x27;</span> + hex_str<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&quot;flag&quot;</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">bytes</span>.fromhex(hex_str):<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>.fromhex(hex_str).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>        x += N<br><br>flag = recover_flag()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Recovered Flag:&quot;</span>, flag)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€ç¯‡æ–‡ç« é€Ÿé€šç¾¤è®º</title>
    <link href="/2025/05/30/%E7%BE%A4%E8%AE%BA/"/>
    <url>/2025/05/30/%E7%BE%A4%E8%AE%BA/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ç¾¤è®º"><a href="#ç¾¤è®º" class="headerlink" title="ç¾¤è®º"></a>ç¾¤è®º</h1><h2 id="ç¾¤åŸºç¡€"><a href="#ç¾¤åŸºç¡€" class="headerlink" title="ç¾¤åŸºç¡€"></a>ç¾¤åŸºç¡€</h2><h3 id="ç¾¤çš„åŸºæœ¬å®šä¹‰"><a href="#ç¾¤çš„åŸºæœ¬å®šä¹‰" class="headerlink" title="ç¾¤çš„åŸºæœ¬å®šä¹‰"></a>ç¾¤çš„åŸºæœ¬å®šä¹‰</h3><ol><li><strong>ä»£æ•°ç³»</strong>: è®¾Sè¡¨ç¤ºä¸€ä¸ªéç©ºé›†åˆï¼Œé‚£ä¹ˆ$S * S-&gt;S$ çš„æ˜ å°„å«åšSçš„ç»“åˆæ³•æˆ–è¿ç®—$S<em>S-&gt;S$,   $(a,b)-&gt;ab$   å…¶ä¸­a,bâˆˆSé›†åˆ(è¿™é‡Œçš„</em>å·ä¸æ˜¯ä¹˜æ³•ï¼Œåªæ˜¯ä¸€ç§è®¡ç®—æ–¹å¼)å¦‚æœè¿™ä¸ªSæ»¡è¶³å°é—­æ€§(ä»»æ„ä¸Šè¿°a*bâˆˆS)ã€‚</li></ol><p>è¿™æ ·çš„Så«åšä¸€ä¸ª<strong>ä»£æ•°ç³»</strong>ï¼Œå½“ç„¶è¿™åªæ˜¯ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬ç†è§£ç¾¤çš„æ€§è´¨</p><ol start="2"><li><p><strong>åŠç¾¤</strong>:å¦‚æœè¿™ä¸ªSæ»¡è¶³ç»“åˆå¾‹ã€‚</p><p>ç»“åˆå¾‹: (ab)c&#x3D;a(bc)</p><p> è¿™ä¸ªSå°±ç§°ä¸º<strong>åŠç¾¤</strong></p></li><li><p><strong>å«å¹ºåŠç¾¤</strong>:</p></li></ol><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦ç†è§£ä¸€ä¸ªå¾ˆé‡è¦çš„æ¦‚å¿µï¼Œ<strong>å¹ºå…ƒ</strong>ã€‚</p><p>è®¾éç©ºé›†åˆSï¼Œå­˜åœ¨Sä¸Šçš„ä¸€ä¸ªäºŒå…ƒè¿ç®—â€.â€ ï¼Œå¯¹äºå…ƒç´ $eâˆˆS$ï¼Œè‹¥å¯¹äºâˆ€aâˆˆSï¼Œéƒ½æœ‰$e<em>a&#x3D;a$ ï¼Œåˆ™ç§°eä¸ºSçš„å·¦å¹ºå…ƒï¼ŒåŒç†âˆ€aâˆˆSï¼Œéƒ½æœ‰a</em>e&#x3D;aï¼Œåˆ™ç§°ä¸ºSçš„å³å¹ºå…ƒï¼Œè‹¥eæ—¢æ˜¯å·¦å¹ºå…ƒåˆæ˜¯å³å¹ºå…ƒ$(ea&#x3D;ae&#x3D;a)$ï¼Œåˆ™ç§°eä¸ºSçš„<strong>å¹ºå…ƒ</strong>(å•ä½å…ƒ)ã€‚</p><p>å¹ºå…ƒ(å•ä½å…ƒ):é€šå¸¸è®°ä¸ºeï¼Œè®¾aâˆˆSï¼Œ$ae&#x3D;ea&#x3D;a$, æœ‰å¹ºå…ƒçš„åŠç¾¤å«åšå«å¹ºåŠç¾¤</p><ol start="4"><li><strong>ç¾¤</strong>:</li></ol><p>ç¾¤å°±æ˜¯å«æœ‰é€†å…ƒçš„å«å¹ºåŠç¾¤ï¼Œ</p><p>é€†å…ƒ:ä»»æ„a,bâˆˆS,å­˜åœ¨ aå’Œbçš„é€†å…ƒåˆ†åˆ«è®°ä½œ,a^-1^,b^-1^ ã€‚</p><p>å¹¶ä¸”$a*a^{-1}&#x3D;e$ </p><p>æ€»ç»“ä¸‹æ¥ï¼Œç¾¤çš„å®šä¹‰å¦‚ä¸‹</p><p>ä¸€ä¸ªé›†åˆ GG å’Œä¸€ä¸ªäºŒå…ƒè¿ç®— :$GÃ—Gâ†’Gâ†’G$ï¼Œæ„æˆä¸€ä¸ªç¾¤ (G,âˆ—)ï¼Œå½“ä¸”ä»…å½“æ»¡è¶³ï¼š</p><ol><li><strong>å°é—­æ€§</strong>ã€‚å¯¹äºä»»æ„ g,hâˆˆGï¼Œgâˆ—hâˆˆGã€‚è¿™å…¶å®æ˜¯ä»£æ•°ç³»ç»Ÿçš„è¦æ±‚ã€‚</li><li><strong>ç»“åˆå¾‹</strong>: $(aâˆ—b)âˆ—c&#x3D;aâˆ—(bâˆ—c)$ã€‚</li><li><strong>å­˜åœ¨å•ä½å…ƒ</strong> eâˆˆGï¼Œä½¿å¾—ç¾¤ä¸­ä»»æ„å…ƒç´  gâˆˆG éƒ½æ»¡è¶³ $eâˆ—g&#x3D;g$ã€‚</li><li><strong>é€†å…ƒ</strong>:å¯¹äºç¾¤ä¸­ä»»æ„å…ƒç´  gâˆˆGï¼Œéƒ½å­˜åœ¨é€†å…ƒ g^âˆ’1^âˆˆG æ»¡è¶³ g^âˆ’1^âˆ—g&#x3D;e</li></ol><ul><li><strong>é˜¿è´å°”ç¾¤</strong>:æ»¡è¶³äº¤æ¢å¾‹çš„ç¾¤</li><li><strong>æœ‰é™ç¾¤ä¸æ— é™ç¾¤</strong>:æ ¹æ®ç¾¤ä¸­å…ƒç´ çš„ä¸ªæ•°æ¥åˆ¤æ–­</li></ul><p>æ»¡è¶³äº¤æ¢å¾‹çš„ç¾¤:ä»»æ„a,bâˆˆG,éƒ½å­˜åœ¨a<em>b&#x3D;b</em>a</p><p>ä¸¾ä¸ªç¾¤çš„ä¾‹å­:</p><ul><li>æ•´æ•°åŠ æ³•ç¾¤(Z,+)</li></ul><blockquote><ol><li>ä»»æ„ä¸¤ä¸ªæ•´æ•°ç›¸åŠ ï¼Œç»“æ„éƒ½æ˜¯å”¯ä¸€çš„æ•´æ•°ã€‚(æ»¡è¶³å°é—­æ€§)</li><li>æ•´æ•°åŠ æ³•æ»¡è¶³ç»“åˆå¾‹(æ»¡è¶³ç»“åˆå¾‹)</li><li>æ•´æ•°çš„å•ä½å…ƒæ˜¯0ï¼Œä»»ä½•æ•´æ•°åŠ 0éƒ½æ˜¯0(æœ‰å¹ºå…ƒ)</li><li>æ•´æ•°åŠ æ³•ä¸­ä¸€ä¸ªæ•°çš„ç›¸åæ•°æ˜¯ä»–çš„é€†å…ƒï¼Œä»–ä»¬ç›¸åŠ ä¾¿æ˜¯å•ä½å…ƒ0(æœ‰é€†å…ƒ)</li></ol></blockquote><p>å¹¶ä¸”æ•´æ•°ç¾¤è¿˜æ»¡è¶³äº¤æ¢å¾‹ã€‚æ‰€ä»¥å®ƒæ˜¯ä¸ªé˜¿è´å°”ç¾¤</p><ul><li>ä¹˜æ³•ç¾¤</li></ul><p>å¦‚æœæ˜¯ä¸€ä¸ªæ•´æ•°ä¹˜æ³•ï¼Œ1å°±æ˜¯å•ä½å…ƒï¼Œä½†æ˜¯ä¸æ˜¯æ‰€æœ‰æ•°éƒ½æœ‰é€†å…ƒï¼Œæ¯”å¦‚4çš„é€†å…ƒ1&#x2F;4å°±ä¸å±äºæ•´æ•°ç¾¤ã€‚</p><p>ä½†æ˜¯æœ‰ç†æ•°ä¹˜æ³•ç¾¤G(Q,*)æ˜¯å­˜åœ¨çš„ã€‚</p><h3 id="ç¾¤çš„æ€§è´¨"><a href="#ç¾¤çš„æ€§è´¨" class="headerlink" title="ç¾¤çš„æ€§è´¨"></a>ç¾¤çš„æ€§è´¨</h3><ul><li>ä¸€äº›æ€§è´¨</li></ul><blockquote><ol><li><strong>å•ä½å…ƒå”¯ä¸€</strong></li></ol><p>è¯æ˜: è®¾e1,e2æ˜¯ç¾¤Gçš„å”¯ä¸€å•ä½å…ƒï¼Œåˆ™,e1&#x3D;e1*e2&#x3D;e2</p><ol start="2"><li><strong>é€†å…ƒå”¯ä¸€</strong></li></ol><p>è¯æ˜ï¼š å¯¹äºç¾¤Gä¸­çš„å…ƒç´ gâˆˆG,å¦‚æœh1,h2æ˜¯gçš„é€†å…ƒã€‚åˆ™$h_1&#x3D;h_1e&#x3D;h_1gh_2&#x3D;eh_2&#x3D;h_2$</p><ol start="3"><li><strong>å¯¹äºa,bâˆˆGï¼Œæœ‰ä¸”åªæœ‰ä¸€ä¸ªcâˆˆGæ»¡è¶³ac&#x3D;bã€‚</strong></li></ol><p>è¯æ˜: å–c&#x3D;a^-1^ bã€‚</p><p>å”¯ä¸€ï¼šå¦‚æœac&#x3D;b,åˆ™c&#x3D;ec&#x3D;a^-1^ ac&#x3D;a^-1^b .</p><ol start="4"><li><strong>(a*b)^-1^&#x3D;b^-1^ a^-1^</strong></li></ol><p>è¯æ˜: $b^{-1}a^{-1}ab&#x3D;b^{-1}b&#x3D;e&#x3D;a^{-1}a&#x3D;abb^{-1}a^{-1}$</p></blockquote><ul><li>è®¡ç®—æ€§è´¨</li></ul><blockquote><p>(1)$a^n a^m&#x3D;a^{m+n}$</p><p>(2)$(a^{n})^m&#x3D;a^{mn}$</p><p>(3)$(a^{-n})^m&#x3D;a^{-mn}$</p><p>(4)$(a^n)^{-m}&#x3D;a^{-mn},(a^{-n})^{-m}&#x3D;a^{mn}$</p></blockquote><ul><li>ç¾¤å’Œå…ƒç´ çš„é˜¶</li></ul><blockquote><p>ä¸€ä¸ªç¾¤å¦‚æœå«æœ‰æœ‰é™ä¸ªå…ƒç´ ï¼Œåˆ™ç§°ä¸ºæœ‰é™ç¾¤ï¼Œå¦åˆ™ç§°ä¸ºæ— é™ç¾¤ï¼Œé€šå¸¸ç”¨|G|æ¥è¡¨ç¤ºç¾¤Gçš„å…ƒç´ ä¸ªæ•°ï¼Œä¹Ÿç§°ä¸ºç¾¤çš„é˜¶ã€‚</p><p>å…ƒç´ çš„é˜¶: è®¾$G$æ˜¯ç¾¤ï¼Œ$aâˆˆG$ï¼Œå¦‚æœnæ˜¯æ»¡è¶³$a^n&#x3D;e$çš„æœ€å°çš„æ­£æ•´æ•°ï¼Œåˆ™ç§°næ˜¯å…ƒç´ açš„é˜¶ã€‚</p></blockquote><h3 id="å­ç¾¤"><a href="#å­ç¾¤" class="headerlink" title="å­ç¾¤"></a>å­ç¾¤</h3><h4 id="å­ç¾¤å®šä¹‰"><a href="#å­ç¾¤å®šä¹‰" class="headerlink" title="å­ç¾¤å®šä¹‰"></a>å­ç¾¤å®šä¹‰</h4><blockquote><p>è®¾(G,*)æ˜¯ç¾¤ï¼ŒHæ˜¯Gçš„éç©ºå­é›†ï¼Œå¦‚æœ(H,*)æ„æˆä¸€ä¸ªç¾¤ï¼Œé‚£ä¹ˆç§°(H,*)æ˜¯ä¸€ä¸ªç¾¤ï¼Œåˆ™ç§°(H,*)æ˜¯(G,*)çš„å­ç¾¤ã€‚</p></blockquote><p>å¹³å‡¡å­ç¾¤:({e},*)(åªæœ‰å•ä½å…ƒ)ï¼Œ(G,*)(Gæœ¬èº«)</p><p>å…¶ä»–,éå¹³å‡¡ç¾¤</p><ul><li>ç¤ºä¾‹</li></ul><blockquote><p>åŠ æ³•å®æ•°ç¾¤(R,+)ï¼Œé‚£ä¹ˆåŠ æ³•æœ‰ç†æ•°ç¾¤(Q,+)æ˜¯å®ƒçš„å­ç¾¤ï¼ŒåŠ æ³•æ•´æ•°ç¾¤(Z,+)ä¹Ÿæ˜¯å®ƒä»¬çš„å­ç¾¤</p><p><img src="https://rockfox0.github.io/picx-images-hosting/ziqun.pfkrycjro.webp"></p></blockquote><ul><li>å­ç¾¤çš„å•ä½å…ƒ</li></ul><blockquote><p>å®šç†:Hæ˜¯ç¾¤Gçš„å­ç¾¤ï¼ŒeâˆˆGæ˜¯å•ä½å…ƒï¼Œåˆ™eä¹Ÿæ˜¯å­ç¾¤Hçš„å­ç¾¤</p></blockquote><p>è¯æ˜: å‡è®¾Hçš„å•ä½å…ƒæ˜¯e^â€™^ï¼ŒåŒæ—¶eâ‰ e^â€™^ã€‚å¯¹äºaâˆˆH,e^â€™^a&#x3D;a&#x3D;eaã€‚æ‰€æœ‰e^â€™^&#x3D;e</p><ul><li>å­ç¾¤çš„é€†å…ƒ</li></ul><blockquote><p>å®šç†: Hæ˜¯ç¾¤Gçš„å­ç¾¤ï¼ŒaâˆˆHï¼Œåˆ™a^-1^âˆˆHã€‚</p><p>è¯æ˜:</p><p>å‡è®¾bâˆˆH,aâˆˆH,bâ‰ aã€‚a*b&#x3D;e</p><p>åŒæ—¶a*a^-1^&#x3D;e&#x3D;a*b æ‰€æœ‰a^-1^&#x3D;b</p></blockquote><ul><li>åˆ¤æ–­å­ç¾¤</li></ul><ol><li>Hæ˜¯ç¾¤Gçš„éç©ºå­é›†ï¼Œå¯¹äºä»»æ„a,bâˆˆH,éƒ½æœ‰a*b^-1^âˆˆHï¼Œåˆ™Hæ˜¯Gçš„å­ç¾¤</li><li>æ ¹æ®å®šä¹‰:è®¾(G,*)æ˜¯ç¾¤ï¼ŒHæ˜¯Gçš„éç©ºå­é›†ï¼Œå¦‚æœ(H,*)æ„æˆä¸€ä¸ªç¾¤ï¼Œé‚£ä¹ˆç§°(H,*)æ˜¯ä¸€ä¸ªç¾¤ï¼Œåˆ™ç§°(H,*)æ˜¯(G,*)çš„å­ç¾¤ã€‚</li><li>Hæ˜¯ç¾¤Gçš„éç©ºå­é›†ï¼Œå¦‚æœHæ˜¯æœ‰é™é›†ï¼Œè€Œä¸”ç¾¤Gçš„è¿ç®—*åœ¨Hä¸Šæ»¡è¶³å°é—­æ€§ï¼Œåˆ™Hæ˜¯Gçš„å­ç¾¤ã€‚</li></ol><h4 id="å­ç¾¤çš„æ„é€ "><a href="#å­ç¾¤çš„æ„é€ " class="headerlink" title="å­ç¾¤çš„æ„é€ "></a>å­ç¾¤çš„æ„é€ </h4><ul><li>é˜¿è´å°”ç¾¤çš„å­ç¾¤æ„é€ </li></ul><ol><li><strong>å®šç†:Gæ˜¯é˜¿è´å°”ç¾¤ï¼ŒmâˆˆZ,åˆ™$G^m&#x3D;[a^m|aâˆˆG ]$æ˜¯Gçš„å­ç¾¤</strong></li></ol><blockquote><p> è¯æ˜: a,bâˆˆG,åˆ™a^m^ï¼Œb^m^ âˆˆGã€‚</p><p> a^m^*(b^m^)^-1^ &#x3D;(a*b^-1^)^m^</p></blockquote><p>ç¤ºä¾‹:åŠ æ³•æ•´æ•°ç¾¤(Z,+)</p><p>3Zå¯ä»¥è¡¨ç¤ºå®ƒçš„å­ç¾¤(3Z,+)&#x3D;{0,Â±3,Â±6,..,Â±3n}</p><ol start="2"><li><strong>å®šç†Gæ˜¯é˜¿è´å°”ç¾¤ï¼ŒmâˆˆZï¼Œåˆ™G{m}&#x3D;{aâˆˆG|a^m^&#x3D;e}æ˜¯å­ç¾¤</strong></li></ol><blockquote><p> è¯æ˜:</p><p> a,bâˆˆGï¼Œa^m^&#x3D;b^m^&#x3D;e,åˆ™a,bâˆˆG{m}</p><p> å› ä¸º$(a<em>b^{-1})^m&#x3D;a^m</em>(b^{-1})^m&#x3D;e*e&#x3D;e$âˆˆG{m}</p><p> å³è¯</p></blockquote><ul><li><p>æ•´æ•°çš„å­ç¾¤</p><ol start="3"><li><strong>Hæ˜¯$Z_n$(æ¨¡nçš„åŠ æ³•)çš„å­ç¾¤ï¼Œåˆ™å­˜åœ¨å”¯ä¸€éè´Ÿæ•´æ•°mï¼Œä½¿å¾—H&#x3D;mz</strong>ã€‚</li></ol></li></ul><blockquote><ul><li>$\mathbb{Z}_næ˜¯æœ‰é™å¾ªç¯ç¾¤ï¼Œç”± 1  ç”Ÿæˆï¼Œå³  \mathbb{Z}_n &#x3D; &lt;1&gt;$ã€‚</li><li>æœ‰é™å¾ªç¯ç¾¤çš„æ¯ä¸ªå­ç¾¤ä¹Ÿæ˜¯å¾ªç¯ç¾¤ï¼Œå¯¹åº”äº ( n ) çš„å› å­ã€‚</li><li>æ‰€ä»¥ ( H ) ä¸€å®šæ˜¯æŸä¸ª ( m ) çš„å€æ•°é›†åˆï¼š<br>[<br> $H &#x3D; \langle m \rangle &#x3D; m\mathbb{Z}_n &#x3D; { mx \bmod n \mid x \in \mathbb{Z} }$<br> ]</li><li>å”¯ä¸€æ€§æ¥è‡ªæœ€å°æ­£ç”Ÿæˆå…ƒçš„å”¯ä¸€æ€§ã€‚</li></ul><hr></blockquote><ol start="4"><li><strong>m1å’Œm2æ˜¯éè´Ÿæ•´æ•°ï¼Œå½“ä¸”ä»…å½“$m_1Z_nâŠ†m_2Z_n$ï¼Œæœ‰m2|m1</strong></li></ol><blockquote><p>$m_2Z_n$ å¯ä»¥çœ‹ä½œåŠ æ³•ç¾¤(G,+)ï¼Œæ ¹æ®ä¸Šé¢é˜¿è´å°”ç¾¤å­ç¾¤çš„æ„é€ ä¸­çš„å®šç†æœ‰</p><p>ä»»æ„kâŠ†Z,ä½¿å¾—$kG&#x3D;m1&#x2F;m_2G&#x3D;m_1Z_nâŠ†G$</p><p>ï¼Œåˆ™æœ‰m2|m1ã€‚åä¹‹ï¼Œè®¾ $m_1&#x3D;m_2q$ï¼Œ</p><p>åˆ™æœ‰$m_1Z_n&#x3D;m_2qZ_n&#x3D;{m_2qx|xâˆˆZ_n}âŠ†m_2Z_n$</p></blockquote><p>æ‰€ä»¥$m2âˆ£m1âŸºm1ZnâŠ†m2Zn$</p><p>ä¸¾ä¾‹,9Z&#x3D;{0,Â±9,Â±18..,Â±9n]æ˜¯3Z&#x3D;{0,Â±3,Â±6,Â±9,â€¦Â±3n}çš„å­ç¾¤ã€‚</p><h4 id="å­ç¾¤æ„é€ å­ç¾¤"><a href="#å­ç¾¤æ„é€ å­ç¾¤" class="headerlink" title="å­ç¾¤æ„é€ å­ç¾¤"></a>å­ç¾¤æ„é€ å­ç¾¤</h4><p>å®šç†1**:H<sub>1</sub>å’ŒH<sub>2</sub> æ˜¯é˜¿è´å°”ç¾¤Gçš„å­ç¾¤ï¼Œåˆ™$H&#x3D;H_1H_2$ ä¹Ÿæ˜¯Gçš„å­ç¾¤**<br>$$<br>H&#x3D;H_1<em>H_2&#x3D;{a_1</em>a_2|a_1âˆˆH_1,a_2âˆˆH_2}<br>$$</p><p>è¯æ˜</p><blockquote><p>Héç©ºï¼Œå› ä¸ºH<sub>1</sub> H<sub>2</sub> éƒ½æ˜¯éç©ºçš„ã€‚</p><p>å¯¹äºä»»æ„a,bâˆˆH,é‚£ä¹ˆæœ‰$a&#x3D;a_1<em>a_2,b&#x3D;b_1</em>b_2ä¸”a_1,b_1âˆˆH_1,a_2,b_2âˆˆH_2$</p><p>$a<em>b^{-1}&#x3D;(a_1</em>a_2)<em>b_2^{-1}<em>b_1^{-1}&#x3D;(a_1</em>b_1^{-1})</em>(a_2*b_2^{-1})âˆˆH$ â€“&gt;å› ä¸ºæ»¡è¶³äº¤æ¢å¾‹</p><p>é€šå¸¸ï¼ŒH1*H1â‰ 2H1</p><p>ä¾‹:(Z,+) ï¼ŒZ+Zæ„æˆçš„å­ç¾¤è¿˜æ˜¯æ˜¯(Z,+)ï¼Œè€Œï¼ˆ2Z,+)æ˜¯{0,Â±2,..,Â±2n)ã€‚</p></blockquote><p>æ‰©å±•: <strong>H<sub>1</sub>ï¼ŒH<sub>2</sub>â€¦H<sub>n</sub> æ˜¯é˜¿è´å°”ç¾¤Gçš„å­ç¾¤ï¼Œåˆ™$H&#x3D;H_1H_2..H_n$ ä¹Ÿæ˜¯Gçš„å­ç¾¤</strong></p><ol start="2"><li>å®šç†2: <strong>H1å’ŒH2æ˜¯Gçš„å­ç¾¤ï¼Œåˆ™H&#x3D;H1âˆ©H2ä¹Ÿæ˜¯Gçš„å­ç¾¤</strong></li></ol><p>$H&#x3D;H_1âˆ©H_2&#x3D;{a|aâˆˆH_1,aâˆˆH_2}$ </p><blockquote><p>è¯æ˜:Héç©º(å› ä¸ºeâˆˆH1ï¼ŒH2)</p><p>é‚£ä¹ˆå®šä¹‰aâˆˆH1ï¼ŒH2;bâˆˆH1ï¼ŒH2ã€‚</p><p>a*b^-1^âˆˆH1ï¼Œa*b^-1^âˆˆH2ã€‚é‚£ä¹ˆa*b^-1^âˆˆHã€‚</p></blockquote><p>æ‰©å±•:<strong>å­˜åœ¨H1ï¼ŒH2â€¦,Hnæ˜¯Gçš„å­ç¾¤ $H_1âˆ©H_2âˆ©â€¦âˆ©H_n&#x3D;H$ ä¹Ÿæ˜¯Gçš„å­ç¾¤</strong></p><ol start="3"><li>å®šç†3:H1å’ŒH2æ˜¯ç¾¤Gçš„éå¹³å‡¡å­ç¾¤ï¼Œé‚£ä¹ˆ</li></ol><p>$Gâ‰ H_1âˆªH_2$</p><p>è¯æ˜:</p><blockquote><p>å‡è®¾Gï¼H1âˆ©H2ã€‚</p><p>å› ä¸ºH1æ˜¯éå¹³å‡¡å­ç¾¤ï¼Œæ‰€ä»¥âˆƒaâˆˆGä½†äº‹å®aâˆ‰H1ã€‚å’ŒbâˆˆGä½†æ˜¯bâˆ‰H2.</p><p>å› ä¸ºG&#x3D;H1âˆªH2ï¼Œæ‰€ä»¥ï¼Œa,bâˆˆH1âˆªH2</p><p>é‚£ä¹ˆæœ‰aâˆˆH2ï¼ŒbâˆˆH1ã€‚</p><p>è€ƒè™‘a*b&#x3D;câˆˆG,é‚£ä¹ˆa*bå¿…å®šå±äºH1æˆ–H2</p><ol><li>å‡è®¾câˆˆH1ï¼Œ</li></ol><p>å› ä¸ºbâˆˆH1ï¼ŒcâˆˆH1ï¼Œä¸”æ ¹æ®å­ç¾¤çš„å®šä¹‰å’Œæ€§è´¨</p><p>åˆ™æœ‰c*b^-1^&#x3D;aâˆˆH1ï¼Œæ˜¾ç„¶çŸ›ç›¾</p><ol start="2"><li>åŒç†å‡è®¾câˆˆH2</li></ol><p>å› ä¸ºaâˆˆH2ï¼ŒcâˆˆH1ï¼Œä¸”æ ¹æ®å­ç¾¤çš„å®šä¹‰å’Œæ€§è´¨</p><p>åˆ™æœ‰c*a^-1^&#x3D;bâˆˆH2ï¼Œæ˜¾ç„¶çŸ›ç›¾</p></blockquote><h2 id="æ­£è§„å­ç¾¤å’Œå•†ç¾¤"><a href="#æ­£è§„å­ç¾¤å’Œå•†ç¾¤" class="headerlink" title="æ­£è§„å­ç¾¤å’Œå•†ç¾¤"></a>æ­£è§„å­ç¾¤å’Œå•†ç¾¤</h2><h3 id="é™ªé›†-coset"><a href="#é™ªé›†-coset" class="headerlink" title="é™ªé›†(coset)"></a>é™ªé›†(coset)</h3><h4 id="é™ªé›†çš„å®šä¹‰"><a href="#é™ªé›†çš„å®šä¹‰" class="headerlink" title="é™ªé›†çš„å®šä¹‰"></a>é™ªé›†çš„å®šä¹‰</h4><ul><li><p>( [è¿™é‡Œçš„a*bè¡¨ç¤ºè¿›è¡Œçš„ç¾¤å†…çš„â€™*â€˜è¿ç®—ï¼Œä¸æ˜¯ä¹˜æ³•ï¼Œä¹Ÿä¸æ˜¯åƒä¹‹å‰æ•´æ•°åŠ æ³•å­ç¾¤é‡Œé¢çš„è®©Zç¾¤å†…çš„å…ƒç´ è¿›è¡Œaæ¬¡è¿ç®—])<strong>å®šä¹‰</strong>:</p><blockquote><p>Hæ˜¯ç¾¤Gçš„å­ç¾¤ï¼ŒaâˆˆGï¼Œ</p><p>åˆ™æœ‰ $aH&#x3D;{a*h|hâˆˆH}$,ç§°ä¸ºHå…³äºaåœ¨Gä¸­çš„å·¦é™ªé›†ã€‚</p><p>  $Ha&#x3D;{h*a|hâˆˆH}$ï¼Œç§°ä¸ºHå…³äºaåœ¨Gä¸­çš„å³é™ªé›†ã€‚</p><p>å¦‚æœHa&#x3D;aHï¼Œç§°ä¸ºHå…³äºaåœ¨Gä¸­çš„é™ªé›†</p><p>aç§°ä¸ºä»£è¡¨å…ƒ</p></blockquote><p>é™ªé›†:[a]<sub>H</sub> ï¼Œå·¦é™ªé›†:aH ï¼Œå³é™ªé›†: Haã€‚</p><p>ä¸ºäº†æ–¹ä¾¿ï¼Œåé¢ç»Ÿä¸€ç§°å‘¼é…ç»™-[a]<sub>H</sub></p></li></ul><p>ç¤ºä¾‹ï¼š3Z&#x3D;{0,Â±3,â€¦,Â±3n}.æ˜¯åŠ æ³•ç¾¤(z,+)çš„å­ç¾¤</p><p>é™ªé›†:</p><blockquote><p>[0]<sub>3Z</sub>&#x3D;{0,0Â±3,â€¦,0Â±3n}</p><p>[1]<sub>3Z</sub>&#x3D;{1,1Â±3,â€¦,1Â±3n}</p><p>[2]<SUB>3Z</SUB>&#x3D;{2,2Â±3n,â€¦,2Â±3n}</p><p>[3]<sub>3Z</sub>&#x3D;{0,0Â±3n,â€¦,Â±3n}</p><p>â€¦â€¦</p></blockquote><p>å¯ä»¥çœ‹åˆ°æ¯ä¸ªæ•´æ•°åªä¼šå‡ºç°åœ¨å”¯ä¸€çš„é™ªé›†ä¸­(é™¤äº†ç›¸åŒçš„é™ªé›†[0]<sub>3Z</sub>å’Œ[3]<sub>3</sub>è¿™ç§å®Œå…¨ç›¸ç­‰çš„é™ªé›†å¤–ï¼Œå…¶ä»–ä»»ä½•é™ªé›†ä¹‹é—´äº¤é›†éƒ½ä¸ºç©º)ã€‚<strong>é™ªé›†å°±æ˜¯å¯¹ç¾¤è¿›è¡Œçš„åˆ’åˆ†</strong>ã€‚</p><blockquote><p>è§£é‡Š:é™ªé›†é€šè¿‡ç¾¤çš„å­ç¾¤å¯¹ç¾¤è¿›è¡Œåˆ’åˆ†ã€‚å¯ä»¥çœ‹åšæ˜¯ä¸€ç§è·ç¦»,è¿™ä¸ªå­ç¾¤3Zä½œä¸ºå¯¹ç¾¤(Z,+)çš„ä¸€ç§åˆ’åˆ†æ ‡æ³¨èƒ½å’Œä¾æ®ã€‚</p><p>[0]<sub>3Z</sub>åˆ°3Zçš„å…ƒç´ çš„è·ç¦»æ˜¯0è¡¨ç¤º3Zæœ¬èº«ï¼Œ[1]<sub>3Z</sub>åˆ°3Zä¸­å…ƒç´ çš„è·ç¦»æ˜¯1ï¼Œ[2]<sub>3Z</sub>åˆ°3Zä¸­å…ƒç´ çš„è·ç¦»æ˜¯2</p><p>è¿™ä¸‰ä¸ªé›†åˆå–å¹¶é›†:[0]<sub>3Z</sub>âˆª[1]<sub>3Z</sub>âˆª[2]<sub>3Z</sub>&#x3D;(Z,+)ã€‚å¹¶ä¸”ä¹‹é—´ä¸¤ä¸¤äº¤é›†ä¸º0</p></blockquote><h4 id="é™ªé›†çš„æ€§è´¨"><a href="#é™ªé›†çš„æ€§è´¨" class="headerlink" title="é™ªé›†çš„æ€§è´¨"></a>é™ªé›†çš„æ€§è´¨</h4><ol><li>æ€§è´¨1:**aâˆˆ[a]H(æ¯ä¸ªå…ƒç´ å¿…ç„¶ä¼šè¿›å…¥å­é›†æ„é€ çš„é™ªé›†é‡Œ)**ã€‚</li></ol><blockquote><p>H&#x3D;{e,â€¦.},é‚£ä¹ˆ[a]<sub>H</sub>&#x3D;{a*e,â€¦}&#x3D;{a,â€¦}</p></blockquote><ol start="2"><li>æ€§è´¨2:<strong>[e]<sub>H</sub>&#x3D;H(ç”¨å•ä½å…ƒæ„é€ çš„é™ªé›†ç­‰äºå­ç¾¤æœ¬èº«â€“å¹³å‡¡é™ªé›†)ã€‚</strong></li></ol><blockquote><p>[e]<sub>H</sub>&#x3D;{â€¦,e*h,â€¦}&#x3D;{â€¦,h,â€¦}</p></blockquote><ol start="3"><li>æ€§è´¨3:<strong>aâˆˆHâ‡”[a]<sub>H</sub>&#x3D;H(å­ç¾¤Hå’ŒHå†…çš„å…ƒç´ æ„é€ é™ªé›†ï¼Œå¿…ç„¶æ˜¯Hæœ¬èº«)</strong></li></ol><blockquote><p>aâˆˆHï¼ŒH&#x3D;{e,â€¦a,â€¦,h,â€¦}</p><p>[a]<sub>H</sub>&#x3D;{a*e,â€¦,a*H,â€¦}ï¼Œç”±äºç¾¤çš„å°é—­æ€§ï¼Œé‚£ä¹ˆ[a]<sub>H</sub>âŠ†Hã€‚</p><p>âˆ€ bâˆˆHï¼ŒaâˆˆHå¯ä»¥æ¨å‡ºa^-1^*bâˆˆHï¼Œå¯ä»¥ä»£è¡¨ä»»æ„hã€‚é‚£ä¹ˆa^-1^*(a^-1^*b)&#x3D;bâˆˆ[a]<sub>H</sub> ï¼Œè¯´æ˜Hçš„å…ƒç´ éƒ½åœ¨é™ªé›†ï¼ŒHâŠ†[a]H.</p><p>å¯å¾—H&#x3D;[a]H</p></blockquote><ol start="4"><li>å®šä¹‰4: **[a]<sub>H</sub> &#x3D;[b]<sub>H</sub> â‡”a^-1^ * bâˆˆH(æˆ–b^-1^ *aâˆˆH)**ã€‚</li></ol><blockquote><p>å…ˆå‡è®¾ä¸¤ä¸ª[a]<sub>H</sub>&#x3D;[b]<sub>H</sub> </p><p>[b]<sub>H</sub>&#x3D;{b,â€¦,b*h,â€¦},[a]<sub>H</sub>&#x3D;{a,â€¦,a*h,â€¦}ã€‚é‚£ä¹ˆåœ¨[a]<sub>H</sub> å¿…ç„¶æœ‰b&#x3D;a*hã€‚ï¼Œa^-1^*b&#x3D;hâˆˆHã€‚ <strong>[a]<sub>H</sub> &#x3D;[b]<sub>H</sub> â‡’a^-1^ * bâˆˆH(æˆ–b^-1^ *aâˆˆH)</strong></p><p>åæ¨: æ¯”è¾ƒç®€å•ä¸å¤šèµ˜è¿°**[a]<sub>H</sub> &#x3D;[b]<sub>H</sub> â‡ a^-1^ * bâˆˆH(æˆ–b^-1^ *aâˆˆH)**</p></blockquote><p>ä¸¾ä¸ªä¾‹å­:</p><blockquote><p>[0]<sub>3Z</sub>&#x3D;{0,0Â±3,â€¦,0Â±3n}</p><p>[1]<sub>3Z</sub>&#x3D;{1,1Â±3,â€¦,1Â±3n}</p><p>[2]<SUB>3Z</SUB>&#x3D;{2,2Â±3n,â€¦,2Â±3n}</p><p>[3]<sub>3Z</sub>&#x3D;{0,0Â±3n,â€¦,Â±3n}</p><p>â€¦â€¦</p><p>è®¾[a]<sub>3Z</sub> å’Œ[b]<sub>3Z</sub> ï¼Œé‚£ä¹ˆå¾ˆæ˜æ˜¾çš„å½“|b-a|çš„ç»å¯¹å€¼&#x3D;3nå³å±äº3Zçš„æ—¶å€™ï¼Œ[a]<sub>3Z</sub> &#x3D;[b]<sub>3Z</sub></p></blockquote><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥åˆ©ç”¨ä¸Šé¢çš„æ€§è´¨ä»‹ç»</p><h3 id="æ‹‰æ ¼æœ—æ—¥å®šç†-Lagrangesâ€™s-theorem"><a href="#æ‹‰æ ¼æœ—æ—¥å®šç†-Lagrangesâ€™s-theorem" class="headerlink" title="æ‹‰æ ¼æœ—æ—¥å®šç†(Lagrangesâ€™s theorem)"></a>æ‹‰æ ¼æœ—æ—¥å®šç†(Lagrangesâ€™s theorem)</h3><h4 id="ç¾¤çš„åˆ’åˆ†"><a href="#ç¾¤çš„åˆ’åˆ†" class="headerlink" title="ç¾¤çš„åˆ’åˆ†"></a>ç¾¤çš„åˆ’åˆ†</h4><p>æˆ‘ä»¬å¯¹å®šä¹‰4è¿›è¡Œå¦ä¸€ç§è§£é‡Šï¼Œå½“ä¸€ä¸ªaå’Œbçš„é€†è¿›è¡Œè¿ç®—æ—¶ï¼Œç±»ä¼¼äºaäºbçš„å·®å€¼ï¼Œå½“è¿™ä¸ªå·®å€¼hâˆˆHæ—¶ï¼Œåˆ™[a]<sub>H</sub> &#x3D;[b]<sub>H</sub> </p><p>æˆ‘ä»¬å¼•å…¥ä¸€ä¸ªä¸“é—¨çš„äºŒå…ƒå…³ç³»: $aâ‰¡b (mod H)â‡”a^{-1}* bâˆˆH(b^{-1}*aâˆˆH)â‡”[a]_H&#x3D;[b]_H$ ã€‚è¿™é‡Œçš„aâ‰¡b (mod H)æ˜¯ä¸€ç§äºŒå…ƒå…³ç³»ï¼Œä¸æ˜¯å–æ¨¡é‚£ç§äºŒå…ƒè¿ç®—ã€‚</p><ul><li>å‰ç½®å®šç†</li></ul><blockquote><ol><li><strong>åˆ’åˆ†</strong>: å¦‚æœ S ä¸æ˜¯ä¸€ä¸ªç©ºé›†å¹¶ä¸”å¯ä»¥å†™æˆä¸€ç³»åˆ—äº’ç›¸ä¹‹é—´ä¸ç›¸äº¤çš„å­é›†çš„å¹¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯´è¿™äº›å­é›†æ„æˆäº† S çš„ä¸€ä¸ªåˆ’åˆ†ã€‚</li><li><strong>é›†åˆä¸ç­‰ä»·å…³ç³»:</strong><br>ä¸€ä¸ªé›†åˆå¦‚æœå­˜åœ¨ä¸€ä¸ªç­‰ä»·å…³ç³»ï¼Œé‚£ä¹ˆæˆ‘ä¸€å®šæœ‰åŠæ³•å¯¹é›†åˆåšä¸€ä¸ªåˆ’åˆ†ã€‚</li><li>ä¸€ä¸ªé›†åˆä¸­çš„ä¸€é’Ÿåˆ’åˆ†å¯¹åº”ä¸€ä¸ªç­‰ä»·å…³ç³»</li></ol></blockquote><ul><li>ç­‰ä»·å…³ç³»ä¸ç­‰ä»·ç±»ã€‚<ol><li>âœ… ç­‰ä»·å…³ç³»ï¼ˆEquivalence Relationï¼‰</li></ol></li></ul><p>è®¾ ( A ) æ˜¯ä¸€ä¸ªé›†åˆã€‚è‹¥äºŒå…ƒå…³ç³»$ ( \sim \subseteq A \times A )$ æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ€§è´¨ï¼Œåˆ™ç§°å…¶ä¸ºé›†åˆ ( A ) ä¸Šçš„<strong>ç­‰ä»·å…³ç³»</strong>ï¼š</p><ul><li><strong>è‡ªåæ€§</strong>ï¼šå¯¹ä»»æ„$ ( a \in A )$ï¼Œæœ‰ $( a \sim a )$</li><li><strong>å¯¹ç§°æ€§</strong>ï¼šè‹¥$ ( a \sim b )$ï¼Œåˆ™ $( b \sim a )$</li><li><strong>ä¼ é€’æ€§</strong>ï¼šè‹¥ $( a \sim b )$ ä¸”$ ( b \sim c )$ï¼Œåˆ™$ ( a \sim c )$<ol start="2"><li>ğŸ¯ ç­‰ä»·ç±»ï¼ˆEquivalence Classï¼‰</li></ol></li></ul><p>è®¾ $( \sim )$ æ˜¯é›†åˆ ( A ) ä¸Šçš„ç­‰ä»·å…³ç³»ï¼Œä»»å–$ ( a \in A )$ï¼Œå®šä¹‰ï¼š</p><p>$[<br>[a] &#x3D; { x \in A \mid x \sim a }<br>]$</p><p>è¯¥é›†åˆç§°ä¸ºå…ƒç´  ( a ) çš„<strong>ç­‰ä»·ç±»</strong>ã€‚</p><blockquote><p>æ‰€æœ‰ç­‰ä»·ç±»åœ¨é›†åˆ ( A ) ä¸­æ„æˆä¸€ä¸ªä¸äº¤ä¸”å®Œå¤‡çš„åˆ’åˆ†ï¼ˆpartitionï¼‰ï¼š</p></blockquote><p>$[<br>A &#x3D; \bigsqcup_{a \in A} [a]<br>]$ï¼ˆè¿™é‡Œä¸ç”¨å¤ªåœ¨æ„ï¼Œç¨å¾®ç†è§£å°±è¡Œï¼‰</p><hr><pre><code class="hljs">    3.  ğŸ“Œ é™ªé›†ï¼ˆQuotient Setï¼‰</code></pre><p>å°†é›†åˆ ( A ) æŒ‰ç…§ç­‰ä»·å…³ç³» ( $\sim$ ) åˆ†ç±»åï¼Œå¾—åˆ°çš„æ‰€æœ‰ç­‰ä»·ç±»ç»„æˆä¸€ä¸ªæ–°é›†åˆï¼Œç§°ä¸º<strong>é™ªé›†</strong>ï¼š</p><p>$[<br>A &#x2F; {\sim} &#x3D; { [a] \mid a \in A }<br>]$</p><p>æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªç­‰ä»·ç±»ï¼Œæ˜¯åŸé›†åˆåœ¨è¯¥ç­‰ä»·å…³ç³»ä¸‹çš„åˆ†ç±»å•ä½ã€‚</p><p>æ ¹æ®ä¸Šé¢çš„å®šç†æˆ‘ä»¬å¾ˆå®¹æ˜“è¯æ˜$aâ‰¡b (mod H)$æ˜¯ä¸€ä¸ªç­‰ä»·å…³ç³»ï¼Œé™ªé›†æ˜¯ä¸€ä¸ªç­‰ä»·ç±»</p><ul><li><p>è¯æ˜</p><blockquote><ol><li>è‡ªåæ€§: $aâ‰¡a(mod H)$</li><li>å¯¹ç§°æ€§:$aâ‰¡b(mod H)â‡’a&#x3D;b<em>h,hâˆˆHâ‡’a</em>h^{-1}&#x3D;b  (h^{-1}âˆˆH)â‡’bâ‰¡a(mod H)$</li><li>ä¼ é€’æ€§:  $aâ‰¡b(mod H),bâ‰¡c(mod H)â‡’a&#x3D;b<em>h,b&#x3D;c</em>h_1,h,h_1âˆˆHâ‡’a&#x3D;c<em>h</em>h_1,h*h_1âˆˆHâ‡’aâ‰¡c(mod H)$</li></ol></blockquote></li><li><p>æ€§è´¨1ï¼š<strong>ä»»æ„ä¸¤ä¸ªé™ªé›†ä¹‹é—´å­˜åœ¨åŒå°„ï¼Œä»»æ„é™ªé›†[a]<sub>H</sub>å’Œå­ç¾¤Hæ˜¯ç­‰åŠ¿çš„</strong>ã€‚(åŒä¸€ä¸ªå­ç¾¤æ‰€æ„é€ çš„é™ªé›†å¤§å°æ˜¯ç›¸ç­‰çš„(å…ƒç´ çš„æ•°é‡)ï¼Œå¹¶ä¸”ç­‰äºå­ç¾¤çš„å¤§å°)</p></li></ul><h4 id="æ‹‰æ ¼æœ—æ—¥å®šç†"><a href="#æ‹‰æ ¼æœ—æ—¥å®šç†" class="headerlink" title="æ‹‰æ ¼æœ—æ—¥å®šç†"></a>æ‹‰æ ¼æœ—æ—¥å®šç†</h4><ul><li><p>å®šç†: <strong>Gæ˜¯æœ‰é™ç¾¤ï¼ŒHæ˜¯ä»»æ„å­ç¾¤ï¼Œåˆ™|H|||G|</strong> (Gä»»æ„å­ç¾¤çš„é˜¶å¿…ç„¶æ˜¯Gçš„é˜¶çš„å› å­)ã€‚</p><p>è¯æ˜:</p><blockquote><p>è®¾Hæ„é€ çš„é™ªé›†ä¸º$[a_1]_H,â€¦,[a_n]<em>H$,å®ƒä»¬æ˜¯Gçš„åˆ’åˆ†æ‰€æœ‰ï¼Œ$|G|&#x3D;\sum</em>{i&#x3D;1}^{n}|[a_i]<em>H|&#x3D;\sum</em>{i}^{n}|H|&#x3D;n|H|  $ï¼Œå¹¶ä¸”æˆ‘ä»¬æ˜¾ç„¶å°±èƒ½çŸ¥é“è¿™ä¸ªnå°±æ˜¯è¿™ä¸ªå­ç¾¤Hèƒ½äº§ç”Ÿçš„é™ªé›†çš„ä¸ªæ•°ã€‚</p></blockquote></li><li><p>ç¤ºä¾‹</p><blockquote><p>è®¾ç¾¤ $\mathbb{Z}_6 &#x3D; {0, 1, 2, 3, 4, 5}$ï¼Œå…¶è¿ç®—ä¸ºåŠ æ³•æ¨¡ $6$ã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰é™é˜¿è´å°”ç¾¤ã€‚</p><p>è€ƒè™‘å…¶å­ç¾¤ $H &#x3D; {0, 3}$ï¼Œè¿™ä¸ªå­ç¾¤ç”± $3$ ç”Ÿæˆï¼Œè®°ä½œ $3\mathbb{Z}_6$ã€‚</p><p>æ„é€ é›†åˆ $\mathbb{Z}_6$ å…³äº $H$ çš„é™ªé›†å¦‚ä¸‹ï¼š</p><p>$0 + H &#x3D; {0, 3}$<br>$1 + H &#x3D; {1, 4}$<br>$2 + H &#x3D; {2, 5}$</p><p>ç”±äº $\mathbb{Z}_6$ æ˜¯é˜¿è´å°”ç¾¤ï¼Œç¾¤çš„é™ªé›†æ„æˆä¸€ä¸ªåˆ’åˆ†ï¼š</p><p>$\mathbb{Z}_6 &#x2F; H &#x3D; { {0,3},\ {1,4},\ {2,5} }$</p><p>æ¯ä¸ªé™ªé›†åŒ…å« $2$ ä¸ªå…ƒç´ ï¼Œå…±æœ‰ $3$ ä¸ªé™ªé›†ã€‚</p><p>ç”±æ‹‰æ ¼æœ—æ—¥å®šç†ï¼Œè‹¥ $H \le G$ï¼Œåˆ™ $|G| &#x3D; [G : H] \cdot |H|$ã€‚</p><p>åœ¨æœ¬ä¾‹ä¸­ï¼š</p><ul><li>$|G| &#x3D; |\mathbb{Z}_6| &#x3D; 6$</li><li>$|H| &#x3D; 2$</li><li>$[\mathbb{Z}_6 : H] &#x3D; 3$</li></ul><p>æ»¡è¶³ $6 &#x3D; 3 \cdot 2$ï¼Œç¬¦åˆæ‹‰æ ¼æœ—æ—¥å®šç†ã€‚</p></blockquote></li></ul><h3 id="å•†ç¾¤"><a href="#å•†ç¾¤" class="headerlink" title="å•†ç¾¤"></a>å•†ç¾¤</h3><h4 id="æ­£è§„å­ç¾¤"><a href="#æ­£è§„å­ç¾¤" class="headerlink" title="æ­£è§„å­ç¾¤"></a>æ­£è§„å­ç¾¤</h4><ul><li><p>å®šä¹‰: <strong>è®¾å®šNæ˜¯ç¾¤Gçš„å­ç¾¤ï¼Œå¦‚æœå¯¹äº$âˆ€aâˆˆG$ï¼Œéƒ½æœ‰$aN&#x3D;Na$ï¼Œç§°ä¸ºNä¸ºGçš„æ­£è§„å­ç¾¤</strong></p></li><li><ol><li>æ€§è´¨1æ­£è§„å­ç¾¤çš„é™ªé›†è¿ç®—è§„å¾‹:<strong>$[a]_N*[b]_N&#x3D;[a*b]Nï¼Œ(a,bâˆˆG)$</strong> è¿™æ˜¯ä¸€ç§é™ªé›†ä¸é™ªé›†çš„è¿ç®—</li></ol><blockquote><p>$(a<em>h)</em>(b<em>h1)$ ,h,h1,h2âˆˆNå¯ä»¥è¡¨ç¤º$[a</em>b]N$ä¸­çš„ä»»æ„å…ƒç´ <br>&#x3D;$a*(h<em>b)<em>h1&#x3D;a</em>b</em>(h2*h1)$æ˜¾ç„¶æˆç«‹ã€‚</p><p>æ³¨æ„è¿™é‡Œçš„å­ç¾¤å¹¶ä¸ä¸€å®šæ»¡è¶³äº¤æ¢å¾‹ï¼Œè¿™ä¸ªæ¨å¯¼åˆ©ç”¨çš„æ˜¯ä¸¤ä¸ªé™ªé›†ä¹‹é—´çš„æ˜ å°„ã€‚</p></blockquote></li></ul><h4 id="å•†ç¾¤-1"><a href="#å•†ç¾¤-1" class="headerlink" title="å•†ç¾¤"></a>å•†ç¾¤</h4><ul><li><p>å¼•å…¥ï¼Œåœ¨å‰é¢çš„æè¿°ä¸­æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªé›†åˆ$G&#x2F;N&#x3D;{[a]_N|aâˆˆG}$ ï¼Œè¿™æ˜¯ä¸€ä¸ªç”±å­ç¾¤Nçš„é™ªé›†ç»„æˆçš„é›†åˆ</p><blockquote><p>å‰é¢è®²è¿°çš„æ€§è´¨1ä½œä¸ºé›†åˆG&#x2F;Nå…ƒç´ ä¹‹é—´çš„è¿ç®—ã€‚$[a]_N*[b]_N&#x3D;[a<em>b]N$è¿™é‡Œçš„â€™</em>â€˜æ˜¯ç¾¤Gçš„è¿ç®—,a,bâˆˆG</p><p>G&#x2F;Næ˜¯ä¸€ä¸ªç¾¤:</p><ol><li>å°é—­æ€§:$[a]_N*[b]_N&#x3D;[a<em>b]N$ ï¼Œa</em>bâˆˆGï¼Œæ˜¾ç„¶æ»¡è¶³ç»“åˆå¾‹</li><li>ç»“åˆå¾‹:$[a]_N*([b]_N*[c]_N)&#x3D;[a<em>b</em>c]_N&#x3D;([a]_N*[b]_N)*[c]_N$</li><li>å•ä½å…ƒ:$N&#x3D;[e]_N,N*[a]_N&#x3D;[a]_N,N*[a]_N&#x3D;[a]_N$ï¼Œæ˜¾ç„¶æ»¡è¶³</li><li>é€†å…ƒ:$[a]_N*[a^{-1}]_N&#x3D;N,[a^{-1}]_N*[a]_N&#x3D;N$</li></ol></blockquote></li><li><p>å®šä¹‰:<strong>åƒè¿™æ ·ç”±æ­£è§„å­ç¾¤Næ„æˆçš„ç¾¤$(G&#x2F;N,*)$ç§°ä¸ºæ¨¡Nä¸‹çš„å•†ç¾¤</strong>ã€‚</p></li><li><p>[G:N]ï¼šå•†ç¾¤G&#x2F;Nçš„é˜¶</p><ol><li><p>å®šç†1: <strong>Gæ˜¯æœ‰é™ç¾¤ï¼ŒNæ˜¯Gçš„æ­£è§„å­ç¾¤ã€‚åˆ™$[G:N]&#x3D;\frac{|G|}{|N|}$</strong> â€”è¯æ˜çœ‹æ‹‰æ ¼æœ—æ—¥å®šç†</p></li><li><p>å®šç†2:<strong>Gæ˜¯æœ‰é™ç¾¤ï¼ŒNæ˜¯Gçš„æ­£è§„å­ç¾¤ï¼ŒKæ˜¯Nçš„æ­£è§„å­ç¾¤ã€‚åˆ™æœ‰$[G:K]&#x3D;[G:N][N:K]$</strong></p><blockquote><p>è¯æ˜:$[G:K]&#x3D;\frac{|G&#x2F;||K|}{|N|&#x2F;|K|}&#x3D;\frac{[G:K]}{[N:K]}   $</p></blockquote></li></ol></li><li><p>é˜¿è´å°”ç¾¤çš„å•†ç¾¤</p><ol><li><p>æ€§è´¨1: <strong>Hæ˜¯é˜¿è´å°”ç¾¤Gçš„å­ç¾¤ï¼Œå¯¹äºâˆ€aâˆˆGï¼Œæœ‰$aH&#x3D;Ha&#x3D;[a]_H$</strong> â€”ï¼ˆè¿™ä¸ªå®šç†åè¿‡æ¥ä¸ä¸€å®šæˆç«‹ï¼‰</p><blockquote><p>è¯æ˜:</p><p>$aH&#x3D;{a<em>h|hâˆˆH}&#x3D;{h</em>a|hâˆˆH}&#x3D;[a]_H$</p></blockquote></li><li><p>æ€§è´¨2:é˜¿è´å°”ç¾¤çš„å­ç¾¤éƒ½æ˜¯æ­£è§„å­ç¾¤</p></li><li><p>æ€§è´¨2:é˜¿è´å°”ç¾¤çš„å­ç¾¤éƒ½å¯ä»¥æ„é€ å•†ç¾¤</p></li><li><p>æ€§è´¨3:é˜¿è´å°”ç¾¤æ„é€ çš„å•†ç¾¤ä¹Ÿæ˜¯å­ç¾¤</p></li></ol></li><li><p>ä¾‹å­</p><blockquote><p>ğŸ“˜ å•†ç¾¤ $\mathbb{Z}_{12} &#x2F; \langle 3 \rangle$ çš„ä¾‹å­ï¼ˆä½“ç°å•†ç¾¤ç»“æ„ï¼‰</p><p>è®¾ç¾¤ $G &#x3D; \mathbb{Z}_{12}$ï¼Œå³æ¨¡ $12$ ä¸‹çš„æ•´æ•°åŠ æ³•ç¾¤ï¼š</p><p>$$<br>G &#x3D; {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11}<br>$$</p><p>è¿™æ˜¯ä¸€ä¸ªé˜¿è´å°”ç¾¤ã€‚</p><p>å– $H &#x3D; \langle 3 \rangle &#x3D; {0, 3, 6, 9}$ï¼Œæ˜¯ $G$ çš„ä¸€ä¸ªå­ç¾¤ã€‚</p><p>ç”±äº $G$ æ˜¯é˜¿è´å°”ç¾¤ï¼Œæ‰€æœ‰å­ç¾¤éƒ½æ˜¯æ­£è§„å­ç¾¤ï¼Œå› æ­¤ $H \trianglelefteq G$ã€‚</p><hr><p>æ„é€ å•†ç¾¤ $G&#x2F;H$ï¼Œå³ $G$ å…³äº $H$ çš„é™ªé›†é›†åˆï¼š</p><ul><li>$[0] &#x3D; {0, 3, 6, 9}$</li><li>$[1] &#x3D; {1, 4, 7, 10}$</li><li>$[2] &#x3D; {2, 5, 8, 11}$</li></ul><p>æ‰€ä»¥ï¼š</p><p>$$<br>\mathbb{Z}_{12} &#x2F; \langle 3 \rangle &#x3D; { [0], [1], [2] }<br>$$</p><p>æˆ‘ä»¬æ¥å®šä¹‰å•†ç¾¤ä¸Šçš„åŠ æ³•ï¼š</p><p>$$<br>[a] + [b] &#x3D; [a + b]<br>$$</p><p>æ¯”å¦‚ï¼š</p><ul><li>$[1] + [1] &#x3D; [2]$</li><li>$[2] + [2] &#x3D; [4] &#x3D; [1]$ï¼ˆå› ä¸º $4 \in [1]$ï¼‰</li><li>$[1] + [2] &#x3D; [3] &#x3D; [0]$ï¼ˆå› ä¸º $3 \in H$ï¼‰</li></ul><p>æˆ‘ä»¬å¯ä»¥åˆ—å‡ºè¿™ä¸ªå•†ç¾¤çš„åŠ æ³•è¿ç®—è¡¨ï¼š</p><table><thead><tr><th>$+$</th><th>$[0]$</th><th>$[1]$</th><th>$[2]$</th></tr></thead><tbody><tr><td>$[0]$</td><td>$[0]$</td><td>$[1]$</td><td>$[2]$</td></tr><tr><td>$[1]$</td><td>$[1]$</td><td>$[2]$</td><td>$[0]$</td></tr><tr><td>$[2]$</td><td>$[2]$</td><td>$[0]$</td><td>$[1]$</td></tr></tbody></table><p>è¿™æ­£æ˜¯ $\mathbb{Z}_3$ çš„åŠ æ³•è¡¨ï¼</p></blockquote></li></ul><hr><h2 id="ç¾¤çš„åŒæ€ä¸åŒæ„"><a href="#ç¾¤çš„åŒæ€ä¸åŒæ„" class="headerlink" title="ç¾¤çš„åŒæ€ä¸åŒæ„"></a>ç¾¤çš„åŒæ€ä¸åŒæ„</h2><blockquote><p>ç¾¤è®ºä¸­çš„åŒæ€å’ŒåŒæ„æ¥æè¿°<strong>ä¸¤ä¸ªç¾¤ä¹‹é—´çš„ç›¸ä¼¼å…³ç³»</strong>ã€‚</p><p>ä»ä¸­æ–‡ä¸Šç²—ç•¥çœ‹ï¼ŒåŒæ„å¥½åƒæŒ‡ç›¸åŒç»“æ„ï¼ŒåŒæ€å¥½åƒä¸å¥½è¯´ã€‚</p><p>å…ˆä¸Šç»“è®ºï¼Œä»ç›¸ä¼¼å…³ç³»çš„ç¨‹åº¦æ¥çœ‹ï¼š<strong>ç›¸åŒï¼åŒæ„ï¼åŒæ€</strong>ï¼Œå³<strong>åŒæ€è¦æ±‚æ¯”åŒæ„æ›´å®½æ¾ï¼ŒåŒæ„æ˜¯ä¸€ç§ç‰¹æ®Šçš„åŒæ€ã€‚</strong></p></blockquote><h3 id="å•å°„æ»¡å°„åŒå°„"><a href="#å•å°„æ»¡å°„åŒå°„" class="headerlink" title="å•å°„æ»¡å°„åŒå°„"></a>å•å°„æ»¡å°„åŒå°„</h3><p><strong>å•å°„ï¼ˆInjectiveï¼‰</strong></p><p>è®¾æœ‰ä¸¤ä¸ªé›†åˆ $A$ å’Œ $B$ï¼Œä¸€ä¸ªå‡½æ•° $f: A \to B$ è¢«ç§°ä¸º<strong>å•å°„</strong>ï¼Œå¦‚æœï¼š</p><blockquote><p>ä¸åŒçš„å…ƒç´ åœ¨ $A$ ä¸­æ˜ å°„åˆ°ä¸åŒçš„å…ƒç´ åœ¨ $B$ ä¸­ã€‚</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ $f(a_1) &#x3D; f(a_2)$ï¼Œé‚£ä¹ˆå¿…æœ‰ $a_1 &#x3D; a_2$ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œå‡½æ•° $f$ åœ¨å®šä¹‰åŸŸä¸­ä¸ä¼šâ€œåˆå¹¶â€ä¸¤ä¸ªä¸åŒçš„è¾“å…¥ã€‚</p><p><strong>æ•°å­¦è¡¨è¾¾å¼</strong>ï¼š<br>$ \forall a_1, a_2 \in A, ; f(a_1) &#x3D; f(a_2) \Rightarrow a_1 &#x3D; a_2 $</p><hr><p><strong>æ»¡å°„ï¼ˆSurjectiveï¼‰</strong></p><p>ä¸€ä¸ªå‡½æ•° $f: A \to B$ æ˜¯<strong>æ»¡å°„</strong>ï¼Œå¦‚æœï¼š</p><blockquote><p>å¯¹äº $B$ ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´  $b$ï¼Œéƒ½è‡³å°‘å­˜åœ¨ä¸€ä¸ª $a \in A$ï¼Œä½¿å¾— $f(a) &#x3D; b$ã€‚</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ$f$ çš„åƒé›†ï¼ˆè¾“å‡ºï¼‰è¦†ç›–äº†æ•´ä¸ªé›†åˆ $B$ã€‚</p><p><strong>æ•°å­¦è¡¨è¾¾å¼</strong>ï¼š<br>$ \forall b \in B, ; \exists a \in A \text{ ä½¿å¾— } f(a) &#x3D; b $</p><hr><p><strong>åŒå°„ï¼ˆBijectiveï¼‰</strong></p><p>ä¸€ä¸ªå‡½æ•° $f: A \to B$ æ˜¯<strong>åŒå°„</strong>ï¼Œå¦‚æœå®ƒ<strong>æ—¢æ˜¯å•å°„åˆæ˜¯æ»¡å°„</strong>ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ$f$ æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼šæ¯ä¸ª $A$ ä¸­çš„å…ƒç´ æœ‰å”¯ä¸€çš„ $B$ ä¸­çš„å¯¹åº”å…ƒç´ ï¼Œä¸”æ¯ä¸ª $B$ ä¸­çš„å…ƒç´ ä¹Ÿæœ‰å”¯ä¸€çš„ $A$ ä¸­çš„å‰åƒã€‚</p><p><strong>æ•°å­¦è¡¨è¾¾å¼</strong>ï¼š<br>$ \forall b \in B, ; \exists! a \in A \text{ ä½¿å¾— } f(a) &#x3D; b $</p><h3 id="ç¾¤åŒæ€-Group-homomorphism"><a href="#ç¾¤åŒæ€-Group-homomorphism" class="headerlink" title="ç¾¤åŒæ€(Group homomorphism)"></a>ç¾¤åŒæ€(Group homomorphism)</h3><p>å®šä¹‰:<strong>è®¾ç¾¤$(G,<em>)$å’Œç¾¤$(Gâ€™,\otimes  )$ ,å¦‚æœå‡½æ•°$f:G\longrightarrow Gâ€™$,å¯¹äºâˆ€a,bâˆˆGéƒ½æœ‰$f(a,b)&#x3D;f(a)\otimes f(b)$ï¼Œåˆ™ç§°fä¸º$(G,</em>)$åˆ°$(G,\otimes)$ çš„ç¾¤åŒæ€.</strong> </p><ul><li>è‹¥$f:G\longrightarrow Gâ€™$,(åé¢ç®€ç§°f)ï¼Œæ˜¯å•å°„ï¼Œé‚£ä¹ˆç§°fæ˜¯å•SåŒæ€</li><li>è‹¥fæ˜¯æ»¡å°„ï¼Œé‚£ä¹ˆç§°fæ˜¯æ»¡åŒæ€æˆ–ä¸ŠåŒæ€</li><li>è‹¥fæ˜¯åŒå°„ï¼Œé‚£ä¹ˆç§°fæ˜¯åŒæ„è®°ä½œ:$G\cong Gâ€™$</li></ul><ul><li><p>ç¤ºä¾‹</p><blockquote><p>ç¾¤ A &#x3D; (Z,+),aâˆˆAï¼Œç¾¤B &#x3D; {1, -1}ï¼Œæ˜ å°„ã€‚</p><p>$f(a)&#x3D;(-1)^a$ </p><p>$f(a_1a_2)&#x3D;(-1)^{a+a_2}$</p></blockquote><p>æ˜æ˜¾ï¼Œå¥‡æ•°æ˜ å°„åˆ°-1ï¼Œå¶æ•°æ˜ å°„åˆ°1ã€‚ä»–ä»¬æ»¡è¶³åŒæ€æ˜ å°„ã€‚</p></li></ul><h4 id="åŒæ€åƒ-homomorphism-image"><a href="#åŒæ€åƒ-homomorphism-image" class="headerlink" title="åŒæ€åƒ(homomorphism image)"></a>åŒæ€åƒ(homomorphism image)</h4><p>å®šä¹‰:$Im f&#x3D;f(G)&#x3D;{f(a)|aâˆˆG}$</p><blockquote><p>åœ¨ç¾¤åŒæ€$f:G\longrightarrow Gâ€™$ åœ¨å…ƒç´ G-&gt;Gâ€˜æ˜ å°„çš„è½ç‚¹å¯èƒ½åªæ˜¯Gâ€™çš„å­é›†ã€‚åƒè¿™æ ·Gâ€™ä¸­èƒ½åœ¨Gå†…æ‰¾åˆ°åŸåƒçš„å­é›†ç§°ä¸ºåŒæ€åƒã€‚</p></blockquote><p><img src="https://rockfox0.github.io/picx-images-hosting/ttxi.102el3rrwz.webp"></p><h4 id="åŒæ€æ ¸-homomorphism-kernel"><a href="#åŒæ€æ ¸-homomorphism-kernel" class="headerlink" title="åŒæ€æ ¸(homomorphism kernel)"></a>åŒæ€æ ¸(homomorphism kernel)</h4><p>å®šä¹‰: $Ker f&#x3D;{aâˆˆG|f(a)&#x3D;eâ€™}$,eâ€™æ˜¯Gâ€™çš„å•ä½å…ƒ</p><blockquote><p>æ ¸è¿™ä¸ªè¯¥æ¦‚å¿µå…³æ³¨çš„æ˜¯å®šä¹‰åŸŸGå†…çš„å…ƒç´ ã€‚Gå†…ç»fæ˜ å°„åç­‰äºGâ€™å†…å•ä½å…ƒçš„å…ƒç´ æ„æˆçš„é›†åˆç§°ä¸ºåŒæ€æ ¸ã€‚</p></blockquote><p><img src="https://rockfox0.github.io/picx-images-hosting/tthe.361t6vjfo2.webp"></p><ul><li><p>åŒæ€æ ¸çš„æ€§è´¨</p><ol><li><strong>å®šä¹‰1: $f:G\longrightarrow Gâ€™$æ˜¯ç¾¤åŒæ€ï¼Œåˆ™Ker fæ˜¯æ­£è§„å­ç¾¤ã€‚</strong></li></ol><p>è¯æ˜: è®¾ $f: G \longrightarrow Gâ€™$ æ˜¯ç¾¤åŒæ€ã€‚</p><p>å®šä¹‰æ ¸ä¸ºï¼š</p><p>$$<br>\ker f &#x3D; { g \in G \mid f(g) &#x3D; e_{Gâ€™} }<br>$$</p><p>æˆ‘ä»¬è¦è¯æ˜ï¼š$\ker f \trianglelefteq G$ï¼Œå³å®ƒæ˜¯ $G$ çš„æ­£è§„å­ç¾¤ã€‚</p><p><strong>è¯æ˜</strong>ï¼š</p><ol><li><p>$\ker f \neq \emptyset$ï¼Œå› ä¸º $f(e_G) &#x3D; e_{Gâ€™}$ï¼Œæ‰€ä»¥ $e_G \in \ker f$ã€‚</p></li><li><p>è‹¥ $a, b \in \ker f$ï¼Œåˆ™ï¼š</p></li></ol><p>$$<br>f(ab^{-1}) &#x3D; f(a)f(b)^{-1} &#x3D; e_{Gâ€™} e_{Gâ€™}^{-1} &#x3D; e_{Gâ€™} \Rightarrow ab^{-1} \in \ker f<br>$$</p><p>æ‰€ä»¥ $\ker f \leq G$ã€‚</p><ol start="3"><li>å¯¹ä»»æ„ $g \in G,; k \in \ker f$ï¼Œæˆ‘ä»¬æœ‰ï¼š</li></ol><p>$$<br>f(gkg^{-1}) &#x3D; f(g)f(k)f(g)^{-1} &#x3D; f(g)e_{Gâ€™}f(g)^{-1} &#x3D; f(g)f(g)^{-1} &#x3D; e_{Gâ€™} \Rightarrow gkg^{-1} \in \ker f<br>$$</p><p>å› æ­¤ï¼Œ$\ker f$ å¯¹å…±è½­å°é—­ï¼Œæ˜¯æ­£è§„å­ç¾¤ï¼š</p><p>$$<br>\ker f \trianglelefteq G<br>$$</p><ol start="2"><li><p>**å®šä¹‰2: ã€‚$f:G \longrightarrow Gâ€™æœ‰fæ˜¯å•å°„\Leftrightarrow Ker f&#x3D;{e}$**l</p><p>è¯æ˜:$å‡è®¾fä¸æ˜¯å•å°„ï¼Œ\exists a,bâˆˆGï¼Œaâ‰ ,æœ‰f(a)&#x3D;f(b).å®šç†3ï¼Œa\equiv b(mod Ker f)ã€‚<br>æ‰€ä»¥,b^{-1}âˆˆKer f,b^{-1}*aâ‰ e,ä¸æ ¸é‡Œåªæœ‰eçŸ›ç›¾$</p></li><li><p><strong>å®šä¹‰3$f:G\longrightarrow Gâ€™ $æ˜¯ç¾¤åŒæ€ï¼Œâˆ€ a,bâˆˆGï¼Œæœ‰$f(a)&#x3D;f(b)\Longleftrightarrow a\equiv b (mod Ker f)$</strong></p><p>è¯æ˜:$f(a)&#x3D;f(b)\Longleftrightarrow f^{-1}(b)\otimes f(a)&#x3D;f^{-1}(b)\otimes f(b)&#x3D;eâ€™$</p><ul><li><p>fæ˜¯å•ä¸€åŒæ€$\Longleftrightarrow$ Ker f&#x3D;{e}(åŒæ€æ ¸åªè¦å•ä½å…ƒ)</p></li><li><p>fæ˜¯æ»¡åŒæ€$\Longleftrightarrow$ Im f&#x3D;Gâ€™(åŒæ€åƒæ˜¯Gå…¶æœ¬èº«)</p></li></ul></li></ol></li></ul><h4 id="ç¾¤åŒæ€çš„ç¤ºä¾‹"><a href="#ç¾¤åŒæ€çš„ç¤ºä¾‹" class="headerlink" title="ç¾¤åŒæ€çš„ç¤ºä¾‹"></a>ç¾¤åŒæ€çš„ç¤ºä¾‹</h4><ul><li><p><strong>åµŒå…¥æ˜ å°„(inclusion map)</strong></p><ul><li><p>å®šä¹‰:æ˜¯æ•°å­¦ä¸­çš„ä¸€ä¸ªåŸºæœ¬æ¦‚å¿µï¼Œä¹Ÿç§°ä¸ºåŒ…å«æ˜ å°„ã€‚å®ƒæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ˜ å°„ï¼Œç”¨äºæè¿°ä¸€ä¸ªé›†åˆå¦‚ä½•åµŒå…¥åˆ°å¦ä¸€ä¸ªé›†åˆä¸­ã€‚</p><blockquote><p>è®¾ç¾¤$(G,*)ï¼ŒH\subseteq G$ å®šä¹‰æ˜ å°„fä¸º$f:H\longrightarrow G$</p><p>æ˜¾ç„¶æœ‰$aâˆˆHï¼Œf(a)&#x3D;a$</p><p>è¯æ˜:$\forall a,bâˆˆH \ f(a<em>b)&#x3D;a</em>b&#x3D;f(a)*f(b)$    </p></blockquote><p>æ‰€ä»¥å­ç¾¤åˆ°ç¾¤çš„åµŒå…¥æ˜ å°„æ˜¯ç¾¤åŒæ€ï¼Œè¿™ä¸ªç¾¤åŒæ€è¿˜æœ‰ä¸ªç‰¹ç‚¹æ˜¯åŸåƒä¸åƒä¹‹é—´æ˜¯ä¸€å¯¹ä¸€çš„ã€‚æ˜¾ç„¶è¿™æ˜¯ä¸€ä¸ªå•å°„ï¼Œè¿™ç§ç¾¤åŒæ€å«å•ä¸€åŒæ€</p></li></ul></li><li><p><strong>è‡ªç„¶æ˜ å°„(natural map)</strong></p><ul><li><p>å®šä¹‰ï¼š<strong>é›†åˆAä¸Šçš„ç­‰ä»·å…³ç³»Råˆ°å•†é›†A&#x2F;Rçš„æ˜ å°„</strong></p><blockquote><p>è®¾ç¾¤$(G,*)ï¼ŒN\subseteq G$ å®šä¹‰æ˜ å°„fä¸º$f:G\longrightarrow G&#x2F;N$<br>æ˜¾ç„¶æœ‰$aâˆˆGï¼Œf(a)&#x3D;[a]_N$ã€‚è¿™é‡Œè¡¨ç¤ºçš„æ˜¯ç¾¤Gä¸Šçš„å…ƒç´ aåˆ°å®ƒçš„å•†ç¾¤G&#x2F;Nä¸Šçš„æ˜ å°„</p><p>è¯æ˜:$\forall a,bâˆˆG \ f(a,b)&#x3D;[a<em>b]_N&#x3D;[a]_N</em>[b]_N&#x3D;f(a)*f(b)$</p></blockquote><p>æ˜¾ç„¶è¿™æ˜¯ä¸€ä¸ªç¾¤åŒæ€ï¼Œåœ¨è¿™ä¸ªç¾¤åŒæ€ä¸­Næ˜¯å•†ç¾¤çš„å•ä½å…ƒã€‚é‚£ä¹ˆè‡ªç„¶æ˜ å°„æ„æˆçš„ç¾¤çš„<strong>åŒæ€æ ¸</strong>å°±Nï¼Œä¹Ÿå°±æ˜¯å•†ç¾¤çš„å•ä½å…ƒã€‚è¿™ä¸ªç¾¤åŒæ€å› ä¸ºæ¯ä¸ªé™ªé›†éƒ½æœ‰ä¸ä¹‹å¯¹åº”çš„<strong>åŸåƒ(ä»£è¡¨å…ƒ)<strong>ï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸ª</strong>æ»¡å°„</strong>ï¼Œè¿™ç§ç¾¤åŒæ€ç§°ä¸º<strong>æ»¡åŒæ€</strong>ã€‚</p></li></ul></li><li><p><strong>mæ¬¡æ–¹æ˜ å°„(n-power map)</strong> </p><ul><li><p>å®šä¹‰:(ä¸åƒä¸Šé¢æœ‰ä¸Šé¢ä¸“é—¨çš„æ¦‚å¿µæˆ‘ä»¬è¿™é‡Œç»™ä¸ªæ•°å­¦å®šä¹‰)Gæ˜¯ä¸€ä¸ªé›†åˆã€‚$Gâ€™&#x3D;{f(a)|aâˆˆGï¼Œf(a)&#x3D;a^m}$  è¿™é‡Œçš„æ¬¡æ–¹æ˜¯æŒ‡çš„è¿›è¡Œmæ¬¡è¿ç®—ã€‚</p><blockquote><p>å®šä¹‰<strong>é˜¿è´å°”ç¾¤</strong>$(G,*)$ ,å®šä¹‰æ˜ å°„fä¸º$f:G \longrightarrow G^m$ ã€‚è¿™æ˜¯ä¸€ä¸ªç¾¤åŒæ€ï¼Œåœ¨è¿™ä¸ªç¾¤åŒæ€ä¸­$Im f&#x3D;G^m$ $Ker f&#x3D;G{m}$(G^m^å’ŒG{m}æ˜¯ä»€ä¹ˆè§å‰é¢ ç¾¤åŸºç¡€-å­ç¾¤-å­ç¾¤çš„æ„é€ )</p><p>è¯æ˜: $\forall a,bâˆˆG\f(a<em>b)&#x3D;(a</em>b)^m&#x3D;a^m*b^m&#x3D;f(a)*f(b)$</p></blockquote><p>ä¾‹:</p><blockquote><p>$f: Z^*_p \longrightarrow Z^*_p ,a\longrightarrow a^2$ </p><p>é‚£ä¹ˆåœ¨è¿™ä¸ªç¾¤åŒæ€ä¸­:$Im f&#x3D;(Z^*_p)^2 ,Ker f&#x3D;Z^*_p{2}&#x3D;{1,p-1} $</p></blockquote></li></ul></li></ul><h4 id="ç¾¤åŒæ€çš„æ€§è´¨"><a href="#ç¾¤åŒæ€çš„æ€§è´¨" class="headerlink" title="ç¾¤åŒæ€çš„æ€§è´¨"></a>ç¾¤åŒæ€çš„æ€§è´¨</h4><ol><li><p>æ€§è´¨1:<strong>ç¾¤åŒæ€çš„å•ä½å…ƒå¯¹åº”å•ä½å…ƒ</strong>ã€‚è®¾eâ€™æ˜¯Gâ€˜çš„å•ä½å…ƒã€‚é‚£ä¹ˆ$f:G\longrightarrow Gâ€™$å°±æœ‰eâ€™&#x3D;f(e)ã€‚</p><blockquote><p>è¯æ˜:$f(ae)&#x3D;f(a)f(e)&#x3D;f(a)$ï¼Œæ‰€ä»¥f(e)æ˜¯å•ä½å…ƒ</p></blockquote></li><li><p>æ€§è´¨2: <strong>é€†å…ƒå¯¹åº”é€†å…ƒ</strong>:$f(a^{-1})&#x3D;f(a)^{-1} ,\forall aâˆˆG  $</p><blockquote><p>è¯æ˜:$f(a)<em>f(a^{-1})&#x3D;f(a</em>a^{-1}&#x3D;f(e))$</p></blockquote></li><li><p>æ€§è´¨3: $H\subseteq G \Longrightarrow  f(H)âˆˆGâ€™$ Hæ˜¯åŸç¾¤Gçš„å­ç¾¤ï¼Œé‚£ä¹ˆf(H)ä¹Ÿæ˜¯åŒæ€æ˜ å°„åGâ€˜çš„å­ç¾¤</p><blockquote><p>è¯æ˜:$\forall a,bâˆˆHï¼Œf(a),f(b)âˆˆf(H),åˆ™f(a)\otimes f(b)^{-1}&#x3D;f(a) \otimes f(b^{-1})&#x3D;f(a<em>b^{-1})\å› ä¸ºa</em>b^{-1}âˆˆHï¼Œé‚£ä¹ˆf(a*b^{-1})âˆˆf(H)$</p><p>æ‰©å±•:åŒæ€åƒ$Im f$ æ˜¯Gâ€™ çš„å­ç¾¤</p></blockquote></li><li><p>æ€§è´¨4:$Hâ€™\subseteq Gâ€™\Longrightarrow f^{-1}(Hâ€™)âˆˆG$  ã€‚å¦‚æœHâ€™æ˜¯åŒæ€æ˜ å°„åçš„ç¾¤Gâ€˜çš„å­ç¾¤ï¼Œé‚£ä¹ˆf^-1^(Hâ€™)æ˜¯åŸç¾¤Gçš„å­ç¾¤</p><blockquote><p><strong>è¯æ˜</strong>ï¼š</p><p>è®¾ $( f: G \to Gâ€™ ) $æ˜¯ç¾¤åŒæ€ï¼Œä¸” $( Hâ€™ \leq Gâ€™ )$ï¼Œæˆ‘ä»¬è¦è¯æ˜$ \ f^{-1}(Hâ€™) \leq G )$ã€‚</p><p>è®°ï¼š</p><p>$$<br>f^{-1}(Hâ€™) &#x3D; { g \in G \mid f(g) \in Hâ€™ }<br>$$</p><p>æˆ‘ä»¬éªŒè¯$ ( f^{-1}(Hâ€™) )$ æ˜¯å¦æ»¡è¶³å­ç¾¤çš„ä¸‰ä¸ªæ¡ä»¶ï¼š</p><ol><li><strong>éç©ºæ€§</strong>ï¼š</li></ol><p>ç”±äº $( Hâ€™ \leq Gâ€™ )$ï¼Œæ‰€ä»¥å•ä½å…ƒ $( e_{Gâ€™} \in Hâ€™ )$ã€‚</p><p>åˆå› ä¸º ( f ) æ˜¯ç¾¤åŒæ€ï¼Œ$( f(e_G) &#x3D; e_{Gâ€™} \in Hâ€™ )$ï¼Œæ‰€ä»¥  $ï¼ˆe_G \in f^{-1}(Hâ€™) )$ï¼Œå› æ­¤$ ( f^{-1}(Hâ€™) \neq \emptyset )$ã€‚</p><ol start="2"><li><strong>å°é—­æ€§</strong>ï¼š</li></ol><p>ä»»å–$ ( a, b \in f^{-1}(Hâ€™) )$ï¼Œåˆ™æœ‰ï¼š</p><p>$$<br>f(a), f(b) \in Hâ€™ \Rightarrow f(a)f(b) \in Hâ€™ \quad (\text{å› ä¸º } Hâ€™ \leq Gâ€™)<br>$$</p><p>ç”±äº ( f ) æ˜¯åŒæ€ï¼Œæœ‰ï¼š</p><p>$$<br>f(ab) &#x3D; f(a)f(b) \in Hâ€™ \Rightarrow ab \in f^{-1}(Hâ€™)<br>$$</p><ol start="3"><li><strong>é€†å…ƒå°é—­æ€§</strong>ï¼š</li></ol><p>ä»»å– $( a \in f^{-1}(Hâ€™) )$ï¼Œåˆ™ $( f(a) \in Hâ€™ )$ï¼Œè€Œ ( Hâ€™ ) æ˜¯å­ç¾¤ï¼Œæ‰€ä»¥ï¼š</p><p>$$<br>f(a)^{-1} \in Hâ€™ \quad \text{ä¸”} \quad f(a^{-1}) &#x3D; f(a)^{-1} \in Hâ€™ \Rightarrow a^{-1} \in f^{-1}(Hâ€™)<br>$$</p><p>ç»¼ä¸Šï¼Œ$( f^{-1}(Hâ€™) )$ æ»¡è¶³å­ç¾¤åˆ¤åˆ«æ³•çš„ä¸‰æ¡æ€§è´¨ï¼Œå› æ­¤ï¼š</p><p>$$<br>f^{-1}(Hâ€™) \leq G<br>$$</p><p>æ¨è®º:Hâ€™&#x3D;{eâ€™}ã€‚é‚£ä¹ˆå¯ä»¥å¾—åˆ°åŒæ€æ ¸æ˜¯Gçš„å­ç¾¤</p></blockquote></li><li><p>æ€§è´¨5: $f(a^m)&#x3D;f(a)^m,\forall aâˆˆGï¼Œ\forall mâˆˆZ$ã€‚æ¯”è¾ƒç®€å•ï¼Œè¯æ˜ç•¥äº†ã€‚</p></li></ol><h4 id="ç¾¤åŒæ€çš„å¤åˆ"><a href="#ç¾¤åŒæ€çš„å¤åˆ" class="headerlink" title="ç¾¤åŒæ€çš„å¤åˆ"></a>ç¾¤åŒæ€çš„å¤åˆ</h4><ul><li><p>å®šä¹‰:$f$æ˜¯ç¾¤$(G,\oplus)$  åˆ°$(Gâ€™,\oplus)$ çš„ç¾¤åŒæ€ï¼Œ$â€™f$æ˜¯$(Gâ€™,\oplus)$åˆ°$(Gâ€™â€™,\otimes)$ çš„ç¾¤åŒæ€ï¼Œåˆ™$f$å’Œ$fâ€™$ çš„å¤åˆè¡¨ç¤ºä¸º:<br>$$<br>fâ€™\circ f:G\longrightarrow  Gâ€™â€™<br>$$<br>è¿™ä¹Ÿæ˜¯ç¾¤åŒæ€ã€‚</p><p>é‚£ä¹ˆè¿™ä¸¤ä¸ªç¾¤åŒæ€çš„å¤åˆå°±æ˜¯ä¸€ä¸ªä»Gåˆ°Gâ€™â€™çš„ç¾¤åŒæ€ã€‚</p><p>è¯æ˜:</p><blockquote><p>$\forall a,bâˆˆGï¼Œæœ‰fâ€™\circ  f(a*b)&#x3D;fâ€™\circ f(a)\otimes fâ€™\circ f(b)$</p></blockquote></li></ul><h3 id="ç¾¤åŒæ„"><a href="#ç¾¤åŒæ„" class="headerlink" title="ç¾¤åŒæ„"></a>ç¾¤åŒæ„</h3><ul><li>å®šä¹‰:<strong>ç¾¤åŒæ„æ˜¯æ»¡è¶³åŒå°„(å•å°„å’Œæ»¡å°„)çš„ç¾¤åŒæ€ã€‚</strong></li></ul><p>å®šä¹‰Gä¸Gâ€˜åŒæ„ï¼Œè®°ä½œ$G\cong Gâ€™$ ã€‚Gä¸Gä¹‹é—´çš„åŒæ„ç§°ä¸ºè‡ªåŒã€‚åŒæ„çš„é€†æ˜ å°„ä¹Ÿæ˜¯åŒæ„</p><p><strong>ç¾¤åŒæ„çš„æ„ä¹‰</strong>:ä¸¤ä¸ªç¾¤çš„å…ƒç´ æ˜¯ä¸€ä¸€å¯¹åº”ï¼Œä¸”è¿ç®—è§„å¾‹å¾—åˆ°ä¿æŒï¼Œå³ä½¿ç»è¿‡æ˜ å°„ï¼Œç¾¤çš„æ‰€æœ‰ç»“æ„ç‰¹æ€§å¾—åˆ°ä¿ç•™ã€‚ä¸€å †åŒæ„çš„ç¾¤åªéœ€è¦ç ”ç©¶ä¸€ä¸ªç¾¤çš„æ€§è´¨å°±è¡Œäº†ã€‚</p><ul><li><p><strong>å¼•ç†1</strong>:è®¾æ˜ å°„ $$f : G \to Gâ€™$$ æ˜¯ç¾¤åŒæ€,åŒæ€æ ¸ $$Ker(f) &#x3D; N$$ï¼Œå¦‚æœ $$H$$ æ˜¯ $$G$$ çš„å­ç¾¤ï¼Œåˆ™æœ‰ $$f^{-1}(f(H)) &#x3D; HN$$ã€‚ </p><p>è¯æ˜:</p><blockquote><p>ä»»å–å…ƒç´  $$h \in H, n \in N$$ï¼Œ$$f(h * n) &#x3D; f(h) \cdot f(n) &#x3D; f(h)$$ï¼ˆåŒæ€æ ¸é‡Œçš„å…ƒç´ æ˜ å°„åˆ° $$Gâ€™$$ æ˜¯å•ä½å…ƒï¼‰   æ•… $$f(HN) \subseteq f(H)$$ã€‚å³ï¼š$$HN \subseteq f^{-1}(f(H))$$ã€‚   å¯¹äºä»»æ„ $$x \in f^{-1}(f(H))$$ï¼Œæœ‰ $$f(x) \in f(H)$$ã€‚   æ•…å­˜åœ¨ $$h$$ ä½¿å¾— $$f(x) &#x3D; f(h)$$ã€‚   æ•… $$f(h^{-1} * x) &#x3D; f(h^{-1}) \cdot f(x) &#x3D; f(h^{-1}) \cdot f(h) &#x3D; eâ€™$$   æ•… $$h^{-1}x \in N$$ã€‚$$x &#x3D; hh^{-1}x \in HN$$   å³ï¼š$$f^{-1}(f(H)) \subseteq HN$$ã€‚   $$HN &#x3D; f^{-1}(f(H))$$ã€‚ </p></blockquote><p>  ç‰¹åˆ«åœ°ï¼Œå½“ $$N \subseteq H$$ æ—¶ï¼Œ $$HN &#x3D; H$$ï¼ˆè€ƒè™‘é™ªé›†çš„æ€§è´¨ï¼‰ï¼Œæ•… $$f^{-1}(f(H)) &#x3D; H$$ã€‚</p></li></ul><h4 id="ç¬¬ä¸€åŒæ„å®šç†-åŸºæœ¬åŒæ€å®šç†"><a href="#ç¬¬ä¸€åŒæ„å®šç†-åŸºæœ¬åŒæ€å®šç†" class="headerlink" title="ç¬¬ä¸€åŒæ„å®šç†:(åŸºæœ¬åŒæ€å®šç†)"></a><strong>ç¬¬ä¸€åŒæ„å®šç†</strong>:(<strong>åŸºæœ¬åŒæ€å®šç†</strong>)</h4><p><strong>ç¬¬ä¸€åŒæ„å®šç†</strong>ï¼š(åŸºæœ¬åŒæ€å®šç†)   è®¾ $f$ æ˜¯ç¾¤ $G$ åˆ°ç¾¤ $Gâ€™$ çš„ç¾¤åŒæ€ï¼Œä¸¤ä¸ªç¾¤å®šä¹‰çš„è¿ç®—ä¸º $<em>$ã€$\cdot$ã€‚åŒæ€æ ¸ä¸º $K$ï¼ŒåŒæ€åƒä¸º $I$ï¼Œåˆ™ $G&#x2F;K \cong I$ï¼Œè¿™ä¸ªç¾¤åŒæ„æ˜¯æŠŠå•†ç¾¤$</em>$é‡Œçš„é™ªé›†$*$æ˜ å°„æˆä»£è¡¨å…ƒçš„åƒï¼Œè®¾æ˜ å°„ä¸º $\rho$ï¼Œå³:   $[ \rho(aK) &#x3D; f(a). ]$   </p><p><strong>è¯æ˜:</strong>   - <strong>(å•å°„)</strong>   :</p><blockquote><p>$\forall a, b \in G$ï¼Œè‹¥ $aK &#x3D; bK$ï¼Œç”±äº $\rho(aK) &#x3D; f(a)$ï¼Œåˆ™ $f(a) &#x3D; f(b)$ã€‚  </p><p>è‹¥ $aK \neq bK$ï¼Œç”±é™ªé›†çŸ¥è¯†å¯çŸ¥ï¼Œ$a \nsim b$ï¼Œåˆ™ $b^{-1}a \notin K$ï¼ˆå› ä¸º $K$ æ˜¯ $G$ çš„æ­£è§„å­ç¾¤$*$ï¼‰ã€‚</p><p>æ•… $f(b^{-1}a) &#x3D; f(b)^{-1} \cdot f(a) \neq eâ€™$ï¼ˆ$eâ€™$ æ˜¯ç¾¤ $Gâ€™$ çš„å•ä½å…ƒï¼‰ï¼Œæ•… $f(a) \neq f(b)$ã€‚   - <strong>(æ»¡å°„)</strong>    $\forall f(a) \in I$ï¼Œéƒ½æœ‰å¯¹åº”çš„åŸåƒ $aK$ï¼Œæ•…æ˜¯æ»¡å°„ã€‚  </p><p><strong>(ç¾¤åŒæ€)</strong>  $ [  \rho(aK * bK) &#x3D; \rho(abK) &#x3D; f(ab) &#x3D; f(a) \cdot f(b) &#x3D; \rho(aK) \cdot \rho(bK),  ] $   å¾—è¯ã€‚   $\rhoâ€™ : G&#x2F;K \to Gâ€™$ æ˜¯å•ä¸€åŒæ€ã€‚    </p></blockquote><h4 id="ç¬¬äºŒåŒæ„å®šç†"><a href="#ç¬¬äºŒåŒæ„å®šç†" class="headerlink" title="ç¬¬äºŒåŒæ„å®šç†"></a>ç¬¬äºŒåŒæ„å®šç†</h4><p><strong>ç¬¬äºŒåŒæ„å®šç†</strong>ï¼š   è®¾ $f: G \to Gâ€™$ æ˜¯ç¾¤çš„æ»¡åŒæ€ï¼Œè®¾åŒæ€æ ¸ä¸º $N$ã€‚è‹¥ $H$ æ˜¯ $G$ çš„åŒ…å« $N$ çš„æ­£è§„å­ç¾¤ï¼Œè®° $Hâ€™ &#x3D; f(H)$ï¼Œåˆ™æœ‰ $  [ G&#x2F;H \cong Gâ€™&#x2F;Hâ€™. ]   $</p><p><strong>è¯æ˜</strong>ï¼š   </p><blockquote><ol><li>**æ„é€ åŒæ€ $\psi$**ï¼š     å®šä¹‰ $\psi: G \to Gâ€™&#x2F;Hâ€™$ï¼Œå¯¹ $\forall g \in G$ï¼Œ$\psi(g) &#x3D; f(g)Hâ€™$ï¼ˆ$f(g) \in Gâ€™$ï¼‰ã€‚</li></ol></blockquote><blockquote><pre><code class="hljs"> **æ»¡åŒæ€**ï¼šä»»å– $f(g)H&#39; \in G&#39;/H&#39;$ï¼Œå…¶åŸåƒä¸º $g \in G$ï¼Œæ•… $\psi$ æ»¡ã€‚ 2. **è®¡ç®—æ ¸ $\text&#123;Ker&#125;(\psi)$**ï¼š     $[   \text&#123;Ker&#125;(\psi) = \&#123; g \in G \mid f(g)H&#39; = H&#39; \&#125; = \&#123; g \in G \mid f(g) \in H&#39; \&#125; = f^&#123;-1&#125;(H&#39;).   ]  $   å›  $H&#39; = f(H)$ ä¸” $N \subseteq H$ï¼Œç”±å¼•ç† $f^&#123;-1&#125;(f(H)) = HN = H$ï¼ˆ$N \subseteq H$ æ—¶ $HN = H$ï¼‰ï¼Œ æ•…ï¼š    $ [   \text&#123;Ker&#125;(\psi) = f^&#123;-1&#125;(f(H)) = H.   ]$   â€˜ 3. **åº”ç”¨ç¬¬ä¸€åŒæ„å®šç†**ï¼š     ç”±ç¬¬ä¸€åŒæ„å®šç†ï¼Œæ»¡åŒæ€ $\psi$ è¯±å¯¼åŒæ„ï¼š    $ [   G/\text&#123;Ker&#125;(\psi) \cong \text&#123;Im&#125;(\psi) \implies G/H \cong G&#39;/H&#39; \quad (\text&#123;å›  &#125; \text&#123;Im&#125;(\psi) = G&#39;/H&#39;).   ]   $ 4. **æ¨è®º**ï¼š   å¯¹è‡ªç„¶åŒæ€ $\pi: G \to G/N$ï¼Œè‹¥ $H \supseteq N$ï¼Œåˆ™ï¼š   \[ (G/N)/(H/N) \cong G/H, \]   ä¸” $H/N \triangleleft G/N \iff H \triangleleft G$ï¼ˆæ­£è§„å­ç¾¤çš„å•†ç¾¤å¯¹åº”æ€§ï¼‰ã€‚  5. **è¯´æ˜**ï¼š   - ç¬¬äºŒåŒæ„å®šç†é€šè¿‡æ„é€ æ»¡åŒæ€ï¼Œåˆ©ç”¨æ ¸çš„æ€§è´¨ï¼ˆç»“åˆ $N \subseteq H$ æ—¶ $f^&#123;-1&#125;(f(H)) = H$ï¼‰ï¼Œå°†å•†ç¾¤åŒæ„è½¬åŒ–ä¸ºç¬¬ä¸€åŒæ„å®šç†çš„åº”ç”¨ã€‚   - æ¨è®ºæ­ç¤ºäº†å•†ç¾¤ä¸­æ­£è§„å­ç¾¤çš„â€œæå‡â€æ€§è´¨ï¼Œæ˜¯ç¾¤è®ºä¸­åˆ†æå­ç¾¤ä¸å•†ç¾¤ç»“æ„çš„å…³é”®å·¥å…·ã€‚  </code></pre></blockquote><h4 id="ç¬¬ä¸‰åŒæ„å®šç†"><a href="#ç¬¬ä¸‰åŒæ„å®šç†" class="headerlink" title="ç¬¬ä¸‰åŒæ„å®šç†"></a>ç¬¬ä¸‰åŒæ„å®šç†</h4><p><strong>ç¬¬ä¸‰åŒæ„å®šç†</strong> **: è®¾ $H$ æ˜¯ç¾¤ $G$ çš„å­ç¾¤ï¼Œ$N$ æ˜¯ç¾¤ $G$ çš„æ­£è§„å­ç¾¤ï¼Œåˆ™ $H \cap N$ æ˜¯ $H$ çš„æ­£è§„å­ç¾¤ï¼Œä¸” $H&#x2F;(H \cap N) \cong HN&#x2F;N$ã€‚ **</p><p>**è¯æ˜: ** </p><blockquote><p><strong>æ­£è§„å­ç¾¤</strong> </p><p>$H \cap N$ æ˜¯ $G$ çš„å­ç¾¤(å­ç¾¤çš„äº¤æ˜¯å­ç¾¤,ä¹Ÿå°±æ˜¯ç¾¤),ä¸” $H \cap N$ æ˜¯ $H$ çš„éç©ºå­é›†(æœ‰å•ä½å…ƒä¸” $H \cap N \subseteq H$ )ã€‚</p><p>æ•… $H \cap N$ æ˜¯ $H$ çš„å­ç¾¤ã€‚ </p><p>è®¾ç¾¤ $D &#x3D; H \cap N$ï¼Œ</p><p>å³è¯:$\forall h \in H, hD &#x3D; Dh$ã€‚ </p><p>å¯¹äºâˆ€$d_1 \in D$ ï¼Œéƒ½èƒ½æ‰¾åˆ° $d_2 \in D$ æ»¡è¶³ $hd_1 &#x3D; d_2h$ã€‚ $hd_1h^{-1} &#x3D; d_2 \in D$ï¼Œ</p><p>å³æ»¡è¶³ $hd_1h^{-1} \in H$ ä¸” $hd_1h^{-1} \in N$ã€‚</p><p>å› ä¸º $h, h^{-1} \in H, d_1 \in D \subseteq H, hd_1h^{-1} \in H$ (ç”±äºç¾¤çš„å°é—­æ€§)ã€‚</p><p>è‡³äº $hd_1h^{-1} \in N$,å³:$hd_1 \in Nh &#x3D; hN$ ($N$ æ˜¯ç¾¤ $G$ çš„æ­£è§„å­ç¾¤)</p><p>ï¼Œå³:$d_1 \in N$ ã€‚</p><p>$N$ æ˜¯ç¾¤ $HN$ çš„æ­£è§„å­ç¾¤ã€‚ </p><p>é¦–å…ˆï¼Œæˆ‘ä»¬çŸ¥é“ $HN$ æ˜¯ç¾¤ $G$ çš„å­ç¾¤ã€‚å› ä¸º $HN &#x3D; NH$ã€‚</p><p>å› ä¸º $\forall h \in H, hN &#x3D; Nh$ã€‚ ç¾¤ $N \subseteq HN$ (æ³¨:$N &#x3D; eN$),åŠ ä¸Šå®ƒæœ¬èº«æ˜¯ç¾¤ï¼Œæ•… $N$ æ˜¯ $HN$ çš„å­ç¾¤ã€‚ æ­£è§„çš„è¯´æ˜åŒä¸Šï¼Œ$N$ æ˜¯ $G$ çš„æ­£è§„å­ç¾¤ï¼Œ$\forall a \in HN \subseteq G, aN &#x3D; Na$ ã€‚</p><p><strong>åŒæ„</strong> </p><p>æ„é€  $\eta: H \to HN&#x2F;N$,å…¶ä¸­ $\forall h \in H, \eta(h) &#x3D; hN$.(å°†ç¾¤ $H$ é‡Œçš„å…ƒç´  $h$ æ˜ å°„åˆ°å•†ç¾¤ $HN&#x2F;N$ é‡Œ)ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ª<strong>æ»¡åŒæ€</strong>ã€‚ </p><p>å¯¹äºæ¯ä¸ª $hN$,éƒ½èƒ½åœ¨ç¾¤ $H$ é‡Œæ‰¾åˆ°åŸåƒã€‚</p><p>ä¸” $Ker(\eta) &#x3D; {h \in H|hN &#x3D; N}$(åŒæ€æ ¸é‡Œçš„å…ƒç´  $h$ å°±æ˜¯å•ä½å…ƒ) $&#x3D; N \cap H$($h \in H$,ä¸” $hN &#x3D; N$,å³ $h \in N$) ç”±åŒæ€åŸºæœ¬å®šç†ï¼Œ $H&#x2F;(H \cap N)(H&#x2F;ker(\eta)) \cong HN&#x2F;N(\eta(H))$ </p></blockquote><h2 id="ç¾¤çš„ç»“æ„"><a href="#ç¾¤çš„ç»“æ„" class="headerlink" title="ç¾¤çš„ç»“æ„"></a>ç¾¤çš„ç»“æ„</h2><blockquote><p>è¿™ä¸€ç« æˆ‘ä»¬ä¸»è¦å°†å¾ªç¯ç¾¤ï¼Œè¿™æ˜¯åœ¨å¯†ç å­¦ä¸­ä¸€ä¸ªå¾ˆé‡è¦çš„æ¦‚å¿µã€‚å‰é¢çš„åŒæ€å’ŒåŒæ„å¯èƒ½æ¯”è¾ƒéš¾ç†è§£å¯ä»¥åªå¤§æ¦‚çœ‹ä¸€ä¸‹ï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦è®¤çœŸçš„çœ‹ã€‚</p></blockquote><ul><li><p><strong>ä¸€ç§æ„é€ å­ç¾¤çš„æ–¹æ³•</strong>ï¼š è®¾Gæ˜¯ç¾¤ï¼Œ$aâˆˆGï¼Œåˆ™<a>&#x3D;{a^z|zâˆˆZ}$æ˜¯<strong>ç”±aç”Ÿæˆçš„Gçš„å­ç¾¤</strong>ã€‚</p><blockquote><p>è¯æ˜:$\forall a^i,a^jâˆˆ<a>åˆ™a^i*(a^j)^{-1}&#x3D;a^{i-j}âˆˆ<a>$ã€‚</p></blockquote></li></ul><h3 id="å¾ªç¯ç¾¤"><a href="#å¾ªç¯ç¾¤" class="headerlink" title="å¾ªç¯ç¾¤"></a>å¾ªç¯ç¾¤</h3><h4 id="å¾ªç¯ç¾¤çš„å®šä¹‰"><a href="#å¾ªç¯ç¾¤çš„å®šä¹‰" class="headerlink" title="å¾ªç¯ç¾¤çš„å®šä¹‰"></a>å¾ªç¯ç¾¤çš„å®šä¹‰</h4><ul><li>å®šä¹‰: <strong>è®¾$G$æ˜¯ç¾¤ï¼Œ$gâˆˆG$,å¦‚æœ$G&#x3D;<g>$ï¼Œåˆ™ç§°$G$æ˜¯å¾ªç¯ç¾¤ï¼Œ$g$è¡¨ç¤ºå¾ªç¯ç¾¤$G$çš„ç”Ÿæˆå…ƒã€‚</strong></li></ul><p>ç¤ºä¾‹:</p><blockquote><ol><li>æ•´æ•°åŠ æ³•ç¾¤:$Z&#x3D;{z|zâˆˆZ}&#x3D;{z*1|zâˆˆZ}&#x3D;&lt;1&gt;&#x3D;&lt;-1&gt;$ -1å’Œ1æ˜¯å¾ªç¯ç¾¤Zçš„ç”Ÿæˆå…ƒâ€”æ— é™å¾ªç¯ç¾¤</li><li>$Z^*_5$ä¹˜æ³•å¾ªç¯ç¾¤:<br>$Z^*_5&#x3D;{1,2,3,4}$ &#x3D;&lt;2&gt;&#x3D;&lt;3&gt;â€”-$2^1&#x3D;2,2^3&#x3D;3ï¼Œ2^4&#x3D;1ã€‚3^2&#x3D;4,3^3&#x3D;2,3^4&#x3D;1$â€”æœ‰é™å¾ªç¯ç¾¤</li></ol></blockquote><ul><li><p>å®šç†1: <strong>ä»»æ„å¾ªç¯ç¾¤éƒ½æ˜¯é˜¿è´å°”ç¾¤</strong> </p><blockquote><p>è¯æ˜:$\forall a,vâˆˆ<g>,è®¾a&#x3D;g^r,b&#x3D;g^kï¼Œåˆ™a<em>b&#x3D;g^{r+k}&#x3D;b</em>a$</p></blockquote></li><li><p>å®šç†2:<strong>å¾ªç¯ç¾¤çš„å­ç¾¤ä¸€å®šæ˜¯å¾ªç¯ç¾¤</strong></p><blockquote><p>è¯æ˜: <strong>è¯æ˜</strong>   è®¾å¾ªç¯ç¾¤ $G$ï¼Œç”Ÿæˆå…ƒä¸º $g$ï¼Œç¾¤é˜¶ $|G| &#x3D; n$ï¼Œ</p><p>å› ä¸ºå¾ªç¯ç¾¤ $G$ ä¸­çš„ä»»æ„ä¸€ä¸ªå…ƒç´ éƒ½å¯ä»¥è¡¨è¾¾ä¸ºç”Ÿæˆå…ƒçš„å¹‚çš„å½¢å¼ï¼Œæ•…è€Œï¼Œè‹¥ $H$ ä¸ºå¾ªç¯ç¾¤ $G$ çš„ä¸€ä¸ªå­ç¾¤ï¼Œåˆ™å¿…ç„¶å¯å†™ä¸º</p><p>$ [ {g^{k_1}, g^{k_2}, \ldots, g^{k_m}}, \quad 1 &lt; k_1 &lt; k_2 &lt; \ldots &lt; k_m \leq n ] $</p><p>å¹¶å¼•å…¥$ [ d &#x3D; \min{k_1, k_2, \ldots, k_m} ]$</p><p>å› ä¸º $G$ æ˜¯ä¸€ä¸ªæœ‰é™ç¾¤ï¼Œç»“åˆå‰è¦çŸ¥è¯†1çŸ¥é“ï¼Œ$G$ ä¸­çš„ä»»ä¸€å…ƒç´ çš„é˜¶éƒ½å­˜åœ¨ï¼Œå³ä»»ä¸€å…ƒç´ éƒ½å¯ä»¥å½¢æˆä¸€ä¸ªå¾ªç¯å­ç¾¤ã€‚æ•…è€Œå¯¹äºå…ƒç´  $g^d$ï¼Œå¿…ç„¶å¯ä»¥å½¢æˆå¾ªç¯å­ç¾¤ $\langle g^d \rangle$ã€‚</p></blockquote></li><li><p>å®šç†3:<strong>è®¾$G$æ˜¯å¾ªç¯ç¾¤,$H$æ˜¯å…¶å­ç¾¤ï¼Œåˆ™å•†ç¾¤$G&#x2F;H$æ˜¯å¾ªç¯ç¾¤</strong></p><blockquote><p><strong>è¯æ˜</strong><br>ï¼ˆå¾ªç¯ç¾¤æ˜¯é˜¿è´å°”ç¾¤ï¼Œè€Œé˜¿è´å°”ç¾¤çš„å­ç¾¤éƒ½æ˜¯æ­£è§„å­ç¾¤ï¼Œæ‰€ä»¥ $H$ æ˜¯æ­£è§„å­ç¾¤ï¼Œå®ƒå¯ä»¥æ„æˆå•†ç¾¤ï¼‰</p><p>è®¾ $G &#x3D; \langle g \rangle$ï¼Œåˆ™ $G&#x2F;H &#x3D; \langle [g]_H \rangle$ã€‚è¿™æ˜¯å› ä¸ºï¼Œ</p><p>å¯¹äº $\forall [g^k]_H \in G&#x2F;H$ï¼Œæœ‰</p><p>$[<br>[g^k]_H &#x3D; [g * \cdots * g]_H &#x3D; [g]_H * \cdots * [g]_H &#x3D; ([g]_H)^k<br>]$</p><p>æ‰€ä»¥ï¼Œ$\forall [g^k]_H$ éƒ½æ˜¯ç”± $[g]_H$ ç”Ÿæˆã€‚æ•…è€Œï¼Œ$[g]_H$ æ˜¯ $G&#x2F;H$ çš„ç”Ÿæˆå…ƒã€‚</p></blockquote></li></ul><h3 id="å…ƒç´ çš„é˜¶"><a href="#å…ƒç´ çš„é˜¶" class="headerlink" title="å…ƒç´ çš„é˜¶"></a>å…ƒç´ çš„é˜¶</h3><ul><li><p>å®šä¹‰: è®¾$G$æ˜¯ç¾¤ï¼Œ$aâˆˆG$ï¼Œå¦‚æœnæ˜¯æ»¡è¶³$a^n&#x3D;e$çš„æœ€å°çš„æ­£æ•´æ•°ï¼Œåˆ™ç§°næ˜¯å…ƒç´ açš„é˜¶ã€‚</p></li><li><p>æ€§è´¨1**:$G$æ˜¯ç¾¤ï¼Œå…ƒç´ açš„é˜¶æ˜¯$n(a^n&#x3D;e)$ï¼Œåˆ™$\forall mâˆˆZ$ï¼Œæœ‰$n|m\Longleftrightarrow a^m&#x3D;e$ã€‚**</p><blockquote><p>è¿™ä¸ªæ˜¯å¾ˆæ˜¾ç„¶çš„ï¼Œå°±ä¸è¯æ˜äº†</p></blockquote></li><li><p>æ€§è´¨2:<strong>æœ‰é™å¾ªç¯ç¾¤çš„é˜¶æ˜¯nï¼Œåˆ™ç”Ÿæˆå…ƒçš„é˜¶ä¹Ÿæ˜¯nã€‚</strong></p><blockquote><p>æ˜¾ç„¶ç”Ÿæˆå…ƒç”Ÿæˆä¸é‡å¤çš„å…ƒç´ æœ€å¤šä¹Ÿåªæœ‰nä¸ªã€‚</p></blockquote></li><li><p>æ€§è´¨3:<strong>æ­£æ•´æ•°$d|n$ï¼Œné˜¶æœ‰é™å¾ªç¯ç¾¤æ°æœ‰ä¸€ä¸ªdé˜¶çš„å­ç¾¤ã€‚</strong></p><blockquote><p>è¯æ˜:(å­˜åœ¨æ€§):d|n,æœ‰$g^{n&#x2F;d}$ çš„é˜¶æ˜¯dã€‚åˆ™$&lt;g^{n&#x2F;d}&gt;$çš„é˜¶æ˜¯dã€‚æ•…è€Œå­˜åœ¨é˜¶æ˜¯dçš„å­ç¾¤$&lt;g^{n&#x2F;d}&gt;$</p><p>ï¼ˆå”¯ä¸€æ€§ï¼‰åè¯æ³•:å‡è®¾å­˜åœ¨å¦ä¸€ä¸ªdé˜¶çš„å¾ªç¯å­ç¾¤$&lt;g^k&gt;$ï¼Œåˆ™$(g^k)^d&#x3D;e$ï¼Œæ‰€ä»¥n|kdï¼Œæœ‰$\frac{n}{d}|k $ ã€‚æ‰€ä»¥,$g^{k}âˆˆ$</p><p>æ‰€ä»¥ï¼Œ$g^kâˆˆ&lt;g^{\frac {n}{d} }&gt;$,æœ‰$&lt;g^k&gt;$æ˜¯$&lt;g^{\frac {n}{d}}&gt;$ ï¼Œå› ä¸ºäºŒè€…é˜¶éƒ½æ˜¯dï¼Œæ‰€ä»¥ä»–ä»¬æ˜¯åŒä¸€ä¸ªå¾ªç¯ç¾¤</p></blockquote><p>ä¾‹ï¼šå¾ªç¯ç¾¤Gçš„é˜¶æ˜¯15ï¼Œ15çš„æ­£å› å­æ˜¯1ï¼Œ3ï¼Œ5ï¼Œ15ï¼Œæ‰€ä»¥Gä¸€ä¸ªæœ‰4ä¸ªå­ç¾¤ã€‚ä»–ä»¬çš„é˜¶åˆ†åˆ«æ˜¯1ï¼Œ3ï¼Œ5ï¼Œ15ã€‚</p></li><li><p>æ€§è´¨4: né˜¶æœ‰é™å¾ªç¯ç¾¤<g>ï¼Œ$\forall âˆˆZ$ï¼Œæœ‰$g^k$çš„é˜¶æ˜¯$\frac {n}{gcd(n,k)}$ ã€‚</p><blockquote><p>è¯æ˜:å‡è®¾$g^k$çš„é˜¶æ˜¯m,åˆ™$g^{km}&#x3D;e$ï¼Œæœ‰$n|km$</p><p>äºæ˜¯,$km&#x3D;lcm(n,k)&#x3D;\frac {nk}{gccd(n,k)}$</p><p>æ‰€ä»¥ï¼Œ$m&#x3D;\frac {n}{gcd(n,k)}$</p></blockquote></li><li><p>æ€§è´¨5:<strong>né˜¶æœ‰é™å¾ªç¯ç¾¤æœ‰$\phi (n)$(æ¬§æ‹‰å‡½æ•°)ä¸ªç”Ÿæˆå…ƒ</strong></p><p>æ ¹æ®ä¸Šè¿°çš„æ€§è´¨$order(g^k)(è¡¨ç¤ºé˜¶)&#x3D;\frac {n}{gcd(n,k)}$ ã€‚å½“gcd(n,k)&#x3D;1æ—¶ï¼Œ$g^k$çš„é˜¶ä¸ºnï¼Œæ­¤æ—¶$g^k$ æ˜¯ç”Ÿæˆå…ƒ</p></li><li><p>æ€§è´¨6:<strong>Gæ˜¯æœ‰é™ç¾¤ï¼Œå…ƒç´ açš„é˜¶ä¹˜æ˜¯|G|çš„å› å­ã€‚</strong></p><blockquote><p>$<a>$æ˜¯Gçš„å­ç¾¤ï¼Œæ ¹æ®æ‹‰æ ¼æœ—æ—¥å®šç†ï¼Œæœ‰$|<a>|||G|$</p><p>å› ä¸ºç”Ÿæˆå…ƒaçš„é˜¶ç­‰äº<a>çš„é˜¶ã€‚æ‰€ä»¥ï¼Œaçš„é˜¶æ˜¯|G|çš„å› å­</p></blockquote></li><li><p>æ€§è´¨7: <strong>ç´ æ•°é˜¶çš„ç¾¤å¿…ç„¶æ˜¯(æœ‰é™)å¾ªç¯ç¾¤ã€‚</strong></p><p><strong>è¯æ˜</strong>ï¼šè®¾ $G$ æ˜¯ç¾¤ï¼Œä¸” $|G| &#x3D; p$ï¼Œ$p$ æ˜¯ç´ æ•°ã€‚ </p><p>è®¾ $a \in G$ï¼Œä¸” $a \neq e$ï¼Œ$a$ çš„é˜¶æ˜¯ $k$ï¼ˆ$a^k &#x3D; e$ï¼‰ã€‚ æ ¹æ®æ€§è´¨6ï¼Œ$k \mid p$ã€‚</p><p>æ‰€ä»¥ï¼Œ$k &#x3D; 1$ æˆ– $p$ã€‚ å› ä¸º $a \neq e$ï¼Œæ‰€ä»¥ $k &#x3D; p$ï¼Œå³ $a$ çš„é˜¶æ˜¯ $p$ï¼Œæœ‰ $a$ æ˜¯ç”Ÿæˆå…ƒã€‚ æ‰€ä»¥ï¼Œ$G$ æ˜¯(æœ‰é™)å¾ªç¯ç¾¤(å› ä¸ºå®ƒæœ‰ç”Ÿæˆå…ƒ)ã€‚</p><p> è®¾ $k$ æ˜¯ $a$ çš„é˜¶ å…ƒç´ çš„é˜¶æ˜¯ç¾¤çš„é˜¶çš„å› å­</p></li></ul><h4 id="å¾ªç¯ç¾¤çš„åŒæ„"><a href="#å¾ªç¯ç¾¤çš„åŒæ„" class="headerlink" title="å¾ªç¯ç¾¤çš„åŒæ„"></a>å¾ªç¯ç¾¤çš„åŒæ„</h4><ul><li><p><strong>æ— é™å¾ªç¯ç¾¤çš„åŒæ„ç¾¤</strong></p><ul><li><p>å®šç†:<strong>è®¾$&lt;G,*&gt;$ä¸ºæ— é™å¾ªç¯ç¾¤ï¼Œåˆ™$&lt;G,*&gt;\cong &lt;Z,+&gt;$</strong></p><p>è¯æ˜:$|a| &#x3D; \infty$ï¼Œä»¤ $f: \mathbb{Z} \to G$ å¦‚ä¸‹ï¼š$f(n) &#x3D; a^n$ï¼Œ</p><p>å› ä¸º $f(n + m) &#x3D; a^{n + m} &#x3D; a^n * a^m &#x3D; f(n) * f(m)$ï¼Œæ‰€ä»¥ $f$ ä¸ºåŒæ€ï¼›</p><p>åˆå› ä¸º $f(n) &#x3D; f(m) \Rightarrow a^n &#x3D; a^m \Rightarrow a^{|n - m|} &#x3D; e \Rightarrow |n - m| &#x3D; 0 \Rightarrow n &#x3D; m$ï¼Œæ‰€ä»¥ $f$ ä¸º 1 - 1ï¼Œonto æ˜“è§ï¼Œä»è€Œ $\langle G, * \rangle \cong \langle \mathbb{Z}, + \rangle$</p></li></ul></li><li><p>æœ‰é™å¾ªç¯ç¾¤çš„åŒæ„ç¾¤</p><ul><li><p>å®šç†:<strong>è®¾ $\langle G, * \rangle$ ä¸ºæœ‰é™å¾ªç¯ç¾¤ï¼Œåˆ™ $\langle G, * \rangle \cong \langle \mathbb{Z}_n, \oplus_n \rangle$</strong> </p><p><strong>è¯æ˜</strong></p><p>$|a| &#x3D; n &gt; 0$ï¼Œä»è€Œ $G &#x3D; {a^0, a^1, \cdots, a^{n - 1}}$ï¼Œä»¤ $f: \mathbb{Z}_n \to G$ å¦‚ä¸‹ï¼š$f(i) &#x3D; a^i$ ($i &#x3D; 0, 1, \cdots, n - 1$)ï¼Œç”±äº $f(i \oplus_n j) &#x3D; a^{i \oplus_n j} &#x3D; a^i * a^j &#x3D; f(i) * f(j)$ï¼Œæ•… $f$ ä¸ºåŒæ€ã€‚ åˆç”±äº $f(i) &#x3D; f(j) \Rightarrow a^i &#x3D; a^j \Rightarrow a^{|i - j|} &#x3D; e \Rightarrow n \mid |i - j| \Rightarrow i \equiv j \pmod{n} \Rightarrow i &#x3D; j$ï¼Œæ•… $f$ ä¸ºå•å°„ï¼Œ$f$ çš„æ»¡å°„æ€§æ˜“è§ï¼Œå› æ­¤ $\langle G, * \rangle \cong \langle \mathbb{Z}_n, \oplus_n \rangle$</p></li></ul><p>æ ¹æ®ä¸Šé¢ä¸¤ä¸ªå®šç†ï¼Œæˆ‘ä»¬è®¨è®ºå¾ªç¯ç¾¤è®¨è®ºä¸å®ƒåŒæ„çš„ &lt;Z,+&gt;å’Œ$\langle \mathbb{Z}_n, \oplus_n \rangle$</p></li><li><p>æ€§è´¨8:<strong>$G$æ˜¯né˜¶æœ‰é™å¾ªç¯ç¾¤ï¼Œdæ˜¯nçš„æ­£å› å­ï¼ŒGé‡Œçš„dé˜¶ä¹˜å…ƒç´ ä¸€å…±æœ‰$\phi (d)$ä¸ª</strong></p><blockquote><p>è®¾ $G$ æ˜¯ä¸€ä¸ªæœ‰é™å¾ªç¯ç¾¤ï¼Œ$|G| &#x3D; n$ï¼Œå³ $G \cong \mathbb{Z}_n$ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ $\mathbb{Z}_n &#x3D; {0, 1, \dots, n-1}$ åœ¨åŠ æ³•æ¨¡ $n$ æ„ä¹‰ä¸‹æ„æˆä¸€ä¸ªå¾ªç¯ç¾¤ï¼Œç”Ÿæˆå…ƒä¸ºä¸ $n$ äº’ç´ çš„å…ƒç´ ã€‚</p><p>è®° $d \mid n$ï¼Œæˆ‘ä»¬è¦æ±‚ $\mathbb{Z}_n$ ä¸­é˜¶ä¸º $d$ çš„å…ƒç´ ä¸ªæ•°ã€‚</p><hr><p><strong>æ­¥éª¤ 1ï¼š$\mathbb{Z}_n$ ä¸­å…ƒç´  $a$ çš„é˜¶ä¸º $\dfrac{n}{\gcd(a, n)}$</strong></p><p>ä»¤ $\text{ord}(a)$ è¡¨ç¤º $a$ çš„é˜¶ï¼Œåˆ™ï¼š</p><p>$$<br>\text{ord}(a) &#x3D; \frac{n}{\gcd(a, n)}<br>$$</p><p>æ‰€ä»¥ï¼Œå½“ä¸”ä»…å½“ $\gcd(a, n) &#x3D; \frac{n}{d}$ æ—¶ï¼Œ$\text{ord}(a) &#x3D; d$ã€‚</p><hr><p><strong>æ­¥éª¤ 2ï¼šæ±‚å‡ºæ»¡è¶³ $\gcd(a, n) &#x3D; \frac{n}{d}$ çš„ $a$ çš„ä¸ªæ•°</strong></p><p>è®¾ $m &#x3D; \dfrac{n}{d}$ï¼Œæˆ‘ä»¬è¦æ±‚ï¼š</p><p>$$<br>#{a \in \mathbb{Z}_n \mid \gcd(a, n) &#x3D; m}<br>$$</p><p>ä»¤ $a &#x3D; m k$ï¼Œåˆ™ $a &lt; n$ï¼Œå³ $k &lt; d$ï¼Œå¹¶ä¸” $\gcd(mk, n) &#x3D; m \iff \gcd(k, d) &#x3D; 1$ã€‚</p><p>æ‰€ä»¥ï¼Œ$k$ æ»¡è¶³ $1 \leq k \leq d$ ä¸” $\gcd(k, d) &#x3D; 1$ï¼Œè¿™æ ·çš„ $k$ æœ‰ $\varphi(d)$ ä¸ªã€‚</p><hr><p><strong>ç»“è®º</strong>ï¼š</p><p>$$<br>\text{$G$ ä¸­é˜¶ä¸º $d$ çš„å…ƒç´ ä¸ªæ•°} &#x3D; \varphi(d)<br>$$</p></blockquote></li></ul><h4 id="ç¾¤çš„ç›´ç§¯"><a href="#ç¾¤çš„ç›´ç§¯" class="headerlink" title="ç¾¤çš„ç›´ç§¯"></a>ç¾¤çš„ç›´ç§¯</h4><ul><li>ç»™å®šä¸¤ä¸ªç¾¤: $(S, \circ), (T, *)$ï¼Œå®šä¹‰ç¬›å¡å„¿ä¹˜ç§¯ $S \times T$ ä¸Šçš„è¿ç®— $\otimes$ å¦‚ä¸‹ï¼š<br>$[<br>\langle s_1, t_1 \rangle \otimes \langle s_2, t_2 \rangle &#x3D; \langle s_1 \circ s_2, t_1 * t_2 \rangle<br>]$</li><li>$(S \times T, \otimes)$ æ˜¯ç¾¤<ul><li>ç»“åˆå¾‹ï¼š<br>$å•ä½å…ƒç´ ï¼š$$\langle 1_S, 1_T \rangle$</li><li>é€†å…ƒç´ ï¼š$\langle s, t \rangle$ çš„é€†å…ƒç´ æ˜¯ $\langle s^{-1}, t^{-1} \rangle$<ul><li>(å…¶ä¸­ï¼š$s, s^{-1} \in S, t, t^{-1} \in T$)</li></ul></li></ul></li></ul><h4 id="å¾ªç¯ç¾¤çš„ç›´ç§¯"><a href="#å¾ªç¯ç¾¤çš„ç›´ç§¯" class="headerlink" title="å¾ªç¯ç¾¤çš„ç›´ç§¯"></a>å¾ªç¯ç¾¤çš„ç›´ç§¯</h4><ul><li>$C_m \times C_n \cong C_{mn}$ <strong>å¦‚æœ</strong> $m$ ä¸ $n$ äº’è´¨ã€‚å…¶ä¸­ $C_k$ è¡¨ç¤º $k$ é˜¶å¾ªç¯ç¾¤ã€‚<ul><li>$\Leftarrow$ è‹¥ $m$ ä¸ $n$ äº’è´¨ï¼Œåªéœ€è¯æ˜ $C_m \times C_n$ å«æœ‰é˜¶ä¸º $mn$ çš„å…ƒç´ ã€‚<ul><li>$(a, b)^{mn} &#x3D; e$ï¼Œå…¶ä¸­ $a, b$ åˆ†åˆ«æ˜¯ $C_m$ å’Œ $C_n$ çš„ç”Ÿæˆå…ƒç´ ã€‚</li><li>è‹¥ $(a, b)^k &#x3D; e$ï¼Œ$k$ å¿…æ˜¯ $m, n$ çš„å…¬å€æ•°ï¼Œå›  $m$ ä¸ $n$ äº’è´¨ï¼Œæ•… $k$ æ˜¯ $mn$ çš„å€æ•°ã€‚æ‰€ä»¥ï¼Œ$(a, b)$ çš„é˜¶æ˜¯ $mn$ã€‚</li></ul></li><li>$\Rightarrow$ è‹¥ $C_m \times C_n \cong C_{mn}$ï¼Œåˆ™ $C_m \times C_n$ æ˜¯å¾ªç¯ç¾¤ï¼Œè®¾å…¶ç”Ÿæˆå…ƒæ˜¯ $(s, t)$ï¼Œåˆ™ $(s, t)$ çš„é˜¶æ˜¯ $mn$ï¼Œè‹¥ $\gcd(m, n) &#x3D; k &gt; 1$ï¼Œåˆ™ $(s, t)^{mn&#x2F;k} &#x3D; e$ï¼Œè¿™ä¸ $(s, t)$ çš„é˜¶æ˜¯ $mn$ çŸ›ç›¾ã€‚<ul><li>æ³¨æ„ï¼š$s^m &#x3D; e_1, t^n &#x3D; e_2$</li></ul></li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>math</category>
      
    </categories>
    
    
    <tags>
      
      <tag>math</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LitCTFå¤ç°</title>
    <link href="/2025/05/25/LitCTF/"/>
    <url>/2025/05/25/LitCTF/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="LitCTF"><a href="#LitCTF" class="headerlink" title="LitCTF"></a>LitCTF</h1><h2 id="ez-math"><a href="#ez-math" class="headerlink" title="ez_math"></a>ez_math</h2><p>ç®€å•çš„çŸ©é˜µrsaï¼ŒåŸç†è§è®ºæ–‡</p><ul><li><a href="https://www.gcsu.edu/sites/files/page-assets/node-808/attachments/pangia.pdf#:~:text=We%20propose%20a%20variation%20on%20the%20RSA%20Cryptosystem%3A,methods%20to%20matrix%20values%20in%20addition%20to%20scalars">https://www.gcsu.edu/sites/files/page-assets/node-808/attachments/pangia.pdf#:~:text=We%20propose%20a%20variation%20on%20the%20RSA%20Cryptosystem%3A,methods%20to%20matrix%20values%20in%20addition%20to%20scalars</a>.</li></ul><p>â€‹       </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> uuid <span class="hljs-keyword">import</span> uuid4<br><br>flag = <span class="hljs-string">b&#x27;LitCTF&#123;&#x27;</span>+ <span class="hljs-built_in">str</span>(uuid4()).encode() + <span class="hljs-string">b&#x27;&#125;&#x27;</span><br>flag = bytes_to_long(flag)<br>len_flag = flag.bit_length()<br>e = <span class="hljs-number">65537</span><br>p = getPrime(<span class="hljs-number">512</span>)<br>P = GF(p)<br>A = [[flag,                 getPrime(len_flag)],<br>     [getPrime(len_flag),   getPrime(len_flag)]]<br>A = matrix(P, A)<br>B = A ** e<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;B = <span class="hljs-subst">&#123;<span class="hljs-built_in">list</span>(B)&#125;</span>&quot;</span>.replace(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;[&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;]&#x27;</span>))<br><br><span class="hljs-comment"># e = 65537</span><br><span class="hljs-comment"># p = 8147594556101158967571180945694180896742294483544853070485096002084187305007965554901340220135102394516080775084644243545680089670612459698730714507241869</span><br><span class="hljs-comment"># B = [[2155477851953408309667286450183162647077775173298899672730310990871751073331268840697064969968224381692698267285466913831393859280698670494293432275120170, 4113196339199671283644050914377933292797783829068402678379946926727565560805246629977929420627263995348168282358929186302526949449679561299204123214741547], [3652128051559825585352835887172797117251184204957364197630337114276860638429451378581133662832585442502338145987792778148110514594776496633267082169998598, 2475627430652911131017666156879485088601207383028954405788583206976605890994185119936790889665919339591067412273564551745588770370229650653217822472440992]]</span><br></code></pre></td></tr></table></figure><p>â€‹       è§£é¢˜ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e = <span class="hljs-number">65537</span><br>p = <span class="hljs-number">8147594556101158967571180945694180896742294483544853070485096002084187305007965554901340220135102394516080775084644243545680089670612459698730714507241869</span><br>P=GF(p)<br>B = Matrix(P,[[<span class="hljs-number">2155477851953408309667286450183162647077775173298899672730310990871751073331268840697064969968224381692698267285466913831393859280698670494293432275120170</span>, <span class="hljs-number">4113196339199671283644050914377933292797783829068402678379946926727565560805246629977929420627263995348168282358929186302526949449679561299204123214741547</span>], [<span class="hljs-number">3652128051559825585352835887172797117251184204957364197630337114276860638429451378581133662832585442502338145987792778148110514594776496633267082169998598</span>, <span class="hljs-number">2475627430652911131017666156879485088601207383028954405788583206976605890994185119936790889665919339591067412273564551745588770370229650653217822472440992</span>]])<br>                                                                                                                                                                                                                                                                                                           <br>gp=(p^<span class="hljs-number">2</span>-p)*(p^<span class="hljs-number">2</span>-<span class="hljs-number">1</span>)<br>d = <span class="hljs-built_in">int</span>(inverse(e,gp))<br><span class="hljs-built_in">print</span>(d)<br>M=B^d<br><span class="hljs-built_in">print</span>(M)<br>m=<span class="hljs-built_in">int</span>(M[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><h2 id="baby"><a href="#baby" class="headerlink" title="baby"></a>baby</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> enc <span class="hljs-keyword">import</span> flag<br><br><br>m = bytes_to_long(flag)<br>g = getPrime(<span class="hljs-number">512</span>)<br>t = getPrime(<span class="hljs-number">150</span>)<br>data = (t * gmpy2.invert(m, g)) % g<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;g = <span class="hljs-subst">&#123;g&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;data = <span class="hljs-subst">&#123;data&#125;</span>&#x27;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">g = 7835965640896798834809247993719156202474265737048568647376673642017466116106914666363462292416077666356578469725971587858259708356557157689066968453881547</span><br><span class="hljs-string">data = 2966297990428234518470018601566644093790837230283136733660201036837070852272380968379055636436886428180671888655884680666354402224746495312632530221228498</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>ç®€å•çš„æ ¼å¯†ç ã€‚éœ€è¦æ¨ç†ä¸€ä¸‹ã€‚è®¾d_1æ˜¯data%gçš„é€†å…ƒ</p><p>é‚£ä¹ˆ$data<em>m(mod g)&#x3D;t(mod g),é‚£ä¹ˆm&#x3D;d_1</em>t-kg$</p><p>ç”±æ­¤æ„é€ æ ¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>g = <span class="hljs-number">7835965640896798834809247993719156202474265737048568647376673642017466116106914666363462292416077666356578469725971587858259708356557157689066968453881547</span><br>d_1=<span class="hljs-number">361604276948326501762250287716016338622906218631144152645999375100275741878714167153966876463816425975791307247683233886856162923152653346318817853658709</span><br><br>M=Matrix(ZZ,[[<span class="hljs-number">2</span>^<span class="hljs-number">200</span>,d_1],[<span class="hljs-number">0</span>,g]])<br>L=M.LLL()<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(L[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>])))<br></code></pre></td></tr></table></figure><h2 id="new-bag"><a href="#new-bag" class="headerlink" title="new_bag"></a>new_bag</h2><p>è¿™ä¸ªèƒŒåŒ…æŒ‰ç†è¯´å¯†åº¦æ˜¯ä¸å¤Ÿçš„ï¼Œä¸å¤Ÿå› ä¸ºæˆ‘ä»¬å·²ç»çŸ¥é“å‰ç¼€æ˜¯Litctf{åç¼€}æ’é™¤å‡ ä¸ªè¿˜æ˜¯è½»æ¾çš„ã€‚<br>$$</p><p>$$</p><p>$$<br>U&#x3D;\begin{bmatrix}<br>2&amp;0&amp;â€¦&amp;0&amp;Na_{11}&amp;Na_{21}&amp;â€¦&amp;Na_{m1}\<br>0&amp;2&amp;â€¦&amp;0&amp;Na_{12}&amp;Na_{22}&amp;â€¦&amp;Na_{m2}\<br>â‹®&amp; &amp;â€¦&amp; â‹®&amp;â‹® &amp;â‹® &amp;â€¦&amp;â‹®\<br>1&amp;1&amp;â€¦&amp;1&amp;Ns_1 &amp;NS_2 &amp;â€¦&amp;NS_m\</p><p>\end{bmatrix}<br>$$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># sage10.6</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">173537234562263850990112795836487093439</span><br>pubkey = [<span class="hljs-number">184316235755254907483728080281053515467</span>, <span class="hljs-number">301753295242660201987730522100674059399</span>, <span class="hljs-number">214746865948159247109907445342727086153</span>, <span class="hljs-number">190710765981032078577562674498245824397</span>, <span class="hljs-number">331594659178887289573546882792969306963</span>, <span class="hljs-number">325241251857446530306000904015122540537</span>, <span class="hljs-number">183138087354043440402018216471847480597</span>, <span class="hljs-number">184024660891182404534278014517267677121</span>, <span class="hljs-number">221852419056451630727726571924370029193</span>, <span class="hljs-number">252122782233143392994310666727549089119</span>, <span class="hljs-number">175886223097788623718858806338121455451</span>, <span class="hljs-number">275410728642596840638045777234465661687</span>, <span class="hljs-number">251664694235514793799312335012668142813</span>, <span class="hljs-number">218645272462591891220065928162159215543</span>, <span class="hljs-number">312223630454310643034351163568776055567</span>, <span class="hljs-number">246969281206041998865813427647656760287</span>, <span class="hljs-number">314861458279166374375088099707870061461</span>, <span class="hljs-number">264293021895772608566300156292334238719</span>, <span class="hljs-number">300802209357110221724717494354120213867</span>, <span class="hljs-number">293825386566202476683406032420716750733</span>, <span class="hljs-number">280164880535680245461599240490036536891</span>, <span class="hljs-number">223138633045675121340315815489781884671</span>, <span class="hljs-number">194958151408670059556476901479795911187</span>, <span class="hljs-number">180523100489259027750075460231138785329</span>, <span class="hljs-number">180425435626797251881104654861163883059</span>, <span class="hljs-number">313871202884226454316190668965524324023</span>, <span class="hljs-number">184833541398593696671625353250714719537</span>, <span class="hljs-number">217497008601504809464374671355532403921</span>, <span class="hljs-number">246589067140439936215888566305171004301</span>, <span class="hljs-number">289015788017956436490096615142465503023</span>, <span class="hljs-number">301775305365100149653555500258867275677</span>, <span class="hljs-number">185893637147914858767269807046039030871</span>, <span class="hljs-number">319328260264390422708186053639594729851</span>, <span class="hljs-number">196198701308135383224057395173059054757</span>, <span class="hljs-number">231185775704496628532348037721799493511</span>, <span class="hljs-number">243973313872552840389840048418558528537</span>, <span class="hljs-number">213140279661565397451805047456032832611</span>, <span class="hljs-number">310386296949148370235845491986451639013</span>, <span class="hljs-number">228492979916155878048849684460007011451</span>, <span class="hljs-number">240557187581619139147592264130657066299</span>, <span class="hljs-number">187388364905654342761169670127101032713</span>, <span class="hljs-number">305292765113810142043496345097024570233</span>, <span class="hljs-number">303823809595161213886303993298011013599</span>, <span class="hljs-number">227663140954563126349665813092551336597</span>, <span class="hljs-number">257833881948992845466919654910838972461</span>, <span class="hljs-number">291249161813309696736659661907363469657</span>, <span class="hljs-number">228470133121759300620143703381920625589</span>, <span class="hljs-number">337912208888617180835513160742872043511</span>, <span class="hljs-number">252639095930536359128379880984347614689</span>, <span class="hljs-number">306613178720695137374121633131944714277</span>, <span class="hljs-number">328627523443531702430603855075960220403</span>, <span class="hljs-number">283995291614222889691668376952473718279</span>, <span class="hljs-number">185992200035693404743830210660606140043</span>, <span class="hljs-number">175575945935802771832062328390060568381</span>, <span class="hljs-number">239709736751531517044198331233711541211</span>, <span class="hljs-number">325191992201185112802734343474281930993</span>, <span class="hljs-number">285825734319916654888050222626163129503</span>, <span class="hljs-number">260820892372814862728958615462018022903</span>, <span class="hljs-number">271109638409686342632742230596810197399</span>, <span class="hljs-number">195432366301516284662210689868561107229</span>, <span class="hljs-number">252351678712166898804432075801905414141</span>, <span class="hljs-number">175869608753229067314866329908981554323</span>, <span class="hljs-number">212291732707466211705141589249474157597</span>, <span class="hljs-number">299891357045144243959903067354676661051</span>, <span class="hljs-number">271237385422923460052644584552894282763</span>, <span class="hljs-number">268702576849722796315440463412052409241</span>, <span class="hljs-number">198273535005705777854651218089804228523</span>, <span class="hljs-number">177684355989910045168511400849036259973</span>, <span class="hljs-number">189237944200991357454773904466163557789</span>, <span class="hljs-number">175427967765368330787115337317676160499</span>, <span class="hljs-number">270446056495616077936737430232108222303</span>, <span class="hljs-number">243318639972702711024520926308402316247</span>, <span class="hljs-number">223872107662231922057872197123261908053</span>, <span class="hljs-number">268995355861070998347238198063073079851</span>, <span class="hljs-number">244478236168888494353493404999149985963</span>, <span class="hljs-number">230731375083676409248450208772518041369</span>, <span class="hljs-number">231630208287176700035265642824425872113</span>, <span class="hljs-number">187649298194887119502654724235771449423</span>, <span class="hljs-number">264924369987111619306245625770849264491</span>, <span class="hljs-number">327092811483332202721992798797117253283</span>, <span class="hljs-number">274967838920225995524024619709213673571</span>, <span class="hljs-number">313836314009366857157961838519499192671</span>, <span class="hljs-number">181860768653760352435352944732117309357</span>, <span class="hljs-number">184011200837375425882494435177626368109</span>, <span class="hljs-number">246455975565763627776562816894916143559</span>, <span class="hljs-number">262208917125258935991543552004318662109</span>, <span class="hljs-number">334006940602786701813813048552124976177</span>, <span class="hljs-number">241119397420390120456580389194328607351</span>, <span class="hljs-number">255370083166310325724283692646412327547</span>, <span class="hljs-number">280056982387584554076672702548437488901</span>, <span class="hljs-number">190822826881447578202544631446213911541</span>, <span class="hljs-number">206119293866065537243159766877834200177</span>, <span class="hljs-number">289535246575130471484249052043282790337</span>, <span class="hljs-number">222004375767927951747133364917437739627</span>, <span class="hljs-number">186041951615746748538744491355290007923</span>, <span class="hljs-number">299120276948597373232905692530626175519</span>, <span class="hljs-number">268645812049699572580085139845553457511</span>, <span class="hljs-number">231990902203442306941381714523426756489</span>, <span class="hljs-number">259677531562170067444672097354970172129</span>, <span class="hljs-number">232573792063456357545735601063504090387</span>, <span class="hljs-number">268451806037215206985127877726665463011</span>, <span class="hljs-number">324266632324016349795115268035757999593</span>, <span class="hljs-number">323952615081869295386415078624753400501</span>, <span class="hljs-number">302316593553669781596237136546083536339</span>, <span class="hljs-number">235576231941572491681115931798290883659</span>, <span class="hljs-number">202271277470197960243533508432663735031</span>, <span class="hljs-number">172391954991101354275650988921310984563</span>, <span class="hljs-number">215333185856183701105529790905068832303</span>, <span class="hljs-number">335916893044781805453250006520700519353</span>, <span class="hljs-number">217268288923298532517983372665872329797</span>, <span class="hljs-number">265455575922780577837866687874732212733</span>, <span class="hljs-number">182194442259001995170676842797322170297</span>, <span class="hljs-number">180222796978664332193987060700843734759</span>, <span class="hljs-number">332629077640484670095070754759241249101</span>, <span class="hljs-number">238815683708676274248277883404136375767</span>, <span class="hljs-number">246167709707533867216616011486975023679</span>, <span class="hljs-number">188375282015595301232040104228085154549</span>, <span class="hljs-number">230675799347049231846866057019582889423</span>, <span class="hljs-number">290911573230654740468234181613682439691</span>, <span class="hljs-number">173178956820933028868714760884278201561</span>, <span class="hljs-number">340087079300305236498945763514358009773</span>, <span class="hljs-number">215775253913162994758086261347636015049</span>, <span class="hljs-number">286306008278685809877266756697807931889</span>, <span class="hljs-number">175231652202310718229276393280541484041</span>, <span class="hljs-number">230887015177563361309867021497576716609</span>, <span class="hljs-number">306478031708687513424095160106047572447</span>, <span class="hljs-number">172289054804425429042492673052057816187</span>]<br>enc = <span class="hljs-number">82516114905258351634653446232397085739</span><br><br>known = <span class="hljs-string">b&#x27;LitCTF&#123;&#x27;</span> + <span class="hljs-string">b&#x27;\x00&#x27;</span>*<span class="hljs-number">8</span> + <span class="hljs-string">b&#x27;&#125;&#x27;</span><br>bin_known = <span class="hljs-built_in">bin</span>(bytes_to_long(known))[<span class="hljs-number">2</span>:]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(bin_known)):<br>    enc -= pubkey[i] * <span class="hljs-built_in">int</span>(bin_known[i])<br>    enc %= p<br><br>new_pubkey = pubkey[-<span class="hljs-number">72</span>:-<span class="hljs-number">8</span>]<br><span class="hljs-built_in">print</span>(new_pubkey)<br>n = <span class="hljs-built_in">len</span>(new_pubkey)<br>d = n / log(<span class="hljs-built_in">max</span>(new_pubkey), <span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(CDF(d))<br><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> trange(<span class="hljs-number">256</span>):<br>    S = enc + k*p<br>    L = Matrix(ZZ,n+<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        L[i,i] = <span class="hljs-number">2</span><br>        L[-<span class="hljs-number">1</span>,i] = <span class="hljs-number">1</span><br>        L[i,-<span class="hljs-number">1</span>] = new_pubkey[i]<br>    L[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>] = S<br>    L[:,-<span class="hljs-number">1</span>] *= <span class="hljs-number">2</span><br><br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> L.LLL():<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">set</span>(line[:-<span class="hljs-number">1</span>]).issubset(&#123;-<span class="hljs-number">1</span>,<span class="hljs-number">1</span>&#125;):<br>            m = <span class="hljs-string">&#x27;&#x27;</span><br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> line[:-<span class="hljs-number">1</span>]:<br>                <span class="hljs-keyword">if</span> i == <span class="hljs-number">1</span>:<br>                    m += <span class="hljs-string">&#x27;0&#x27;</span><br>                <span class="hljs-keyword">else</span>:<br>                    m += <span class="hljs-string">&#x27;1&#x27;</span><br>            flag = <span class="hljs-string">b&#x27;LitCTF&#123;&#x27;</span> + long_to_bytes(<span class="hljs-built_in">int</span>(m,<span class="hljs-number">2</span>)) + <span class="hljs-string">b&#x27;&#125;&#x27;</span><br>            <span class="hljs-built_in">print</span>(flag)<br>            <span class="hljs-comment"># LitCTF&#123;Am3xItsT&#125;</span><br><span class="hljs-built_in">print</span>(L)<br></code></pre></td></tr></table></figure><h2 id="math"><a href="#math" class="headerlink" title="math"></a>math</h2><p>è¿™é‡Œå¾ˆå®¹æ˜“å°±èƒ½æŸ¥åˆ°noiseåœ¨factordbä¸Šåˆ©ç”¨n-hint&#x3D;noise*()</p><p>ä¹‹åå°±å¾ˆç®€å•äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"> <span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> enc <span class="hljs-keyword">import</span> flag<br><br>m = bytes_to_long(flag)<br>e = <span class="hljs-number">65537</span><br>p,q = getPrime(<span class="hljs-number">1024</span>),getPrime(<span class="hljs-number">1024</span>)<br>n = p*q<br>noise = getPrime(<span class="hljs-number">40</span>)<br>tmp1 = noise*p+noise*q<br>tmp2 = noise*noise<br>hint = p*q+tmp1+tmp2<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;hint = <span class="hljs-subst">&#123;hint&#125;</span>&quot;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 17532490684844499573962335739488728447047570856216948961588440767955512955473651897333925229174151614695264324340730480776786566348862857891246670588649327068340567882240999607182345833441113636475093894425780004013793034622954182148283517822177334733794951622433597634369648913113258689335969565066224724927142875488372745811265526082952677738164529563954987228906850399133238995317510054164641775620492640261304545177255239344267408541100183257566363663184114386155791750269054370153318333985294770328952530538998873255288249682710758780563400912097941615526239960620378046855974566511497666396320752739097426013141</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 1443781085228809103260687286964643829663045712724558803386592638665188285978095387180863161962724216167963654290035919557593637853286347618612161170407578261345832596144085802169614820425769327958192208423842665197938979924635782828703591528369967294598450115818251812197323674041438116930949452107918727347915177319686431081596379288639254670818653338903424232605790442382455868513646425376462921686391652158186913416425784854067607352211587156772930311563002832095834548323381414409747899386887578746299577314595641345032692386684834362470575165392266454078129135668153486829723593489194729482511596288603515252196</span><br><span class="hljs-string">hint = 17532490684844499573962335739488728447047570856216948961588440767955512955473651897333925229174151614695264324340730480776786566348862857891246670588649327068340567882240999607182345833441113636475093894425780004013793034622954182148283517822177334733794951622433597634369648913113258689335969565315879035806034866363781260326863226820493638303543900551786806420978685834963920605455531498816171226961859405498825422799670404315599803610007692517859020686506546933013150302023167306580068646104886750772590407299332549746317286972954245335810093049085813683948329319499796034424103981702702886662008367017860043529164</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="leak"><a href="#leak" class="headerlink" title="leak"></a>leak</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>flag=<span class="hljs-string">b&#x27;114514f0xsad&#x27;</span><br><br>m = bytes_to_long(flag)<br>p,q,e = getPrime(<span class="hljs-number">1024</span>),getPrime(<span class="hljs-number">1024</span>),getPrime(<span class="hljs-number">101</span>)<br>n = p*q<br>temp = gmpy2.invert(e,p-<span class="hljs-number">1</span>)<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br>hint = temp&gt;&gt;<span class="hljs-number">180</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;hint = <span class="hljs-subst">&#123;hint&#125;</span>&quot;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">e = 1915595112993511209389477484497</span><br><span class="hljs-string">n = 12058282950596489853905564906853910576358068658769384729579819801721022283769030646360180235232443948894906791062870193314816321865741998147649422414431603039299616924238070704766273248012723702232534461910351418959616424998310622248291946154911467931964165973880496792299684212854214808779137819098357856373383337861864983040851365040402759759347175336660743115085194245075677724908400670513472707204162448675189436121439485901172477676082718531655089758822272217352755724670977397896215535981617949681898003148122723643223872440304852939317937912373577272644460885574430666002498233608150431820264832747326321450951</span><br><span class="hljs-string">c = 5408361909232088411927098437148101161537011991636129516591281515719880372902772811801912955227544956928232819204513431590526561344301881618680646725398384396780493500649993257687034790300731922993696656726802653808160527651979428360536351980573727547243033796256983447267916371027899350378727589926205722216229710593828255704443872984334145124355391164297338618851078271620401852146006797653957299047860900048265940437555113706268887718422744645438627302494160620008862694047022773311552492738928266138774813855752781598514642890074854185464896060598268009621985230517465300289580941739719020511078726263797913582399</span><br><span class="hljs-string">hint = 10818795142327948869191775315599184514916408553660572070587057895748317442312635789407391509205135808872509326739583930473478654752295542349813847128992385262182771143444612586369461112374487380427668276692719788567075889405245844775441364204657098142930</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>æ¨å¯¼ä¸€ä¸‹è®¾hint&#x3D;dp<br>$$<br>e(d_p+x)&#x3D;k(p-1)+1<br>$$<br>æ¨¡pä¹‹åæœ‰ä¸ºä»€ä¹ˆå¯ä»¥ç”±mod pæ¨æ–­åˆ°mod nçœ‹è¿™ä¸ªä½ å°±æ‡‚äº†ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> Crypto.Util.number import bytes_to_long, getPrime, inverse<br><br><span class="hljs-attribute">e</span>=0x10001<br>p,<span class="hljs-attribute">q</span>=getPrime(10),getPrime(10)<br><span class="hljs-attribute">n</span>=p*q<br><span class="hljs-built_in">print</span>(inverse(e,n))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(2*<span class="hljs-number">*10</span>):<br>    <span class="hljs-keyword">if</span> (e*i+11451)%<span class="hljs-attribute">p</span>==0&amp;(e*i+11451)%n==0:<br>        <span class="hljs-built_in">print</span>(i)<br></code></pre></td></tr></table></figure><p>$$<br>e(d_p+x)+k-1&#x3D;0 mod p<br>$$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># sage10.6</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> itertools<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">small_roots</span>(<span class="hljs-params">f, bounds, m=<span class="hljs-number">1</span>, d=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> d:<br>        d = f.degree()<br>        <span class="hljs-built_in">print</span>(d)<br>    R = f.base_ring()<br>    N = R.cardinality()<br>    f /= f.coefficients().pop(<span class="hljs-number">0</span>)<br>    f = f.change_ring(ZZ)<br>    G = <span class="hljs-type">Sequence</span>([], f.parent())<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m + <span class="hljs-number">1</span>):<br>        base = N ^ (m - i) * f ^ i<br>        <span class="hljs-keyword">for</span> shifts <span class="hljs-keyword">in</span> itertools.product(<span class="hljs-built_in">range</span>(d), repeat=f.nvariables()):<br>            g = base * prod(<span class="hljs-built_in">map</span>(power, f.variables(), shifts))<br>            G.append(g)<br>    B, monomials = G.coefficient_matrix()<br>    monomials = vector(monomials)<br>    factors = [monomial(*bounds) <span class="hljs-keyword">for</span> monomial <span class="hljs-keyword">in</span> monomials]<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, factor)<br>    B = B.dense_matrix().LLL()<br>    B = B.change_ring(QQ)<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, <span class="hljs-number">1</span> / factor)<br>    H = <span class="hljs-type">Sequence</span>([], f.parent().change_ring(QQ))<br>    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">filter</span>(<span class="hljs-literal">None</span>, B * monomials):<br>        H.append(h)<br>        I = H.ideal()<br>        <span class="hljs-keyword">if</span> I.dimension() == -<span class="hljs-number">1</span>:<br>            H.pop()<br>        <span class="hljs-keyword">elif</span> I.dimension() == <span class="hljs-number">0</span>:<br>            roots = []<br>            <span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> I.variety(ring=ZZ):<br>                root = <span class="hljs-built_in">tuple</span>(R(root[var]) <span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> f.variables())<br>                roots.append(root)<br>            <span class="hljs-keyword">return</span> roots<br>    <span class="hljs-keyword">return</span> []<br><br>e = <span class="hljs-number">1915595112993511209389477484497</span><br>n = <span class="hljs-number">12058282950596489853905564906853910576358068658769384729579819801721022283769030646360180235232443948894906791062870193314816321865741998147649422414431603039299616924238070704766273248012723702232534461910351418959616424998310622248291946154911467931964165973880496792299684212854214808779137819098357856373383337861864983040851365040402759759347175336660743115085194245075677724908400670513472707204162448675189436121439485901172477676082718531655089758822272217352755724670977397896215535981617949681898003148122723643223872440304852939317937912373577272644460885574430666002498233608150431820264832747326321450951</span><br>c = <span class="hljs-number">5408361909232088411927098437148101161537011991636129516591281515719880372902772811801912955227544956928232819204513431590526561344301881618680646725398384396780493500649993257687034790300731922993696656726802653808160527651979428360536351980573727547243033796256983447267916371027899350378727589926205722216229710593828255704443872984334145124355391164297338618851078271620401852146006797653957299047860900048265940437555113706268887718422744645438627302494160620008862694047022773311552492738928266138774813855752781598514642890074854185464896060598268009621985230517465300289580941739719020511078726263797913582399</span><br>leak = <span class="hljs-number">10818795142327948869191775315599184514916408553660572070587057895748317442312635789407391509205135808872509326739583930473478654752295542349813847128992385262182771143444612586369461112374487380427668276692719788567075889405245844775441364204657098142930</span><br>leak &lt;&lt;= <span class="hljs-number">180</span><br>R.&lt;x,y&gt; = PolynomialRing(Zmod(n),implementation=<span class="hljs-string">&#x27;generic&#x27;</span>)<br>f = e * (leak + x) + (y - <span class="hljs-number">1</span>)<br>res = small_roots(f,(<span class="hljs-number">2</span>^<span class="hljs-number">180</span>,<span class="hljs-number">2</span>^<span class="hljs-number">101</span>),m=<span class="hljs-number">2</span>,d=<span class="hljs-number">4</span>)<br><span class="hljs-built_in">print</span>(res)<br><span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> res:<br>    dp_low = root[<span class="hljs-number">0</span>]<br>    dp = leak + dp_low<br>    tmp = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,e*dp,n) - <span class="hljs-number">2</span><br>    p = gmpy2.gcd(tmp,n)<br>    q = n // p<br>    d = inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>    m = <span class="hljs-built_in">pow</span>(c,d,n)<br>    <span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment"># LitCTF&#123;03ecda15d1a89b06454c6050c1bd489f&#125;</span><br></code></pre></td></tr></table></figure><p>æœ€åä¸€æ­¥ï¼Œè¯æ˜:<br>$$<br>tmp&#x3D;2^{e<em>d_p}mod n -2\equiv 2^{k_1(p-1)+1}-k_2</em>n-2\equiv 2+k_3<em>p-k_2</em>n-2&#x3D;p(k_3-k_2*q)<br>$$</p>]]></content>
    
    
    <categories>
      
      <category>crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
      <tag>å¤ç°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¢…æ£®æ—‹è½¬ç”Ÿæˆéšæœºæ•°</title>
    <link href="/2025/03/30/%E9%80%86%E5%90%91%E6%A2%85%E6%A3%AE%E7%AE%97%E6%B3%95/"/>
    <url>/2025/03/30/%E9%80%86%E5%90%91%E6%A2%85%E6%A3%AE%E7%AE%97%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="æ¢…æ£®æ—‹è½¬ç”Ÿæˆéšæœºæ•°çš„é€†å‘é¢„æµ‹å’Œæ¢å¤"><a href="#æ¢…æ£®æ—‹è½¬ç”Ÿæˆéšæœºæ•°çš„é€†å‘é¢„æµ‹å’Œæ¢å¤" class="headerlink" title="æ¢…æ£®æ—‹è½¬ç”Ÿæˆéšæœºæ•°çš„é€†å‘é¢„æµ‹å’Œæ¢å¤"></a>æ¢…æ£®æ—‹è½¬ç”Ÿæˆéšæœºæ•°çš„é€†å‘é¢„æµ‹å’Œæ¢å¤</h1><ul><li>é¢„æµ‹ä¸‹ä¸€ä¸ªéšæœºæ•°ï¼Œæ¢å¤è¢«éšè—çš„éšæœºæ•°æ®</li></ul><p>é¦–å‘äºå…ˆçŸ¥ç¤¾åŒº ï¼š<a href="https://xz.aliyun.com/news/16929">å­é›†å’Œé—®é¢˜çš„ä¸¤ç§è§£å†³æ–¹å¼-å…ˆçŸ¥ç¤¾åŒº</a></p><h2 id="ç®—æ³•è¿‡ç¨‹"><a href="#ç®—æ³•è¿‡ç¨‹" class="headerlink" title="ç®—æ³•è¿‡ç¨‹"></a>ç®—æ³•è¿‡ç¨‹</h2><ul><li>wikiä¸Šæœ‰ç®—æ³•å®ç°çš„æºä»£ç </li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_int32</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">0xFFFFFFFF</span> &amp; x)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MT19937</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed</span>):<br>        <span class="hljs-variable language_">self</span>.mt = [<span class="hljs-number">0</span>] * <span class="hljs-number">624</span><br>        <span class="hljs-variable language_">self</span>.mt[<span class="hljs-number">0</span>] = seed<br>        <span class="hljs-variable language_">self</span>.mti = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">624</span>):<br>            <span class="hljs-variable language_">self</span>.mt[i] = _int32(<span class="hljs-number">1812433253</span> * (<span class="hljs-variable language_">self</span>.mt[i - <span class="hljs-number">1</span>] ^ <span class="hljs-variable language_">self</span>.mt[i - <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">30</span>) + i)<br><br><br>     <span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_number</span>(<span class="hljs-params">self,x=<span class="hljs-literal">None</span></span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.mti == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> x <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-variable language_">self</span>.twist()<br>        y = <span class="hljs-variable language_">self</span>.mt[<span class="hljs-variable language_">self</span>.mti]<br>        y = y ^ y &gt;&gt; <span class="hljs-number">11</span><br>        y = y ^ y &lt;&lt; <span class="hljs-number">7</span> &amp; <span class="hljs-number">2636928640</span><br>        y = y ^ y &lt;&lt; <span class="hljs-number">15</span> &amp; <span class="hljs-number">4022730752</span><br>        y = y ^ y &gt;&gt; <span class="hljs-number">18</span><br>        <span class="hljs-variable language_">self</span>.mti = (<span class="hljs-variable language_">self</span>.mti + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span><br>        <span class="hljs-keyword">return</span> _int32(y)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">twist</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">624</span>):<br>            y = _int32((<span class="hljs-variable language_">self</span>.mt[i] &amp; <span class="hljs-number">0x80000000</span>) + (<span class="hljs-variable language_">self</span>.mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>] &amp; <span class="hljs-number">0x7fffffff</span>))<br>            <span class="hljs-variable language_">self</span>.mt[i] = (y &gt;&gt; <span class="hljs-number">1</span>) ^ <span class="hljs-variable language_">self</span>.mt[(i + <span class="hljs-number">397</span>) % <span class="hljs-number">624</span>]<br><br>            <span class="hljs-keyword">if</span> y % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>:<br>                <span class="hljs-variable language_">self</span>.mt[i] = <span class="hljs-variable language_">self</span>.mt[i] ^ <span class="hljs-number">0x9908b0df</span><br></code></pre></td></tr></table></figure><p>æ ¹æ®ä»£ç åˆ†æè¿‡ç¨‹ã€‚å› ä¸ºç¤¾åŒºå·²ç»æœ‰äººè®²è¿‡å¾ˆè¯¦ç»†çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬è¿™é‡Œå°±åªè¯´ä¸€ä¸‹å¤§è‡´åˆ†ä¸ºä¸‰ä¸ªè¿‡ç¨‹</p><ul><li>åˆå§‹åŒ–</li></ul><p>æ ¹æ®ç§å­seedï¼Œç”Ÿæˆåˆå§‹çŠ¶æ€mt(å…±æœ‰624ä¸ªæ•°æ®ã€‚ç„¶åmti&#x3D;&#x3D;0.</p><ul><li>å¤„ç†mtç”Ÿæˆéšæœºæ•°</li></ul><p>å¯¹mtè¿›è¡Œä¸€ç³»åˆ—çº¿æ€§æ“ä½œç„¶åç”Ÿæˆéšæœºæ•°ã€‚</p><ul><li>è¿›è¡Œæ—‹è½¬</li></ul><p>å½“å·²ç»ç”Ÿæˆäº†624ä¸ªéšæœºæ•°æ—¶ï¼Œç›¸å½“äºè€—å…‰äº†ä¸€è½®çš„çŠ¶æ€ã€‚å°±éœ€è¦åˆ©ç”¨æ—‹è½¬ç”Ÿæˆæ–°ä¸€è½®æ•°æ®ï¼Œè§‚å¯Ÿè¿™ä¸ªtwistä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªé¢„æµ‹624ä½ä¹‹åå‡ºç°çš„ä¸‹ä¸€è½®çš„mtçŠ¶æ€ç„¶åé¢„æµ‹ä¸‹ä¸€ä¸ªéšæœºæ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">M1=[]<br>M2=[]<br>rng=MT19937(seed=<span class="hljs-number">1123</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1248</span>):<br>    a=rng.extract_number()<br>    <span class="hljs-keyword">if</span> i&lt;<span class="hljs-number">624</span>:<br>        M1.append(a)<br>    <span class="hljs-keyword">else</span>:<br>        M2.append(a)<br><span class="hljs-built_in">print</span>(M1)<br><span class="hljs-built_in">print</span>(M2)<br></code></pre></td></tr></table></figure><p>å¦‚å›¾å¯ä»¥è°ƒç”¨å‡½æ•°ç”Ÿæˆéšæœºæ•°æˆ‘ä»¬å¯ä»¥åˆ©ç”¨M1é¢„æµ‹M2çš„æ•°æ®ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç”¨RandCrackåº“é¢„æµ‹ç”Ÿæˆçš„éšæœºæ•°å’Œç”Ÿæˆä¹‹å‰ç”Ÿæˆçš„éšæœºæ•°ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å†™ä¸€ä¸ªé¢„æµ‹çš„ä»£ç ã€‚</p><ul><li>åº“å‡½æ•°</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">rc=RandCrack()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> M1:<br>    rc.submit(i)<br><span class="hljs-built_in">next</span>=rc.predict_randrange(<span class="hljs-number">0</span>, <span class="hljs-number">0xFFFFFFFF</span>)<span class="hljs-comment">#(è¿™é‡Œç¡®å®šè¾“å‡ºçš„èµ·å§‹å’Œæœ«å°¾bit,ï¼Œè¿™é‡Œåœ¨åé¢è®²è§£ä¸ºä½•è¿™æ ·)</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">next</span>)<br></code></pre></td></tr></table></figure><ul><li>é€†å‘å‡½æ•°è¿›è¡Œé¢„æµ‹</li></ul><blockquote><ul><li>é€†å‘extract_number()å‡½æ•°</li></ul><p>â€‹       y &#x3D; y ^ y &gt;&gt; 11<br>â€‹        y &#x3D; y ^ y &lt;&lt; 7 &amp; 2636928640<br>â€‹        y &#x3D; y ^ y &lt;&lt; 15 &amp; 4022730752<br>â€‹        y &#x3D; y ^ y &gt;&gt; 18</p><p>è¿™æ˜¯è¿™ä¸ªå‡½æ•°æœ€å…³é”®çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬åœ¨ä¸€è½®ä¸­å¯ä»¥åˆ©ç”¨ç”Ÿæˆä¸€è½®çš„éšæœºæ•°æ¢å¤mtï¼Œç„¶åé¢„æµ‹ä¸‹ä¸€è½®çš„mtæ¢å¤æ•°æ®ï¼Œä»ä¸‹å¾€ä¸Šã€‚</p></blockquote><p>æˆ‘ä»¬æŠŠæ“ä½œåçš„yå†™æˆbitå½¢å¼y&#x3D;$y_1..y_{32}$ |åŒæ—¶è®°æ“ä½œå‰$x&#x3D;x_1..x_{32}$ã€‚ã€‚ã€‚</p><p>â€‹                            $$y&#x3D;x\oplus x&gt;&gt;n$$   <strong>n&gt;&#x3D;32-n</strong></p><p>é‚£ä¹ˆæœ‰$y_1..y_{32}&#x3D;x_1..x_{32}\oplus 0..0x_1..x_{32-n}$</p><p>é‚£ä¹ˆ$y_1..y_n&#x3D;x_1..x_n$            $x_{n+1}..x_{32}\oplus x_1..x_{32-n}&#x3D;y_{n+1}..y_{32}$</p><p>å¯ä»¥å¾—åˆ°$x_{n+1}..x_{32}&#x3D;y_{n+1}..y_{32}\oplus y_1..y_{32-n}$ å› ä¸ºn&gt;32-n,æ‰€ä»¥$y_1..y_{32-n}$æ˜¯å·²çŸ¥çš„</p><p>æ‰€ä»¥$x&#x3D;y&gt;&gt;n$</p><p>åŒç†ï¼Œå½“<strong>n&lt;32-n</strong> ,æƒ…å†µæœ‰æ‰€è½¬å˜</p><p>æœ€åè¿™é‡Œæ— æ³•$y_{n+1}..y_{32}\oplus y_1..y_{32-n}$ æ— æ³•ä¸€æ¬¡æ€§å®Œå…¨æ¢å¤å¤šè½®å‡ æ¬¡å°±å¥½äº†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥$x_{n+1}..x_{2n+1}&#x3D;y_{n+1}..y_{32}\oplus y_1..y_{n+1}$ </p><p>æˆ‘ä»¬å¤šè¿›è¡Œå‡ æ¬¡è¿™æ ·çš„å˜åŒ–å°±è¡Œäº†ã€‚</p><p>é€†å‘ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"> <span class="hljs-keyword">def</span> <span class="hljs-title function_">re_right</span>(<span class="hljs-params">self,x,bit,mask=<span class="hljs-number">0xffffffff</span></span>):<br>     tmp=x<br>     <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>//bit):<br>         tmp=x^tmp&gt;&gt;bit&amp;mask<br>     <span class="hljs-keyword">return</span> tmp<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">re_left</span>(<span class="hljs-params">self,x,bit,mask=<span class="hljs-number">0xffffffff</span></span>):<br>     tmp=x<br>     <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>//bit):<br>         tmp=x^tmp&lt;&lt;bit&amp;mask<br>     <span class="hljs-keyword">return</span> tmp<br></code></pre></td></tr></table></figure><p>è¿™é‡Œå¦‚æœæˆ‘ä»¬åªè¿›è¡Œæ­£å‘çš„é¢„æµ‹ï¼Œå°±æš‚æ—¶ä¸ç”¨åå‘å†™ä¸€ä¸ªtwistä»£ç äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">re_extract</span>(<span class="hljs-params">self,m</span>):<br>        m=<span class="hljs-variable language_">self</span>.re_right(m,<span class="hljs-number">18</span>,<span class="hljs-number">0xffffffff</span>)<br>        m=<span class="hljs-variable language_">self</span>.re_left(m,<span class="hljs-number">15</span>,<span class="hljs-number">4022730752</span>)<br>        m=<span class="hljs-variable language_">self</span>.re_left(m,<span class="hljs-number">7</span>,<span class="hljs-number">2636928640</span>)<br>        m=<span class="hljs-variable language_">self</span>.re_right(m,<span class="hljs-number">11</span>)<br>        <span class="hljs-keyword">return</span> m&amp;<span class="hljs-number">0xffffffff</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">re_state</span>(<span class="hljs-params">self,outputs</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(outputs)!=<span class="hljs-number">624</span>:<br>            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;Invalid number of outputs&quot;</span>)<br><br>        <span class="hljs-variable language_">self</span>.mt=[<span class="hljs-variable language_">self</span>.re_extract(m)<span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> outputs]<br>        <span class="hljs-variable language_">self</span>.mti=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.mt<br>M1=[]<br>M2=[]<br>rng=MT19937(seed=<span class="hljs-number">1123</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1248</span>):<br>    a=rng.extract_number()<br>    <span class="hljs-keyword">if</span> i&lt;<span class="hljs-number">624</span>:<br>        M1.append(a)<br>    <span class="hljs-keyword">else</span>:<br>        M2.append(a)<br><span class="hljs-built_in">print</span>(M1)<br><span class="hljs-built_in">print</span>(M2)<br>pre=MT19937()<br>pre.re_state(M1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;é¢„æµ‹ RNG:&quot;</span>, [pre.extract_number() <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)])<br><br></code></pre></td></tr></table></figure><p>ç»“åˆä¸Šè¿°ä»£ç å¯ä»¥å¾ˆå¥½çš„é¢„æµ‹ä¸‹ä¸€ä¸ªã€‚ä¸è¿‡æˆ‘ä»¬è¦å¦‚æœè¿›è¡Œæ¢å¤å‰é¢çš„æ•°å’Œæ›´ç²¾ç®€çš„æ“ä½œã€‚ä¾¿éœ€è¦é€†å‘twist</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">def</span> twist(self):<br>       <span class="hljs-attribute">for</span> i in range(<span class="hljs-number">0</span>, <span class="hljs-number">624</span>):<br>           <span class="hljs-attribute">y</span> = _int32((self.mt[i] &amp; <span class="hljs-number">0</span>x80000000) + (self.mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>] &amp; <span class="hljs-number">0</span>x7fffffff))<br>           <span class="hljs-attribute">self</span>.mt[i] = (y &gt;&gt; <span class="hljs-number">1</span>) ^ self.mt[(i + <span class="hljs-number">397</span>) % <span class="hljs-number">624</span>]<br><br>           <span class="hljs-attribute">if</span> y % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>:<br>               <span class="hljs-attribute">self</span>.mt[i] = self.mt[i] ^ <span class="hljs-number">0</span>x9908b0df<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€ç‰ˆå‡½æ•°ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">re_twist</span>(<span class="hljs-params">self,mt</span>):<br>    re_tw=[<span class="hljs-number">0</span>]*<span class="hljs-number">624</span><span class="hljs-comment">#ç”Ÿæˆåˆ—è¡¨</span><br>    a=deepcopy(mt[<span class="hljs-number">623</span>])<br>    c=deepcopy(mt[<span class="hljs-number">396</span>])<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">623</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<span class="hljs-comment">#ä»å¤§åˆ°å°éå†ï¼Œä»¥ä¾¿twist[(i+397)%624]æ˜¯ç¬¦åˆæ¡ä»¶çš„</span><br>        k=mt[i]^mt[(i+<span class="hljs-number">397</span>) % <span class="hljs-number">624</span>]<br>        <span class="hljs-keyword">if</span> (k&amp;<span class="hljs-number">0x80000000</span>)&gt;&gt;<span class="hljs-number">31</span>==<span class="hljs-number">1</span>:<span class="hljs-comment">#åˆ¤æ–­y&gt;&gt;1çš„ç¬¬ä¸€ä½</span><br>            k=k^<span class="hljs-number">0x9908b0df</span><br>            low=<span class="hljs-number">1</span><br>            high=(k&amp;<span class="hljs-number">0x40000000</span>)&gt;&gt;<span class="hljs-number">30</span><br>            re_tw[i]=high&lt;&lt;<span class="hljs-number">31</span><br>            re_tw[(i+<span class="hljs-number">1</span>)%<span class="hljs-number">624</span>]=re_tw[(i+<span class="hljs-number">1</span>)%<span class="hljs-number">624</span>]+((k&amp;<span class="hljs-number">0x3fffffff</span>)&lt;&lt;<span class="hljs-number">1</span>)+low<br>            <span class="hljs-keyword">if</span> i !=<span class="hljs-number">623</span>:<br>                mt[(i+<span class="hljs-number">1</span>)%<span class="hljs-number">624</span>]=re_tw[(i+<span class="hljs-number">1</span>)%<span class="hljs-number">624</span>]<span class="hljs-comment">#è¿˜åŸæ­£ç¡®çš„ä¾èµ–</span><br>        <span class="hljs-keyword">elif</span> (k &amp; <span class="hljs-number">0x80000000</span>) &gt;&gt; <span class="hljs-number">31</span> == <span class="hljs-number">0</span>:<br>            low = <span class="hljs-number">0</span><br>            high = (k &amp; <span class="hljs-number">0x40000000</span>) &gt;&gt; <span class="hljs-number">30</span><br>            re_tw[i] = high &lt;&lt; <span class="hljs-number">31</span><br>            re_tw[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>] = re_tw[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>] + ((k &amp; <span class="hljs-number">0x3fffffff</span>) &lt;&lt; <span class="hljs-number">1</span>) + low<br>            <span class="hljs-keyword">if</span> i != <span class="hljs-number">623</span>:<br>                mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>] = re_tw[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>]<br><br>    <span class="hljs-keyword">return</span> re_tw<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªåè½¬å‡½æ•°ï¼Œå¯è¯»æ€§ä¸å¤ªå¥½ï¼Œæˆ‘ä»¬ä»å¤§åˆ°å°éå†ã€‚</p><p>å…ˆå°†å¼‚æˆ–mt[(i+397) % 624] (ä»å¤§åˆ°å°çš„å¾ˆæ˜æ˜¾çš„æ˜¯èƒ½å¤Ÿç›´æ¥åˆ©ç”¨è¿™ä¸ªåè§£ï¼Œå¹¶ä¸”æ¯ä¸€æ¬¡å¾ªç¯åéƒ½ä¼šæ›´æ”¹ä¾èµ–)</p><p>ä¸è¿‡è¿™å…³æœ‰ä¸ªç¼ºé™·å°±æ˜¯ä¸èƒ½è¿˜åŸå‡ºmt[0]ï¼Œ</p><blockquote><p>å› ä¸ºæœ€åä¸€ä¸ªè®¡ç®—mt[0]çš„æ—¶å€™ä¼šè‡ªåŠ¨æŠŠre_tw[0]å˜æˆre_tw[i]&#x3D;high&lt;&lt;31ã€‚</p><p>æˆ‘æ¢å¤å‡ºæ¥ç»“æœæ¢å¤å‡ºäº†å®ƒä¸‹ä¸€ä¸ªçš„mt1[0]æ‰€ä»¥æœ€åæˆ‘æ¢äº†ä¸€ä¸ªæ–¹æ³•ã€‚</p></blockquote><p>æ¯”å¦‚æˆ‘ä»¬è¦æ±‚mt[i],å·²çŸ¥å®ƒæ—‹è½¬åmt1[]</p><blockquote><p>æˆ‘ä»¬åˆ©ç”¨mt1[i]æ¢å¤å‡ºmt[i]çš„æœ€é«˜çš„1ä½ï¼Œç„¶åå†åˆ©ç”¨mt1[i-1]æ¢å¤å‡ºç¬¬çš„31ä½</p><p>å…·ä½“æ¢å¤è¿‡ç¨‹</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">0x7fffffff</span>=<span class="hljs-number">0b01111111111111111111111111111111</span><br><span class="hljs-number">0x80000000</span>=<span class="hljs-number">0b10000000000000000000000000000000</span><br></code></pre></td></tr></table></figure><p>å¦‚æœè¿™ç§æ“ä½œåº”ç”¨ç»™ä¸€ä¸ªè§„å®šçš„32bitçš„æ•°é‚£ä¹ˆ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">y</span> = _int32((self.mt[i] &amp; <span class="hljs-number">0</span>x80000000) + (self.mt[(i + <span class="hljs-number">1</span>) % <span class="hljs-number">624</span>] &amp; <span class="hljs-number">0</span>x7fffffff))<br></code></pre></td></tr></table></figure><p>åœ¨yç­‰äºmt[i]ç¬¬32Bit å’Œ.mt[(i + 1) % 624]çš„å31bitä¹‹å’Œ</p><p>ç”±äºéƒ½æ˜¯çº¿æ€§æ“ä½œï¼Œæˆ‘ä»¬å…ˆ</p><p>k&#x3D;mt[i]^mt[(i+397) % 624]ï¼Œ</p><blockquote><ul><li>å¦‚æœkä¸0x9908b0dfå¼‚æˆ–è¿‡ï¼Œé‚£ä¹ˆç”±äº(y&lt;&lt;1)^0x9908b0df&#x3D;kï¼Œ</li></ul><p>k&lt;&lt;31&#x3D;&#x3D;1ã€‚</p><ul><li>å¦‚æœkæ²¡ä¸0x9908b0dfå¼‚æˆ–</li></ul><p>k&lt;&lt;31&#x3D;&#x3D;0</p><p>ä¾¿èƒ½é€šè¿‡yå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">re_tw1</span>(<span class="hljs-params">mt</span>):<br>    high=<span class="hljs-number">0x80000000</span><br>    low=<span class="hljs-number">0x7fffffff</span><br>    mask=<span class="hljs-number">0x9908b0df</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">623</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>        t=mt[i]^mt[(i+<span class="hljs-number">397</span>) % <span class="hljs-number">624</span>]<br>        <span class="hljs-keyword">if</span> t&amp;high==high:<br>            t=t^mask<br>            t=t&lt;&lt;<span class="hljs-number">1</span><br>            t|=<span class="hljs-number">1</span><span class="hljs-comment">#ç¡®å®šä½å¥‡æ•°</span><br>        <span class="hljs-keyword">else</span>:<br>            t=t&lt;&lt;<span class="hljs-number">1</span><br>        res=t&amp;high <span class="hljs-comment">#å–å¾—é«˜ä½</span><br>        t=mt[i-<span class="hljs-number">1</span>]^mt[(i+<span class="hljs-number">396</span>) % <span class="hljs-number">624</span>]<br>        <span class="hljs-keyword">if</span> t&amp;high==high:<br>            t=t^mask<br>            t=t&lt;&lt;<span class="hljs-number">1</span><br>            t|=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            t=t&lt;&lt;<span class="hljs-number">1</span><br>        res=res+(t&amp;low)<br>        mt[i]=res<br>    <span class="hljs-keyword">return</span> mt<br></code></pre></td></tr></table></figure><p>éªŒè¯ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    M1 = []<br>    M2 = []<br>    rng = MT19937(seed=<span class="hljs-number">1123</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1248</span>):<br>        a = rng.extract_number()<br>        <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">624</span>:<br>            M1.append(a)<br>        <span class="hljs-keyword">else</span>:<br>            M2.append(a)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;M1=<span class="hljs-subst">&#123;M1&#125;</span>&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;M2=<span class="hljs-subst">&#123;M2&#125;</span>&#x27;</span>)<br>    pre = MT19937()<br>    m = pre.re_state(M2)<br>    pre.mt=re_tw1(m)<br>    <span class="hljs-built_in">print</span>(pre.mt)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;é¢„æµ‹ RNG:&quot;</span>, [pre.extract_number(x=<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)])<br></code></pre></td></tr></table></figure><p>å¯ä»¥è·‘ä¸€ä¸‹æ˜¯ä¸€æ ·çš„</p><p>è¿™é‡Œçš„x&#x3D;1æ˜¯æ§åˆ¶æ˜¯å¦æ—‹è½¬çš„ï¼Œå…·ä½“ç¿»é˜…ä¸Šè¿°æºä»£ç ã€‚</p><p>[<a href="https://github.com/rockfox0/TM19973/blob/main/MT.py">TM19973&#x2F;MT.py at main Â· rockfox0&#x2F;TM19973</a>]â€”è¿™æ˜¯MT19973çš„æºç å’Œé€†å‘çš„ä»£ç çš„githubé“¾æ¥</p><h2 id="å¦‚æœæ˜¯ä¸è¿ç»­çš„è¾“å‡ºä¿¡æ¯"><a href="#å¦‚æœæ˜¯ä¸è¿ç»­çš„è¾“å‡ºä¿¡æ¯" class="headerlink" title="å¦‚æœæ˜¯ä¸è¿ç»­çš„è¾“å‡ºä¿¡æ¯"></a>å¦‚æœæ˜¯ä¸è¿ç»­çš„è¾“å‡ºä¿¡æ¯</h2><p>åœ¨ä¸€äº›æ¯”è¾ƒéš¾çš„æ¢…æ£®æ—‹è½¬çš„é¢˜ç›®ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°çš„éšæœºæ•°æ˜¯é—´æ–­ï¼Œæ¥è‡ªäºä¸åŒçš„bitå€¼ã€‚åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¦‚æœçŸ¥é“äº†è¿ç»­çš„19937ä¸ªbitçš„ä¿¡æ¯(ä¹Ÿå°±æ˜¯ä¸€è½®)ï¼Œæˆ‘ä»¬æ¢å¤ä¹‹å‰çš„å’Œé¢„æµ‹ä¹‹åçš„æ˜¯å¾ˆè½»æ˜“çš„ã€‚</p><p>å› ä¸ºæ¢…æ£®æ—‹è½¬æ˜¯çº¿æ€§æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨çº¿æ€§ä»£æ•°çš„çŸ¥è¯†æ¥åšè¿™ä¸ªã€‚</p><p>å‡è®¾å·²çŸ¥çš„æ•°æ®æ˜¯bï¼Œbå¯ä»¥è½¬åŒ–ä¸ºä¸€ä¸ªå‘é‡ã€‚yè¡¨ç¤ºåˆå§‹çš„stateã€‚yç»è¿‡Mè¿™ä¸ªçŸ©é˜µçš„çº¿æ€§è¿ç®—å¯ä»¥å¾—åˆ°bã€‚</p><p>$ y<em>M&#x3D;bâ€”y&#x3D;b</em>(M)^{-1}$</p><p>æˆ‘ä»¬åªéœ€è¦æ„é€ å‡ºMè¡¨ç¤ºçº¿æ€§è¿ç®—çš„è¿‡ç¨‹ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ã€‚ã€‚åœ¨python ä»£ç  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">a=getrandombits(t)<br></code></pre></td></tr></table></figure><p>å¦‚æœt&lt;32ï¼Œå°±ä¼šå…ˆç”Ÿæˆæ­£å¸¸çš„ä¸€ç»„32bitæ•°ï¼Œç„¶åæŠŠ32bitå³ç§»16bitã€‚å°±èƒ½å¾—åˆ°16bitä»¥å†…çš„aã€‚å¦‚æœæˆ‘ä»¬å¾—åˆ°çš„æ˜¯ä¸€äº›t&#x3D;20bitçš„æ•°æ®æƒ³è¦æ¢å¤å®ƒï¼Œæ˜¾ç„¶ç”¨å‰é¢ç›´æ¥é€†å‘çš„æ–¹å¼æ˜¯ä¸å¤ªå¯è¡Œçš„ã€‚æˆ‘ä»¬è¿™æ˜¯å°±å¯ä»¥æ„é€ çŸ©é˜µMï¼Œåˆ©ç”¨çº¿æ€§ä»£æ•°çš„è¿ç®—è¡¨ç¤ºçº¿æ€§çš„è¿ç®—è¿‡ç¨‹ã€‚</p><ul><li>æˆ‘ä»¬è¦å…ˆè‡ªå®šä¹‰ä¸€ä¸ªéšæœºæ•°ç”Ÿæˆå™¨çš„å‡½æ•°ï¼Œæ¥è¡¨ç¤ºæˆ‘ä»¬ç”Ÿæˆéšæœºæ•°çš„æ–¹å¼ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">getRows</span>(<span class="hljs-params">rng</span>):<br>    row=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        row+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(rng.getrandbits(<span class="hljs-number">20</span>))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">20</span>))))<br>    <span class="hljs-keyword">return</span> row<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¡¨ç¤ºå°±æ˜¯ç”Ÿæˆ20bitå†…çš„éšæœºæ•°ç„¶åç´¯åŠ 1000ä¸ªåˆ°rowä¸Šå¾—åˆ°çš„rowå°±æ˜¯ä¸€ä¸ªæœ‰20000ä¸ª0&#x2F;1æ•°æ®çš„åˆ—è¡¨</p><p>å…¶å®æˆ‘ä»¬è¦æ±‚19968Bitçš„å·²çŸ¥æ•°æ®å°±å¤Ÿäº†ï¼Œä¸è¿‡è¿™é‡Œå¤šç‚¹ä¹Ÿè¡Œã€‚</p><ul><li>ç„¶åå°±æ˜¯æ„å»ºMçº¿æ€§è¿ç®—çš„çŸ©é˜µ,Må°†åˆå§‹çŸ©é˜µå˜æˆ</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">19968</span>)):<br>    state = [<span class="hljs-number">0</span>]*<span class="hljs-number">624</span><br>    temp = <span class="hljs-string">&quot;0&quot;</span>*i + <span class="hljs-string">&quot;1&quot;</span>*<span class="hljs-number">1</span> + <span class="hljs-string">&quot;0&quot;</span>*(<span class="hljs-number">19968</span>-<span class="hljs-number">1</span>-i)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        state[j] = <span class="hljs-built_in">int</span>(temp[<span class="hljs-number">32</span>*j:<span class="hljs-number">32</span>*j+<span class="hljs-number">32</span>],<span class="hljs-number">2</span>)<br>    rng.setstate((<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state+[<span class="hljs-number">624</span>]),<span class="hljs-literal">None</span>)) <br>    M.append(getRows(rng))<br>M=Matrix(GF(<span class="hljs-number">2</span>),M)<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªç”ŸæˆMçº¿æ€§è¿ç®—çš„çŸ©é˜µä»£ç æ˜¯ä¸å˜çš„å¯ä»¥ç›´æ¥ã€‚æ— è®ºç”Ÿæˆéšæœºæ•°æ˜¯éšè—äº†å“ªäº›éƒ¨åˆ†ï¼Œè¿™äº›ä»£ç éƒ½æ˜¯ä¸å˜çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>n=<span class="hljs-number">1000</span><br>D=[]<span class="hljs-comment">#1000ä¸ªå¾—åˆ°20</span><br>rng=Random()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getRows</span>(<span class="hljs-params">rng</span>):<br>    row=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        row+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(rng.getrandbits(<span class="hljs-number">20</span>))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">20</span>))))<br>    <span class="hljs-keyword">return</span> row<br>M=[]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">19968</span>)):<br>    state = [<span class="hljs-number">0</span>]*<span class="hljs-number">624</span><br>    temp = <span class="hljs-string">&quot;0&quot;</span>*i + <span class="hljs-string">&quot;1&quot;</span>*<span class="hljs-number">1</span> + <span class="hljs-string">&quot;0&quot;</span>*(<span class="hljs-number">19968</span>-<span class="hljs-number">1</span>-i)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        state[j] = <span class="hljs-built_in">int</span>(temp[<span class="hljs-number">32</span>*j:<span class="hljs-number">32</span>*j+<span class="hljs-number">32</span>],<span class="hljs-number">2</span>)<br>    rng.setstate((<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state+[<span class="hljs-number">624</span>]),<span class="hljs-literal">None</span>)) <br>    M.append(getRows(rng))<br>M=Matrix(GF(<span class="hljs-number">2</span>),M)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¡Œæ•°:&quot;</span>, M.nrows())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;åˆ—æ•°:&quot;</span>, M.ncols())<br>r=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    r+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(D[i])[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">20</span>))))<br>r=vector(GF(<span class="hljs-number">2</span>),r)<br>y=M.solve_left(r)<br>G=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    C=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        C&lt;&lt;=<span class="hljs-number">1</span><br>        C|=<span class="hljs-built_in">int</span>(y[<span class="hljs-number">32</span>*i+j])<br>    G.append(C)<span class="hljs-comment">#å°†æ¢å¤çš„stateè½¬åŒ–ä¸ºæ¯ä¸ªå…ƒç´ 32bitçš„åˆ—è¡¨</span><br><span class="hljs-keyword">import</span> random<br>RNG1 = random.Random()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    G[i]=<span class="hljs-built_in">int</span>(G[i])<br>RNG1.setstate((<span class="hljs-built_in">int</span>(<span class="hljs-number">3</span>),<span class="hljs-built_in">tuple</span>(G+[<span class="hljs-built_in">int</span>(<span class="hljs-number">624</span>)]),<span class="hljs-literal">None</span>))<span class="hljs-comment">#å°†stateä½œä¸ºéšæœºæ•°ç”Ÿæˆå™¨çš„åˆå§‹çŠ¶æ€ï¼Œæµ‹è¯•ç”Ÿæˆçš„stateæ˜¯å¦æ­£ç¡®</span><br>P=[RNG1.getrandbits(<span class="hljs-number">20</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">75</span>)]<br><span class="hljs-built_in">print</span>(P)<br><span class="hljs-built_in">print</span>(D[:<span class="hljs-number">75</span>])<br></code></pre></td></tr></table></figure><p>çŸ¥é“è¿™ä¸¤ä¸ªå°±æ¯”è¾ƒå®¹æ˜“äº†å‰©ä¸‹å¯ä»¥çœ‹æ³¨é‡Š</p><ul><li>ps:</li></ul><blockquote><p>å¤šæ•°äººçš„sagemathåº”è¯¥æ˜¯è£…åœ¨wslç­‰å…¶ä»–è™šæ‹Ÿç¯å¢ƒå¹³å°ä¸Šçš„ï¼Œå› ä¸ºè¿™ä¸ªé¢˜ç›®æ¯”è¾ƒæ¶ˆè€—å†…å­˜ï¼Œwslçš„å†…å­˜é»˜è®¤åªç»™6.5Gã€‚è¿™ä¸ªå·²çŸ¥20bitçš„è¿˜å¥½ï¼Œå¦‚æœæœªçŸ¥bitå¤ªå¤šæ¶ˆè€—å†…å­˜è‚¯å®šæ˜¯ä¸å¤Ÿçš„ã€‚å»ºè®®æŠŠwslå†…å­˜ä¸Šé™æ‹‰åˆ°16Gã€‚ç½‘ä¸Šæœ‰å¾ˆå¤šæ›´æ”¹æ•™ç¨‹è¿™é‡Œå°±ä¸è¯´äº†</p></blockquote><h3 id="tpctf-2025"><a href="#tpctf-2025" class="headerlink" title="tpctf 2025"></a>tpctf 2025</h3><p>æ¥ä¸‹æ¥å¯ä»¥çœ‹çœ‹ä¸€é“tpçš„ctfé¢˜ç›®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    flag=f.read()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">64</span>):<br>    <span class="hljs-built_in">print</span>(random.getrandbits(<span class="hljs-number">32</span>)+flag[random.getrandbits(<span class="hljs-number">32</span>)%<span class="hljs-built_in">len</span>(flag)])<br>    <span class="hljs-built_in">input</span>()<br>    <br></code></pre></td></tr></table></figure><p>è¿™é‡ŒæŠŠæœ€å8bitåŠ ä¸Šäº†å¦ä¸€ä¸ªéšæœºæ•°è¿›è¡Œäº†æ··æ·†ï¼Œä¸è¿‡ç»è¿‡æµ‹è¯•ï¼ŒåŠ æ³•å¯èƒ½ä¼šå½±å“20bitä»¥ä¸Šç”šè‡³æ›´é«˜ã€‚ä¸è¿‡åœ¨10000bitæ•°æ®ä»¥å†…å¤§å¤šå‡ºç°20bitä»¥ä¸Šæ•°æ®æ¦‚ç‡æ¯”è¾ƒå°ã€‚æˆ‘ä»¬è¿™é‡Œè®¾ç½®æ··æ·†çš„æ˜¯æœ«å°¾24bitå¹¶ä¸”æ˜¯é—´éš”è·å¾—ä¿¡æ¯ï¼Œè·å–ç¬¬ä¸€ä¸ªä¿¡æ¯åï¼Œåä¸€ä¸ªéšæœºæ•°å°±è¢«æ··æ·†æ‰äº†ã€‚æˆ‘ä»¬è¿™é‡Œå¯ä»¥è·å¾—2700ç»„éšæœºçš„æ•°æ®</p><p>æ„å»ºæ¢å¤stateçš„ä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br>n=<span class="hljs-number">2500</span><br>D=[]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(D))<br>rng=Random()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getRows</span>(<span class="hljs-params">rng</span>):<br>    row=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        row+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(rng.getrandbits(<span class="hljs-number">32</span>)&gt;&gt;<span class="hljs-number">24</span>)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>))))<br>        _=rng.getrandbits(<span class="hljs-number">32</span>)<br>    <span class="hljs-keyword">return</span> row<br>M=[]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">19968</span>)):<br>    state = [<span class="hljs-number">0</span>]*<span class="hljs-number">624</span><br>    temp = <span class="hljs-string">&quot;0&quot;</span>*i + <span class="hljs-string">&quot;1&quot;</span>*<span class="hljs-number">1</span> + <span class="hljs-string">&quot;0&quot;</span>*(<span class="hljs-number">19968</span>-<span class="hljs-number">1</span>-i)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>        state[j] = <span class="hljs-built_in">int</span>(temp[<span class="hljs-number">32</span>*j:<span class="hljs-number">32</span>*j+<span class="hljs-number">32</span>],<span class="hljs-number">2</span>)<br>    rng.setstate((<span class="hljs-number">3</span>,<span class="hljs-built_in">tuple</span>(state+[<span class="hljs-number">624</span>]),<span class="hljs-literal">None</span>)) <br>    M.append(getRows(rng))<br>M=Matrix(GF(<span class="hljs-number">2</span>),M)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¡Œæ•°:&quot;</span>, M.nrows())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;åˆ—æ•°:&quot;</span>, M.ncols())<br>r=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    r+=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, (<span class="hljs-built_in">bin</span>(D[i]&gt;&gt;<span class="hljs-number">24</span>)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">8</span>))))<br>r=vector(GF(<span class="hljs-number">2</span>),r)<br>y=M.solve_left(r)<br>G=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    C=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        C&lt;&lt;=<span class="hljs-number">1</span><br>        C|=<span class="hljs-built_in">int</span>(y[<span class="hljs-number">32</span>*i+j])<br>    G.append(C)<span class="hljs-comment">#å°†æ¢å¤çš„stateè½¬åŒ–ä¸ºæ¯ä¸ªå…ƒç´ 32bitçš„åˆ—è¡¨</span><br><span class="hljs-keyword">import</span> random<br>RNG1 = random.Random()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    G[i]=<span class="hljs-built_in">int</span>(G[i])<br>RNG1.setstate((<span class="hljs-built_in">int</span>(<span class="hljs-number">3</span>),<span class="hljs-built_in">tuple</span>(G+[<span class="hljs-built_in">int</span>(<span class="hljs-number">624</span>)]),<span class="hljs-literal">None</span>))<span class="hljs-comment">#å°†stateä½œä¸ºéšæœºæ•°ç”Ÿæˆå™¨çš„åˆå§‹çŠ¶æ€ï¼Œæµ‹è¯•ç”Ÿæˆçš„stateæ˜¯å¦æ­£ç¡®</span><br><br></code></pre></td></tr></table></figure><p>æ¢å¤å‡ºçŠ¶æ€åæˆ‘ä»¬å¯ä»¥å¾—åˆ°æœªè¢«æ··æ·†çš„éšæœºæ•°ã€‚æˆ‘ä»¬å…ˆå¯ä»¥åˆ©ç”¨çˆ†ç ´æ±‚å‡ºflagçš„é•¿åº¦å’Œflag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python">G=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>    G[i]=<span class="hljs-built_in">int</span>(G[i])<br>RNG1 = Random()<br>RNG1.setstate((<span class="hljs-built_in">int</span>(<span class="hljs-number">3</span>),<span class="hljs-built_in">tuple</span>(G+[<span class="hljs-built_in">int</span>(<span class="hljs-number">624</span>)]),<span class="hljs-literal">None</span>))<br><br>flag=[]<br>ind=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(X)):<br>    a = RNG1.getrandbits(<span class="hljs-number">32</span>)<br>    b = RNG1.getrandbits(<span class="hljs-number">32</span>)<br>    f = X[i]-a<br>    <span class="hljs-keyword">if</span> <span class="hljs-number">0</span> &lt; f &lt; <span class="hljs-number">255</span> :<br>        flag.append(f)<br>        ind.append(b)<br><span class="hljs-keyword">for</span> fl <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-built_in">set</span>(flag)),<span class="hljs-number">50</span>):<span class="hljs-comment">#flæ˜¯flagçš„é•¿åº¦ï¼Œåˆ©ç”¨çˆ†ç ´åˆ¤æ–­é•¿åº¦æ˜¯å¦ç¬¦åˆæ¡ä»¶</span><br>    TN = [i%fl <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ind]<br>    TF = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(fl):<br>        t = TN.index(i)<br>        TF.append(flag[t])<br>    TF =  <span class="hljs-built_in">bytes</span>(TF)<br>    <span class="hljs-keyword">if</span> TF[:<span class="hljs-number">6</span>]==(<span class="hljs-string">b&#x27;TPCTF&#123;&#x27;</span>):<br>       <span class="hljs-built_in">print</span>(TF)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hgame2025-week1 crypto</title>
    <link href="/2025/03/05/hgame%20week1/"/>
    <url>/2025/03/05/hgame%20week1/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="hgame-week1"><a href="#hgame-week1" class="headerlink" title="hgame week1"></a>hgame week1</h1><h2 id="sieve"><a href="#sieve" class="headerlink" title="sieve"></a>sieve</h2><p>é¢˜ç›®ä»£ç :</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> nextprime<br><br>FLAG = <span class="hljs-string">b&#x27;hgame&#123;xxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span><br>m = bytes_to_long(FLAG)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">trick</span>(<span class="hljs-params">k</span>):<br>    <span class="hljs-keyword">if</span> k &gt; <span class="hljs-number">1</span>:<br>        mul = prod(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,k)) <br>        <span class="hljs-keyword">if</span> k - mul % k - <span class="hljs-number">1</span> == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> euler_phi(k) + trick(k-<span class="hljs-number">1</span>) + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> euler_phi(k) + trick(k-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br><br>e = <span class="hljs-number">65537</span><br>p = q = nextprime(trick(e^<span class="hljs-number">2</span>//<span class="hljs-number">6</span>)&lt;&lt;<span class="hljs-number">128</span>)<br>n = p * q<br>enc = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;enc=&#125;</span>&#x27;</span>)<br><span class="hljs-comment">#enc=2449294097474714136530140099784592732766444481665278038069484466665506153967851063209402336025065476172617376546</span><br><br></code></pre></td></tr></table></figure><p>$k - mul (mod  k) - 1 &#x3D;&#x3D; 0$ è¿™é‡Œå…¶å®æ˜¯åˆ¤æ–­kæ˜¯å¦æ˜¯ç´ æ•°</p><p>æ ¹æ®å¨å°”é€Šå®šç†:å¦‚æœpæ˜¯ä¸€ä¸ªå¥‡ç´ æ•°æˆ–P&#x3D;2ï¼Œé‚£ä¹ˆæœ‰</p><p>$(p-1)!&#x3D;-1(mod p)$</p><p>è¯æ˜:</p><blockquote><p>è®¾xå’Œå®ƒçš„é€†å…ƒx<sup>-1</sup> å¦‚æœä»–ä»¬ç›¸ç­‰åˆ™æœ‰<br>$x^2&#x3D;1 mod pâ€”&gt;(x-1)(x+1)&#x3D;0mod p$</p><p>è¿™æ˜¯xåªèƒ½ç­‰äºp-1æˆ–1</p></blockquote><blockquote><p>p&#x3D;2æ—¶å€™ï¼Œæ˜¾ç„¶æˆç«‹</p><p>pæ˜¯å¥‡ç´ æ•°æ—¶ï¼š<br>mul&#x3D;1*2â€¦*(p-2)*(p-1)</p><p>p-1&#x3D;-1(mod p)</p><p>å¹¶ä¸”å¯¹åº”A&#x3D;0,1,2..,(p-1)æ˜¯ä¸€ä¸ªå®Œå…¨çš„å‰©ä½™ç³»</p><p>ä»è¿™ä¸ªå®Œå…¨å‰©ä½™ç³»é‡Œé¢æ’é™¤0,1,p-1ã€‚å¾—åˆ°B&#x3D;2,3,â€¦,p-2</p><p>åœ¨Bå†…æœ‰å¶æ•°ä¸ªå…ƒç´ ï¼Œå¹¶ä¸”éƒ½ä¸päº’ç´ ï¼Œå¹¶ä¸”æ¯ä¸¤ä¸ªäº’é€†çš„å…ƒç´ é…å¯¹é‚£ä¹ˆ</p><p>åˆ™æœ‰ m&#x3D;2*3*â€¦p-2,m &#x3D;1 mod p</p><p>åˆ™$(p-1)!&#x3D;-1(mod p)$</p></blockquote><p>æ‰€ä»¥è¿™ä¸ªé€’å½’æ–¹ç¨‹æœ€åè¿”å›çš„trick(e^2&#x2F;&#x2F;6)&#x3D;1åˆ°p-1æ‰€æœ‰æ•°çš„æ¬§æ‹‰å‡½æ•°+pä»¥å†…ç´ æ•°çš„ä¸ªæ•°ï¼Œå¦‚æœç›´æ¥å¼ºåˆ¶çˆ†ç ´ä¸–ç•Œå¤æ‚åº¦è¿‡é«˜ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨ç­›æ³•æ¥åšã€‚ æˆ‘è‡ªå·±æå¾—ç­›æ³•æ•ˆç‡å¤ªä½äº†äº†è¦ä¸€ä¸ªå°æ—¶ï¼Œè¿™é‡Œæˆ‘ä»¬åˆ†æå®˜æ–¹çš„ä»£ç ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;boost/multiprecision/cpp_int.hpp&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> boost::multiprecision;<br><br><span class="hljs-comment">// ä½¿ç”¨ç­›é€‰æ³•è®¡ç®—æ¬§æ‹‰å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">sieve_euler_phi</span><span class="hljs-params">(cpp_int n, vector&lt;cpp_int&gt;&amp; phi)</span> </span>&#123;<br>    phi.<span class="hljs-built_in">resize</span>(<span class="hljs-built_in">static_cast</span>&lt;std::<span class="hljs-type">size_t</span>&gt;(n + <span class="hljs-number">1</span>));<br><br>    <span class="hljs-keyword">for</span> (cpp_int i = <span class="hljs-number">0</span>; i &lt;= n; ++i) &#123;<br>        phi[<span class="hljs-built_in">static_cast</span>&lt;std::<span class="hljs-type">size_t</span>&gt;(i)] = i;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (cpp_int i = <span class="hljs-number">2</span>; i &lt;= n; ++i) &#123;<br><br>        <span class="hljs-keyword">if</span> (phi[<span class="hljs-built_in">static_cast</span>&lt;std::<span class="hljs-type">size_t</span>&gt;(i)] == i) &#123; <span class="hljs-comment">// iæ˜¯è´¨æ•°</span><br>            <span class="hljs-keyword">for</span> (cpp_int j = i; j &lt;= n; j += i) &#123;<br>                phi[<span class="hljs-built_in">static_cast</span>&lt;std::<span class="hljs-type">size_t</span>&gt;(j)] = phi[<span class="hljs-built_in">static_cast</span>&lt;std::<span class="hljs-type">size_t</span>&gt;(j)] * (i - <span class="hljs-number">1</span>) / i;<br>            &#125;<br>        &#125;<br>        <br>        <span class="hljs-keyword">if</span> (i % <span class="hljs-number">100000000</span> == <span class="hljs-number">0</span>) &#123; <span class="hljs-comment">// æ¯è®¡ç®—100000ä¸ªæ•°è¾“å‡ºä¸€æ¬¡è¿›åº¦</span><br><br>            cout &lt;&lt; <span class="hljs-string">&quot;Sieved up to &quot;</span> &lt;&lt; i.<span class="hljs-built_in">str</span>() &lt;&lt; endl;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    cpp_int n = <span class="hljs-number">715849728</span>; <br>    vector&lt;cpp_int&gt; phi;<br><br>    <span class="hljs-built_in">sieve_euler_phi</span>(n, phi);<br><br>    cpp_int result = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (cpp_int i = <span class="hljs-number">1</span>; i &lt;= n; ++i) &#123;<br>        result += phi[<span class="hljs-built_in">static_cast</span>&lt;std::<span class="hljs-type">size_t</span>&gt;(i)];<br>        <span class="hljs-keyword">if</span> (phi[<span class="hljs-built_in">static_cast</span>&lt;std::<span class="hljs-type">size_t</span>&gt;(i)] == i - <span class="hljs-number">1</span>) &#123; <span class="hljs-comment">// iæ˜¯è´¨æ•°</span><br>            result += <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;Calculated trick(&quot;</span> &lt;&lt; n.<span class="hljs-built_in">str</span>() &lt;&lt; <span class="hljs-string">&quot;): &quot;</span> &lt;&lt; result.<span class="hljs-built_in">str</span>() &lt;&lt; endl;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>æ›´ç®€æ´çš„æ–¹æ³•æˆ‘ä»¬åˆ†å¼€æ¥çœ‹,åˆ©ç”¨äº†æœæ•™ç­›</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br>e = <span class="hljs-number">65537</span><br>n=(e * e) // <span class="hljs-number">6</span><br>cache=<span class="hljs-literal">None</span><br><span class="hljs-keyword">if</span> cache <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>    cache=&#123;&#125;<br><span class="hljs-keyword">if</span> n <span class="hljs-keyword">in</span> cache:<br>    <span class="hljs-built_in">print</span>(cache[n])<br><span class="hljs-keyword">if</span> n&lt;<span class="hljs-number">1</span>:<br>    <span class="hljs-built_in">print</span>(n,<span class="hljs-string">&#x27;=0&#x27;</span>)<br>pre_max=<span class="hljs-built_in">min</span>(n,<span class="hljs-number">10</span>**<span class="hljs-number">6</span>)<br><span class="hljs-built_in">print</span>(pre_max)<br>phi =<span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(pre_max+<span class="hljs-number">1</span>))<br><br><span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>,pre_max+<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">if</span> phi[p]==p:<br>        <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(p,pre_max+<span class="hljs-number">1</span>,p):<br>            phi[m] -= phi[m] // p<span class="hljs-comment">#è¿™é‡Œæ˜¯ç”¨äºè¾…åŠ©è®¡ç®—ï¼Œå¤„ç†å°äº10**6ä½æ—¶çš„æƒ…å†µ</span><br></code></pre></td></tr></table></figure><h3 id="ç­›æ³•"><a href="#ç­›æ³•" class="headerlink" title="ç­›æ³•"></a>ç­›æ³•</h3><p>è¿™é‡Œç”¨åˆ°çš„ä¸ç®—æ™®é€šçš„æ¬§æ‹‰ç­›é€‰ï¼Œè€Œæ˜¯åˆ©ç”¨äº†æœæ•™ç­›</p><h3 id="æœæ•™ç­›"><a href="#æœæ•™ç­›" class="headerlink" title="æœæ•™ç­›"></a>æœæ•™ç­›</h3><p>é€‚ç”¨äºæ•°è®ºä¸­çš„ç§¯æ€§å‡½æ•°ï¼ˆæ¬§æ‹‰å‡½æ•°ä¾¿æ˜¯ä¸€ç§ç§¯æ€§å‡½æ•°ï¼‰</p><ul><li>ç§¯æ€§å‡½æ•°ã€</li></ul><blockquote><p>è‹¥gcd(m,n)&#x3D;1</p><p>f(m*n)&#x3D;f(m)*f(n)ï¼Œå…·ä½“çš„æœæ•™ç­›å¤ç°æ–‡ç« ä¸å¤šè§£é‡Šï¼Œæˆ‘ä¹Ÿä¸æ˜¯å¾ˆä¼šIoçš„è¿™äº›(æˆ‘å¤ªèœäº†)</p></blockquote><ul><li>åˆ©ç”¨è¯æ˜ï¼ˆè¿˜éœ€è¦äº†è§£ï¼Œç¹åæ¼”å·ç§¯è¿™äº›ï¼Œå†…å®¹å¤ªå¤šäº†ï¼Œæˆ‘ä¹Ÿä¸ç®—å¾ˆä¼šã€‚å°±çŸ¥é“æ€ä¹ˆç”¨å§</li></ul><p>è¿™é‡Œè´´ä¸€ç¯‡ç›¸å…³æ–‡ç« <a href="https://www.cnblogs.com/peng-ym/p/9446555.html">æœæ•™ç­› - pengym - åšå®¢å›­</a></p><p>æˆ‘ä»¬ä¾¿å¯ä»¥å¾—å‡ºæˆ‘ä»¬è¦æ±‚çš„nä»¥å†…çš„æ‰€æœ‰æ¬§æ‹‰å‡½æ•°çš„å’Œ$S(n)&#x3D;n(n+1)&#x2F;2-\sum^n_{k&#x3D;2}S([n&#x2F;k])$</p><p>é¢˜ç›®ä»£ç :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sum_euler_phi</span>(<span class="hljs-params">n, cache=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> cache <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        cache = &#123;&#125;<br>    <span class="hljs-keyword">if</span> n <span class="hljs-keyword">in</span> cache:<br>        <span class="hljs-keyword">return</span> cache[n]<br>    <span class="hljs-keyword">if</span> n &lt; <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>    <span class="hljs-comment"># é¢„å¤„ç†å°èŒƒå›´çš„æ¬§æ‹‰å‡½æ•°</span><br>    pre_max = <span class="hljs-built_in">min</span>(n, <span class="hljs-number">10</span>**<span class="hljs-number">6</span>)<br>    phi = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(pre_max + <span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, pre_max + <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> phi[p] == p:  <span class="hljs-comment"># pæ˜¯ç´ æ•°</span><br>            <span class="hljs-keyword">for</span> multiple <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(p, pre_max + <span class="hljs-number">1</span>, p):<br>                phi[multiple] -= phi[multiple] // p<br>    <span class="hljs-comment"># è®¡ç®—å‰ç¼€å’Œ</span><br>    s_phi = [<span class="hljs-number">0</span>] * (pre_max + <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, pre_max + <span class="hljs-number">1</span>):<br>        s_phi[i] = s_phi[i - <span class="hljs-number">1</span>] + phi[i]<br>    <span class="hljs-comment"># åˆ†å—é€’å½’å¤„ç†å¤§èŒƒå›´</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">helper</span>(<span class="hljs-params">n</span>):<br>        a=[]<br>        <span class="hljs-keyword">if</span> n &lt;= pre_max:<br>            <span class="hljs-keyword">return</span> s_phi[n]<br>        res = n * (n + <span class="hljs-number">1</span>) // <span class="hljs-number">2</span><br>        k = <span class="hljs-number">2</span><br>        <span class="hljs-keyword">while</span> k &lt;= n:<br>            m = n // k<br>            next_k = n//m  + <span class="hljs-number">1</span><br>            res -= (next_k - k) * helper(m)<br>            k = next_k<br><br>        <span class="hljs-keyword">return</span> res<br>    result = helper(n)<br>    cache[n] = result<br>    <span class="hljs-keyword">return</span> result<br><br>e = <span class="hljs-number">65537</span><br>k = (e * e) // <span class="hljs-number">6</span><br>sum_phi = sum_euler_phi(k)<br>prime_count = primepi(k)<br>trick_value = sum_phi + prime_count<br><br>shifted_value = trick_value &lt;&lt; <span class="hljs-number">128</span><br>p = nextprime(shifted_value)<br>n = p * p  <span class="hljs-comment"># å› ä¸º p = q</span><br>phi = p * (p - <span class="hljs-number">1</span>)<br>d = invert(e, phi)<br>enc = <span class="hljs-number">2449294097474714136530140099784592732766444481665278038069484466665506153967851063209402336025065476172617376546</span><br>m = <span class="hljs-built_in">pow</span>(enc, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m).decode())<br></code></pre></td></tr></table></figure><h3 id="superrsa"><a href="#superrsa" class="headerlink" title="superrsa"></a>superrsa</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> prime<br> <br>FLAG=<span class="hljs-string">b&#x27;hgame&#123;xxxxxxxxxxxxxxxxxx&#125;&#x27;</span><br>e=<span class="hljs-number">0x10001</span><br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">primorial</span>(<span class="hljs-params">num</span>):<br>    result = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, num + <span class="hljs-number">1</span>):<br>        result *= prime(i)  <span class="hljs-comment">#å–å‰numä¸ªç´ æ•°ç›¸ä¹˜</span><br>    <span class="hljs-keyword">return</span> result<br>M=primorial(random.choice([<span class="hljs-number">39</span>,<span class="hljs-number">71</span>,<span class="hljs-number">126</span>]))  <span class="hljs-comment">#39</span><br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_key</span>():<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        k = getPrime(random.randint(<span class="hljs-number">20</span>,<span class="hljs-number">40</span>))<br>        a = getPrime(random.randint(<span class="hljs-number">20</span>,<span class="hljs-number">60</span>))<br>        p = k * M + <span class="hljs-built_in">pow</span>(e, a, M)<br>        <span class="hljs-keyword">if</span> isPrime(p):<br>            <span class="hljs-keyword">return</span> p<br> <br>p,q=gen_key(),gen_key()<br>n=p*q<br>m=bytes_to_long(FLAG)<br>enc=<span class="hljs-built_in">pow</span>(m,e,n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;n=&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;enc=&#125;</span>&#x27;</span>)<br> <br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">n=787190064146025392337631797277972559696758830083248285626115725258876808514690830730702705056550628756290183000265129340257928314614351263713241</span><br><span class="hljs-string">enc=365164788284364079752299551355267634718233656769290285760796137651769990253028664857272749598268110892426683253579840758552222893644373690398408</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€é“rocaçš„æ¿å­é¢˜ï¼ŒåŸç†ä¸å¤ªç†è§£ï¼Œå¥—æ¨¡æ¿å§</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#p,q=k*M+(65537**a %M)</span><br> <br><span class="hljs-comment"># Hardcoded parameters for efficiency</span><br><span class="hljs-comment"># Found using params.py</span><br>param = \<br>&#123;<br>  <span class="hljs-number">512</span>: &#123;<br>    <span class="hljs-string">&quot;n&quot;</span>: <span class="hljs-number">39</span>,<br>    <span class="hljs-string">&quot;a_max&quot;</span>: <span class="hljs-number">62</span>,<br>    <span class="hljs-string">&quot;k_max&quot;</span>: <span class="hljs-number">37</span>,<br>    <span class="hljs-string">&quot;M&quot;</span>: <span class="hljs-number">0x924cba6ae99dfa084537facc54948df0c23da044d8cabe0edd75bc6</span>,<br>    <span class="hljs-string">&quot;M_prime&quot;</span>: <span class="hljs-number">0x1b3e6c9433a7735fa5fc479ffe4027e13bea</span>,<br>    <span class="hljs-string">&quot;m&quot;</span>: <span class="hljs-number">5</span>,<br>    <span class="hljs-string">&quot;t&quot;</span>: <span class="hljs-number">6</span>,<br>    <span class="hljs-string">&quot;c_a&quot;</span>: <span class="hljs-number">0x80000</span><br>  &#125;<br>&#125;<br> <br><span class="hljs-comment"># https://github.com/mimoo/RSA-and-LLL-attacks/blob/master/coppersmith.sage</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">coppersmith_howgrave_univariate</span>(<span class="hljs-params">pol, N, beta, mm, tt, XX</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Coppersmith revisited by Howgrave-Graham</span><br><span class="hljs-string">    finds a solution if:</span><br><span class="hljs-string">    * b|N, b &gt;= N^beta , 0 &lt; beta &lt;= 1</span><br><span class="hljs-string">    * |x| &lt; XX</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment">#</span><br>    <span class="hljs-comment"># init</span><br>    <span class="hljs-comment">#</span><br>    dd = pol.degree()<br>    nn = dd * mm + tt<br> <br>    <span class="hljs-comment">#</span><br>    <span class="hljs-comment"># checks</span><br>    <span class="hljs-comment">#</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-number">0</span> &lt; beta &lt;= <span class="hljs-number">1</span> :<br>        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;beta should belongs in (0, 1]&quot;</span>)<br> <br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> pol.is_monic():<br>        <span class="hljs-keyword">raise</span> ArithmeticError(<span class="hljs-string">&quot;Polynomial must be monic.&quot;</span>)<br> <br> <br>    <span class="hljs-comment">#</span><br>    <span class="hljs-comment"># Coppersmith revisited algo for univariate</span><br>    <span class="hljs-comment">#</span><br> <br>    <span class="hljs-comment"># change ring of pol and x</span><br>    polZ = pol.change_ring(ZZ)<br>    x = polZ.parent().gen()<br> <br>    <span class="hljs-comment"># compute polynomials</span><br>    gg = []<br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(mm):<br>        <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(dd):<br>            gg.append((x * XX)**jj * N**(mm - ii) * polZ(x * XX)**ii)<br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(tt):<br>        gg.append((x * XX)**ii * polZ(x * XX)**mm)<br> <br>    <span class="hljs-comment"># construct lattice B</span><br>    BB = Matrix(ZZ, nn)<br> <br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn):<br>        <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ii+<span class="hljs-number">1</span>):<br>            BB[ii, jj] = gg[ii][jj]<br> <br>    <span class="hljs-comment"># LLL</span><br>    BB = BB.LLL(early_red=<span class="hljs-literal">True</span>, use_siegel=<span class="hljs-literal">True</span>)<br> <br>    <span class="hljs-comment"># transform shortest vector in polynomial</span><br>    new_pol = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn):<br>        new_pol += x**ii * BB[<span class="hljs-number">0</span>, ii] / XX**ii<br> <br>    <span class="hljs-comment"># factor polynomial</span><br>    potential_roots = new_pol.roots()<br> <br>    <span class="hljs-keyword">return</span> [i[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> potential_roots]<br> <br><span class="hljs-comment"># Top level of the attack, feeds the queue for the workers</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">roca</span>(<span class="hljs-params">N</span>):<br> <br>  <span class="hljs-comment"># Key is not always of perfect size, infer from size</span><br>  keylength = <span class="hljs-built_in">int</span>(log(N, <span class="hljs-number">2</span>))<br>  <span class="hljs-keyword">if</span> keylength &lt; <span class="hljs-number">1000</span> :<br>    keylength = <span class="hljs-number">512</span><br>  <span class="hljs-keyword">elif</span>  keylength &lt; <span class="hljs-number">2000</span> :<br>    keylength = <span class="hljs-number">1024</span><br>  <span class="hljs-keyword">elif</span> keylength &lt; <span class="hljs-number">4000</span> :<br>    keylength = <span class="hljs-number">2048</span><br>  <span class="hljs-keyword">else</span>:<br>    keylength = <span class="hljs-number">4096</span><br> <br>  <span class="hljs-comment"># bruteforce</span><br>  M_prime = param[keylength][<span class="hljs-string">&#x27;M_prime&#x27;</span>]<br>  c_prime = discrete_log(N, Mod(<span class="hljs-number">65537</span>, M_prime))<br>  ord_prime = Zmod(M_prime)(<span class="hljs-number">65537</span>).multiplicative_order()<br>  top = (c_prime + ord_prime)/<span class="hljs-number">2</span><br>  beta = <span class="hljs-number">0.5</span><br>  mm = param[keylength][<span class="hljs-string">&#x27;m&#x27;</span>]<br>  tt = param[keylength][<span class="hljs-string">&#x27;t&#x27;</span>]<br> <br>  XX = <span class="hljs-built_in">int</span>((<span class="hljs-number">2</span>*<span class="hljs-built_in">pow</span>(N, beta)) / M_prime)<br> <br>  <span class="hljs-comment"># Bruteforce until p, q are found</span><br>  a_prime = floor(c_prime/<span class="hljs-number">2</span>)<br>  <span class="hljs-keyword">while</span> a_prime &lt; top:<br> <br>      <span class="hljs-comment"># Construct polynomial</span><br>      m_inv = <span class="hljs-built_in">int</span>(inverse_mod(M_prime, N))<br>      k_tmp = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(<span class="hljs-number">65537</span>, a_prime, M_prime))<br>      known_part_pol = <span class="hljs-built_in">int</span>(k_tmp * m_inv)<br>      F = PolynomialRing(Zmod(N), implementation=<span class="hljs-string">&#x27;NTL&#x27;</span>, names=(<span class="hljs-string">&#x27;x&#x27;</span>,))<br>      (x,) = F._first_ngens(<span class="hljs-number">1</span>)<br>      pol = x + known_part_pol<br> <br>      <span class="hljs-comment"># Get roots of polynomial using coppersmith</span><br>      roots = coppersmith_howgrave_univariate(pol, N, beta, mm, tt, XX)<br> <br>      <span class="hljs-comment"># Check if roots are p, q</span><br>      <span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> roots:<br>        factor1 = k_tmp + <span class="hljs-built_in">abs</span>(root) * M_prime<br>        <span class="hljs-keyword">if</span> mod(N, factor1) == <span class="hljs-number">0</span>:<br>          factor2 = N // factor1<br>          <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(factor1), <span class="hljs-built_in">int</span>(factor2)<br>      a_prime += <span class="hljs-number">1</span><br> <br> <br> <br>N=<span class="hljs-number">787190064146025392337631797277972559696758830083248285626115725258876808514690830730702705056550628756290183000265129340257928314614351263713241</span><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;[+] Factoring %i&quot;</span> % N)<br> <br>factor1, factor2 = roca(N)<br> <br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;[+] Found factors of N:&quot;</span>)<br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;[+] p =&quot;</span> , factor1)<br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;[+] q =&quot;</span> , factor2)<br></code></pre></td></tr></table></figure><h3 id="ez-bag"><a href="#ez-bag" class="headerlink" title="ez_bag"></a>ez_bag</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs routeros">import random<br>import copy<br><span class="hljs-keyword">from</span> Crypto.Util.number import getPrime<br><span class="hljs-keyword">from</span> paramiko.util import bit_length<br><br>L=[]<br>list = []<br>bag = []<br><span class="hljs-attribute">p</span>=getPrime(16)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(1):<br>    t = p<br>    a=[getPrime(20) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(16)]<br>    <span class="hljs-attribute">b</span>=0<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> a:<br>        <span class="hljs-attribute">temp</span>=t%2<br>        b+=temp*j<br>        <span class="hljs-attribute">t</span>=t&gt;&gt;1<br>    <span class="hljs-attribute">A</span>=copy.deepcopy(a)<br>    list.append(a)<br>    L.append(A)<br>    L[i].append(b)<br><br>    bag.append(b)<br><span class="hljs-built_in">print</span>(bin(p))<br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-built_in">print</span>(f<span class="hljs-string">&#x27;list=&#123;list&#125;&#x27;</span>)<br><span class="hljs-built_in">print</span>(f<span class="hljs-string">&#x27;S=&#123;bag&#125;&#x27;</span>)<br><span class="hljs-built_in">print</span>(f<span class="hljs-string">&#x27;L=&#123;L&#125;&#x27;</span>)<br><span class="hljs-built_in">print</span>(bin(p))<br><span class="hljs-comment"># è¿™é‡Œæ˜¯æˆ‘ç”¨æ¥ç”Ÿæˆï¼ˆå¤šç»´ï¼‰å­é›†å’Œçš„pythonä»£ç </span><br></code></pre></td></tr></table></figure><p>ç®€å•çš„å¤šç»´å­é›†å’Œï¼Œå½“æ—¶è¿˜å¡äº†æŒºä¹…çš„ä¸è¿‡ç¡®å®å­¦åˆ°å¾ˆå¤š</p><p>[<a href="https://xz.aliyun.com/news/16929?time__1311=eqUxnDRD0Dg0i=DCYD/Wn+OGzN0QqQrKQ74D&u_atoken=b3c9c0fbbc78a1e94826c0bd7a8d5542&u_asig=0a472f9217412553212422014e0034">æ–‡ç«  - å­é›†å’Œé—®é¢˜çš„ä¸¤ç§è§£å†³æ–¹å¼ - å…ˆçŸ¥ç¤¾åŒº</a>]ï¼Œèµ›åæˆ‘å†™äº†ä¸€ç¯‡æ–‡ç« æœ‰å¾ˆæ¸…æ¥šçš„è®²è§£ï¼Œè¿˜æœ‰è§£é¢˜ä»£ç </p><h1 id="GHctfâ€“rsa-feirema"><a href="#GHctfâ€“rsa-feirema" class="headerlink" title="GHctfâ€“rsa feirema"></a>GHctfâ€“rsa feirema</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, bytes_to_long<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> f<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;test_flag&#125;&#x27;</span><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p*q<br><br>m = bytes_to_long(flag)<br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><br>R.&lt;x&gt; = ZZ[]<br>f = R(<span class="hljs-built_in">str</span>(f))<br><br>w = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,f(p),n)<br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;n = &#125;</span>\n&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;e = &#125;</span>\n&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c = &#125;</span>\n&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;f = &#125;</span>\n&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;w = &#125;</span>\n&#x27;</span>)<br><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 101780569941880865465631942473186578520071435753163950944409148606282910806650879176280021512435190682009749926285674412651435782567149633130455645157688819845748439487113261739503325065997835517112163014056297017874761742768297646567397770742374004940360061700285170103292360590891188591132054903101398360047</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 77538275949900942020886849496162539665323546686749270705418870515132296087721218282974435210763225488530925782158331269160555819622551413648073293857866671421886753377970220838141826468831099375757481041897142546760492813343115244448184595644585857978116766199800311200819967057790401213156560742779242511746</span><br><span class="hljs-string">f = 2*x^332 - x^331 + x^329 + 3*x^328 - x^327 - 3*x^325 + x^323 - 3*x^322 - x^321 - 3*x^320 + x^319 + 2*x^318 - 4*x^317 - 3*x^315 - 2*x^314 + x^313 + x^312 + 2*x^311 + 2*x^309 + 2*x^308 + 5*x^307 + 2*x^306 + 3*x^305 + 5*x^304 + 4*x^303 + x^302 - x^301 - x^300 - 2*x^299 - 2*x^298 + x^297 + 3*x^296 - x^295 - 4*x^292 - x^290 + 4*x^289 - x^287 - 3*x^286 + x^285 - 2*x^284 + x^283 - x^282 - 2*x^281 + x^280 - 2*x^279 + x^278 + 2*x^277 - 3*x^276 - x^275 - 4*x^274 - 3*x^273 - 5*x^272 - 2*x^271 - 3*x^270 + 2*x^269 + 2*x^268 - x^267 - 2*x^266 + x^265 + x^264 - 3*x^262 - 3*x^259 + 2*x^258 - x^257 + 2*x^256 + 2*x^255 - x^254 - 2*x^253 - x^252 + 2*x^251 - x^250 + x^249 + 2*x^247 + 2*x^246 + 2*x^245 - 2*x^244 - 3*x^243 + 2*x^242 - 3*x^241 - x^240 - 3*x^239 - x^236 - 3*x^235 - 2*x^234 - x^233 - 2*x^232 - x^231 - 3*x^230 - 2*x^229 - 4*x^228 - 2*x^227 - 3*x^226 + 2*x^225 + x^224 - x^223 - 2*x^221 + 3*x^219 - x^217 - 2*x^216 + x^215 + 2*x^213 - x^212 + 3*x^211 + x^210 + 4*x^209 + x^208 - x^206 - x^205 - x^204 + 2*x^203 - 3*x^202 + 2*x^199 - x^198 + 2*x^196 - 2*x^195 + 3*x^194 + 3*x^193 - x^192 + 4*x^191 + 2*x^189 + x^186 - x^185 - x^184 + 3*x^183 + x^182 + 2*x^181 - 2*x^180 + x^177 + x^175 - x^173 + 3*x^172 + x^170 + x^169 - x^167 - 2*x^166 - x^165 - 4*x^164 - 2*x^163 + 2*x^162 + 4*x^161 - 2*x^160 - 3*x^159 - 2*x^158 - 2*x^157 + x^156 - x^155 + 3*x^154 - 4*x^153 + x^151 + 2*x^150 + x^149 - x^148 + 2*x^147 + 3*x^146 + 2*x^145 - 4*x^144 - 4*x^143 + x^142 - 2*x^140 - 2*x^139 + 2*x^138 + 3*x^137 + 3*x^136 + 3*x^135 + x^134 - x^133 + 2*x^132 + 3*x^130 - 3*x^129 - 2*x^128 - x^127 - 2*x^126 + x^125 + x^124 - 2*x^123 + x^122 - x^121 + 3*x^120 - x^119 - 2*x^118 - x^117 - x^116 - 2*x^115 + 2*x^114 + 2*x^113 - 3*x^112 - x^111 - 4*x^110 + x^109 + x^108 + x^106 - 4*x^105 + x^104 - x^103 - x^101 + x^100 - 2*x^99 + x^98 - x^97 + 3*x^96 + 3*x^94 - x^93 - x^92 + x^91 - 2*x^90 + x^89 - x^88 + x^87 - x^86 + x^85 + x^84 - x^83 + x^79 - 3*x^78 - 2*x^77 + x^74 + 3*x^73 - x^72 - 3*x^71 - 2*x^70 + x^69 - 3*x^66 + x^65 + x^64 - 4*x^62 - x^61 + x^60 - x^59 + 3*x^58 - x^57 - x^54 + 3*x^53 + x^51 - 3*x^50 - x^49 + 2*x^47 - x^46 - x^44 + x^43 - x^42 - 4*x^41 - 3*x^39 - x^37 - x^36 - 3*x^35 + x^34 + x^33 - 2*x^32 + 2*x^31 - x^30 + 2*x^29 - 2*x^28 - 2*x^27 - x^24 + x^22 - 5*x^21 + 3*x^20 + 2*x^19 - x^18 + 2*x^17 + x^16 - 2*x^15 - 2*x^14 + x^13 + x^12 + 2*x^11 - 3*x^10 + 3*x^9 + 2*x^8 - 4*x^6 - 2*x^5 - 4*x^4 + x^3 - x^2 - 1</span><br><span class="hljs-string">w = 32824596080441735190523997982799829197530203904568086251690542244969244071312854874746142497647579310192994177896837383837384405062036521829088599595750902976191010000575697075792720479387771945760107268598283406893094243282498381006464103080551366587157561686900620059394693185990788592220509670478190685244</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><ul><li>è§£é¢˜ä»£ç </li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">101780569941880865465631942473186578520071435753163950944409148606282910806650879176280021512435190682009749926285674412651435782567149633130455645157688819845748439487113261739503325065997835517112163014056297017874761742768297646567397770742374004940360061700285170103292360590891188591132054903101398360047</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">77538275949900942020886849496162539665323546686749270705418870515132296087721218282974435210763225488530925782158331269160555819622551413648073293857866671421886753377970220838141826468831099375757481041897142546760492813343115244448184595644585857978116766199800311200819967057790401213156560742779242511746</span><br>w = <span class="hljs-number">32824596080441735190523997982799829197530203904568086251690542244969244071312854874746142497647579310192994177896837383837384405062036521829088599595750902976191010000575697075792720479387771945760107268598283406893094243282498381006464103080551366587157561686900620059394693185990788592220509670478190685244</span><br><br><span class="hljs-comment"># å®šä¹‰å¤šé¡¹å¼å¹¶è®¡ç®—f(1)</span><br>R.&lt;x&gt; = ZZ[]<br>f = <span class="hljs-number">2</span>*x^<span class="hljs-number">332</span> - x^<span class="hljs-number">331</span> + x^<span class="hljs-number">329</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">328</span> - x^<span class="hljs-number">327</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">325</span> + x^<span class="hljs-number">323</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">322</span> - x^<span class="hljs-number">321</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">320</span> + x^<span class="hljs-number">319</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">318</span> - <span class="hljs-number">4</span>*x^<span class="hljs-number">317</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">315</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">314</span> + x^<span class="hljs-number">313</span> + x^<span class="hljs-number">312</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">311</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">309</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">308</span> + <span class="hljs-number">5</span>*x^<span class="hljs-number">307</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">306</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">305</span> + <span class="hljs-number">5</span>*x^<span class="hljs-number">304</span> + <span class="hljs-number">4</span>*x^<span class="hljs-number">303</span> + x^<span class="hljs-number">302</span> - x^<span class="hljs-number">301</span> - x^<span class="hljs-number">300</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">299</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">298</span> + x^<span class="hljs-number">297</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">296</span> - x^<span class="hljs-number">295</span> - <span class="hljs-number">4</span>*x^<span class="hljs-number">292</span> - x^<span class="hljs-number">290</span> + <span class="hljs-number">4</span>*x^<span class="hljs-number">289</span> - x^<span class="hljs-number">287</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">286</span> + x^<span class="hljs-number">285</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">284</span> + x^<span class="hljs-number">283</span> - x^<span class="hljs-number">282</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">281</span> + x^<span class="hljs-number">280</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">279</span> + x^<span class="hljs-number">278</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">277</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">276</span> - x^<span class="hljs-number">275</span> - <span class="hljs-number">4</span>*x^<span class="hljs-number">274</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">273</span> - <span class="hljs-number">5</span>*x^<span class="hljs-number">272</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">271</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">270</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">269</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">268</span> - x^<span class="hljs-number">267</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">266</span> + x^<span class="hljs-number">265</span> + x^<span class="hljs-number">264</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">262</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">259</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">258</span> - x^<span class="hljs-number">257</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">256</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">255</span> - x^<span class="hljs-number">254</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">253</span> - x^<span class="hljs-number">252</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">251</span> - x^<span class="hljs-number">250</span> + x^<span class="hljs-number">249</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">247</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">246</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">245</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">244</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">243</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">242</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">241</span> - x^<span class="hljs-number">240</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">239</span> - x^<span class="hljs-number">236</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">235</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">234</span> - x^<span class="hljs-number">233</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">232</span> - x^<span class="hljs-number">231</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">230</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">229</span> - <span class="hljs-number">4</span>*x^<span class="hljs-number">228</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">227</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">226</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">225</span> + x^<span class="hljs-number">224</span> - x^<span class="hljs-number">223</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">221</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">219</span> - x^<span class="hljs-number">217</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">216</span> + x^<span class="hljs-number">215</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">213</span> - x^<span class="hljs-number">212</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">211</span> + x^<span class="hljs-number">210</span> + <span class="hljs-number">4</span>*x^<span class="hljs-number">209</span> + x^<span class="hljs-number">208</span> - x^<span class="hljs-number">206</span> - x^<span class="hljs-number">205</span> - x^<span class="hljs-number">204</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">203</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">202</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">199</span> - x^<span class="hljs-number">198</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">196</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">195</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">194</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">193</span> - x^<span class="hljs-number">192</span> + <span class="hljs-number">4</span>*x^<span class="hljs-number">191</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">189</span> + x^<span class="hljs-number">186</span> - x^<span class="hljs-number">185</span> - x^<span class="hljs-number">184</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">183</span> + x^<span class="hljs-number">182</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">181</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">180</span> + x^<span class="hljs-number">177</span> + x^<span class="hljs-number">175</span> - x^<span class="hljs-number">173</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">172</span> + x^<span class="hljs-number">170</span> + x^<span class="hljs-number">169</span> - x^<span class="hljs-number">167</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">166</span> - x^<span class="hljs-number">165</span> - <span class="hljs-number">4</span>*x^<span class="hljs-number">164</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">163</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">162</span> + <span class="hljs-number">4</span>*x^<span class="hljs-number">161</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">160</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">159</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">158</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">157</span> + x^<span class="hljs-number">156</span> - x^<span class="hljs-number">155</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">154</span> - <span class="hljs-number">4</span>*x^<span class="hljs-number">153</span> + x^<span class="hljs-number">151</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">150</span> + x^<span class="hljs-number">149</span> - x^<span class="hljs-number">148</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">147</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">146</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">145</span> - <span class="hljs-number">4</span>*x^<span class="hljs-number">144</span> - <span class="hljs-number">4</span>*x^<span class="hljs-number">143</span> + x^<span class="hljs-number">142</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">140</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">139</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">138</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">137</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">136</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">135</span> + x^<span class="hljs-number">134</span> - x^<span class="hljs-number">133</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">132</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">130</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">129</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">128</span> - x^<span class="hljs-number">127</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">126</span> + x^<span class="hljs-number">125</span> + x^<span class="hljs-number">124</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">123</span> + x^<span class="hljs-number">122</span> - x^<span class="hljs-number">121</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">120</span> - x^<span class="hljs-number">119</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">118</span> - x^<span class="hljs-number">117</span> - x^<span class="hljs-number">116</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">115</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">114</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">113</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">112</span> - x^<span class="hljs-number">111</span> - <span class="hljs-number">4</span>*x^<span class="hljs-number">110</span> + x^<span class="hljs-number">109</span> + x^<span class="hljs-number">108</span> + x^<span class="hljs-number">106</span> - <span class="hljs-number">4</span>*x^<span class="hljs-number">105</span> + x^<span class="hljs-number">104</span> - x^<span class="hljs-number">103</span> - x^<span class="hljs-number">101</span> + x^<span class="hljs-number">100</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">99</span> + x^<span class="hljs-number">98</span> - x^<span class="hljs-number">97</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">96</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">94</span> - x^<span class="hljs-number">93</span> - x^<span class="hljs-number">92</span> + x^<span class="hljs-number">91</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">90</span> + x^<span class="hljs-number">89</span> - x^<span class="hljs-number">88</span> + x^<span class="hljs-number">87</span> - x^<span class="hljs-number">86</span> + x^<span class="hljs-number">85</span> + x^<span class="hljs-number">84</span> - x^<span class="hljs-number">83</span> + x^<span class="hljs-number">79</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">78</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">77</span> + x^<span class="hljs-number">74</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">73</span> - x^<span class="hljs-number">72</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">71</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">70</span> + x^<span class="hljs-number">69</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">66</span> + x^<span class="hljs-number">65</span> + x^<span class="hljs-number">64</span> - <span class="hljs-number">4</span>*x^<span class="hljs-number">62</span> - x^<span class="hljs-number">61</span> + x^<span class="hljs-number">60</span> - x^<span class="hljs-number">59</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">58</span> - x^<span class="hljs-number">57</span> - x^<span class="hljs-number">54</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">53</span> + x^<span class="hljs-number">51</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">50</span> - x^<span class="hljs-number">49</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">47</span> - x^<span class="hljs-number">46</span> - x^<span class="hljs-number">44</span> + x^<span class="hljs-number">43</span> - x^<span class="hljs-number">42</span> - <span class="hljs-number">4</span>*x^<span class="hljs-number">41</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">39</span> - x^<span class="hljs-number">37</span> - x^<span class="hljs-number">36</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">35</span> + x^<span class="hljs-number">34</span> + x^<span class="hljs-number">33</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">32</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">31</span> - x^<span class="hljs-number">30</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">29</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">28</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">27</span> - x^<span class="hljs-number">24</span> + x^<span class="hljs-number">22</span> - <span class="hljs-number">5</span>*x^<span class="hljs-number">21</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">20</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">19</span> - x^<span class="hljs-number">18</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">17</span> + x^<span class="hljs-number">16</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">15</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">14</span> + x^<span class="hljs-number">13</span> + x^<span class="hljs-number">12</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">11</span> - <span class="hljs-number">3</span>*x^<span class="hljs-number">10</span> + <span class="hljs-number">3</span>*x^<span class="hljs-number">9</span> + <span class="hljs-number">2</span>*x^<span class="hljs-number">8</span> - <span class="hljs-number">4</span>*x^<span class="hljs-number">6</span> - <span class="hljs-number">2</span>*x^<span class="hljs-number">5</span> - <span class="hljs-number">4</span>*x^<span class="hljs-number">4</span> + x^<span class="hljs-number">3</span> - x^<span class="hljs-number">2</span> - <span class="hljs-number">1</span><br><br>k = f(<span class="hljs-number">1</span>)  <br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è®¡ç®—å¾—åˆ°çš„kå€¼: <span class="hljs-subst">&#123;k&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># è®¡ç®—2^k mod nï¼ˆå¤„ç†è´ŸæŒ‡æ•°ï¼‰</span><br><span class="hljs-keyword">if</span> k &gt;= <span class="hljs-number">0</span>:<br>    result = <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, k, n)<br><span class="hljs-keyword">else</span>:<br>    inv_2 = inverse_mod(<span class="hljs-number">2</span>, n) <br>    result = <span class="hljs-built_in">pow</span>(inv_2, -k, n)<br><br>p = gcd(w - result, n)<br>q = n // p<br><br><span class="hljs-comment"># è®¡ç®—ç§é’¥å¹¶è§£å¯†</span><br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = inverse_mod(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>flag = long_to_bytes(<span class="hljs-built_in">int</span>(m))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;åˆ†è§£å¾—åˆ°çš„ç´ æ•°p: <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;åˆ†è§£å¾—åˆ°çš„ç´ æ•°q: <span class="hljs-subst">&#123;q&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è§£å¯†åçš„Flag: <span class="hljs-subst">&#123;flag.decode()&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><blockquote><p>åŸç†,    $p^kâ‰¡pâ‰¡1mod(p-1)$ â€“&gt; $ f(p)â‰¡f(1) mod(p-1)$</p><p>åˆ™æœ‰$2^{f(p)}â‰¡2^{f(1)}modp $æ˜æ˜¾ $2^{f(p)}-2^{f(1)}&#x3D;result$èƒ½è¢«pæ•´é™¤ï¼Œä¸”n&#x3D;p*qæ‰€ä»¥ p&#x3D;gcd(result,n)</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>python</category>
      
      <category>crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
      <tag>python</tag>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¤šç»´å­é›†å’Œé—®é¢˜</title>
    <link href="/2025/02/23/%E8%83%8C%E5%8C%85%E5%AF%86%E7%A0%81%E5%92%8C%E5%A4%9A%E7%BB%B4%E5%AD%90%E9%9B%86%E5%92%8C%E9%97%AE%E9%A2%98(Multidimensional%20Subset%20Sum%20Problem)/"/>
    <url>/2025/02/23/%E8%83%8C%E5%8C%85%E5%AF%86%E7%A0%81%E5%92%8C%E5%A4%9A%E7%BB%B4%E5%AD%90%E9%9B%86%E5%92%8C%E9%97%AE%E9%A2%98(Multidimensional%20Subset%20Sum%20Problem)/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="èƒŒåŒ…å¯†ç å’Œå¤šç»´å­é›†å’Œé—®é¢˜-Multidimensional-Subset-Sum-Problemã€‚"><a href="#èƒŒåŒ…å¯†ç å’Œå¤šç»´å­é›†å’Œé—®é¢˜-Multidimensional-Subset-Sum-Problemã€‚" class="headerlink" title="èƒŒåŒ…å¯†ç å’Œå¤šç»´å­é›†å’Œé—®é¢˜(Multidimensional Subset Sum Problemã€‚)"></a>èƒŒåŒ…å¯†ç å’Œå¤šç»´å­é›†å’Œé—®é¢˜(<strong>Multidimensional Subset Sum Problem</strong>ã€‚)</h1><ul><li>çŸ¥è¯†:LLLç®—æ³•ï¼Œä»¥åŠBKZè§£å†³æ–¹æ³•ï¼Œè¿˜æœ‰MITM(ä¸­é—´ç›¸é‡ç®—æ³•)ç®—æ³•è§£å†³ã€‚</li></ul><blockquote><p>é¦–å‘äºå…ˆçŸ¥ç¤¾åŒº ï¼š<a href="https://xz.aliyun.com/news/16929">å­é›†å’Œé—®é¢˜çš„ä¸¤ç§è§£å†³æ–¹å¼-å…ˆçŸ¥ç¤¾åŒº</a></p></blockquote><h2 id="ç®€å•ä»‹ç»ä¸€äº›è¿™é‡Œæ‰€ç§°çš„èƒŒåŒ…é—®é¢˜ï¼Œä»¥å­é›†å’Œé—®é¢˜-Subset-Sum-Problem"><a href="#ç®€å•ä»‹ç»ä¸€äº›è¿™é‡Œæ‰€ç§°çš„èƒŒåŒ…é—®é¢˜ï¼Œä»¥å­é›†å’Œé—®é¢˜-Subset-Sum-Problem" class="headerlink" title="ç®€å•ä»‹ç»ä¸€äº›è¿™é‡Œæ‰€ç§°çš„èƒŒåŒ…é—®é¢˜ï¼Œä»¥å­é›†å’Œé—®é¢˜(Subset Sum Problem)"></a>ç®€å•ä»‹ç»ä¸€äº›è¿™é‡Œæ‰€ç§°çš„èƒŒåŒ…é—®é¢˜ï¼Œä»¥å­é›†å’Œé—®é¢˜(Subset Sum Problem)</h2><ul><li>èƒŒåŒ…é—®é¢˜</li></ul><blockquote><p>$W&#x3D;x_1a_1+x_2a_2+â€¦+xna_n$</p><p>Wè¡¨ç¤ºèƒŒåŒ…çš„æ‰¿é‡ï¼Œxåªèƒ½ä½0æˆ–1(è¿™é‡Œæ˜¯0&#x2F;1èƒŒåŒ…ï¼Œå®Œå…¨èƒŒåŒ…æ„Ÿå…´è¶£å¯ä»¥äº†è§£è¿™é‡Œä»…è¯¦ç»†é˜è¿°0-1èƒŒåŒ…)ï¼Œç”¨æ¥è¡¨ç¤ºé€‰ä¸­æˆ–ä¸é€‰ä¸­ã€‚</p><p>è¿™ç§0-1èƒŒåŒ…é—®é¢˜ä¹Ÿå«åšå­é›†å’Œé—®é¢˜ï¼Œç»™å®šä¸€ä¸ªé›†åˆï¼Œ$A&#x3D;{a1,a2,a3â€¦an}$</p><p>å®ƒçš„éƒ¨åˆ†å…ƒç´ çš„çš„å’Œç­‰äºWï¼Œæ‰€ä»¥å«åšå­é›†å’Œã€‚å¦‚æœä¸é‡‡å–ä»»ä½•å–å·§çš„æ–¹å¼æš´åŠ›ç ´è§£è¿™ä¸ªé—®é¢˜ï¼Œå®è·µå¤æ‚åº¦ä½$o(2^n)$,å¦‚æœnè¾ƒå¤§è¿™æ˜¯ååˆ†å›°éš¾çš„</p></blockquote><h2 id="Merkleâ€“Hellmanå…¬é’¥åŠ å¯†ç®—æ³•ï¼ˆè¿™ç§åŠ å¯†ç®—æ³•ä»¥åŠä¸å†å®‰å…¨"><a href="#Merkleâ€“Hellmanå…¬é’¥åŠ å¯†ç®—æ³•ï¼ˆè¿™ç§åŠ å¯†ç®—æ³•ä»¥åŠä¸å†å®‰å…¨" class="headerlink" title="Merkleâ€“Hellmanå…¬é’¥åŠ å¯†ç®—æ³•ï¼ˆè¿™ç§åŠ å¯†ç®—æ³•ä»¥åŠä¸å†å®‰å…¨)"></a>Merkleâ€“Hellmanå…¬é’¥åŠ å¯†ç®—æ³•ï¼ˆè¿™ç§åŠ å¯†ç®—æ³•ä»¥åŠä¸å†å®‰å…¨)</h2><ul><li>åŸç†:è™½ç„¶å•çº¯çš„èƒŒåŒ…ç ´è§£ååˆ†å¤æ‚ï¼Œä½†æ˜¯å¦‚æœæ˜¯è¶…é€’å¢èƒŒåŒ…å°±èƒ½æå¤§é™ä½éš¾åº¦ï¼Œæˆ‘ä»¬è®¾å®šåˆå§‹èƒŒåŒ…ä¸ºè¶…é€’å¢èƒŒåŒ…ï¼Œå†åˆ©ç”¨æ¨¡æ•°må’Œä¹˜æ•°wå¯¹å…¶è¿›è¡ŒåŠ å¯†</li></ul><h3 id="è¶…é€’å¢èƒŒåŒ…"><a href="#è¶…é€’å¢èƒŒåŒ…" class="headerlink" title="è¶…é€’å¢èƒŒåŒ…"></a>è¶…é€’å¢èƒŒåŒ…</h3><blockquote><p>è¶…é€’å¢èƒŒåŒ…çš„æ€§è´¨:è®¾å®šé›†åˆ:$A&#x3D;{a1,a2,a3â€¦an}$</p><p>$a_k&gt;2a_{k-1}$ ,ç”Ÿæˆä¸€ä¸ªè¶…é€’å¢èƒŒåŒ…å¹¶è§£é€†æ¨å‡ºç”¨bagåŠ å¯†åçš„æ•°ï¼Œå› ä¸ºè¶…é€’å¢èƒŒåŒ…çš„ç‰¹æ€§ï¼Œè¿™æ˜¯å¾ˆå®¹æ˜“çš„</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&gt;<span class="hljs-keyword">from</span> Crypto.Random.random import randint<br>&gt;<span class="hljs-keyword">from</span> Crypto.Util.number import getPrime, long_to_bytes, bytes_to_long<br><br>&gt;bag=[]<br>&gt;<span class="hljs-attribute">a</span>=getPrime(10)<br>&gt;<span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>   <span class="hljs-attribute">a</span>=randint(2,5)*a<br>   bag.append(a)<br>   <span class="hljs-keyword">if</span> len(bag)==24:<br>       break<br>&gt;<span class="hljs-built_in">print</span>(bag)<br>&gt;<span class="hljs-attribute">flag</span>=getPrime(24)<br>&gt;<span class="hljs-built_in">print</span>(flag)<br>&gt;<span class="hljs-attribute">a</span>=0<br>&gt;<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> bag:<br>   <span class="hljs-attribute">f</span>=flag%2<br>   <span class="hljs-attribute">a</span>=a+i*f<br>   <span class="hljs-attribute">flag</span>=flag&gt;&gt;1<br>&gt;<span class="hljs-built_in">print</span>(a)<br>&gt;def reverse_flag(a, bag):<br>   flag = 0<br>   <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(bag)):<br>       <span class="hljs-keyword">if</span> a &gt;= bag[24-i-1]:<br>           a -= bag[24-i-1]<br>           flag |= (1 &lt;&lt; (24-i-1))<br>   return flag<br>&gt;<span class="hljs-attribute">F</span>=reverse_flag(a,bag)<br>&gt;<span class="hljs-built_in">print</span>(F)<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥è¿›è¡Œå…¬é’¥åŠ å¯†:</p><p>wåšä¹˜æ•°ï¼Œmå–æ¨¡ï¼Œå¹¶ä¸”gcd(w,m)&#x3D;1;$m&gt;\sum_{i&#x3D;1}^{n} a_i$</p><p>åˆ©ç”¨åŠ å¯†åå¾—åˆ°$b_i&#x3D;w a$,å¾—åˆ°å¦ä¸€ä¸ªèƒŒåŒ…$B&#x3D;{b_1,b_2,â€¦,b_n}$</p><p>Bå°±æ˜¯å…¬é’¥ï¼Œæˆ‘ä»¬åˆ©ç”¨å…¬é’¥Bå¯¹ä¿¡æ¯è¿›è¡ŒåŠ å¯†</p></blockquote><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs routeros">def reverse_flag(a, bag):<br>    flag = 0<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(bag)):<br>        <span class="hljs-keyword">if</span> a &gt;= bag[24-i-1]:<br>            a -= bag[24-i-1]<br>            flag |= (1 &lt;&lt; (24-i-1))<br>    return flag<br><span class="hljs-attribute">m</span>=663037888222452170426631697<br><span class="hljs-attribute">w</span>=17854050521669203729<br>B=[]<br><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> bag:<br>    b=(w<span class="hljs-number">*a</span>)%m<br>    B.append(b)<br><span class="hljs-built_in">print</span>(f<span class="hljs-string">&#x27;B=&#123;B&#125;&#x27;</span>)<br><span class="hljs-attribute">c</span>=en_f(flag,B)<br><span class="hljs-built_in">print</span>(f<span class="hljs-string">&#x27;c=&#123;c&#125;&#x27;</span>)<br><span class="hljs-comment">#Bå°±è¡¨ç¤ºå…¬é’¥ï¼Œç”¨Bå¯¹æ¶ˆæ¯è¿›è¡ŒåŠ å¯†</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¦‚æœnå¾ˆå¤§æˆ‘ä»¬å°±éœ€è¦é€šè¿‡å¯¹Bçš„æ¯ä¸€ä¸ªæ•°å’Œcä¹˜w_1ï¼Œç„¶åæ¨¡mï¼Œæœ€ååˆ©ç”¨ä¸Šè¿°ç›¸åŒçš„æ–¹æ³•ä¾¿èƒ½æ¢å¤flagä¸‹é¢æ˜¯å®Œæ•´ä»£ç </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> Crypto.Random.random import randint<br><span class="hljs-keyword">from</span> Crypto.Util.number import getPrime, long_to_bytes, bytes_to_long, inverse<br><br>bag=[]<br><span class="hljs-attribute">a</span>=getPrime(10)<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-attribute">a</span>=randint(2,5)*a<br>    bag.append(a)<br>    <span class="hljs-keyword">if</span> len(bag)==24:<br>        break<br><span class="hljs-built_in">print</span>(bag)<br><span class="hljs-attribute">flag</span>=getPrime(24)<br><span class="hljs-built_in">print</span>(flag)<br><br>def en_f(flag,bag):<br>    a = 0<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> bag:<br>        f = flag % 2<br>        a = a + i * f<br>        flag = flag &gt;&gt; 1<br>    return a<br>def reverse_flag(a, bag):<br>    flag = 0<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(bag)):<br>        <span class="hljs-keyword">if</span> a &gt;= bag[24-i-1]:<br>            a -= bag[24-i-1]<br>            flag |= (1 &lt;&lt; (24-i-1))<br>    return flag<br><span class="hljs-attribute">m</span>=663037888222452170426631697<br><span class="hljs-attribute">w</span>=17854050521669203729<br>B=[]<br><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> bag:<br>    b=(w<span class="hljs-number">*a</span>)%m<br>    B.append(b)<br><span class="hljs-built_in">print</span>(f<span class="hljs-string">&#x27;B=&#123;B&#125;&#x27;</span>)<br><span class="hljs-attribute">c</span>=en_f(flag,B)<br><span class="hljs-built_in">print</span>(f<span class="hljs-string">&#x27;c=&#123;c&#125;&#x27;</span>)<br><span class="hljs-attribute">w_1</span>=inverse(w,m)<br>BAG=[]<br><span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> B:<br>    <span class="hljs-attribute">a</span>=b*w_1%m<br>    BAG.append(a)<br><span class="hljs-attribute">c</span>=c*w_1%m<br><span class="hljs-attribute">F</span>=reverse_flag(c,BAG)<br><span class="hljs-built_in">print</span>(f<span class="hljs-string">&#x27;F=&#123;F&#125;&#x27;</span>)<br><span class="hljs-built_in">print</span>(f<span class="hljs-string">&#x27;BAG=&#123;BAG&#125;&#x27;</span>)<br></code></pre></td></tr></table></figure><ul><li>è¿™ç§åŠ å¯†æ–¹å¼å®é™…ä¸Šå·²ç»ä¸å®‰å…¨äº†ï¼ŒLLLç®—æ³•èƒ½å¾ˆè½»æ˜“çš„ç ´è§£èƒŒåŒ…å¯†ç ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¾¿è®²è§£LLLç®—æ³•ä¸èƒŒåŒ…å¯†ç </li></ul><h2 id="LLLå’ŒLLL-BKZä¸å­é›†å’Œé—®é¢˜"><a href="#LLLå’ŒLLL-BKZä¸å­é›†å’Œé—®é¢˜" class="headerlink" title="LLLå’ŒLLL-BKZä¸å­é›†å’Œé—®é¢˜"></a>LLLå’ŒLLL-BKZä¸å­é›†å’Œé—®é¢˜</h2><ul><li>è¿™é‡Œæ‰€æŒ‡çš„0-1èƒŒåŒ…æ›´å¤šçš„ä¹Ÿè¢«å«åšå­é›†å’Œé—®é¢˜ï¼Œ</li></ul><h3 id="LLLç®—æ³•"><a href="#LLLç®—æ³•" class="headerlink" title="LLLç®—æ³•"></a>LLLç®—æ³•</h3><p>ä¸‹é¢æˆ‘ä»¬åšä¸€äº›æ ¼çš„ç®€å•ä»‹ç»ä»¥åŠè¿™é‡Œéœ€è¦ç”¨åˆ°çš„åº”ç”¨</p><ul><li>ä»€ä¹ˆæ˜¯æ ¼</li></ul><p>æˆ‘ä»¬å®šä¹‰ä¸€ç»„åŸºå‘é‡basis,ç”±è¿™ç»„åŸºå‘é‡å’Œæ•´æ•°ç³»æ‰€æ„æˆçš„æ‰€æœ‰ç‚¹å°±æ˜¯æ ¼ã€‚</p><p>ä¾‹å¦‚(1,0)å’Œ(0,1)è¿™ä¸€ç»„å‘é‡å°±èƒ½æ„å»ºè¿™æ ·çš„æ ¼</p><p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20250220163434-8350b562-ef65-1.webp" alt="img"></p><p>è¿™æ ·å°±æ„å»ºäº†ä¸€ä¸ªæ™®é€šçš„æ ¼ï¼Œå½“ç„¶æˆ‘ä»¬é‡åˆ°çš„å¤§å¤šæ•°æ ¼åŸºå½“ç„¶ä¸ä¼šåƒè¿™ä¹ˆç®€å•ã€‚æˆ‘ä»¬åœ¨å­é›†å’Œä¸­éœ€è¦åº”ç”¨åˆ°çš„æ˜¯æ‰¾æ ¼é‡Œé¢æœ€çŸ­å‘é‡çš„åŠæ³•</p><ul><li>hermite å®šç†</li></ul><blockquote><p>å¯¹åº”ä»»æ„nç»´çš„æ ¼Lï¼Œéƒ½æœ‰ä¸€ä¸ªéé›¶å‘é‡vå±äºLï¼Œå¹¶ä¸”</p></blockquote><p>$|v|&lt;&#x3D;\sqrt{n}det(L)^{1&#x2F;n}$</p><p>å‡è®¾å‘é‡væ˜¯æ ¼Lçš„å…¶ä¸­ä¸€ä¸ªå‘é‡æ»¡è¶³è¿™ä¸ªå®šç†ï¼Œå¹¶ä¸”vå’Œ$\sqrt{n}det(L)^{1&#x2F;n}$å¤§å°ç›¸å·®ä¸ç®—å¤šï¼Œæˆ‘ä»¬å¯ä»¥åˆ¤å®švæ˜¯æœ€çŸ­éé›¶å‘é‡ã€‚æˆ‘ä»¬åœ¨è®¡ç®—LLLç›¸å…³é¢˜ç›®æ—¶ï¼Œå¦‚æœä¸æ»¡è¶³è¿™ä¸ªå®šç†ï¼Œåˆ™éœ€è¦æ„é€ ã€‚å½“ç„¶è¿™é‡Œå¹¶ä¸éœ€è¦</p><p>æˆ‘ä»¬ç°åœ¨å¯ä»¥ä¸¾ä¾‹ä¸ªèƒŒåŒ…åŠ å¯†çš„ä¾‹å­</p><p>ç»™å‡ºæœ€çŸ­å‘é‡çš„ä¸Šé™ã€‚</p><p>2024æå®¢å¤§æŒ‘æˆ˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;******&#x27;</span><br>m = bytes_to_long(flag)<br><br><span class="hljs-keyword">assert</span> m.bit_length() == <span class="hljs-number">327</span><br>p = getPrime(<span class="hljs-number">1024</span>)<br>a = getPrime(<span class="hljs-number">1024</span>)<br>c = getPrime(<span class="hljs-number">400</span>)<br><br>b = (a*m + c) % p<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;a = <span class="hljs-subst">&#123;a&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;b = <span class="hljs-subst">&#123;b&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p = <span class="hljs-subst">&#123;p&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">a = 16979084980432354094619720470840276286258619760418310258927074185970855030192034811294130599976409219799692929847459006262555680679361326852776377401377268595469956168424494543</span><br><span class="hljs-string">b = 87985708831523238980948938165414984318379459926002798504435964538203443877988599888615810231215118828138306895572062833107988965151522391460216837691927960249874511818878134399</span><br><span class="hljs-string">p = 13172449451206565880103976654678882171806396314446781873576804063136706915381625485522965544955909918869440326004499036629202691608534025007719873521577414908702557726376984665</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>å·²çŸ¥a,b,pã€‚</p><p>æ¥ä¸‹æ¥æ„é€ å‡½æ•°</p><blockquote><p>b&#x3D;am+c-kp</p><p>c&#x3D;b+kp-am</p><p>m&#x3D;0+m+0</p><p>1&#x3D;[1,0,0]</p><p>[1,m,k]*[1,0,b&#x2F;&#x2F;0,1,-a&#x2F;&#x2F;0,0,p]&#x3D;[1,m,c]</p><p>å¦‚æœmå’Œcè¿œè¿œå°äºa,b,påˆ™[1,m,c]å¯è§†ä¸ºæœ€çŸ­å‘é‡,é€šè¿‡æ±‚å‡ºæœ€çŸ­å‘é‡å³å¯æ±‚å‡ºmå’Œcã€‚ä½†æ˜¯è¿™é‡Œ[1,0,b]ä¸èƒ½ç¡®å®šæ˜¯å¦ä¸€å®šæ¯”[1,m,c]å¤§å¾ˆå¤šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆå°è¯•æ„é€ </p></blockquote><p>è¿™é‡Œæ„é€ å‡ºæ¥ï¼Œ$b-a*m +kp &#x3D; c$<br>$$(1\quad m\quad k )\begin{bmatrix}1&amp;0&amp;b\0&amp;1&amp;-<br>a\0&amp;0&amp;p\end{bmatrix}&#x3D;(1\quad m \quad c)$$<br>$||\mathbf{v}||&#x3D;\sqrt{1+|m|2+|c|2}\approx2^{401}&gt;|p|{1&#x2F;3}&#x3D;2^{341}$<br>è¡¥ä¸ª$2^{200}$<br>|V|&lt;&#x3D;|p|*1&#x2F;3ï¼Œå¹¶ä¸”å¤§å°æ¥è¿‘ï¼Œä½†æ˜¯åŠ äº†ZZä¹‹åæ—©æ ¼çš„èŒƒå›´å˜å¤§äº†ä¸€äº›ã€‚</p><p>å½“ç„¶è¿™åªæ˜¯ç®€å•çš„ä¸¾ä¾‹ï¼ŒçŸ¥è¯†ä¸ºäº†æ›´æ–¹ä¾¿çš„ç†è§£èƒŒåŒ…å¯†ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>a = <span class="hljs-number">16979084980432354094619720470840276286258619760418310258927074185970855030192034811294130599976409219799692929847459006262555680679361326852776377401377268595469956168424494543</span><br>b = <span class="hljs-number">87985708831523238980948938165414984318379459926002798504435964538203443877988599888615810231215118828138306895572062833107988965151522391460216837691927960249874511818878134399</span><br>p = <span class="hljs-number">13172449451206565880103976654678882171806396314446781873576804063136706915381625485522965544955909918869440326004499036629202691608534025007719873521577414908702557726376984665</span><br><br><br>M = matrix([[<span class="hljs-number">2</span>^<span class="hljs-number">377</span>,<span class="hljs-number">0</span>, b], [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>, -a],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,p]])<br>L = M.LLL()[<span class="hljs-number">0</span>]<br><br><span class="hljs-built_in">print</span>(long_to_bytes(L[<span class="hljs-number">1</span>]))<br><br><span class="hljs-comment">#b&#x27;SYC&#123;1e989433efffd767589e989ad0f091075c06&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æˆ‘ä»¬è®²è¿°LLLç®—æ³•åœ¨å­é›†å’Œé—®é¢˜çš„åº”ç”¨ï¼Œä»¥åŠæ€ä¹ˆç ´è§£åˆšåˆšçš„Merkleâ€“Hellmanå…¬é’¥åŠ å¯†ç®—æ³•</p><blockquote><p>$\sum_{i&#x3D;1}^nx_ia_i&#x3D;S$,è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„å­é›†å’Œé—®é¢˜ï¼Œç°åœ¨æˆ‘ä»¬æ¥æ„é€ çŸ©é˜µã€‚</p><p>$v1&#x3D;2,â€¦,a1$,</p><p>$v2&#x3D;2,â€¦,a2$</p><p>$vn&#x3D;2,..,an$</p><p>$v_{n+1}&#x3D;2,â€¦,s$</p><p>æ¥æ„é€ ä¸€ä¸ªæ ¼,æ˜¯ä¸€ä¸ª(n+1)(n+1)çš„çŸ©é˜µã€‚<br>$$<br>U&#x3D;\begin{bmatrix}<br>2&amp;0&amp;â€¦&amp;0&amp;Na_1\<br>0&amp;2&amp;â€¦&amp;0&amp;Na_2\<br>â‹®&amp; &amp;â€¦&amp; &amp;â‹®\<br>1&amp;1&amp;â€¦&amp;1&amp;Ns\</p><p>\end{bmatrix}<br>$$<br>$A&#x3D;[x_1,x_2,..,x_n,-1]$</p><p>$A*U&#x3D;B$ â€¦â€¦$B&#x3D;[2x_1-1,2x_2-1,â€¦2x_n-1,0]$</p><p>åœ¨ä¸€å®šæ¡ä»¶ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ ¼è§£é™¤Bç„¶åæ‰¾å‡ºxã€‚è¿™é‡ŒNæŒ‰ç†è¯´æ˜¯å¤§äº$\sqrt{4&#x2F;n}$çš„æ•°ï¼Œä¸è¿‡æˆ‘è¿™é‡Œè¯•è¿‡ç›´æ¥N&#x3D;1ä¹Ÿæ— æ‰€è°“</p></blockquote><p>ä¸€å®šçš„æ¡ä»¶ï¼Œæ»¡è¶³æ ¼å¯†ç çš„å®šç†ï¼Œè¿™é‡Œæˆ‘ä»¬è¦æ±‚çš„Bå°±æ˜¯æœ€çŸ­éé›¶å‘é‡</p><ul><li>èƒŒåŒ…çš„å¯†åº¦</li></ul><p>$d&#x3D;{n\over log_2(max_ia_i)}$  ä¸€èˆ¬æ¥è¯´d&lt;0.9408å¦‚æœdè¿‡å¤§åˆ™æ— æ³•å®Œæˆè®¡ç®—,å½“ç„¶è¿™é‡Œæ‰€ä»¥aiè‚¯å®šä¸èƒ½ç”¨åŒæ—¶ä¹˜ä»¥æŸä¸ªæ•°çš„æ–¹å¼æ¥æ‰©å¤§ai</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> copy<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br><span class="hljs-keyword">from</span> paramiko.util <span class="hljs-keyword">import</span> bit_length<br><br>L=[]<br><span class="hljs-built_in">list</span> = []<br>bag = []<br>p=getPrime(<span class="hljs-number">16</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>):<br>    t = p<br>    a=[getPrime(<span class="hljs-number">20</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br>    b=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> a:<br>        temp=t%<span class="hljs-number">2</span><br>        b+=temp*j<br>        t=t&gt;&gt;<span class="hljs-number">1</span><br>    A=copy.deepcopy(a)<br>    <span class="hljs-built_in">list</span>.append(a)<br>    L.append(A)<br>    L[i].append(b)<br><br>    bag.append(b)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bin</span>(p))<br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;list=<span class="hljs-subst">&#123;<span class="hljs-built_in">list</span>&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;S=<span class="hljs-subst">&#123;bag&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;L=<span class="hljs-subst">&#123;L&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bin</span>(p))<br><span class="hljs-comment"># è¿™é‡Œæ˜¯æˆ‘ç”¨æ¥ç”Ÿæˆï¼ˆå¤šç»´ï¼‰å­é›†å’Œçš„pythonä»£ç </span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ç”¨æ™®é€šçš„LLLç®—æ³•æ— æ³•åšåˆ°å°äº0.9æ‰€ä»¥åé¢æˆ‘ä»¬å¯ä»¥ç”¨BKZç®—æ³•æ¥ç²¾ç¡®ã€‚</p><p>æˆ‘ä»¬å…ˆæš‚æ—¶ç”¨LLLç®—æ³•,å¾…ä¼šå†å¼•ç”³åˆ°BKZ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-built_in">list</span>=[[<span class="hljs-number">657617</span>, <span class="hljs-number">583853</span>, <span class="hljs-number">1042693</span>, <span class="hljs-number">750203</span>, <span class="hljs-number">870173</span>, <span class="hljs-number">796337</span>, <span class="hljs-number">575711</span>, <span class="hljs-number">686359</span>, <span class="hljs-number">549503</span>, <span class="hljs-number">596027</span>, <span class="hljs-number">532981</span>, <span class="hljs-number">694483</span>, <span class="hljs-number">527447</span>, <span class="hljs-number">954991</span>, <span class="hljs-number">1021303</span>, <span class="hljs-number">728369</span>]]<br>S=[<span class="hljs-number">7753890</span>]<br>n = <span class="hljs-built_in">len</span>(<span class="hljs-built_in">list</span>[<span class="hljs-number">0</span>])  <span class="hljs-comment"># ç¡®å®šåˆ—æ•°</span><br>N=<span class="hljs-built_in">len</span>(S)<br>L = matrix(QQ, n + <span class="hljs-number">1</span>, n + N)  <br><br><span class="hljs-keyword">for</span> i, a <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">list</span>):<br>    <span class="hljs-keyword">for</span> row, x <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(a):<br>        L[row, row] = <span class="hljs-number">2</span>  <br>        L[row, -(i + <span class="hljs-number">1</span>)] = <span class="hljs-number">5</span> * x  <br><br>L[-<span class="hljs-number">1</span>, :] = <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N):<br>    L[-<span class="hljs-number">1</span>, -i-<span class="hljs-number">1</span>] = <span class="hljs-number">5</span> * S[i]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;åŸå§‹çŸ©é˜µ:&quot;</span>)<br><span class="hljs-built_in">print</span>(L)<br><br><br>res = L.LLL()<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;LLL è§„çº¦åçš„çŸ©é˜µ:&quot;</span>)<br><span class="hljs-built_in">print</span>(res)<br>l=res[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(l)<br>a=<span class="hljs-number">0</span><br>p=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span>  i <span class="hljs-keyword">in</span> l:<br>    <span class="hljs-built_in">print</span>(i)<br>    <span class="hljs-keyword">if</span> i==-<span class="hljs-number">1</span>:<br>       p=(<span class="hljs-number">1</span>&lt;&lt;a)+p<br>    <span class="hljs-keyword">if</span> i==<span class="hljs-number">1</span>:<br>        p=p+<span class="hljs-number">0</span><br>    a=a+<span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(p)<br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„$d\approx 4&#x2F;5$ å°äº0.9è¿™æ ·å¯ä»¥è§£å‡ºp</p><ul><li>ä¹‹å‰ è®²çš„éƒ½æ˜¯å•ç»´çš„å­é›†å’Œï¼Œç°åœ¨è®²ä¸€è®²å¤šç»´çš„</li></ul><h3 id="å¤šç»´å­é›†å’Œ"><a href="#å¤šç»´å­é›†å’Œ" class="headerlink" title="å¤šç»´å­é›†å’Œ"></a>å¤šç»´å­é›†å’Œ</h3><p>å…¶å®è·Ÿå•ç»´åº¦åŒºåˆ«ä¸å¤§ä½†æ˜¯è®¡ç®—èƒŒåŒ…å¯†åº¦dçš„æ—¶å€™ï¼Œkè¡¨ç¤ºç»´åº¦ã€‚ä¹Ÿå°±æ˜¯æœ‰å‡ ä¸ªæ–¹ç¨‹</p><p>$d&#x3D;{n\over k*log_2(max_ia_i)}$</p><p>æ„é€ å¤šç»´å­é›†å’Œçš„çŸ©é˜µ</p><p>ä¾‹å¦‚æœ‰è¿™æ ·å‡ å¤šç»´çŸ©é˜µ</p><blockquote><p>$s1&#x3D;a_{11}x_1+a_{12}x_2+â€¦+a_{1n}x_n$</p><p>$s2&#x3D;a_{21}x_1+a_{22}x_2+â€¦+a{2n}x_n$</p><p>â€¦â€¦â€¦.</p><p>$s_m&#x3D;a_{m1}x_1+a_{m2}x_2+â€¦a_{mn}x_n$</p></blockquote><p>æˆ‘ä»¬å¯ä»¥æ„é€ å¦‚ä¸‹çŸ©é˜µ<br>$$<br>U&#x3D;\begin{bmatrix}<br>2&amp;0&amp;â€¦&amp;0&amp;Na_{11}&amp;Na_{21}&amp;â€¦&amp;Na_{m1}\<br>0&amp;2&amp;â€¦&amp;0&amp;Na_{12}&amp;Na_{22}&amp;â€¦&amp;Na_{m2}\<br>â‹®&amp; &amp;â€¦&amp; â‹®&amp;â‹®      &amp;â‹®      &amp;â€¦&amp;â‹®\<br>1&amp;1&amp;â€¦&amp;1&amp;Ns_1   &amp;NS_2  &amp;â€¦&amp;NS_m\</p><p>\end{bmatrix}<br>$$<br>æ˜¯ä¸€ä¸ª(n+1)(n+m)çš„çŸ©é˜µ</p><p>åœ¨å¤šç»´è¿ç®—æ—¶ï¼Œæ™®é€šçš„LLLç®—æ³•å³ä½¿åœ¨æ»¡è¶³èƒŒåŒ…dçš„æ¡ä»¶ä¸‹ä¹Ÿå¯èƒ½æ— æ³•è®¡ç®—å‡ºxæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°BKZç®—æ³•è®©å®ƒæ›´ç²¾ç¡®ï¼Œè¿™é‡Œå…ˆç”¨sagemathçš„åº“ç›´æ¥ç”¨ï¼ŒåŸç†æˆ–è®¸ä»¥åæœ‰ç©ºå†™ä¸€å†™</p><ul><li>ä¾ç„¶ä¸¾ä¸ªä¾‹å­</li></ul><p>ç”¨ä¸Šé¢å“ªé‚£ä¸ªä»£ç ç”Ÿæˆä¸€ç»„æ–°çš„å¤šç»´å­é›†å’Œ</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs py">p= <span class="hljs-number">14144071626274053077</span><br><span class="hljs-built_in">list</span>=[[<span class="hljs-number">3733096223</span>, <span class="hljs-number">4016122661</span>, <span class="hljs-number">2604791743</span>, <span class="hljs-number">3803752969</span>, <span class="hljs-number">2811015913</span>, <span class="hljs-number">2424854837</span>, <span class="hljs-number">2699276627</span>, <span class="hljs-number">3166905239</span>, <span class="hljs-number">4019323999</span>, <span class="hljs-number">2343359177</span>, <span class="hljs-number">3992862143</span>, <span class="hljs-number">3785767001</span>, <span class="hljs-number">2586924229</span>, <span class="hljs-number">3070457717</span>, <span class="hljs-number">2310412309</span>, <span class="hljs-number">2592357127</span>, <span class="hljs-number">2366334797</span>, <span class="hljs-number">2962683019</span>, <span class="hljs-number">2805750461</span>, <span class="hljs-number">3539027497</span>, <span class="hljs-number">2625450769</span>, <span class="hljs-number">3336823673</span>, <span class="hljs-number">3642010859</span>, <span class="hljs-number">2889382921</span>, <span class="hljs-number">3049931387</span>, <span class="hljs-number">2602304807</span>, <span class="hljs-number">3568999013</span>, <span class="hljs-number">3896273113</span>, <span class="hljs-number">3525202201</span>, <span class="hljs-number">2911945987</span>, <span class="hljs-number">3053645753</span>, <span class="hljs-number">3516097829</span>, <span class="hljs-number">3325059901</span>, <span class="hljs-number">3973524911</span>, <span class="hljs-number">3228036937</span>, <span class="hljs-number">3902446631</span>, <span class="hljs-number">2519797219</span>, <span class="hljs-number">2554082147</span>, <span class="hljs-number">3545600809</span>, <span class="hljs-number">2970361349</span>, <span class="hljs-number">3746719201</span>, <span class="hljs-number">3902275159</span>, <span class="hljs-number">2826114469</span>, <span class="hljs-number">3210912233</span>, <span class="hljs-number">3456385657</span>, <span class="hljs-number">2818943899</span>, <span class="hljs-number">2768933641</span>, <span class="hljs-number">3729610429</span>, <span class="hljs-number">3468484559</span>, <span class="hljs-number">2822792989</span>, <span class="hljs-number">3173397109</span>, <span class="hljs-number">2476550641</span>, <span class="hljs-number">3205047343</span>, <span class="hljs-number">3556526131</span>, <span class="hljs-number">4186055693</span>, <span class="hljs-number">3610056343</span>, <span class="hljs-number">2793960107</span>, <span class="hljs-number">3004053329</span>, <span class="hljs-number">4291698713</span>, <span class="hljs-number">3258552733</span>, <span class="hljs-number">2510177729</span>, <span class="hljs-number">3530096797</span>, <span class="hljs-number">3269456219</span>, <span class="hljs-number">2600147623</span>], [<span class="hljs-number">3587860039</span>, <span class="hljs-number">3244673137</span>, <span class="hljs-number">4081135321</span>, <span class="hljs-number">3530424101</span>, <span class="hljs-number">3123822853</span>, <span class="hljs-number">4215837937</span>, <span class="hljs-number">2935180159</span>, <span class="hljs-number">3477346757</span>, <span class="hljs-number">3880682317</span>, <span class="hljs-number">3596126549</span>, <span class="hljs-number">3442632797</span>, <span class="hljs-number">2328804859</span>, <span class="hljs-number">3357519169</span>, <span class="hljs-number">3456684767</span>, <span class="hljs-number">2373991303</span>, <span class="hljs-number">3774163111</span>, <span class="hljs-number">2808888127</span>, <span class="hljs-number">2384282179</span>, <span class="hljs-number">3360642323</span>, <span class="hljs-number">2890006079</span>, <span class="hljs-number">3498280733</span>, <span class="hljs-number">4159921411</span>, <span class="hljs-number">2968219733</span>, <span class="hljs-number">2201454251</span>, <span class="hljs-number">2563597627</span>, <span class="hljs-number">2925599561</span>, <span class="hljs-number">3511920007</span>, <span class="hljs-number">3455169373</span>, <span class="hljs-number">4244464129</span>, <span class="hljs-number">2267534219</span>, <span class="hljs-number">3802834417</span>, <span class="hljs-number">3249221947</span>, <span class="hljs-number">3788296273</span>, <span class="hljs-number">3211757309</span>, <span class="hljs-number">3459173929</span>, <span class="hljs-number">2167189499</span>, <span class="hljs-number">4259795633</span>, <span class="hljs-number">3173827273</span>, <span class="hljs-number">3798038071</span>, <span class="hljs-number">2881017599</span>, <span class="hljs-number">2491861231</span>, <span class="hljs-number">3698075663</span>, <span class="hljs-number">2442704783</span>, <span class="hljs-number">2464350851</span>, <span class="hljs-number">2577280613</span>, <span class="hljs-number">3793908917</span>, <span class="hljs-number">3390031453</span>, <span class="hljs-number">2983114619</span>, <span class="hljs-number">3646066681</span>, <span class="hljs-number">3158874871</span>, <span class="hljs-number">4184514839</span>, <span class="hljs-number">3301620067</span>, <span class="hljs-number">2516698291</span>, <span class="hljs-number">2473620133</span>, <span class="hljs-number">2187913543</span>, <span class="hljs-number">2861276653</span>, <span class="hljs-number">3335457143</span>, <span class="hljs-number">4076976949</span>, <span class="hljs-number">4077911921</span>, <span class="hljs-number">2762541787</span>, <span class="hljs-number">2973463733</span>, <span class="hljs-number">2198753783</span>, <span class="hljs-number">3496416383</span>, <span class="hljs-number">2424059459</span>], [<span class="hljs-number">3061838191</span>, <span class="hljs-number">3887444321</span>, <span class="hljs-number">2835006259</span>, <span class="hljs-number">2308551199</span>, <span class="hljs-number">2177389033</span>, <span class="hljs-number">3986307341</span>, <span class="hljs-number">2414267861</span>, <span class="hljs-number">2952804007</span>, <span class="hljs-number">3200321087</span>, <span class="hljs-number">2191758329</span>, <span class="hljs-number">2456777549</span>, <span class="hljs-number">3408679943</span>, <span class="hljs-number">3387498193</span>, <span class="hljs-number">2252571389</span>, <span class="hljs-number">2203638343</span>, <span class="hljs-number">4150893269</span>, <span class="hljs-number">4090387747</span>, <span class="hljs-number">2678251061</span>, <span class="hljs-number">2458844237</span>, <span class="hljs-number">2656259999</span>, <span class="hljs-number">3509519891</span>, <span class="hljs-number">3149747201</span>, <span class="hljs-number">3239724491</span>, <span class="hljs-number">2669248759</span>, <span class="hljs-number">3373027501</span>, <span class="hljs-number">4059007219</span>, <span class="hljs-number">2176826131</span>, <span class="hljs-number">3976102891</span>, <span class="hljs-number">3519556919</span>, <span class="hljs-number">2860631489</span>, <span class="hljs-number">3840588329</span>, <span class="hljs-number">2785908253</span>, <span class="hljs-number">2837499491</span>, <span class="hljs-number">2531399681</span>, <span class="hljs-number">2564265103</span>, <span class="hljs-number">2155431539</span>, <span class="hljs-number">3558134303</span>, <span class="hljs-number">3155722357</span>, <span class="hljs-number">2730822779</span>, <span class="hljs-number">3714250021</span>, <span class="hljs-number">2706880243</span>, <span class="hljs-number">2151311731</span>, <span class="hljs-number">3265319041</span>, <span class="hljs-number">3933743987</span>, <span class="hljs-number">3428310059</span>, <span class="hljs-number">3400800863</span>, <span class="hljs-number">3254316203</span>, <span class="hljs-number">2215699271</span>, <span class="hljs-number">2533362239</span>, <span class="hljs-number">3652131817</span>, <span class="hljs-number">3234801131</span>, <span class="hljs-number">2316545713</span>, <span class="hljs-number">3872326961</span>, <span class="hljs-number">2278496027</span>, <span class="hljs-number">2752640987</span>, <span class="hljs-number">4080627461</span>, <span class="hljs-number">2156282111</span>, <span class="hljs-number">2251944407</span>, <span class="hljs-number">3373404887</span>, <span class="hljs-number">2567296219</span>, <span class="hljs-number">2694349121</span>, <span class="hljs-number">2313219967</span>, <span class="hljs-number">2745218381</span>, <span class="hljs-number">4211643661</span>]]<br>S=[<span class="hljs-number">103031517597</span>, <span class="hljs-number">104870298939</span>, <span class="hljs-number">97387282977</span>]<br>n = <span class="hljs-built_in">len</span>(<span class="hljs-built_in">list</span>[<span class="hljs-number">0</span>])  <span class="hljs-comment"># ç¡®å®šåˆ—æ•°</span><br>N=<span class="hljs-built_in">len</span>(S)<br>L = matrix(QQ, n + <span class="hljs-number">1</span>, n + N)  <br><br><span class="hljs-keyword">for</span> i, a <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">list</span>):<br>    <span class="hljs-keyword">for</span> row, x <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(a):<br>        L[row, row] = <span class="hljs-number">2</span>  <br>        L[row, -(i + <span class="hljs-number">1</span>)] = x  <br><br>L[-<span class="hljs-number">1</span>, :] = <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N):<br>    L[-<span class="hljs-number">1</span>, -i-<span class="hljs-number">1</span>] =  S[i]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;åŸå§‹çŸ©é˜µ:&quot;</span>)<br><span class="hljs-built_in">print</span>(L)<br><br><br>res = L.BKZ(block_size=<span class="hljs-number">20</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;LLL è§„çº¦åçš„çŸ©é˜µ:&quot;</span>)<br><span class="hljs-built_in">print</span>(res)<br>l=res[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(l)<br>a=<span class="hljs-number">0</span><br>p=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span>  i <span class="hljs-keyword">in</span> l:<br>    <span class="hljs-built_in">print</span>(i)<br>    <span class="hljs-keyword">if</span> i==-<span class="hljs-number">1</span>:<br>       p=(<span class="hljs-number">1</span>&lt;&lt;a)+p<br>    <span class="hljs-keyword">if</span> i==<span class="hljs-number">1</span>:<br>        p=p+<span class="hljs-number">0</span><br>    a=a+<span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(p)<br><br></code></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾å¯ä»¥å‘ç°å¾—åˆ°çš„pæ˜¯æœ€å¤§çš„ã€‚</p><h3 id="MITM-ä¸­é—´ç›¸é‡ç®—æ³•"><a href="#MITM-ä¸­é—´ç›¸é‡ç®—æ³•" class="headerlink" title="MITM(ä¸­é—´ç›¸é‡ç®—æ³•)"></a>MITM(ä¸­é—´ç›¸é‡ç®—æ³•)</h3><ul><li>è¿™ä¸ªç®—æ³•æ•ˆç‡ä¸ç®—é«˜ï¼Œè¿™ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦çº¦ä¸º$o(2^{n&#x2F;2})$ï¼Œä¸è¿‡è¿™é‡Œå¯ä»¥å½“ä½œäº†è§£ï¼Œå¹¶ä¸”MITMç®—æ³•åœ¨dè¶…è¿‡1å·¦å³æ—¶ä¹Ÿä¼šå¤±æ•ˆã€‚</li></ul><p>è¿™ä¸ªç®—æ³•ä¹Ÿä¸éš¾ï¼Œå°±æ˜¯æŠŠæœ‰nä¸ªå…ƒç´ çš„å­é›†å’Œé—®é¢˜åˆ†æˆä¸¤éƒ¨åˆ†è®¡ç®—ï¼Œpythonç¤ºä¾‹å¦‚ä¸‹ï¼ŒæŠŠè¦æ±‚çš„Påˆ†æˆä¸¤éƒ¨åˆ†æ©ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sympy<br><span class="hljs-keyword">import</span> copy<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> product<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getPrime</span>(<span class="hljs-params">bits</span>):<br>    <span class="hljs-keyword">return</span> sympy.randprime(<span class="hljs-number">2</span> ** (bits - <span class="hljs-number">1</span>), <span class="hljs-number">2</span> ** bits)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_p_and_b</span>():<br>    L = []<br>    <span class="hljs-built_in">list</span> = []<br>    bag = []<br><br>    p = getPrime(<span class="hljs-number">32</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>):<br>        t = p<br>        a = [getPrime(<span class="hljs-number">32</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>)]<br>        b = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> a:<br>            temp = t % <span class="hljs-number">2</span><br>            b += temp * j<br>            t = t &gt;&gt; <span class="hljs-number">1</span><br>        A = copy.deepcopy(a)<br>        <span class="hljs-built_in">list</span>.append(a)<br>        L.append(A)<br>        L[i].append(b)<br>        bag.append(b)<br><br>    <span class="hljs-keyword">return</span> p, a, b<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">MITM</span>(<span class="hljs-params">a, b</span>):<br>    n = <span class="hljs-built_in">len</span>(a)<br>    half = n // <span class="hljs-number">2</span><br><br><br>    left_sums = &#123;&#125;<br>    <span class="hljs-keyword">for</span> bits <span class="hljs-keyword">in</span> product([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], repeat=half):<br>        s = <span class="hljs-built_in">sum</span>(bits[i] * a[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(half))<span class="hljs-comment"># så­é›†å’Œç´¯åŠ è¿‡ç¨‹</span><br>        left_sums[s] = bits<span class="hljs-comment"># æ„å»ºå­—å…¸é”®å€¼å¯¹å¯¹åº”</span><br><br>    <span class="hljs-keyword">for</span> bits <span class="hljs-keyword">in</span> product([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], repeat=n - half):<br>        s = <span class="hljs-built_in">sum</span>(bits[i] * a[i + half] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n - half))<br>        <span class="hljs-keyword">if</span> b - s <span class="hljs-keyword">in</span> left_sums:<span class="hljs-comment">#åˆ¤æ–­b-sæ˜¯å¦å”¯ä¸€ä¸Šè¿°å­—å…¸ä¸­</span><br>            left_bits = left_sums[b - s]<br>            full_bits = left_bits + bits<br>            p_bits = <span class="hljs-built_in">sum</span>(full_bits[i] &lt;&lt; i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n))<br>            <span class="hljs-keyword">return</span> p_bits<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><br>p, a, b = generate_p_and_b()<br><span class="hljs-built_in">print</span>(a)<br><span class="hljs-built_in">print</span>(b)<br>p1 =MITM(a, b)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;åŸå§‹ p: <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é‡å»ºçš„ p: <span class="hljs-subst">&#123;p1&#125;</span>&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>è¿™é‡ŒçŸ¥è¯†æ¼”ç¤ºçš„ä¸€ç»´çš„ï¼Œå¦‚æœæ˜¯å¤šç»´çš„ï¼Œè‡ªè¡Œæ·»åŠ çº¦æŸå³å¯ã€‚ä¸è¿‡è¿™ä¸ªç®—æ³•æ¯”è¾ƒæ…¢ï¼Œä»…ä½œå‚è€ƒ</p>]]></content>
    
    
    <categories>
      
      <category>crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>coppersmithæ–¹æ³•ç›¸å…³</title>
    <link href="/2025/01/23/copper/"/>
    <url>/2025/01/23/copper/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="coppersmith"><a href="#coppersmith" class="headerlink" title="coppersmith"></a>coppersmith</h1><p>åŸè®ºæ–‡<a href="https://www.math.auckland.ac.nz/~sgal018/crypto-book/ch19.pdf">ch19.pdf</a></p><p>å€Ÿé‰´åšå®¢ï¼š<a href="https://jayxv.github.io/2020/08/13/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bcoppersmith/">https://jayxv.github.io/2020/08/13/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bcoppersmith/</a></p><ul><li>å‰è¨€</li></ul><p>æœ€è¿‘ç»å¸¸é‡åˆ°coppersmithæ”»å‡»ï¼Œæ‰€ä»¥å†³å®šè¿˜æ˜¯æœ‰å¿…è¦æ·±å…¥å­¦ä¹ ä¸€ä¸‹</p><h2 id="coppersmithâ€™Method"><a href="#coppersmithâ€™Method" class="headerlink" title="coppersmithâ€™Method"></a>coppersmithâ€™Method</h2><blockquote><p>ä»‹ç»ï¼šcoppersmithæ–¹æ³•åŸºäºæ ¼çº¦ç®€å’ŒLLLç®—æ³•æ¥æ‰¾åˆ°ä¸€å®šæ¨¡æ•°ä¸‹å¤šé¡¹å¼çš„å°æ ¹ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ±‚è§£æ¨¡å¤šé¡¹å¼æ–¹ç¨‹çš„é—®é¢˜è½¬åŒ–ä¸ºä¸€ä¸ªæ ¼ä¸­çš„çŸ­å‘é‡é—®é¢˜</p></blockquote><blockquote><p>ä¾‹å¦‚F$F(x)&#x3D;x^3+x+123(mod M)$,M&#x3D;77,å‡è®¾å­˜åœ¨x0ä½¿å¾—$F(x_0)&#x3D;0$</p><p>å¹¶ä¸”è¿™ä¸ªx0å°äºæŸä¸ªç‰¹å®šå€¼ï¼Œå°±å¯ä»¥ä½¿ç”¨coppersmithç®—æ³•</p><p>ç»™å®šæ¨¡Mçš„å¤šé¡¹å¼$F(x)&#x3D;x^d+a^{dâˆ’1}x_{dâˆ’1}+â‹¯+a^1x+a^0$,[å¿…é¡»è®©$x^d$æ»¡è¶³ç³»æ•°ä¸º1ï¼Œå¯ä»¥ä¹˜$a_d^{-1}$æ¥é…å‡‘ã€‚å¦‚æœadæ²¡æœ‰æ¨¡Mé€†å…ƒï¼Œå¯ä»¥æ‹†åˆ†ä¸ºå¤šç»„ã€‚</p><p>å‡è®¾æˆ‘ä»¬çŸ¥é“$F(x_0)&#x3D;0(mod M)$ ,å¹¶ä¸”|$x_0$&lt;$M^{1&#x2F;d}$</p><p>å‡è®¾æˆ‘ä»¬ç°åœ¨èƒ½æ‰¾åˆ°G($x_0$)&#x3D;0,ä¸éœ€è¦å–æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨coppersmithæ–¹æ³•æŠŠè¿™ä¸ªF(x)å˜ä¸ºG(x)</p></blockquote><p>ä¾‹å¦‚$M&#x3D;17*19&#x3D;323$,$F(x)&#x3D;x^2+33x+215,$,å‡è®¾ä¸€ä¸ªå°æ ¹$x_0&#x3D;3$ä½†æ˜¯åœ¨æ•´æ•°</p><p>åŸŸä¸‹F(3)!&#x3D;0,æ‰€ä»¥æˆ‘ä»¬è¦æ‰¾åˆ°G(3)&#x3D;0,</p><blockquote><p>$G(x)&#x3D;9â‹…F(x)âˆ’Mâ‹…(x+6)&#x3D;9x^2âˆ’26xâˆ’3$ï¼Œæ»¡è¶³G(3)&#x3D;0,</p><p>è¿™æ˜¯ä¸€å…ƒcoppersmithçš„æ ¸å¿ƒæ€è·¯ã€‚</p></blockquote><ul><li>ä¸ºä»€ä¹ˆé€ æ ¼èƒ½å¾—åˆ°è¾ƒå°çš„G(X)</li></ul><p>è®¾F(x)æ„é€ ç³»æ•°çŸ©é˜µä¸ºA,x&#x3D;(x,x,x)</p><p>G(x)ç³»æ•°çŸ©é˜µ,L&#x3D;UAã€‚$A*x&#x3D;(ax+bx+cx)&#x3D;(0)mod(m)$</p><p>$L<em>x&#x3D;U</em>(A<em>X)&#x3D;U</em>(0)&#x3D;0mod(m)$</p><p>ä¾ç„¶æ»¡è¶³f(x0)&#x3D;0,G(x0)&#x3D;0,mod(m)</p><ul><li>æˆ‘ä»¬ç°åœ¨ä¸»è¦è¦æ‰¾x0çš„ç•Œï¼Œè®¾Xæ˜¯|x0|çš„ä¸Šç•Œ</li></ul><p>F(x)å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªè¡Œå‘é‡$B_F&#x3D;(a_0,a_1X,a_2X^2,â€¦,a_dX^d)$</p><p>é¦–å…ˆæˆ‘ä»¬æœ‰F(X),M,B_F,Xâ€”-$F(x_0)&#x3D;0(mod M)$</p><p>é‚£ä¹ˆå½“$|B_F|&lt;M&#x2F;(d+1)^{0.5}$,åˆ™æœ‰F(x0)&#x3D;0æ¥ä¸‹æ¥è¯æ˜å®ƒ</p><ul><li>å¼•å…¥æŸ¯è¥¿ä¸ç­‰å¼â€“1å¼å­</li></ul><p>$(âˆ‘^n_{i&#x3D;1}x_iy_i)^2â‰¤(âˆ‘^n_{i&#x3D;1}x^2_i)(âˆ‘^n_{i&#x3D;1}y^2i)$</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-01-18-214808.7w6x6ow66y.webp"></p><p>æ‰€ä»¥$-M&lt;F(x_0)&lt;M$ ä¸”F(x0)&#x3D;0 mod M æ‰€ä»¥F(X0)&#x3D;0</p><ul><li>ç¡®å®šè¾¹ç•Œå€¼X</li></ul><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-01-18-215702.5fkorrivy0.webp"></p><p>Xä¸ºx0å–å€¼ä¸Šç•Œï¼Œè¿™!ä¸ªçŸ©é˜µ$det(L)&#x3D;M^dX^{d(d+1)&#x2F;2}$</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ ¼åŸºè§„çº¦æ‰¾åˆ°æœ€å°çš„ç¬¬ä¸€è¡Œbâ€™,æ ¼çš„éƒ¨åˆ†ä¸å¤šå™è¿°å¯ä»¥å‚è€ƒå†™çš„LLLçš„é€Ÿé€šblog</p><p>ä¹‹åæˆ‘ä»¬å¯ä»¥å¾—åˆ°åœ¨æ»¡è¶³1å¼å­çš„æ¡ä»¶ä¸‹</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-01-18-215950.7egvi3oiam.webp"></p><p>å¯ä»¥å¾—åˆ°Xçš„å¤§è‡´èŒƒå›´</p><p>ç¤ºä¾‹M&#x3D;10001,å¤šé¡¹å¼$F(x)&#x3D;x^3+10x^2+5000xâˆ’222$</p><p>ç¡®å®š$x_0&lt;M^{1&#x2F;6}$,è¿™é‡Œçœç•¥äº†ç›¸å·®æ— å‡ çš„ç³»æ•°ã€‚ç¡®å®šä¸Šç•Œä¸º5å·¦å³</p><p>æˆ‘ä»¬è¿™æ˜¯å¯ä»¥æ„é€ çŸ©é˜µç„¶åæ ¼åŸºè§„çº¦ã€‚</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-01-18-222154.9nzw1l9ffn.webp"></p><p>ç¬¬ä¸€è¡Œä¾¿æ˜¯æ‰€éœ€æ±‚æ»¡è¶³è¦æ±‚çš„æœ€å°$G(x)&#x3D;444+xâˆ’20x^2âˆ’2x^3$</p><p>æ¥çš„x0&#x3D;4</p><ul><li>The Full Coppersimth Method</li></ul><p>ä¸€ä¸ªå…³äºæé«˜Xå¤§å°çš„æ–¹æ³•ï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•æˆ‘ä»¬ç§°è¿™ç§å¾€æ ¼é‡Œæ’å…¥çš„ï¼Œå¢åŠ äº†æ ¼çš„ç»´åº¦è€Œä¸å¢åŠ Mçš„å¤šé¡¹å¼ä¸ºï¼šâ€œx-shiftâ€ polynomialï¼Œå®ƒä»¬æ˜¯$xF(x),x^2F(x),â€¦,x^kF(x)xF(x)$ï¼Œæ˜¾ç„¶è¿™äº›å¤šé¡¹å¼åœ¨Mä¸‹çš„è§£ä¹Ÿä¸ºx0</p><p>é’ˆå¯¹ç¬¬äºŒç§æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨F(x)F(x)çš„å¹‚æ¥å¢åŠ Mï¼Œå› ä¸ºF(x0)â‰¡0(modM)Fï¼Œåˆ™æœ‰$F(x0)^kâ‰¡0(modM^ k)$</p><ul><li>å¦ä¸€ä¸ªå®šç†</li></ul><p>è®¾$0&lt;Ïµ&lt;min0.18,1&#x2F;d,F(x)$åº¦ä¸ºdçš„é¦–ä¸€å¤šé¡¹å¼å¦‚æœåœ¨åŸŸä¸‹æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè·Ÿx0æ»¡è¶³$|x0|&lt;M^{1&#x2F;d-Ïµ}$ .é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸d,1&#x2F;Ïµ,log(M)ç›¸å…³çš„å¤šé¡¹å¼æ—¶é—´å†…æ‰¾åˆ°x0.</p><p>è¯æ˜æœ‰ç‚¹æŠ½è±¡äº†è®ºæ–‡æ”¾è¿™é‡Œæœ‰ç©ºå†ç…ç…å§ï¼Œæˆ‘ç›´æ¥å†™ä¸‹å‡ ä¸ªè„šæœ¬ç”¨å¾—åˆ°çš„å…³ç³»å¼å­</p><p>hâ‰ˆ$1\over {dÏµ}$ ï¼Œdh&#x3D;nè¡¨ç¤ºæ ¼çš„ç»´åº¦ã€‚</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-01-22-220410.b902hjivk.webp"></p><ul><li>å…³äºå·²çŸ¥péƒ¨åˆ†ä¿¡æ¯åˆ†è§£n</li></ul><blockquote><p>è®¾$N&#x3D;pâˆ—q$å¹¶ä¸”æœ‰$p&lt;q&lt;2p$ï¼Œè®¾$0&lt;Ïµ&lt;14$4ï¼Œå¦‚æœæ»¡è¶³å…³ç³»ï¼š$|pâˆ’pâ€²|â‰¤$$$1\over{2\sqrt{2}} $$$$N^{1&#x2F;4âˆ’Ïµ}$$ï¼Œé‚£ä¹ˆç»™å®šNå’Œpâ€™,æˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸log(N)å’Œ1&#x2F;Ïµç›¸å…³çš„æ—¶é—´å¤æ‚åº¦å†…åˆ†è§£Nã€‚åŸç†è¯æ˜æœ‰ç‚¹å¥¥äº†</p></blockquote><p>ä¸¾ä¾‹:N&#x3D;16803551ï¼Œpâ€²&#x3D;2830ï¼ŒX&#x3D;10.</p><blockquote><p>è®¾F(x)&#x3D;(x+pâ€™),N,F(x)ï¼ŒxF(x)&#x3D;(x2+pâ€²x)ï¼Œx2F(x)</p><p>è€ƒè™‘å¤šé¡¹å¼ï¼šN,F(X),xF(x),$x^2F(X)$,ç„¶åæ„é€ æ ¼</p></blockquote><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-01-23-172218.5c12u1ryzi.webp"></p><p>LLLè§„çº¦åå¾—åˆ°ç¬¬ä¸€è¡Œçš„SVPä¸ºï¼ˆ105ï¼Œ-1200ï¼Œ800ï¼Œ1000ï¼‰ï¼Œå»é™¤X&#x3D;10å¯ä»¥å¾—åˆ°G(x)&#x3D;x3+8x2âˆ’120x+105ï¼›è§£çš„x&#x3D;7ï¼Œ</p><p>è¿™é‡Œçš„Nå¯ä»¥çœ‹ä½œkpï¼ŒæŠŠå®ƒçœ‹ä½œæ˜¯kâˆ—pä¹Ÿè®¸ä¼šå¥½ç†è§£äº›ï¼šæ‰€é€‰å–çš„å¤šé¡¹å¼å¸¦å…¥æ­£è§£xæ—¶å‡åœ¨æ¨¡pä¸‹ä¸0åŒä½™</p><h3 id="ä¸€äº›é¢˜ç›®-å•å…ƒcoppersmith"><a href="#ä¸€äº›é¢˜ç›®-å•å…ƒcoppersmith" class="headerlink" title="ä¸€äº›é¢˜ç›®(å•å…ƒcoppersmith)"></a>ä¸€äº›é¢˜ç›®(å•å…ƒcoppersmith)</h3><h4 id="å·²çŸ¥Pé«˜ä½"><a href="#å·²çŸ¥Pé«˜ä½" class="headerlink" title="å·²çŸ¥Pé«˜ä½"></a>å·²çŸ¥Pé«˜ä½</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, bytes_to_long, inverse<br><br>flag=<span class="hljs-string">b&#x27;fox&#123;fox want to eat what&#125;&#x27;</span><br>p=getPrime(<span class="hljs-number">512</span>)<br>p_high=(p&gt;&gt;<span class="hljs-number">200</span>)&lt;&lt;<span class="hljs-number">200</span><br><span class="hljs-built_in">print</span>(p_high)<br>q=getPrime(<span class="hljs-number">512</span>)<br>e=<span class="hljs-number">0b10001</span><br>n=p*q<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p=&quot;</span>,p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q=&quot;</span>,q)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n=&quot;</span>,n)<br>m=bytes_to_long(flag)<br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c=&quot;</span>,c)<br></code></pre></td></tr></table></figure><p>è§£å¯†ä»£ç ï¼Œè¿™é‡Œå¼•ç”¨çš„betaè¡¨ç¤ºNä¸pçš„æŒ‡æ•°å…³ç³»åœ¨(0.4,0.5ï¼‰è€Œä¸”ä¸€èˆ¬å·²çŸ¥pçš„ä¿¡æ¯çš„æ¯”ç‰¹ä½æ•°è¦ä¸ºpæœ¬èº«æ¯”ç‰¹ä½æ•°çš„ä¸€èˆ¬ä»¥ä¸Šè°ƒæ•´betaå¯ä»¥å¢åŠ ä¸Šé™Xä½†æ˜¯ä¼šå¯¼è‡´æ—¶é—´å¤æ‚åº¦å¢å¤§ï¼Œ,å¦å¤–å…¶å®è¿˜è¦ä¸€ä¸ªÏµ(epsilon)ç”¨æ¥çº¦æŸå¤šé¡¹å¼çš„æ ¹ï¼Œä¸€èˆ¬è®¾ç½®åœ¨0.01åˆ°0.05çš„æ ·å­ï¼Œä¹Ÿå¯ä»¥åœ¨è¿™ä¸ªç°æˆçš„å‡½æ•°ä¸­è®¾ç½®ï¼Œè¶Šå°çº¦æŸè¶Šä¸¥æ ¼ä½†æ˜¯ä¹Ÿä¼šå½±å“è¿ç®—æ—¶é—´</p><p>å¯ä»¥åœ¨è¿™ä¸ªè„šæœ¬å®ç°æºç çœ‹çœ‹ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>N=<span class="hljs-number">133710312641113123859964440077377533712342702504367787255182846824724010714496099762855320340674761905445770124260476807002239449704342315985473499561372208925050652507764912706096791716888012136098375017749241890296762979638092647971448134034808167719762321413756060356748672986521523183243757912647146630053</span><br>e=<span class="hljs-number">0b10001</span><br>c= <span class="hljs-number">65557915039839389047479107840683903322175662706377407690136936904175441214121027091201698676495252709350177099515464449769710120030105578393734170368995189857074788448412022342701700787139604106626472335713315769690072453661188617266051033715771747892127805257411819414888757977975890254221744212355033949446</span><br><br>p1=<span class="hljs-number">10588155095945660931536816256842811488117167553129301589697663144204701166787360146714639470812049936139282091010528731135222839016760257988792628488962048</span><br>ZmodN = Zmod(N)<br>P.&lt;x&gt;=PolynomialRing(ZmodN)<br>f=p1+x<br>x0=f.small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">200</span>,beta=<span class="hljs-number">0.4</span>)<br>p=p1+x0[<span class="hljs-number">0</span>]<br>p=<span class="hljs-built_in">int</span>(p)<br>q=N//p<br>h=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = inverse_mod(e,h)<br>m=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c,d,N))<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><ul><li>è¡¥å……ï¼Œå¦‚æœæ˜¯æ±‚ä½ä½å¯ä»¥,&#96;&#96;è®¾f&#x3D;p+x*2^kbits,ç„¶åf &#x3D; f.monic()åŒ–ç³»æ•°ä¸º1</li></ul><h4 id="å·²çŸ¥dä½ä½"><a href="#å·²çŸ¥dä½ä½" class="headerlink" title="å·²çŸ¥dä½ä½"></a>å·²çŸ¥dä½ä½</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, bytes_to_long, inverse<br><br>flag=<span class="hljs-string">b&#x27;fox&#123;fox want to sleep&#125;&#x27;</span><br>p=getPrime(<span class="hljs-number">512</span>)<br>q=getPrime(<span class="hljs-number">512</span>)<br>e=<span class="hljs-number">49</span><br>n=p*q<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p=&quot;</span>,p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q=&quot;</span>,q)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n=&quot;</span>,n)<br>m=bytes_to_long(flag)<br>d=inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>d0=d&amp;((<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">512</span>)-<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;d0=&quot;</span>,d0)<br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c=&quot;</span>,c)<br><br></code></pre></td></tr></table></figure><p>å·²çŸ¥dçš„ä½512ä½ï¼Œéœ€è¦å…ˆæ¨å¯¼æ±‚å‡ºpä½ä½ç„¶åå†åˆ©ç”¨pä½ä½æ±‚æ³•æ±‚å‡ºp</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-01-21-214742.2ks0rr9581.webp"></p><p>kå¿…ç„¶æ˜¯å°äºeçš„æ‰€ä»¥()å¦‚æœeæ¯”è¾ƒå°å¯ä»¥ç”¨çˆ†ç ´ï¼Œè€Œä¸”å¾—åˆ°çš„p0ä¸ä¸€å®šå°±æ˜¯ä½ä½æ‰€ä»¥éœ€è¦å’Œnæ±‚å…¬çº¦æ•°è®¡ç®—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">re</span>(<span class="hljs-params">p0,n</span>):<br>    P.&lt;x&gt; = PolynomialRing(Zmod(n))<br>    pb=p0.nbits()<br>    nb=n.nbits()<br>    f = p0 + x*<span class="hljs-number">2</span>^pb<br>    f = f.monic()<br>    r = f.small_roots(X=<span class="hljs-number">2</span>^(nb//<span class="hljs-number">2</span>-pb),beta=<span class="hljs-number">0.4</span>)<br>    <span class="hljs-keyword">if</span> r:<span class="hljs-comment">#ä¸ä¸€å®šæ˜¯p0æ‰€ä»¥éœ€è¦çˆ†ç ´ä¸€ä¸‹</span><br>        x0 = r[<span class="hljs-number">0</span>]<br>        p = gcd(x0*<span class="hljs-number">2</span>^pb + p0, n)<br>        <span class="hljs-keyword">return</span> ZZ(p)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">re_p0</span>(<span class="hljs-params">d0,e,n</span>):<br>    X=var(<span class="hljs-string">&#x27;X&#x27;</span>)<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,e+<span class="hljs-number">1</span>):<br>        res=solve_mod([e*d0*X == k*n*X + k*X + X-k*X**<span class="hljs-number">2</span> - k*n],<span class="hljs-number">2</span>^d0.nbits())<br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> res:<br>            p0=ZZ(x[<span class="hljs-number">0</span>])<br>            p=re(p0,n)<br>            <span class="hljs-keyword">if</span> p <span class="hljs-keyword">and</span> p!=<span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">return</span> p<br>e=<span class="hljs-number">49</span><br>n= <span class="hljs-number">109414997218017430689750411358870671148755060537823638639312822690278731526747343386131161374178565377568510541067027291819153801268584631898655552531100229691697272740485676268557392576883083322538380985686287633325507643109809662875001865516112341416350089749503409352233344213405771505339817806009334467873</span><br>d0= <span class="hljs-number">6589907493136215112152812078061957297077302140846480772722502061060417041525745970773308362109848374417314681016788951311262599036142398830169352909596817</span><br>c= <span class="hljs-number">52618099026096173424982985915057984673936322178451784029192431909399153643977616885476290932528093004726036699015260255387007582939696987106414732619027888230272826489001101650428442052309028725473145170506018789419664921530741182296203037987680548988272155176048872109505915948350201120031522636544622010733</span><br>p=re_p0(d0,e,n)<br>q=n//p<br>d=inverse_mod(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br>â€™â€˜â€™<br>ä¸€èˆ¬æ¥è¯´eæ˜¯ç´ æ•°ä½†æ˜¯æˆ‘å½“æ—¶åº”è¯¥æ˜¯å†™é”™äº†é¢˜ç›®è„šæœ¬ä½†æ˜¯ä»ç„¶èƒ½è·‘<br>â€˜â€™â€˜<br></code></pre></td></tr></table></figure><h4 id="å·²çŸ¥dé«˜ä½"><a href="#å·²çŸ¥dé«˜ä½" class="headerlink" title="å·²çŸ¥dé«˜ä½"></a>å·²çŸ¥dé«˜ä½</h4><p>é¢˜ç›®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> m1<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">task1</span>():<br>    e = <span class="hljs-number">149</span><br>    p = getPrime(<span class="hljs-number">512</span>)<br>    q = getPrime(<span class="hljs-number">512</span>)<br>    n = p * q<br>    d = inverse(e,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">pow</span>(m1, e, n), d &gt;&gt; <span class="hljs-number">222</span> &lt;&lt; <span class="hljs-number">222</span>, n)<br>    <br>c1, leak1, n1 = task1()<br><span class="hljs-built_in">print</span>(c1, leak1, n1)<br><span class="hljs-comment"># (89623543982221289730635223555830551523170205418976759060541832483843039074358160566735322009158596405712449020903311144480669706226166537602750967447480664875090686428406188847601970724994074417752345460791736191511081890913041143570455636020205647345764692062144226011846336769477026234106683791286490222089, 138474880017294332349992670187778287774153347391371789199005713563195654993662610111557185709277805165708109047494971468100563949333712521647405765501704478862377527360106399421209690341743821320754482338590671565510629203215009008479290995785318405211007685664887994061938667418220613430135743123498167435264, 146331610798417415036517077006943013321623040860385791423062775325646472298267580898028515394910588437521335092742913111680737790430660749825981979147191282007208147041227246620008377726207734522466015971515317594545750944838673018946440525615131606652748549901880641896940968837669894325535750125282351577689)</span><br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œl e a k d &#x3D; d &gt; &gt; 222 &lt; &lt; 222 </p><p>å’Œä¸Šé¢è®¡ç®—ä½ä½æ–¹æ³•ç±»ä¼¼ä½†æ˜¯è¿™é‡Œå¾—åˆ°åˆ°pä¸ä¸€å®šæ˜¯pé«˜ä½ï¼Œè¿™é‡Œçš„çœç•¥ä¹‹ç±»çš„ä¸ç®—å¾ˆæ˜ç™½</p><p>æœ‰ç‚¹æŠ½è±¡äº†ï¼Œä¸å¤ªç†è§£è¿™é‡Œé«˜ä½çš„è¯¯å·®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">full_p</span>(<span class="hljs-params">p_high, n,d_high,bits</span>):<br>    PR.&lt;x&gt; = PolynomialRing(Zmod(n))    <br>    f = x + p_high<br>    f = f.monic()<br>    roots = f.small_roots(X=<span class="hljs-number">2</span>^(bits + <span class="hljs-number">4</span>), beta=<span class="hljs-number">0.4</span>)  <br>    <span class="hljs-keyword">if</span> roots:<br>        x0 = roots[<span class="hljs-number">0</span>]<br>        p = gcd(x0 + p_high, n)<br>        <span class="hljs-keyword">return</span> ZZ(p)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">p_high</span>(<span class="hljs-params">d_high, e, n,bits</span>):<br>    PR.&lt;X&gt; = PolynomialRing(RealField(<span class="hljs-number">1000</span>))<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, e+<span class="hljs-number">1</span>)):<br>        f=e * d_high * X - (k*n*X + k*X + X-k*X**<span class="hljs-number">2</span> - k*n)<br>        results = f.roots()<br>        <span class="hljs-keyword">if</span> results:<br>            <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> results:<br>                p_high = <span class="hljs-built_in">int</span>(x[<span class="hljs-number">0</span>])<br>                p = full_p(p_high, n,d_high,bits)<br>                <span class="hljs-keyword">if</span> p <span class="hljs-keyword">and</span> p != <span class="hljs-number">1</span>:<br>                    <span class="hljs-keyword">return</span> p<br><br><br>c1 = <span class="hljs-number">89623543982221289730635223555830551523170205418976759060541832483843039074358160566735322009158596405712449020903311144480669706226166537602750967447480664875090686428406188847601970724994074417752345460791736191511081890913041143570455636020205647345764692062144226011846336769477026234106683791286490222089</span><br>leak1 = <span class="hljs-number">138474880017294332349992670187778287774153347391371789199005713563195654993662610111557185709277805165708109047494971468100563949333712521647405765501704478862377527360106399421209690341743821320754482338590671565510629203215009008479290995785318405211007685664887994061938667418220613430135743123498167435264</span><br>n1 = <span class="hljs-number">146331610798417415036517077006943013321623040860385791423062775325646472298267580898028515394910588437521335092742913111680737790430660749825981979147191282007208147041227246620008377726207734522466015971515317594545750944838673018946440525615131606652748549901880641896940968837669894325535750125282351577689</span><br>e1 = <span class="hljs-number">149</span><br>p1 = p_high(leak1, e1, n1,<span class="hljs-number">222</span>)<br>q1 = n1 // p1<br>d1 = inverse(e1,(p1 - <span class="hljs-number">1</span>) * (p1 - <span class="hljs-number">1</span>))<br>m1 = <span class="hljs-built_in">pow</span>(c1,<span class="hljs-built_in">int</span>(d1),n1)<br><span class="hljs-built_in">print</span>(m1)<br></code></pre></td></tr></table></figure><h3 id="SU-rsa"><a href="#SU-rsa" class="headerlink" title="SU_rsa"></a>SU_rsa</h3><p>åº”è¯¥ç®—æ˜¯æ¯”è¾ƒå®¹æ˜“åˆ†æçš„ç®€å•rsa</p><p>ç”±äºç»™çš„æ˜¯dçš„é«˜ä½ï¼Œç›´æ¥å¯ä»¥ç”¨å¾—åˆ°k(è¿™ç®—æ˜¯ä¸€ç§æ•´é™¤ï¼Œå½“æ—¶ç¡®å®æ²¡æƒ³åˆ°è¿™ç§æ–¹æ³•ï¼Œå› ä¸ºnå’Œp,q,kå·®å€¼è¿‡å¤§æ‰€ä»¥kå¯ä»¥åˆ©ç”¨æ•´é™¤æ±‚å‡ºæ¥)<br>$$<br>k&#x3D;(e<em>d_m-1)&#x2F;&#x2F;n + 1<br>$$<br>ç”±æ ‡å‡†å…³ç³»å¾—åˆ°<br>$$<br>k</em>(n-p-q+1)+1&#x3D;&#x3D;e*d\<br>(p+q) &#x3D;(n+1+k^{-1})\mod e<br>$$<br>ç›¸å½“äºç»™å‡ºäº†p%eæˆ–è€…q%eçš„å€¼ï¼Œeä¸º256bitsï¼Œæ˜¾ç„¶small_rootsæ±‚è§£ä¸€ä¸‹å°±è¡Œã€‚ </p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œç”±äºå–çš„ä½ä½æ¯”è¾ƒå°ï¼Œå·²çŸ¥ä¿¡æ¯æ¯”è¾ƒå°‘ï¼Œéœ€è¦çˆ†ç ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>d_m =  <span class="hljs-number">54846367460362174332079522877510670032871200032162046677317492493462931044216323394426650814743565762481796045534803612751698364585822047676578654787832771646295054609274740117061370718708622855577527177104905114099420613343527343145928755498638387667064228376160623881856439218281811203793522182599504560128</span><br>n =  <span class="hljs-number">102371500687797342407596664857291734254917985018214775746292433509077140372871717687125679767929573899320192533126974567980143105445007878861163511159294802350697707435107548927953839625147773016776671583898492755338444338394630801056367836711191009369960379855825277626760709076218114602209903833128735441623</span><br>e =  <span class="hljs-number">112238903025225752449505695131644979150784442753977451850362059850426421356123</span><br>k = (e*d_m-<span class="hljs-number">1</span>)//n + <span class="hljs-number">1</span><br>s = (n+<span class="hljs-number">1</span>+inverse_mod(k, e))%e<br>PR.&lt;x&gt; = PolynomialRing(Zmod(e))<br>f = x^<span class="hljs-number">2</span>-s*x+n<br>p0 = <span class="hljs-built_in">int</span>(f.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(p0)<br><span class="hljs-keyword">import</span> multiprocessing<br><span class="hljs-keyword">import</span> tqdm<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">copper_attack</span>(<span class="hljs-params">i</span>):<br>    PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>    f = e*(<span class="hljs-number">2</span>^<span class="hljs-number">12</span>*x + i) + p0<br>    f = f.monic()<br>    res = f.small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">244</span>, beta=<span class="hljs-number">0.499</span>, epsilon=<span class="hljs-number">0.02</span>)<br>    <span class="hljs-keyword">if</span>(res != []):<br>        t = <span class="hljs-built_in">int</span>(res[<span class="hljs-number">0</span>])<br>        p = e*(<span class="hljs-number">2</span>^<span class="hljs-number">12</span>*t + i) + p0<br>        q = n // p<br>        <span class="hljs-keyword">assert</span> p * q == n <span class="hljs-keyword">and</span> isPrime(p) <span class="hljs-keyword">and</span> isPrime(q)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">b&#x27;SUCTF&#123;&#x27;</span>,sha256(<span class="hljs-built_in">str</span>(p).encode()).hexdigest()[:<span class="hljs-number">32</span>],<span class="hljs-string">b&#x27;&#125;&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">b&#x27;SUCTF&#123;&#x27;</span>,sha256(<span class="hljs-built_in">str</span>(q).encode()).hexdigest()[:<span class="hljs-number">32</span>],<span class="hljs-string">b&#x27;&#125;&#x27;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-keyword">with</span> multiprocessing.Pool(processes=<span class="hljs-number">16</span>) <span class="hljs-keyword">as</span> pool:<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> tqdm.tqdm(pool.imap(copper_attack, <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>^<span class="hljs-number">12</span>)), total=<span class="hljs-built_in">int</span>(<span class="hljs-number">2</span>^<span class="hljs-number">12</span>)):<br>        <span class="hljs-keyword">if</span>(_):<br>            <span class="hljs-keyword">break</span><span class="hljs-comment">#å¤šçº¿ç¨‹</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>python</category>
      
      <category>crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2025/01/11/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%94%9F%E6%88%90%E5%99%A8(PRNG)/"/>
    <url>/2025/01/11/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%94%9F%E6%88%90%E5%99%A8(PRNG)/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¼ªéšæœºæ•°ç”Ÿæˆå™¨-PRNG"><a href="#ä¼ªéšæœºæ•°ç”Ÿæˆå™¨-PRNG" class="headerlink" title="ä¼ªéšæœºæ•°ç”Ÿæˆå™¨(PRNG)"></a>ä¼ªéšæœºæ•°ç”Ÿæˆå™¨(PRNG)</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>éšæœºæ•°ç”Ÿæˆåˆ†ä¸ºä¼ªéšæœºï¼ŒçœŸéšæœºã€‚çœŸéšæœºæ˜¯åˆ©ç”¨ç°å®ä¸­çš„ç”µå­å…ƒä»¶å™ªéŸ³æ¥ç”Ÿäº§çš„ã€‚</p><p>ä¼ªéšæœºæ•°ï¼šç”¨çœŸéšæœºæ•°ç”Ÿæˆç§å­ï¼Œç”¨ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ç”Ÿæˆä¼ªéšæœºæ•°ä½æµ</p><p>PRNGç®—æ³•å¤§è‡´åˆ†ä¸ºä¸¤ç±»ï¼š </p><ul><li><p>ä¸“ç”¨ç®—æ³•ï¼šä¸ºç”Ÿæˆä¼ªéšæœºä½æµè€Œä¸“é—¨è®¾è®¡ã€‚ </p></li><li><p>åŸºäºç°æœ‰å¯†ç ç®—æ³•çš„ç®—æ³•ï¼šå¯†ç ç®—æ³•ä¼šéšæœºåŒ–è¾“å…¥æ•°æ®ã€‚</p><ul><li>å¯¹ç§°åˆ†ç»„å¯†ç ã€</li><li>å“ˆå¸Œå‡½æ•°</li><li>æ¶ˆæ¯éªŒè¯ç </li></ul></li></ul><h2 id="ä¸“ç”¨ç®—æ³•"><a href="#ä¸“ç”¨ç®—æ³•" class="headerlink" title="ä¸“ç”¨ç®—æ³•"></a>ä¸“ç”¨ç®—æ³•</h2><h3 id="LCG-çº¿æ€§åŒä½™ç”Ÿæˆå™¨"><a href="#LCG-çº¿æ€§åŒä½™ç”Ÿæˆå™¨" class="headerlink" title="LCG(çº¿æ€§åŒä½™ç”Ÿæˆå™¨)"></a>LCG(çº¿æ€§åŒä½™ç”Ÿæˆå™¨)</h3><p>$x_{n+1}&#x3D;(aX_n+b)mod m$</p><blockquote><p>mï¼Œæ˜¯æ¨¡é‡ï¼Œaæ˜¯ä¹˜æ•°ï¼Œbæ˜¯å¢é‡</p><p>$X_n&#x3D;(a^{-1}(X_{n+1}-b))mod m$</p><p>$aâ‰¡(X_{n+1}âˆ’b)â‹…X_n^{âˆ’1}(modM)$æˆ–$a &#x3D; (X_{n+2} - X_{n+1})(X_{n+1} - X_n)^{-1} (mod m)$</p><p>$b &#x3D; X_{n+1} - aX_n (mod m)$</p><p>è®¾$t_n &#x3D; X_{n+1}- X_n$<br>$t_n &#x3D; (aX_n+b) - (aX_{n-1}+b) &#x3D; at_{n-1}(mod m)$<br>$t_{n+1}t_{n-1} - t_nt_n &#x3D; (aat_{n-1}t_{n-1} - at_{n-1}at_{n-1}) &#x3D; 0 (mod m)$<br>å³$T_n &#x3D; t_n+1t_{n-1} - t_nt_n$æ˜¯mçš„å€æ•°ï¼Œæ±‚Tn , Tn-1æœ€å¤§å…¬å› æ•°å³ä¸ºm<br>$m &#x3D; gcd((t_{n+1}t_{n-1} - t_nt_n) , (t_nt_{n-2} - t_{n-1}t_{n-1}))$</p></blockquote><h3 id="BBSç”Ÿæˆå™¨"><a href="#BBSç”Ÿæˆå™¨" class="headerlink" title="BBSç”Ÿæˆå™¨"></a>BBSç”Ÿæˆå™¨</h3>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>æ¥šæ…§æ¯(åŸé¢˜æ¯)æŠ½è±¡lcg</title>
    <link href="/2025/01/09/z3-LCG/"/>
    <url>/2025/01/09/z3-LCG/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="DASCTF-2024æ¥šæ…§æ¯åŸé¢˜æ¯-çš„ä¸€é“æŠ½è±¡lcgåšé¢˜è¿‡ç¨‹"><a href="#DASCTF-2024æ¥šæ…§æ¯åŸé¢˜æ¯-çš„ä¸€é“æŠ½è±¡lcgåšé¢˜è¿‡ç¨‹" class="headerlink" title="DASCTF(2024æ¥šæ…§æ¯åŸé¢˜æ¯)çš„ä¸€é“æŠ½è±¡lcgåšé¢˜è¿‡ç¨‹"></a>DASCTF(2024æ¥šæ…§æ¯åŸé¢˜æ¯)çš„ä¸€é“æŠ½è±¡lcgåšé¢˜è¿‡ç¨‹</h1><h3 id="ä¸€äº›åæ§½"><a href="#ä¸€äº›åæ§½" class="headerlink" title="ä¸€äº›åæ§½"></a>ä¸€äº›åæ§½</h3><p>ä¸ºä»€ä¹ˆç¿»éå…¨ç½‘éƒ½æ²¡æœ‰è¿™é“é¢˜wpï¼Œå¯¹äºçœŸèœçš„æˆ‘ï¼Œæ‰‹æ“æœ‰ç‚¹éš¾æ³µ</p><h3 id="åšé¢˜è¿‡ç¨‹"><a href="#åšé¢˜è¿‡ç¨‹" class="headerlink" title="åšé¢˜è¿‡ç¨‹"></a>åšé¢˜è¿‡ç¨‹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs pytho">from Crypto.Util.number import *<br>from random import *<br>from secret import flag<br><br>LENGTH = 512<br>RATIO = 0.02024<br>M = 2**LENGTH<br>a, b, seed = getPrime(LENGTH), getPrime(LENGTH), getPrime(LENGTH)<br>SEED = seed<br><br><br>x = []<br>for i in range(64):<br>    seed = (a*seed + b) % M<br>    x.append(&quot;&quot;.join([bin(seed)[2:].zfill(LENGTH)[i] if uniform(0,1) &lt; RATIO else &quot;*&quot; for i in range(LENGTH)]))<br><br><br>print(&quot;c =&quot;, bytes_to_long(flag) ^ SEED)<br>print(&quot;a =&quot;,a)<br>print(&quot;b =&quot;,b)<br>print(&quot;x =&quot;,x)<br><br></code></pre></td></tr></table></figure><p>å°è¯•æ¨¡æ‹Ÿä¸€ä¸ªç±»ä¼¼æƒ…</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs mel">from Crypto.Util.number import *<br>from random import *<br>a = <span class="hljs-number">7048435472566573813031570507837890091364947084306630050544242220147807292350445564322172244244726206563452305566866223414437853917448623276909090327076693</span><br>b = <span class="hljs-number">9204853069421046007176344891235245198607052139715825810823076231566533652655127030214860066312526149219510111657539481375881111759200483396551737326166933</span><br>f=b<span class="hljs-string">&#x27;flag&#123;yoxi_nidi_liangmin&#125;&#x27;</span><br>m=bytes_to_long(f)<br>M=<span class="hljs-number">2</span>**<span class="hljs-number">512</span><br><span class="hljs-keyword">seed</span>=<span class="hljs-number">8656702749867102422219200570484898209691959687594188444284921871713214793286935518322058853234901407306874127174670521978953484935737586264798208150365287</span><br>RATIO=<span class="hljs-number">0.6</span><br>Seed=<span class="hljs-keyword">seed</span><br><span class="hljs-keyword">print</span>(<span class="hljs-keyword">seed</span>)<br>x=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>):<br>    <span class="hljs-keyword">seed</span> = (a * <span class="hljs-keyword">seed</span> + b) % M<br>    <span class="hljs-keyword">print</span>(<span class="hljs-keyword">seed</span>)<br>    x.append(<span class="hljs-string">&quot;&quot;</span>.join([bin(<span class="hljs-keyword">seed</span>)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">512</span>)[i] <span class="hljs-keyword">if</span> <span class="hljs-keyword">uniform</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>) &lt; RATIO <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;*&quot;</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">512</span>)]))<br><span class="hljs-keyword">print</span>(<span class="hljs-keyword">seed</span>)<br><span class="hljs-keyword">print</span>(x)<br>c=m^Seed<br><span class="hljs-keyword">print</span>(c)<br><br></code></pre></td></tr></table></figure><p>æˆ‘æŠŠæ˜¾ç¤ºæ•°æ®ç™¾åˆ†æ¯”è°ƒé«˜äº†ä¸€ç‚¹ï¼Œå› ä¸ºæµ‹è¯•å¦‚æœå¤ªä½å°±æ˜¯å‡ºç°é”™è¯¯ç»“æœã€‚è¿™è¡Œä»£ç åŠ å¯†é€»è¾‘è·ŸåŸé¢˜ä¸€æ ·ã€‚è¿‡ç¨‹ä¹Ÿå¾ˆç®€æ´</p><p>æˆ‘ä»¬ä½¿ç”¨z3çº¦æŸã€‚ç”±äºæ˜¯æ‰å­¦çš„z3æœ‰çš„ï¼Œå†™çš„æ—¶å€™ä¹Ÿæœ‰äº›é—®é¢˜ï¼Œæ¯”å¦‚å®šä¹‰</p><p>BitVecå‘é‡åœ¨è½¬æ¢çš„æ—¶å€™ä¼šå‡ºç°ç±»å‹é”™è¯¯ã€‚è¿™æ˜¯æ”¹è¿›åçš„è§£å¼€ä¸Šè¿°è„šæœ¬çš„ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br><br>num = [[BitVec(<span class="hljs-string">f&#x27;num[<span class="hljs-subst">&#123;i&#125;</span>,<span class="hljs-subst">&#123;j&#125;</span>]&#x27;</span>, <span class="hljs-number">512</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>)] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>a = <br>b = <br>M = <span class="hljs-number">2</span>**<span class="hljs-number">512</span><br><br><br>A = []<br>s=Solver()<br><br><br><br>seed = []<br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">512</span>):<br>        <span class="hljs-keyword">if</span> A[i][j] == <span class="hljs-string">&#x27;0&#x27;</span>:<br>            s.add(Extract(<span class="hljs-number">511</span>-j, <span class="hljs-number">511</span>-j, num[i][<span class="hljs-number">0</span>]) == <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">elif</span> A[i][j] == <span class="hljs-string">&#x27;1&#x27;</span>:<br>            s.add(Extract(<span class="hljs-number">511</span>-j, <span class="hljs-number">511</span>-j, num[i][<span class="hljs-number">0</span>]) == <span class="hljs-number">1</span>)<br><br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>    s.add(num[i+<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] == (a * num[i][<span class="hljs-number">0</span>] + b) % M)<br><br><br><span class="hljs-keyword">if</span> s.check() == sat:<br>    model = s.model()<br>    Seed=model[num[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]]<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹é¢˜ç›®æœ¬èº«</p><p>64æ­¤Lcgé€’æ¨ï¼Œå¾—åˆ°64ä¸ªè¢«å¤§éƒ¨åˆ†éšè—çš„äºŒè¿›åˆ¶ä½æˆ‘ä»¬éœ€è¦æ±‚åˆ°ç¬¬ä¸€ä¸ªè¢«é€’å½’çš„å†åæ¨å‡ºSEEDã€‚è§£å¯†è¿‡ç¨‹çœ‹èµ·æ¥è¿˜ç®—ç®€å•ä½†æ˜¯ï¼Œè®¡ç®—ä¹Ÿéœ€è¦æ—¶é—´æˆ‘çš„è„šæœ¬å¤§æ¦‚ç®—äº†åŠä¸ªå°æ—¶ã€‚<br>è¡¥å……</p><blockquote><p>Extractè¿™ä¸€éƒ¨åˆ†æ˜¯å®šä¹‰èµ·å§‹å’Œç»“æŸä½ç½®</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br><br>num = [BitVec(<span class="hljs-string">f&#x27;num[<span class="hljs-subst">&#123;i&#125;</span>]&#x27;</span>, <span class="hljs-number">512</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>)]<span class="hljs-comment">#æœ‰ç‚¹åƒäºŒç»´æ•°ç»„ï¼Œæ˜¯é‡ç‚¹å¾—ç†è§£ä¸€ä¸‹,512è¿™é‡Œæ˜¯num[i]ä¸€ä¸ªçš„å¤§å°ã€‚æˆ‘ä»¬å®šä¹‰j</span><br><br><br>a = <span class="hljs-number">7048435472566573813031570507837890091364947084306630050544242220147807292350445564322172244244726206563452305566866223414437853917448623276909090327076693</span><br>b = <span class="hljs-number">9204853069421046007176344891235245198607052139715825810823076231566533652655127030214860066312526149219510111657539481375881111759200483396551737326166933</span><br>M = <span class="hljs-number">2</span>**<span class="hljs-number">512</span><br>c = <span class="hljs-number">168815802663712138791999335515513916578434659976069633486645257813364375941625207868153496481655635421252190634818222465004994343266249958687663356753760620029589052494330932123212</span><br>A=[]<br><br>s=Solver()<br><br>seed = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">512</span>):<br>        <span class="hljs-keyword">if</span> A[i][j] == <span class="hljs-string">&#x27;0&#x27;</span>:<br>            s.add(Extract(<span class="hljs-number">511</span>-j, <span class="hljs-number">511</span>-j, num[i]) == <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">elif</span> A[i][j] == <span class="hljs-string">&#x27;1&#x27;</span>:<br>            s.add(Extract(<span class="hljs-number">511</span>-j, <span class="hljs-number">511</span>-j, num[i]) == <span class="hljs-number">1</span>)<span class="hljs-comment">#å®šä¹‰æ›¿æ¢ä½ç½®</span><br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">63</span>):<br>    s.add(num[i+<span class="hljs-number">1</span>] == (a * num[i] + b) % M)<br><br><span class="hljs-keyword">if</span> s.check() == sat:<br><br>    model = s.model()<br>    Seed=model[num[<span class="hljs-number">0</span>]]<br>    <span class="hljs-built_in">print</span>(Seed)<br>ç„¶å<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">3109110488358343346016940967694590460203057088734099480714916540569545873216239855284197469883314735576988812243170940490083088872700634135415701390964362</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br>a_1 = <span class="hljs-built_in">pow</span>(a, -<span class="hljs-number">1</span>, M)<br>seed = (a_1 * (Seed - b)) % M<br>m = c ^ seed<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">b&#x27;DASCTF&#123;0n\x85\xb8\xffU_know_th3_polynomial_0F_D47a_you_can_m@ke_Use_of_Leak_bits!&#125;&#x27;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>z3</category>
      
      <category>crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
      <tag>python</tag>
      
      <tag>Lcg</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DSAç­¾åç®—æ³•</title>
    <link href="/2024/12/29/DSA%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95/"/>
    <url>/2024/12/29/DSA%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="DSAç­¾åç®—æ³•"><a href="#DSAç­¾åç®—æ³•" class="headerlink" title="DSAç­¾åç®—æ³•"></a>DSAç­¾åç®—æ³•</h1><h2 id="DSAç®—æ³•ç®€ä»‹"><a href="#DSAç®—æ³•ç®€ä»‹" class="headerlink" title="DSAç®—æ³•ç®€ä»‹"></a>DSAç®—æ³•ç®€ä»‹</h2><p>DSAï¼ˆDigital Signature Algorithmï¼‰æ˜¯Schnorrå’ŒElGamal<a href="https://zhida.zhihu.com/search?content_id=165246664&content_type=Article&match_order=1&q=%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95&zhida_source=entity">ç­¾åç®—æ³•</a>çš„å˜ç§ï¼Œè¢«ç¾å›½NISTä½œä¸ºDSS(DigitalSignature Standard) æ•°å­—ç­¾åçš„æ ‡å‡†ã€‚</p><p>DSAæ˜¯ä¸€ç§æ›´é«˜çº§çš„éªŒè¯æ–¹å¼ï¼Œå®ƒæ˜¯ä¸€ç§<a href="https://zhida.zhihu.com/search?content_id=165246664&content_type=Article&match_order=1&q=%E5%85%AC%E5%BC%80%E5%AF%86%E9%92%A5%E7%AE%97%E6%B3%95&zhida_source=entity">å…¬å¼€å¯†é’¥ç®—æ³•</a>ï¼Œä¸èƒ½ç”¨æ¥åŠ å¯†æ•°æ®ï¼Œä¸€èˆ¬ç”¨äºæ•°å­—ç­¾åå’Œè®¤è¯ã€‚DSA ä¸å•å•åªæœ‰å…¬é’¥ã€ç§é’¥ï¼Œè¿˜æœ‰æ•°å­—ç­¾åã€‚ç§é’¥åŠ å¯†ç”Ÿæˆæ•°å­—ç­¾åï¼Œå…¬é’¥éªŒè¯æ•°æ®åŠç­¾åã€‚åœ¨DSAæ•°å­—ç­¾åå’Œè®¤è¯ä¸­ï¼Œå‘é€è€…ä½¿ç”¨è‡ªå·±çš„ç§é’¥å¯¹æ–‡ä»¶æˆ–æ¶ˆæ¯è¿›è¡Œç­¾åï¼Œæ¥å—è€…æ”¶åˆ°æ¶ˆæ¯åä½¿ç”¨å‘é€è€…çš„å…¬é’¥æ¥éªŒè¯ç­¾åçš„çœŸå®æ€§ï¼ŒåŒ…æ‹¬æ•°æ®çš„å®Œæ•´æ€§ä»¥åŠæ•°æ®å‘é€è€…çš„èº«ä»½ã€‚å¦‚æœæ•°æ®å’Œç­¾åä¸åŒ¹é…åˆ™è®¤ä¸ºéªŒè¯å¤±è´¥ï¼æ•°å­—ç­¾åçš„ä½œç”¨å°±æ˜¯æ ¡éªŒæ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¢«ä¿®æ”¹ã€‚</p><p>DSAæ•°å­—ç­¾åå¯ä»¥ç†è§£ä¸ºæ˜¯<a href="https://zhida.zhihu.com/search?content_id=165246664&content_type=Article&match_order=1&q=%E5%8D%95%E5%90%91%E5%8A%A0%E5%AF%86&zhida_source=entity">å•å‘åŠ å¯†</a>çš„å‡çº§ï¼Œä¸ä»…æ ¡éªŒæ•°æ®å®Œæ•´æ€§ï¼Œè¿˜æ ¡éªŒå‘é€è€…èº«ä»½ï¼ŒåŒæ—¶è¿˜ç”±äºä½¿ç”¨äº†éå¯¹ç§°çš„å¯†é’¥æ¥ä¿è¯å¯†é’¥çš„å®‰å…¨ï¼Œæ‰€ä»¥ç›¸æ¯”æ¶ˆæ¯æ‘˜è¦ç®—æ³•æ›´å®‰å…¨ã€‚</p><p>DSAåªæ˜¯ä¸€ç§ç®—æ³•ï¼Œå’ŒRSAä¸åŒä¹‹å¤„åœ¨äºå®ƒä¸èƒ½ç”¨ä½œåŠ å¯†å’Œè§£å¯†ï¼Œä¹Ÿä¸èƒ½è¿›è¡Œ<a href="https://zhida.zhihu.com/search?content_id=165246664&content_type=Article&match_order=1&q=%E5%AF%86%E9%92%A5%E4%BA%A4%E6%8D%A2&zhida_source=entity">å¯†é’¥äº¤æ¢</a>ï¼Œåªç”¨äºç­¾å,å®ƒæ¯”RSAè¦å¿«å¾ˆå¤šã€‚</p><h2 id="DSAç®—æ³•ç­¾åçš„è¿‡ç¨‹"><a href="#DSAç®—æ³•ç­¾åçš„è¿‡ç¨‹" class="headerlink" title="DSAç®—æ³•ç­¾åçš„è¿‡ç¨‹"></a>DSAç®—æ³•ç­¾åçš„è¿‡ç¨‹</h2><ol><li>ä½¿ç”¨<a href="https://zhida.zhihu.com/search?content_id=165246664&content_type=Article&match_order=2&q=%E6%B6%88%E6%81%AF%E6%91%98%E8%A6%81%E7%AE%97%E6%B3%95&zhida_source=entity">æ¶ˆæ¯æ‘˜è¦ç®—æ³•</a>ï¼ˆä¾‹å¦‚sha-256&#x2F;md5)å°†è¦å‘é€æ•°æ®åŠ å¯†ç”Ÿæˆä¿¡æ¯æ‘˜è¦ã€‚</li><li>å‘é€æ–¹ç”¨è‡ªå·±çš„DSAç§é’¥å¯¹ä¿¡æ¯æ‘˜è¦å†åŠ å¯†ï¼Œå½¢æˆæ•°å­—ç­¾åã€‚</li><li>å°†åŸæŠ¥æ–‡å’ŒåŠ å¯†åçš„æ•°å­—ç­¾åä¸€å¹¶é€šè¿‡äº’è”ç½‘ä¼ ç»™æ¥æ”¶æ–¹ã€‚</li><li>æ¥æ”¶æ–¹ç”¨å‘é€æ–¹çš„å…¬é’¥å¯¹æ•°å­—ç­¾åè¿›è¡Œè§£å¯†ï¼ŒåŒæ—¶å¯¹æ”¶åˆ°çš„æ•°æ®ç”¨æ¶ˆæ¯æ‘˜è¦ç®—æ³•äº§ç”ŸåŒä¸€ä¿¡æ¯æ‘˜è¦ã€‚</li><li>å°†è§£å¯†åçš„ä¿¡æ¯æ‘˜è¦å’Œæ”¶åˆ°çš„æ•°æ®åœ¨æ¥æ”¶æ–¹é‡æ–°åŠ å¯†äº§ç”Ÿçš„æ‘˜è¦è¿›è¡Œæ¯”å¯¹æ ¡éªŒï¼Œå¦‚æœä¸¤è€…ä¸€è‡´ï¼Œåˆ™è¯´æ˜åœ¨ä¼ é€è¿‡ç¨‹ä¸­ä¿¡æ¯æ²¡æœ‰ç ´åå’Œç¯¡æ”¹ï¼›å¦åˆ™ï¼Œåˆ™è¯´æ˜ä¿¡æ¯å·²ç»å¤±å»å®‰å…¨æ€§å’Œä¿å¯†æ€§ã€‚</li></ol><h2 id="ç®—æ³•åŸç†"><a href="#ç®—æ³•åŸç†" class="headerlink" title="ç®—æ³•åŸç†"></a>ç®—æ³•åŸç†</h2><p>DSAæ˜¯è¯ä¹¦åŸºäºæœ‰é™åŸŸç¦»æ•£å¯¹æ•°çš„éš¾é¢˜ã€‚</p><ul><li><strong>ç›¸å…³å‚æ•°</strong></li></ul><p>p:ä¸€ä¸ªç´ æ¨¡æ•°ï¼Œå…¶å€¼æ»¡è¶³:$2^ {L-1}&lt;p&lt;2^L,$  Læ˜¯64çš„å€æ•°æ»¡è¶³512&lt;&#x3D;L&lt;&#x3D;1024</p><p>q:(p-1)çš„ç´ æ•°å› å­ï¼Œå…¶å€¼æ»¡è¶³2^159^&lt;p&lt;2^160^ å³qé•¿åº¦ä¸º160.</p><p>g:g&#x3D;pow(h,(p-1)&#x2F;q,p).hæ»¡è¶³1&lt;h&lt;p-1 çš„ä»»æ„æ•´æ•°ï¼Œä»è€Œæœ‰pow(h,(p-1)&#x2F;q,p)&gt;1</p><p>x:ç§é’¥ã€‚xä¸ºä¸€ä¸ªä¼ªéšæœºæˆ–éšæœºç”Ÿæˆçš„æ•´æ•°ï¼Œå…¶å€¼æ»¡è¶³0&lt;x&lt;q</p><p>y:å…¬é’¥ã€‚y&#x3D;pow(g,x,p)</p><ul><li><strong>DSAç­¾åè¿‡ç¨‹:</strong></li></ul><ol><li>äº§ç”Ÿä¸€ä¸ªéšæœºæ•°kï¼Œå…¶å€¼å¤§å°æ»¡è¶³0&lt;k&lt;qã€‚</li><li>è®¡ç®—r&#x3D;pow(g,k,p) mod p,å…¶å€¼æ»¡è¶³r&gt;0</li><li>è®¡ç®—$S&#x3D;ï¼ˆK^{-1}(SHA(M)+x*r))mod q$,å…¶å€¼æ»¡è¶³s&gt;0</li></ol><p>$k^{-1}$è¡¨ç¤ºæ•´æ•°kå…³äºæŸä¸ªæ¨¡çš„é€†å…ƒã€‚kåœ¨æ¯æ¬¡ç­¾åéƒ½é‡æ–°ç”Ÿæˆ</p><p>sha(M):Mçš„hashå€¼ï¼ŒMä¸ºå¾…ç­¾åçš„æ˜æ–‡ï¼Œshaæ˜¯ä¸€ä¸ªå•å‘æ•£åˆ—å‡½æ•°ã€‚SHA(M)æ˜¯ä¸€ä¸ªé•¿ä¸º160bitesçš„å­—ç¬¦ä¸²ã€‚</p><p>4ã€‚ æœ€ç»ˆç­¾åæ˜¯è¯ä¹¦å¯¹(r,s)ï¼Œå®ƒä»¬å’ŒMä¸€èµ·å‘é€åˆ°éªŒè¯æ–¹</p><ol start="5"><li>å°½ç®¡ r å’Œ s ä¸º 0 çš„æ¦‚ç‡ç›¸å½“å°ï¼Œä½†åªè¦æœ‰ä»»ä½•ä¸€ä¸ªä¸º 0 ï¼Œå¿…é¡»é‡æ–°ç”Ÿæˆ kï¼Œå¹¶é‡æ–°è®¡ç®— r å’Œ s</li></ol><ul><li><strong>DSAéªŒè¯ç­¾åè¿‡ç¨‹</strong></li></ul><blockquote><p>w&#x3D;s^-1^(mod p);è®¡ç®—u1&#x3D;SHA(M)*w(mod p)</p><p>u2&#x3D;r*w(mod q) </p><p>v&#x3D;(g^u1^y^u2^(mod p))(mod q)</p><p>éªŒè¯v&#x3D;r</p><p>r&#x3D;pow(g,k,p)(mod q)</p><p>æˆ‘ä»¬è¦è¯v&#x3D;rï¼Œ åªéœ€è¯æ˜$g^{u1}â‹…y^{u2}â‰¡g^k(modp)mod q$</p></blockquote><img src="https://raw.githubusercontent.com/rockfox0/picx-images-hosting/master/dsa1.7lk2cajx72.webp" style="zoom:33%;" /><h2 id="ä¸€é“å…³äºç­¾åçš„é¢˜"><a href="#ä¸€é“å…³äºç­¾åçš„é¢˜" class="headerlink" title="ä¸€é“å…³äºç­¾åçš„é¢˜"></a>ä¸€é“å…³äºç­¾åçš„é¢˜</h2><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><br>from secret import r<span class="hljs-punctuation">,</span> t<span class="hljs-punctuation">,</span>flag<br>from Crypto.Util.number import *<br><br>flag <span class="hljs-punctuation">=</span> bytes_to_long<span class="hljs-punctuation">(</span>flag.encode<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>e <span class="hljs-punctuation">=</span> <span class="hljs-number">65537</span><br><br>def gen_keys<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">:</span><br>    p <span class="hljs-punctuation">=</span> getPrime<span class="hljs-punctuation">(</span><span class="hljs-number">1024</span><span class="hljs-punctuation">)</span><br>    q <span class="hljs-punctuation">=</span> getPrime<span class="hljs-punctuation">(</span><span class="hljs-number">1024</span><span class="hljs-punctuation">)</span><br>    phi <span class="hljs-punctuation">=</span> <span class="hljs-punctuation">(</span>p<span class="hljs-punctuation">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span>*<span class="hljs-punctuation">(</span>q<span class="hljs-punctuation">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><br>    d <span class="hljs-punctuation">=</span> inverse<span class="hljs-punctuation">(</span>e<span class="hljs-punctuation">,</span>phi<span class="hljs-punctuation">)</span><br>    n <span class="hljs-punctuation">=</span> p*q<br>    print<span class="hljs-punctuation">(</span>f&#x27;n = &#123;n&#125;&#x27;<span class="hljs-punctuation">)</span><br>    Gensin_imapct <span class="hljs-punctuation">=</span> <span class="hljs-punctuation">(</span>d ** <span class="hljs-number">6</span> <span class="hljs-punctuation">+</span> <span class="hljs-number">7</span><span class="hljs-punctuation">)</span> % phi<br>    print<span class="hljs-punctuation">(</span>f&#x27;Gensin_imapct= &#123;Gensin_imapct&#125;&#x27;<span class="hljs-punctuation">)</span><br>    return d<span class="hljs-punctuation">,</span> n<span class="hljs-punctuation">,</span> Gensin_imapct<br><br>def sign_in<span class="hljs-punctuation">(</span>n<span class="hljs-punctuation">,</span>d<span class="hljs-punctuation">)</span><span class="hljs-punctuation">:</span><br>    m <span class="hljs-punctuation">=</span> flag * <span class="hljs-built_in">pow</span><span class="hljs-punctuation">(</span>r<span class="hljs-punctuation">,</span>e**<span class="hljs-number">3</span><span class="hljs-punctuation">+</span>d**<span class="hljs-number">4</span><span class="hljs-punctuation">,</span>n<span class="hljs-punctuation">)</span> % n<br>    s <span class="hljs-punctuation">=</span> <span class="hljs-built_in">pow</span><span class="hljs-punctuation">(</span>m<span class="hljs-punctuation">,</span>d**<span class="hljs-number">2</span><span class="hljs-punctuation">,</span>n<span class="hljs-punctuation">)</span><br>    return s<br><br>def clue<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">:</span><br>    assert t &gt; <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>r &gt; <span class="hljs-number">1</span><br>    clue <span class="hljs-punctuation">=</span> <span class="hljs-built_in">pow</span><span class="hljs-punctuation">(</span>r<span class="hljs-punctuation">,</span>t<span class="hljs-punctuation">)</span><span class="hljs-punctuation">+</span><span class="hljs-number">1</span><br>    <span class="hljs-meta">#print(t)</span><br>    print<span class="hljs-punctuation">(</span>isPrime<span class="hljs-punctuation">(</span>clue<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br>d<span class="hljs-punctuation">,</span>n<span class="hljs-punctuation">,</span>Gensin_imapct <span class="hljs-punctuation">=</span> gen_keys<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>clue<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>sign <span class="hljs-punctuation">=</span> sign_in<span class="hljs-punctuation">(</span>n<span class="hljs-punctuation">,</span>d<span class="hljs-punctuation">)</span><br>print<span class="hljs-punctuation">(</span>f&#x27;sign = &#123;sign&#125;&#x27;<span class="hljs-punctuation">)</span><br><br>&#x27;&#x27;&#x27;<br>n = <span class="hljs-number">19639600328223</span><span class="hljs-number">84467170448912</span><span class="hljs-number">35469885019032</span><span class="hljs-number">91473349872361</span><span class="hljs-number">01873374900992</span><span class="hljs-number">35320163949095</span><span class="hljs-number">67762757637482</span><span class="hljs-number">27981733198307</span><span class="hljs-number">18606820715206</span><span class="hljs-number">55098361565285</span><span class="hljs-number">24171541461838</span><span class="hljs-number">07043355911537</span><span class="hljs-number">76055798928550</span><span class="hljs-number">29596256255556</span><span class="hljs-number">09821531659803</span><span class="hljs-number">97579235902710</span><span class="hljs-number">14581030885883</span><span class="hljs-number">83616253063214</span><span class="hljs-number">88259768221057</span><span class="hljs-number">35233257594943</span><span class="hljs-number">49507721269702</span><span class="hljs-number">11685369981876</span><span class="hljs-number">61347072502855</span><span class="hljs-number">83246543964703</span><span class="hljs-number">04051821380286</span><span class="hljs-number">34998049047122</span><span class="hljs-number">05450221890639</span><span class="hljs-number">94727777531050</span><span class="hljs-number">92338755867733</span><span class="hljs-number">86805066295473</span><span class="hljs-number">93515821317364</span><span class="hljs-number">70784436503385</span><span class="hljs-number">51391338657593</span><span class="hljs-number">55286813851518</span><span class="hljs-number">29489714323857</span><span class="hljs-number">99295497313102</span><span class="hljs-number">23985355362071</span><span class="hljs-number">60512827633675</span><span class="hljs-number">81487024513259</span><span class="hljs-number">80353936486982</span><span class="hljs-number">95761231935673</span><span class="hljs-number">28112121558438</span><span class="hljs-number">88427077650287</span><span class="hljs-number">47574728595160</span>1<br>Gensin_imapct= <span class="hljs-number">18615555428360</span><span class="hljs-number">73720385848311</span><span class="hljs-number">97613798031066</span><span class="hljs-number">44123408751679</span><span class="hljs-number">93935871527101</span><span class="hljs-number">93226223071624</span><span class="hljs-number">05939351971133</span><span class="hljs-number">49434361718733</span><span class="hljs-number">61429064747281</span><span class="hljs-number">42088496643169</span><span class="hljs-number">39425060989161</span><span class="hljs-number">84658671434281</span><span class="hljs-number">66101133715080</span><span class="hljs-number">08672890560522</span><span class="hljs-number">58234178266565</span><span class="hljs-number">87225513551367</span><span class="hljs-number">39429001353366</span><span class="hljs-number">55190422227648</span><span class="hljs-number">01563252344045</span><span class="hljs-number">26317511663378</span><span class="hljs-number">66573505541269</span><span class="hljs-number">06044647802447</span><span class="hljs-number">91115016937996</span><span class="hljs-number">85793286356164</span><span class="hljs-number">55291791600544</span><span class="hljs-number">04011586231897</span><span class="hljs-number">77493819354020</span><span class="hljs-number">23854289083858</span><span class="hljs-number">69456073212978</span><span class="hljs-number">84481858791649</span><span class="hljs-number">09390679473356</span><span class="hljs-number">53489678909744</span><span class="hljs-number">38067150657024</span><span class="hljs-number">02663094294822</span><span class="hljs-number">60023169901634</span><span class="hljs-number">43409951591975</span><span class="hljs-number">84811683173565</span><span class="hljs-number">57541315705141</span><span class="hljs-number">19138583237472</span><span class="hljs-number">95630124277461</span><span class="hljs-number">05236672734074</span><span class="hljs-number">08969327099398</span><span class="hljs-number">98865571387315</span><span class="hljs-number">26292041808679</span>6<br>1<br>sign = <span class="hljs-number">18261288204538</span><span class="hljs-number">98118157203048</span><span class="hljs-number">27597984265847</span><span class="hljs-number">90136542118628</span><span class="hljs-number">59672989593212</span><span class="hljs-number">17958474429167</span><span class="hljs-number">05403582815245</span><span class="hljs-number">84790036056298</span><span class="hljs-number">52836449001592</span><span class="hljs-number">84591973184497</span><span class="hljs-number">64410933317169</span><span class="hljs-number">82897124114044</span><span class="hljs-number">41725787627481</span><span class="hljs-number">26221751595280</span><span class="hljs-number">43832658613950</span><span class="hljs-number">76527124697355</span><span class="hljs-number">90424448908497</span><span class="hljs-number">68659898808439</span><span class="hljs-number">29716655444342</span><span class="hljs-number">66745079347402</span><span class="hljs-number">89112385815614</span><span class="hljs-number">97418112019001</span><span class="hljs-number">37134278753663</span><span class="hljs-number">90061291630074</span><span class="hljs-number">54921434977528</span><span class="hljs-number">44144796958648</span><span class="hljs-number">14381738638647</span><span class="hljs-number">29524626228931</span><span class="hljs-number">57776771994548</span><span class="hljs-number">62423889409624</span><span class="hljs-number">27531910977068</span><span class="hljs-number">38634387659596</span><span class="hljs-number">60041452765723</span><span class="hljs-number">20724583981474</span><span class="hljs-number">33491427033501</span><span class="hljs-number">64863896170184</span><span class="hljs-number">40139421924715</span><span class="hljs-number">45946760153334</span><span class="hljs-number">90120458473155</span><span class="hljs-number">24603087767378</span><span class="hljs-number">61250198418837</span><span class="hljs-number">67276980680906</span><span class="hljs-number">18376138788002</span><span class="hljs-number">60718292723081</span>1<br>&#x27;&#x27;&#x27;<br></code></pre></td></tr></table></figure><blockquote><p>æ¬§æ‹‰å®šç†çš„åº”ç”¨ã€‚</p><p>å¦‚æœa&#x3D;b mod(Ï•(n))</p><p>é‚£ä¹ˆr^a&#x3D;r^b(mod n)</p><p>å…³äºrï¼Œå› ä¸ºr&gt;1ã€‚r^t+1ä¸ºç´ æ•°</p><p>å½“t&#x3D;1æ—¶ï¼Œr&#x3D;ä¸€ä¸ªç´ æ•°-1æœ‰æ— æ•°ä¸­æƒ…å†µ</p><p>å½“t!&#x3D;1ï¼Œr^t^+1&#x3D;(r-1)(r^t-1^+r^t-2^+â€¦+r-1)ã€‚r&gt;1ï¼Œä»…å½“r&#x3D;2æ—¶r-1&#x3D;1ï¼Œæ‰å¯èƒ½å‡ºç°r^t^+1ä¸ºè´¨æ•°ã€‚</p><p>sign&#x3D;flag^d2^*pow(r,e^3^+d^6^,n)(mod n)</p><p>åˆ©ç”¨æ¬§æ‹‰å®šç†åŒ–ç®€ï¼Œed&#x3D;1mod(Ï•(n))</p><p>sign&#x3D;flag^d2^*pow(r,e+Gensin_imapct-7,n)mod(n)</p><p>è§£é¢˜ä»£ç </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">from Crypto.Util.number import long_to_bytes, inverse</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">n = 19639600328223844671704489123546988501903291473349872361018733749009923532016394909567762757637482279817331983071860682071520655098361565285241715414618380704335591153776055798928550295962562555560982153165980397579235902710145810308858838361625306321488259768221057352332575949434950772126970211685369981876613470725028558324654396470304051821380286349980490471220545022189063994727777531050923387558677338680506629547393515821317364707844365033855139133865759355286813851518294897143238579929549731310223985355362071605128276336758148702451325980353936486982957612319356732811212155843888427077650287475747285951601</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">Gensin_imapct= 18615555428360737203858483119761379803106644123408751679939358715271019322622307162405939351971133494343617187336142906474728142088496643169394250609891618465867143428166101133715080086728905605225823417826656587225513551367394290013533665519042222764801563252344045263175116633786657350554126906044647802447911150169379968579328635616455291791600544040115862318977749381935402023854289083858694560732129788448185879164909390679473356534896789097443806715065702402663094294822600231699016344340995159197584811683173565575413157051411913858323747295630124277461052366727340740896932709939898865571387315262920418086796</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">r=2</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">e=65537</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">sign = 18261288204538981181572030482759798426584790136542118628596729895932121795847442916705403582815245847900360562985283644900159284591973184497644109333171698289712411404441725787627481262217515952804383265861395076527124697355904244489084976865989880843929716655444342667450793474028911238581561497418112019001371342787536639006129163007454921434977528441447969586481438173863864729524626228931577767719945486242388940962427531910977068386343876595966004145276572320724583981474334914270335016486389617018440139421924715459467601533349012045847315524603087767378612501984188376727698068090618376138788002607182927230811</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">flagd2=sign*inverse(pow(r,e+Gensin_imapct-7,n),n)</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">flag=pow(flagd2,e**2,n)</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash"><span class="hljs-built_in">print</span>(long_to_bytes(flag))</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash"><span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27;</span></span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash"><span class="hljs-string">b&#x27;</span>SYC&#123;G0od_Math_h3lps_S1gnature_in_RSA&#125;<span class="hljs-string">&#x27;</span></span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash"><span class="hljs-string">&#x27;</span><span class="hljs-string">&#x27;&#x27;</span></span><br></code></pre></td></tr></table></figure></blockquote>]]></content>
    
    
    <categories>
      
      <category>crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RSAç»´çº³æ”»å‡»åŠå…¶æ‰©å±•</title>
    <link href="/2024/12/29/RSA-wiener/"/>
    <url>/2024/12/29/RSA-wiener/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="RSAä¸¤ç§ç‰¹æ®Šæ”»å‡»æƒ…å†µ"><a href="#RSAä¸¤ç§ç‰¹æ®Šæ”»å‡»æƒ…å†µ" class="headerlink" title="RSAä¸¤ç§ç‰¹æ®Šæ”»å‡»æƒ…å†µ"></a>RSAä¸¤ç§ç‰¹æ®Šæ”»å‡»æƒ…å†µ</h1><h2 id="På’Œqçš„ä¸å½“åˆ†è§£"><a href="#På’Œqçš„ä¸å½“åˆ†è§£" class="headerlink" title="På’Œqçš„ä¸å½“åˆ†è§£"></a>På’Œqçš„ä¸å½“åˆ†è§£</h2><p><strong>|p-q|å¾ˆå¤§</strong>æ—¶ï¼Œä¸€å®šå­˜åœ¨æŸä¸ªå‚æ•°ipè¾ƒå°ï¼Œè¿™é‡Œæˆ‘ä»¬å‡è®¾pè¾ƒå°æˆ‘ä»¬å¯ä»¥é€šè¿‡ç©·ä¸¾æ³•åˆ†è§£æ¨¡æ•°ï¼Œä½†æ˜¯å¾ˆå°‘é‡åˆ°</p><ul><li><p>å¦‚æœä¸¤ä¸ªè´¨æ•°å·®è·å¾ˆå°ï¼ˆå³ <code>q - p</code> å¾ˆå°ï¼‰ï¼Œé‚£ä¹ˆï¼š</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">n = p * q = (<span class="hljs-keyword">a</span> - b)(<span class="hljs-keyword">a</span> + b) = <span class="hljs-keyword">a</span>^<span class="hljs-number">2</span> - b^<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p>æ¨å¯¼è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li>ä»¤ï¼š<code>a = (p + q) / 2</code>ï¼Œ<code>b = (q - p) / 2</code></li><li>åˆ™ï¼š<code>n = a^2 - b^2</code></li><li>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä» <code>a = âŒˆâˆšnâŒ‰</code> å¼€å§‹ï¼Œä¸æ–­å°è¯• <code>b^2 = a^2 - n</code> æ˜¯å¦æ˜¯<strong>å®Œå…¨å¹³æ–¹æ•°</strong></li><li>å¦‚æœæ‰¾åˆ°äº†æŸä¸ª <code>a</code> ä½¿å¾— <code>b^2 = a^2 - n</code> æ˜¯å®Œå…¨å¹³æ–¹æ•°ï¼Œå°±èƒ½è¿˜åŸ <code>p = a - b, q = a + b</code></li></ul></li></ul><p>ä¸¾ä¾‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br><span class="hljs-keyword">import</span> random<br><br><span class="hljs-comment"># ç”Ÿæˆ p å’Œ q</span><br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = gmpy2.next_prime(p, p + <span class="hljs-number">10000</span>) <span class="hljs-comment">#è¿™ä¸ªæ•°çš„ä¸‹ä¸€ä¸ªç´ æ•°åœ¨æŸä¸ªèŒƒå›´å†…ã€‚</span><br>n = p * q<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p=&quot;</span>,p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q=&quot;</span>,q)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n=&quot;</span>,n)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">factor</span>(<span class="hljs-params">n</span>):<br>    a = gmpy2.iroot(n, <span class="hljs-number">2</span>)[<span class="hljs-number">0</span>] <span class="hljs-comment">#aå¯ä»¥çœ‹ä½œp+q</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        a+=<span class="hljs-number">1</span><br>        b2 = a * a - n  <span class="hljs-comment">#</span><br><br>        <span class="hljs-keyword">if</span> gmpy2.is_square(b2):<span class="hljs-comment">#åˆ¤æ–­b2æ˜¯å¦æ˜¯å…¨å¹³æ–¹</span><br>            b2 = gmpy2.mpz(b2)  <span class="hljs-comment"># è½¬æ¢ä¸ºå¤§æ•´æ•°</span><br>            b, xflag = gmpy2.iroot(b2, <span class="hljs-number">2</span>) <span class="hljs-comment">#è¿”å›å…ƒç»„</span><br>            <span class="hljs-keyword">assert</span> xflag  <span class="hljs-comment"># å¦‚æœèƒ½å¹³æ–¹è¿”å›True</span><br>            <span class="hljs-keyword">return</span> (a - b, a + b)<br><br><span class="hljs-built_in">print</span>(factor(n))<br><br></code></pre></td></tr></table></figure><p>ä¸€ä¸ªå˜å¼é¢˜ç›®:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">assert</span> flag[:<span class="hljs-number">5</span>]==<span class="hljs-string">b&#x27;flag&#123;&#x27;</span><br>â€‹<br>m1 = bytes_to_long(flag[:<span class="hljs-number">20</span>])<br>p  = getPrime(<span class="hljs-number">512</span>)<br>p1 = gmpy2.next_prime(p)<br>q  = getPrime(<span class="hljs-number">512</span>)<br>q1 = gmpy2.next_prime(q)<br>n1 = p*q*p1*q1<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;n1 =&#x27;</span>,n1)<br>e = <span class="hljs-number">0x10001</span><br>c1 = <span class="hljs-built_in">pow</span>(m1,e,n1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;c1 =&#x27;</span>,c1)<br>â€‹<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰n&#x3D;å››ä¸ªç´ æ•°å› å­ä¹˜ç§¯</p><p>ä¸Šè¿°å¯ä»¥åˆ†ä¸ºä¸¤ç§ã€‚ã€‚(p,q)(p1,q1)â€¦(p,q1)(p1,q)è¿™ä¸¤ç»„æ¯ç»„ä¸¤ä¸ªå…ƒç´ ä¹˜ç§¯ç›¸è¿‘ï¼Œå¯ä»¥åˆ©ç”¨è´¹é©¬åˆ†è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, inverse, long_to_bytes<br><span class="hljs-keyword">import</span> random<br><br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> gcd<br><span class="hljs-keyword">from</span> pywin.Demos.cmdserver <span class="hljs-keyword">import</span> flags<br><span class="hljs-keyword">from</span> scipy.signal <span class="hljs-keyword">import</span> qspline1d<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> factor_list<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">factor</span>(<span class="hljs-params">n</span>):<br>    a = gmpy2.iroot(n, <span class="hljs-number">2</span>)[<span class="hljs-number">0</span>] <span class="hljs-comment">#aå¯ä»¥çœ‹ä½œp+q</span><br>    factor_list = []<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        a+=<span class="hljs-number">1</span><br>        b2 = a * a - n  <span class="hljs-comment">#</span><br><br>        <span class="hljs-comment"># å¦‚æœ b^2 æ˜¯ä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°</span><br>        <span class="hljs-keyword">if</span> gmpy2.is_square(b2):<br>            b2 = gmpy2.mpz(b2)  <span class="hljs-comment"># è½¬æ¢ä¸ºå¤§æ•´æ•°</span><br>            b, xflag = gmpy2.iroot(b2, <span class="hljs-number">2</span>) <span class="hljs-comment">#è¿”å›å…ƒç»„</span><br>            <span class="hljs-keyword">assert</span> xflag<span class="hljs-comment"># å¦‚æœèƒ½å¹³æ–¹è¿”å›True</span><br>            factor_list.append([a + b, a - b])<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(factor_list) == <span class="hljs-number">2</span>:<br>                <span class="hljs-keyword">break</span><br><br>    <span class="hljs-keyword">return</span> factor_list<br>e = <span class="hljs-number">0x10001</span><br>c1 = <span class="hljs-number">6201882078995455673376327652982610102807874783073703018551044780440620679217833227711395689114659144506630609087600915116940111002026241056808189658969089532597757995423694966667948250438579639890580690392400661711864264184444018345499567505424672090632235109624193289954785503512742400960515331371813467034511130432319427185134018830006918682733848618201088649690422818940385123599468595766345668931882249779415788129316594083269412221804774856038796248038700275509397599351533280014908894068141056694660319816046357462684688942519849441237878018480036145051967731081582598773076490918572392784684372694103015244826</span><br>n = <span class="hljs-number">6348779979606280884589422188738902470575876294643492831465947360363568026280963989291591157710389629216109615274754718329987990551836115660879103234129921943824061416396264358110216047994331119920503431491509529604742468032906950984256964560405062345280120526771439940278606226153077959057882262745273394986607004406770035459301695806378598890589432538916219821477777021460189140081521779103226953544426441823244765828342973086422949017937701261348963541035128661464068769033772390320426795044617751909787914185985911277628404632533530390761257251552073493697518547350246993679844132297414094727147161169548160586911</span><br>factor_list=factor(n)<br>X1,Y1=factor_list[<span class="hljs-number">0</span>]<br>X2,Y2=factor_list[<span class="hljs-number">1</span>]<br>p=gcd(X1,X2)<br>p1=gcd(Y1,Y2)<br>q=X1//p<br>q1=Y1//p1<br>Phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)*(p1-<span class="hljs-number">1</span>)* (q1-<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p=&quot;</span>,p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q=&quot;</span>,q)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q1=&quot;</span>,q1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p1&quot;</span>,p1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Phi=&quot;</span>,Phi)<br><br>d = inverse(e, Phi)<br>flag=<span class="hljs-built_in">pow</span>(c1,d,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag=&quot;</span>,long_to_bytes(flag),<span class="hljs-string">&quot;&#125;&quot;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">flag= b&#x27;flag&#123;Euler_funct1ons&#x27; &#125;&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="ç»´çº³æ”»å‡»"><a href="#ç»´çº³æ”»å‡»" class="headerlink" title="ç»´çº³æ”»å‡»"></a>ç»´çº³æ”»å‡»</h2><h3 id="ä½¿ç”¨æ¡ä»¶"><a href="#ä½¿ç”¨æ¡ä»¶" class="headerlink" title="ä½¿ç”¨æ¡ä»¶"></a>ä½¿ç”¨æ¡ä»¶</h3><p>ç§é’¥d&lt;1&#x2F;3N^1&#x2F;4^,é€‰æ‹©è¾ƒå¤§çš„å…¬é’¥eï¼Œç”¨*e* â€²ä»£æ›¿*e*ï¼Œå…¶ä¸­*e* â€² &#x3D; *e* + *k* â‹… *Î»* ( *N* )ï¼Œ*k*ä¸ºæŸä¸ªè¾ƒå¤§çš„æ•°ã€‚å½“*e* â€² è¶³å¤Ÿå¤§æ—¶ï¼Œå³*e* â€² &gt; <em>N</em> 3&#x2F;2 <em>ï¼Œåˆ™æ— è®ºd</em>æœ‰å¤šå°ï¼Œéƒ½æ— æ³•å®æ–½ç»´çº³æ”»å‡»ã€‚å‡è®¾pä¸qäºŒè¿›åˆ¶é•¿åº¦ç›¸ç­‰å³p&lt;q&lt;2pï¼Œå¯ä»¥å¾—åˆ°p+q&lt;3p&lt;3(n)^0.5^</p><p>æ¬§æ‹‰å‡½æ•°Ï†(N)&#x3D;N-p-q+1 æ»¡è¶³N-3(N)^0.5^&lt;Ï†(N)&lt;N</p><ul><li>åŸºäºå®šç†</li></ul><p><img src="https://rockfox0.github.io/picx-images-hosting/wiener.99tfjay02x.webp"></p><h3 id="ç»´çº³æ”»å‡»-1"><a href="#ç»´çº³æ”»å‡»-1" class="headerlink" title="ç»´çº³æ”»å‡»"></a>ç»´çº³æ”»å‡»</h3><blockquote></blockquote><h3 id="ç»´çº³çš„æ–¹æ³•"><a href="#ç»´çº³çš„æ–¹æ³•" class="headerlink" title="ç»´çº³çš„æ–¹æ³•"></a>ç»´çº³çš„æ–¹æ³•</h3><blockquote><p>ed&#x3D;1+k*Ï†(N)</p><p>|$e\over Ï†(N) $-$k\over d$|&#x3D;$1 \over d*Ï†(n)$</p><p>Ï†(N)çº¦ç­‰äºN,K&#x2F;dçº¦ç­‰äºe&#x2F;â€”&gt;|$e\over N$-$k\over d$|&#x3D;|$k(p+q-1)-1\over Nd$|</p><p>è¦ä½¿ä¸Šè¿°å¼å­&lt;1&#x2F;(2d^2^) </p><p>p+q&lt;3(N)^0.5^,0&lt;K&lt;då¯ä»¥æ¨æ–­ï¼Œ|$e\over N$-$k\over d$|&lt;3&#x2F;N)^0.5^</p><p>æ‰€ä»¥d&lt;3&#x2F;(n)^0.25^</p></blockquote><blockquote><p><em>e<strong>d</strong>g</em>&#x3D;<em>k</em>(<em>p</em>âˆ’1)(<em>q</em>âˆ’1)+<em>g</em>,<em>k</em>&gt;<em>g</em></p><p>åŒæ—¶é™¤ä»¥kï¼Œk&#x2F;g&lt;1å¯ä»¥å¿½ç•¥</p><p>âŒŠ<em>k<strong>e</strong>d**g</em>âŒ‹&#x3D;(<em>p</em>âˆ’1)(<em>q</em>âˆ’1)</p><p>(<em>pq</em>âˆ’(<em>p</em>âˆ’1)(<em>q</em>âˆ’1)+1)&#x2F;2&#x3D;(p+q)&#x2F;2</p><p>($(p+q)\over 2$)^2^-pq&#x3D;($p-q\over 2$)^2^ #å¯ä»¥ç”¨è¿™ä¸ªåˆ¤æ–­è¿åˆ†æ•°æ”¶æ•›æ˜¯å¦ä¸ºæ‰€éœ€çš„k&#x2F;(dg)</p></blockquote><p>ä¾‹é¢˜sagemathä¸Šçš„è¿åˆ†æ•°æ‰©å±•å‡½æ•°å®ç°æ›´ä¾¿æ·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">possible</span>(<span class="hljs-params">e,alist,N</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> alist:<br>        <span class="hljs-keyword">if</span> x==<span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br>        phi=(e*x.denominator()-<span class="hljs-number">1</span>)//x.numerator()<br>        <span class="hljs-keyword">if</span> (N-phi+<span class="hljs-number">1</span>)%<span class="hljs-number">2</span>==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> sqrt(<span class="hljs-built_in">pow</span>((N-phi+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)-N).is_integer():<br>            (p,q)=var(<span class="hljs-string">&#x27;p q&#x27;</span>)<br>            x=solve([(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)==phi,p*q==N],p,q)<br>            <span class="hljs-keyword">return</span> x <br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">continue</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">wienner_attack</span>(<span class="hljs-params">e,N</span>):<br>    c=continued_fraction(e/N)<span class="hljs-comment">#è·å–è¿åˆ†æ•°é›†åˆ</span><br>    alist=c.convergents()<span class="hljs-comment">#åˆ©ç”¨è¿åˆ†æ•°å¾—åˆ°è¿åˆ†æ•°æ”¶æ•›</span><br>    <span class="hljs-keyword">return</span> possible(e,alist,N)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">x.denominator():</span><br><span class="hljs-string"></span><br><span class="hljs-string">è¿™ä¸ªå‡½æ•°è¿”å›åˆ†æ•° x çš„åˆ†æ¯ã€‚</span><br><span class="hljs-string">x.numerator():</span><br><span class="hljs-string"></span><br><span class="hljs-string">è¿™ä¸ªå‡½æ•°è¿”å›åˆ†æ•° x çš„åˆ†å­ã€‚</span><br><span class="hljs-string">e * x.denominator():</span><br><span class="hljs-string"></span><br><span class="hljs-string">è¿™ä¸ªéƒ¨åˆ†å°† e ä¹˜ä»¥ x çš„åˆ†æ¯ã€‚</span><br><span class="hljs-string">e * x.denominator() - 1:</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªä»£ç è¿”å›çš„æ˜¯på’Œq</p><h3 id="rrrrrrsaâ€“ä¸€é“é¢˜"><a href="#rrrrrrsaâ€“ä¸€é“é¢˜" class="headerlink" title="rrrrrrsaâ€“ä¸€é“é¢˜"></a>rrrrrrsaâ€“ä¸€é“é¢˜</h3><p><img src="https://rockfox0.github.io/picx-images-hosting/26a1d4b9c2b9329f06b882ccf7930df9.54xu78e8w8.webp"></p><p>è¿™æ˜¯ä¸€ä¸ªå…³äºrsa-wieneræ”»å‡»æ‹“å±•çš„æ¨å¯¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">P1 = getPrime(<span class="hljs-number">1038</span>)<br>P2 = sympy.nextprime(P1)<br><span class="hljs-keyword">assert</span>(P2 - P1 &lt; <span class="hljs-number">1000</span>)<br><br>Q1 = getPrime(<span class="hljs-number">512</span>)<br>Q2 = sympy.nextprime(Q1)<br><br>N1 = P1 * P1 * Q1<br>N2 = P2 * P2 * Q2<br></code></pre></td></tr></table></figure><p>åˆšå¥½å¯ä»¥åº”ç”¨åœ¨è¿™é‡Œã€‚</p><p>å¾ˆæ˜æ˜¾æ˜¯æ»¡è¶³æ¡ä»¶çš„ã€‚æ‰€ä»¥Q1&#x2F;Q2æ˜¯N1&#x2F;N2çš„æ”¶æ•›è¿åˆ†æ•°æ‰©å±•</p><blockquote><p>N1&#x2F;N2&#x3D;(P1&#x2F;P1)^2^*(Q1&#x2F;Q2) </p><p>Q1&#x2F;Q1&gt;N1&#x2F;N2,N1&lt;N2,Q1&lt;Q2</p><p>n1&#x2F;n2&lt;Q1&#x2F;Q2&lt;1,ç„¶åæˆ‘ä»¬ç”¨</p><p>å› ä¸ºQ1å’ŒQ2éƒ½æ˜¯ç´ æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¾—åˆ°Q1å’ŒQ2</p><p>å¹¶ç”¨N1%Q1æ¥åˆ¤æ–­æ˜¯å¦ç¬¦åˆæ¡ä»¶</p></blockquote><p>è§£é¢˜ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes, inverse<br><br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">possible</span>(<span class="hljs-params">alist,N1</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> alist:<br>        <span class="hljs-keyword">if</span> x==<span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br>        Q1=x.numerator()<br>        <span class="hljs-keyword">if</span> N1%Q1==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> Q1!=<span class="hljs-number">1</span>:<br>            Q2=x.denominator()<br>            <span class="hljs-keyword">return</span> Q1,Q2<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">continue</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">wienner_attack</span>(<span class="hljs-params">N1,N2</span>):<br>    c=continued_fraction(N1/N2)<span class="hljs-comment">#è·å–è¿åˆ†æ•°é›†åˆ</span><br>    alist=c.convergents()<span class="hljs-comment">#åˆ©ç”¨è¿åˆ†æ•°å¾—åˆ°è¿åˆ†æ•°æ”¶æ•›</span><br>    <span class="hljs-keyword">return</span> possible(alist,N1)<br>N1=<span class="hljs-number">60143104944034567859993561862949071559877219267755259679749062284763163484947626697494729046430386559610613113754453726683312513915610558734802079868190554644983911078936369464590301246394586190666760362763580192139772729890492729488892169933099057105842090125200369295070365451134781912223048179092058016446222199742919885472867511334714233086339832790286482634562102936600597781342756061479024744312357407750731307860842457299116947352106025529309727703385914891200109853084742321655388368371397596144557614128458065859276522963419738435137978069417053712567764148183279165963454266011754149684758060746773409666706463583389316772088889398359242197165140562147489286818190852679930372669254697353483887004105934649944725189954685412228899457155711301864163839538810653626724347</span><br>c1=<span class="hljs-number">55094296873556883585060020895253176070835143350249581136609315815308788255684072804968957510292559743192424646169207794748893753882418256401223641287546922358162629295622258913168323493447075410872354874300793298956869374606043622559405978242734950156459436487837698668489891733875650048466360950142617732135781244969524095348835624828008115829566644654403962285001724209210887446203934276651265377137788183939798543755386888532680013170540716736656670269251318800501517579803401154996881233025210176293554542024052540093890387437964747460765498713092018160196637928204190194154199389276666685436565665236397481709703644555328705818892269499380797044554054118656321389474821224725533693520856047736578402581854165941599254178019515615183102894716647680969742744705218868455450832</span><br>E1=<span class="hljs-number">125932919717342481428108392434488550259190856475011752106073050593074410065655587870702051419898088541590032209854048032649625269856337901048406066968337289491951404384300466543616578679539808215698754491076340386697518948419895268049696498272031094236309803803729823608854215226233796069683774155739820423103</span><br>N2=<span class="hljs-number">60143104944034567859993561862949071559877219267755259679749062284763163484947626697494729046430386559610613113754453726683312513915610558734802079868195633647431732875392121458684331843306730889424418620069322578265236351407591029338519809538995249896905137642342435659572917714183543305243715664380787797562011006398730320980994747939791561885622949912698246701769321430325902912003041678774440704056597862093530981040696872522868921139041247362592257285423948870944137019745161211585845927019259709501237550818918272189606436413992759328318871765171844153527424347985462767028135376552302463861324408178183842139330244906606776359050482977256728910278687996106152971028878653123533559760167711270265171441623056873903669918694259043580017081671349232051870716493557434517579121</span><br>c2=<span class="hljs-number">39328446140156257571484184713861319722905864197556720730852773059147902283123252767651430278357950872626778348596897711320942449693270603776870301102881405303651558719085454281142395652056217241751656631812580544180434349840236919765433122389116860827593711593732385562328255759509355298662361508611531972386995239908513273236239858854586845849686865360780290350287139092143587037396801704351692736985955152935601987758859759421886670907735120137698039900161327397951758852875291442188850946273771733011504922325622240838288097946309825051094566685479503461938502373520983684296658971700922069426788236476575236189040102848418547634290214175167767431475003216056701094275899211419979340802711684989710130215926526387138538819531199810841475218142606691152928236362534181622201347</span><br>E2=<span class="hljs-number">125932919717342481428108392434488550259190856475011752106073050593074410065655587870702051419898088541590032209854048032649625269856337901048406066968337289491951404384300466543616578679539808215698754491076340386697518948419895268049696498272031094236309803803729823608854215226233796069683774155739820425393</span><br><br>t=wienner_attack(N1,N2)<br>Q1=t[<span class="hljs-number">0</span>]<br>Q2=t[<span class="hljs-number">1</span>]<br><span class="hljs-built_in">print</span>(Q1)<br><span class="hljs-built_in">print</span>(Q2)<br>P2=gmpy2.iroot(N2//Q2,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br>P1=gmpy2.iroot(N1//Q1,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br>phi1=(P1-<span class="hljs-number">1</span>)*P1*(Q1-<span class="hljs-number">1</span>)<br>phi2=(P2-<span class="hljs-number">1</span>)*P2*(Q2-<span class="hljs-number">1</span>)<br>d1=gmpy2.invert(E1,phi1)<br>d2=gmpy2.invert(E2,phi2)<br>m1=gmpy2.powmod(c1,d1,N1)<br>m2=gmpy2.powmod(c2,d2,N2)<br>f1=long_to_bytes(m1)<br>f2=long_to_bytes(m2)<br><span class="hljs-built_in">print</span>(f1,f2)<br></code></pre></td></tr></table></figure><h3 id="rrrrsa-â€”-l3hctf"><a href="#rrrrsa-â€”-l3hctf" class="headerlink" title="rrrrsa â€” l3hctf"></a>rrrrsa â€” l3hctf</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_vulnerable_key</span>(<span class="hljs-params">bits=<span class="hljs-number">1024</span></span>):<br>    p_bits = bits // <span class="hljs-number">2</span><br>    q_bits = bits - p_bits<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p = random_prime(<span class="hljs-number">2</span>**(p_bits), lbound=<span class="hljs-number">2</span>**(p_bits-<span class="hljs-number">1</span>))<br>        q = random_prime(<span class="hljs-number">2</span>**(q_bits), lbound=<span class="hljs-number">2</span>**(q_bits-<span class="hljs-number">1</span>))<br>        <span class="hljs-keyword">if</span> p != q <span class="hljs-keyword">and</span> p &gt; q <span class="hljs-keyword">and</span> p &lt; <span class="hljs-number">2</span>*q:<br>            <span class="hljs-keyword">break</span><br>            <br>    N = p * q<br>    phi = (p**<span class="hljs-number">4</span> - <span class="hljs-number">1</span>) * (q**<span class="hljs-number">4</span> - <span class="hljs-number">1</span>)<br><br>    d_bits = <span class="hljs-number">1024</span><br>    d_bound = <span class="hljs-number">2</span>**d_bits<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        d_small = randint(<span class="hljs-number">2</span>, d_bound)<br>        d = phi - d_small<br>        <span class="hljs-keyword">if</span> gcd(d, phi) == <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">if</span> d_small.bit_length() == <span class="hljs-number">1021</span>:<br>                <span class="hljs-keyword">break</span><br><br>    e = inverse_mod(d, phi)<br>    <br>    <span class="hljs-keyword">return</span> N, e<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">m, N, e</span>):<br>    n = <span class="hljs-number">4</span><br>    r = <span class="hljs-number">2</span><br>    R = Integers(N)<br>    P = PolynomialRing(R, <span class="hljs-string">&#x27;t&#x27;</span>)<br>    t = P.gen()<br>    Q = P.quotient(t**n - r)<br><br>    m_poly = Q([m, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>])<br><br>    c_poly = m_poly ** e<br><br>    <span class="hljs-keyword">return</span> c_poly.lift()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    N, e = generate_vulnerable_key()<br>    m = <span class="hljs-built_in">int</span>.from_bytes(flag, <span class="hljs-string">&#x27;big&#x27;</span>)<br>    c = encrypt(m, N, e)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;N = <span class="hljs-subst">&#123;N&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e = <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># N = 99697845285265879829811232968100099666254250525000506525475952592468738395250956460890611762459685140661035795964867321445992110528627232335703962897072608767840783176553829502743629914407970206513639916759403399986924602596286330464348286080258986075962271511105387188070309852907253486162504945490429185609</span><br><span class="hljs-comment"># e = 74900336437853271512557457581304251523854378376434438153117909482138661618901386551154807447783262736408028580620771857416463085746907317126876189023636958838207330193074215769008709076254356539808209005917645822989554532710565445155350102802675594603406077862472881027575871589046600011223990947361848608637247276816477996863812313225929441545045479384803449990623969591150979899801722841101938868710054151839628803383603849632857020369527380816687165487370957857737696187061619496102857237814447790678611448197153594917852504509869007597997670022501500067854210261136878917620198551551460145853528269270832725348151160651020188255399136483482428499340574623409209151124687319668989144444549871527949104436734300277004316939985015286758651969045396343970037328043635061226100170529991733947365830164811844853806681198818875837903563263114249814483901121700854712406832325690101810786429930813776784979083590353027191492894890551838308899148551566437532914838098811643805243593419063566975400775134981190248113477610235165151367913498299241375039256652674679958159505112725441797566678743542054295794919839551675786573113798857814005058856054462008797386322048089657472710775620574463924678367455233801970310210504653908307254926827</span><br><span class="hljs-comment"># c = 98460941530646528059934657633016619266170844887697553075379408285596784682803952762901219607460711533547279478564732097775812539176991062440097573591978613933775149262760936643842229597070673855940231912579258721734434631479496590694499265794576610924303262676255858387586947276246725949970866534023718638879</span><br><br></code></pre></td></tr></table></figure><p>åˆ©ç”¨ç»´çº³æ”»å‡»ï¼Œè¿™é‡Œå¯ä»¥æ¨ä¸€ä¸‹ï¼Œ<br>$$<br>ed-1&#x3D;k*(phi)\<br>\frac{e}{phi}-\frac{k}{d}&#x3D;\frac{1}{d*phi}\<br>\frac{e}{n^4}-\frac{k}{(d-ds)}â‰ˆ\frac{e}{phi}-\frac{k}{d-ds}\<br>\frac{e}{n^4}-\frac{k}{ds} &gt;\frac{1}{2ds^2}<br>$$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><br>N = <span class="hljs-number">99697845285265879829811232968100099666254250525000506525475952592468738395250956460890611762459685140661035795964867321445992110528627232335703962897072608767840783176553829502743629914407970206513639916759403399986924602596286330464348286080258986075962271511105387188070309852907253486162504945490429185609</span><br>e = <span class="hljs-number">74900336437853271512557457581304251523854378376434438153117909482138661618901386551154807447783262736408028580620771857416463085746907317126876189023636958838207330193074215769008709076254356539808209005917645822989554532710565445155350102802675594603406077862472881027575871589046600011223990947361848608637247276816477996863812313225929441545045479384803449990623969591150979899801722841101938868710054151839628803383603849632857020369527380816687165487370957857737696187061619496102857237814447790678611448197153594917852504509869007597997670022501500067854210261136878917620198551551460145853528269270832725348151160651020188255399136483482428499340574623409209151124687319668989144444549871527949104436734300277004316939985015286758651969045396343970037328043635061226100170529991733947365830164811844853806681198818875837903563263114249814483901121700854712406832325690101810786429930813776784979083590353027191492894890551838308899148551566437532914838098811643805243593419063566975400775134981190248113477610235165151367913498299241375039256652674679958159505112725441797566678743542054295794919839551675786573113798857814005058856054462008797386322048089657472710775620574463924678367455233801970310210504653908307254926827</span><br>c = <span class="hljs-number">98460941530646528059934657633016619266170844887697553075379408285596784682803952762901219607460711533547279478564732097775812539176991062440097573591978613933775149262760936643842229597070673855940231912579258721734434631479496590694499265794576610924303262676255858387586947276246725949970866534023718638879</span><br>A = N**<span class="hljs-number">4</span><br><br>cf = continued_fraction(e / A)<br>conv_gen = cf.convergents()<br>N2 = N**<span class="hljs-number">2</span><br>N2p1 = N2 + <span class="hljs-number">1</span><br>target_val = N2p1**<span class="hljs-number">2</span>  <span class="hljs-comment"># (N^2 + 1)^2</span><br><br>found = <span class="hljs-literal">False</span><br><span class="hljs-keyword">for</span> c_frac <span class="hljs-keyword">in</span> conv_gen:<br>    k = c_frac.numerator()<br>    d_small = c_frac.denominator()<br>    bl = d_small.bit_length()<br>    <span class="hljs-keyword">if</span>(bl!=<span class="hljs-number">1021</span>):<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-built_in">print</span>(bl)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Trying convergent: k=<span class="hljs-subst">&#123;k&#125;</span>, d_small=<span class="hljs-subst">&#123;d_small&#125;</span>, bits=<span class="hljs-subst">&#123;bl&#125;</span>&quot;</span>)<br>    <br>    c_val = e * d_small + <span class="hljs-number">1</span><br>    <br>    phi_cand = c_val // k<br>    diff = target_val - phi_cand<br>    <span class="hljs-keyword">if</span>(is_square(diff)==<span class="hljs-number">0</span>):<br>        <span class="hljs-keyword">continue</span><br>    <br>    E = sqrtD // <span class="hljs-number">2</span><br>    <span class="hljs-keyword">for</span> t_val <span class="hljs-keyword">in</span> [<span class="hljs-number">2</span>*N + E]:<br>        <span class="hljs-keyword">if</span> t_val &lt;= <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> is_square(t_val):<br>            <span class="hljs-keyword">continue</span><br>        <br>        s_val = isqrt(t_val)<br>        <span class="hljs-keyword">if</span> s_val**<span class="hljs-number">2</span> != t_val:<br>            <span class="hljs-keyword">continue</span><br>        <br>        <span class="hljs-comment">#x^2 - s_val*x + N = 0 </span><br>        R.&lt;x&gt; = PolynomialRing(ZZ)<br>        poly = x**<span class="hljs-number">2</span> - s_val*x + N<br>        roots = poly.roots(multiplicities=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(roots) != <span class="hljs-number">2</span>:<br>            <span class="hljs-keyword">continue</span><br>        p, q = roots<br>        <span class="hljs-keyword">if</span> p * q != N:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;N factorized successfully!&quot;</span>)<br>        found = <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> found:<br>        <span class="hljs-keyword">break</span><br>phi = (p**<span class="hljs-number">4</span> - <span class="hljs-number">1</span>) * (q**<span class="hljs-number">4</span> - <span class="hljs-number">1</span>)<br><br>d = inverse_mod(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, N)<br>flag_bytes = <span class="hljs-built_in">int</span>(m).to_bytes((m.bit_length() + <span class="hljs-number">7</span>) // <span class="hljs-number">8</span>, <span class="hljs-string">&#x27;big&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Flag:&quot;</span>, flag_bytes.decode())<br></code></pre></td></tr></table></figure><h3 id="æ‰©å±•ç»´çº³"><a href="#æ‰©å±•ç»´çº³" class="headerlink" title="æ‰©å±•ç»´çº³"></a>æ‰©å±•ç»´çº³</h3><p>å‚è€ƒï¼šè®ºæ–‡:<a href="https://dunkirkturbo.github.io/2020/05/04/WriteUp-De1CTF2020-Crypto/howgrave-graham1999.pdf">https://dunkirkturbo.github.io/2020/05/04/WriteUp-De1CTF2020-Crypto/howgrave-graham1999.pdf</a></p><p><a href="https://ctf-wiki.org/crypto/asymmetric/rsa/d_attacks/rsa_extending_wiener/">ctf-wiki-æ‰©å±•ç»´çº³</a></p><h4 id="ç»´çº³çš„æ–¹æ³•-1"><a href="#ç»´çº³çš„æ–¹æ³•-1" class="headerlink" title="ç»´çº³çš„æ–¹æ³•"></a>ç»´çº³çš„æ–¹æ³•</h4><p>è¿™é‡Œæˆ‘ä»¬å¿½ç•¥å‰é¢æåˆ°çš„q&lt;p&lt;2qçš„æ¡ä»¶ã€‚åˆ©ç”¨å…¶ä»–è¿›è¡Œç»´çº³æ”»å‡»</p><p>è¿™é‡Œæœ‰ä¸ªå‰æï¼Œeçº¦ç­‰äºn,Sçº¦ç­‰äº(n)^0.5^(å¤§æ¦‚å°±æ˜¯2çš„æŒ‡æ•°å·®ä¸å¤š)</p><p>Î»(N)&#x3D;lcm(p-1,q-1)â€¦.g&#x3D;gcd(p-1,q-1). s&#x3D;1-p-q</p><blockquote><p>$ed-k*Î»(N)&#x3D;1$</p><p>$edg-kN&#x3D;g+ks$</p><p>$e\over N$-$k\over dg$&#x3D;($k\over dg$)($s\over N$)+$1\over dN$</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-01-05-144234.9rjh97w4em.webp"></p><p>è¿™é‡ŒåŸè®ºæ–‡çš„è¯æ˜è¿‘ä¼¼çš„é‡æœ‰ç‚¹å¤šï¼Œä¸å¤Ÿä¸¥è°¨ï¼Œä¸èƒ½ç®—æ˜¯ä¸¥æ ¼çš„ç»´çº³è¯æ˜ï¼Œæœ€å¼€å§‹çš„é‚£ä¸ªæ›´ç»†èŠ‚</p></blockquote><h4 id="GUOçš„æ–¹æ³•"><a href="#GUOçš„æ–¹æ³•" class="headerlink" title="GUOçš„æ–¹æ³•"></a>GUOçš„æ–¹æ³•</h4><p>è€ƒè™‘å­˜åœ¨ä¸¤ä¸ªeã€‚</p><p>$e_1d_1g-k_1(p-1)(p-1)&#x3D;g$</p><p>$e_2d_2g-k_2(p-1)(q-1)&#x3D;g$</p><p>åŒ–ç®€å¯ä»¥å¾—åˆ°</p><p>$k_2d_1e_1âˆ’k_1d_2e_2&#x3D;k_2âˆ’k_1$</p><blockquote><p>åŒæ—¶é™¤ä»¥$k_2d_1e_2$</p><p>$e_1\over e_2$-$k_1d_2\over k_2d_1$&#x3D;$k_2-k_1\over k_2d_1e_2$</p><p>è®¾$d_i&lt;N^Î±$</p><p>$k_2-k_1\over k_2d_1e_2$â‰ˆN^âˆ’(1+Î±)^</p><p>ä¸ºäº†æ»¡è¶³ä¸Šè¿°å®šç†</p><p>2(<em>k</em>2âˆ’<em>k</em>1)<em>d</em>1<em>k</em>2&lt;<em>e</em>2</p><p>ä½†æ˜¯é€šè¿‡$k_1d_2\over k_2 d_1$æ‰¾åˆ°åˆ†è§£Nä¸æ˜¯å¾ˆç°å®ï¼Œè¿™ä¸ªæ‰©å±•ç»“åˆäº†ä¸Šè¿°ä¸¤ç§æ–¹æ³•åˆ©ç”¨æ ¼æ¥æ±‚</p></blockquote><h4 id="æ‰©å±•ç»´çº³æ”»å‡»"><a href="#æ‰©å±•ç»´çº³æ”»å‡»" class="headerlink" title="æ‰©å±•ç»´çº³æ”»å‡»"></a>æ‰©å±•ç»´çº³æ”»å‡»</h4><p>ä¸¤ä¸ªå…³ç³»ï¼š</p><blockquote><p>$d_ige_iâˆ’k_iN&#x3D;g+k_is$  â€”M</p><p>k_id_je_jâˆ’k_jd_ie_i&#x3D;k_iâˆ’k_j â€”G<sub>i,j</sub></p></blockquote><p>æˆ‘ä»¬å‡è®¾$d_i$ å’Œ$k_i $éƒ½å°äºN^Î±n^ï¼Œä¸”gå¾ˆå°ï¼Œsâ‰ˆN^1&#x2F;2^ã€‚å¯ä»¥æ³¨æ„åˆ°$W_i$ å’ŒGiçš„å³ä¾§éå¸¸å°ï¼Œå®é™…ä¸Šåˆ†åˆ«æœ€å¤šä¸ºN^1&#x2F;2+Î±^ å’ŒN^Î±^ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å››ä¸ªç­‰å¼æ„é€ æ ¼</p><p>$k_1 k_2&#x3D;k_1 k_2$</p><p>$d_1ge_1âˆ’k_1N&#x3D;g+k_1s$</p><p>$k_1d_2e_2âˆ’k_2d_1e_1&#x3D;k_1âˆ’k_2$</p><p>$d_1d_2g^2e_1e_2âˆ’d_1gk_2e_1Nâˆ’d_2gk_1e_2N+k_1k_2N_2&#x3D;(g+k_1s)(g+k_2s)$</p><p>å¯ä»¥æ„é€ å¦‚ä¸‹æ ¼</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-01-05-155922.8l060oyhju.webp" alt="å±å¹•æˆªå›¾-2025-01-05-155922"></p><p>è§†ä½œA*L&#x3D;B</p><p>æ ¹æ®å‡è®¾</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-01-05-155934.4xumd62jsr.webp" alt="å±å¹•æˆªå›¾-2025-01-05-155934"></p><p><img src="https://rockfox0.github.io/picx-images-hosting/eae24001bbe299decdd775bef1ea1800.73u0gaysyt.webp" alt="img"></p><p>æ˜æ˜¾|L|â‰ˆ2N,ä½†æ˜¯æ˜æ˜¾N^2Î±^,N^1&#x2F;2+2Î±^,N^Î±2^,N^1+2Î±^.æ˜æ˜¾è¿™é‡Œä¸ç¬¦åˆå®šç†è¦æ±‚éœ€è¦æ„é€ ä¸€ä¸‹ï¼Œ</p><blockquote><p>$M_1&#x3D;N$^1&#x2F;2^,$M_2&#x3D;N$^1+Î±^ï¼Œå¾—åˆ°</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-01-05-161454.83a4c4gc3x.webp" alt="å±å¹•æˆªå›¾-2025-01-05-161454"></p><p>æ ¹æ®ä¸Šè¿°æ¡ä»¶</p><p><em>Î±</em>â‰¤5&#x2F;14</p><p>æŠŠB2å½“ä½œæ±‚å‡ºçš„æœ€çŸ­å‘é‡ã€‚A&#x3D;B*L^-1^ã€‚è¿™æ˜¯æˆ‘ä»¬å°±èƒ½å¾—åˆ°Aï¼ŒA[1]&#x2F;A[0]&#x3D;$d_1g\over k_1$</p><p>Ï†(N)&#x3D;$edg\over k$-$g\over k$&#x3D;$edg\over k$</p></blockquote><h4 id="ç¾ŠåŸæ¯-simple-py"><a href="#ç¾ŠåŸæ¯-simple-py" class="headerlink" title="ç¾ŠåŸæ¯ simple.py"></a>ç¾ŠåŸæ¯ simple.py</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> DES<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> random<br><br>key = <span class="hljs-string">&quot;abcdefgh&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">des_encrypt</span>(<span class="hljs-params">m</span>):<br>    des = DES.new(key, DES.MODE_ECB)<br>    res = des.encrypt(m)<br>    <span class="hljs-keyword">return</span> res<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_key</span>():<br>    p = getPrime(<span class="hljs-number">2048</span>)<br>    q = getPrime(<span class="hljs-number">2048</span>)<br>    n = p * q<br>    bit = n.bit_length()<br>    phi_n = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>    num = random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        u = getPrime(bit / <span class="hljs-number">4</span> - num)<br>        <span class="hljs-keyword">if</span> gmpy2.gcd(u, phi_n) != <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">continue</span><br>        t = gmpy2.invert(u, phi_n)<br>        e = bytes_to_long(des_encrypt(long_to_bytes(t)))<br>        <span class="hljs-keyword">if</span> gmpy2.gcd(e, phi_n) == <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">return</span> (n, e)<br><br>P = getPrime(<span class="hljs-number">1024</span>)<br>Q = getPrime(<span class="hljs-number">1024</span>)<br>N = P * Q<br>E = <span class="hljs-number">65537</span><br>lcm = gmpy2.lcm(P-<span class="hljs-number">1</span>, Q-<span class="hljs-number">1</span>)<br>e1 = gmpy2.invert(getPrime(<span class="hljs-number">730</span>), lcm)<br>e2 = gmpy2.invert(getPrime(<span class="hljs-number">730</span>), lcm)<br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, E, N)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;N = &quot;</span> + <span class="hljs-built_in">str</span>(N)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;e2 = &quot;</span> + <span class="hljs-built_in">str</span>(e2)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;c = &quot;</span> + <span class="hljs-built_in">str</span>(c)<br>_n, _e = gen_key()<br>_c = <span class="hljs-built_in">pow</span>(e1, _e, _n)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;_n = &quot;</span> + <span class="hljs-built_in">str</span>(_n)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;_e = &quot;</span> + <span class="hljs-built_in">str</span>(_e)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;_c = &quot;</span> + <span class="hljs-built_in">str</span>(_c)<br><br><span class="hljs-comment"># N = 14922959775784066499316528935316325825140011208871830627653191549546959775167708525042423039865322548420928571524120743831693550123563493981797950912895893476200447083386549353336086899064921878582074346791320104106139965010480614879592357793053342577850761108944086318475849882440272688246818022209356852924215237481460229377544297224983887026669222885987323082324044645883070916243439521809702674295469253723616677245762242494478587807402688474176102093482019417118703747411862420536240611089529331148684440513934609412884941091651594861530606086982174862461739604705354416587503836130151492937714365614194583664241</span><br><span class="hljs-comment"># e2 = 27188825731727584656624712988703151030126350536157477591935558508817722580343689565924329442151239649607993377452763119541243174650065563589438911911135278704499670302489754540301886312489410648471922645773506837251600244109619850141762795901696503387880058658061490595034281884089265487336373011424883404499124002441860870291233875045675212355287622948427109362925199018383535259913549859747158348931847041907910313465531703810313472674435425886505383646969400166213185676876969805238803587967334447878968225219769481841748776108219650785975942208190380614555719233460250841332020054797811415069533137170950762289</span><br><span class="hljs-comment"># c = 6472367338832635906896423990323542537663849304314171581554107495210830026660211696089062916158894195561723047864604633460433867838687338370676287160274165915800235253640690510046066541445140501917731026596427080558567366267665887665459901724487706983166070740324307268574128474775026837827907818762764766069631267853742422247229582756256253175941899099898884656334598790711379305490419932664114615010382094572854799421891622789614614720442708271653376485660139560819668239118588069312179293488684403404385715780406937817124588773689921642802703005341324008483201528345805611493251791950304129082313093168732415486813</span><br><span class="hljs-comment"># _n = 440489238264900860776949063845200558734341182253911040104689726634414488997095518284964514078079911856352824174173937251558842251349762631716798307360995414545464514355957499460396352456341058329671470384493547042182238690727766731554287411757022792467324815342497916894285866240516524768645049867582541899123632009100512965460004548382054578461249990158442675234477122521189649316341623637146867589119951831385717513964941787562068891523060843170463600255518728070958509224053460041184869943038887434435024428311063533345514827827485121055022245800823723487812635502090530820946638405345755666124356919178290008475459419571761406117827422883820901663916276191422633940699113760516149002609672230610575442643822241126824287790055264162725209120192661985259423924307785452001927701323647247782658775780117642900694831475681037634691806232211286493187121464506122012889644137364079403183353774265910554863733455161820449073656744610495110838881353269890437984975607744603113572453211439334880155671730821755361054781243639407912133971530394031933785051770725331242932929244719594830548310768937037042243794551163891451545574837838357398072638709907958216067999891842395376953596940377457308329336524488962532620850237570279134567668379</span><br><span class="hljs-comment"># _e = 861605654852236668414010386016782729745549477722901970933220380452652052018502113737968204529790495739233258572209422774257139256367928649554562561889013164344608269555777150446651170697255381344437283003508476336814132594917061838422072660017477530465048729471603537912401826065081663165440462979219418291010867656746870617893935758241591032350010782861988742885918015532494020406350897048575155800941991107973433915573030255070411073793489218782862225921465295055907689734413881263179029741870520797816282420230090879687287575328294171448819803530205292587159921154471289747571107461754730577787617451127061265552788125691266357724955508391085485034126227212788895416902189479587194999818764639403752596165043883295506465916277734482380252399557395621566461322664559344483889187037851178431011220134914560438657522787409632677020269086895142488669203469256629173438313487046130238010206678820035631793666627274457756812810094004185303422637897314225624079032617334487815628021058997628511963565055629435278956251869329025544623291223984190562109149316159243565323565271491356378189561005084676592786453581431393651385181326525455441155960432946682976515756161038293313433862078763004704003356983371787414787104076401121444383911561</span><br><span class="hljs-comment"># _c = 305937839546594439230463861584604201077374759167468410827830943528403007941779658881672477705113617614828611332427199124217887937391378281943856159571057598203709366891547401974326016980711130197275312149966105151573748299654404630150641461765232935912266448303266990247145252052886920248198006212876273661195636104435277145396636985516064154534488750879453474211852461463041960835745695368577903786702607508492658563272121038693371752289017330781719235752018697635304458321008407930986565779826278048082764754367267460637798512780153281325733348999426407049795270044819657399403071013496169060640127279409914638535996355848933378734045908205536540619564723586905257569498716707820544351092379516465943537383422680357333849248129118148543389733395686399565999586899123087310025442994131218237679518267106194962305629529210402269726736072967966518381350920965727690274018080619332676536005722214955949897632990356174168234408837737546230730400434240785496100281815168806724358191550743656843853383646410487436540166360406982096949178466861150173527305369007546917550634679211293496458282787881244581230558011582720632502886494712233308474151958909251857281750741736910202763888790654287328846201724930302778996046434656839999091303411</span><br><br><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦å…ˆæ±‚å‡ºe1ï¼Œå†é€šè¿‡e1å’Œe2æ‰¾åˆ°lcmï¼Œå†é€šè¿‡lcmæ‰¾åˆ°då’Œm</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs scss">def <span class="hljs-built_in">des_decrypt</span>(m):<br>    des = DES.<span class="hljs-built_in">new</span>(key, DES.MODE_ECB)<br>    res = des.<span class="hljs-built_in">decrypt</span>(m)<br>    return res<br>ciphertext = <span class="hljs-built_in">long_to_bytes</span>(_e)<br>decrypted_data = <span class="hljs-built_in">des_decrypt</span>(ciphertext)<br>_t=<span class="hljs-built_in">bytes_to_long</span>(decrypted_data)<br><span class="hljs-built_in">print</span>(_t)åˆ©ç”¨è¿™ä¸ªå…ˆæ±‚å‡º_t<br></code></pre></td></tr></table></figure><p>t &#x3D; gmpy2.invert(u, phi_n)ï¼Œè¿™é‡Œtæ»¡è¶³ç»´çº³æ”»å‡»çš„æ¡ä»¶å¯ä»¥åˆ©ç”¨tæ±‚å‡ºphi_nå†è§£å‡º_då’Œe1ã€‚_</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs excel">from gmpy2 import invert<br>def possible(e,alist,<span class="hljs-built_in">N</span>)<span class="hljs-symbol">:</span><br>    for x in ali<span class="hljs-symbol">st:</span><br>        <span class="hljs-built_in">if</span> x==<span class="hljs-symbol">0:</span><br>            continue<br>        <span class="hljs-built_in">phi</span>=(e*x.denominator()-<span class="hljs-number">1</span>)//x.numerator()<br>        <span class="hljs-built_in">if</span> (<span class="hljs-built_in">N</span>-<span class="hljs-built_in">phi</span>+<span class="hljs-number">1</span>)%<span class="hljs-number">2</span>==<span class="hljs-number">0</span> <span class="hljs-built_in">and</span> <span class="hljs-built_in">sqrt</span>(pow((<span class="hljs-built_in">N</span>-<span class="hljs-built_in">phi</span>+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)-<span class="hljs-built_in">N</span>).is_integer()<span class="hljs-symbol">:</span><br>            (p,q)=<span class="hljs-built_in">var</span>(&#x27;p q&#x27;)<br>            <span class="hljs-built_in">Phi</span>=<span class="hljs-built_in">phi</span><br>            return <span class="hljs-built_in">Phi</span><br>        el<span class="hljs-symbol">se:</span><br>            continue<br>def wienner_attack(e,<span class="hljs-built_in">N</span>)<span class="hljs-symbol">:</span><br>    c=continued_fraction(e/<span class="hljs-built_in">N</span>)#è·å–è¿åˆ†æ•°é›†åˆ<br>    alist=c.convergents()#åˆ©ç”¨è¿åˆ†æ•°å¾—åˆ°è¿åˆ†æ•°æ”¶æ•›<br>    return possible(e,alist,<span class="hljs-built_in">N</span>)<br>_<span class="hljs-built_in">t</span>=<br>_c = <br>_<span class="hljs-built_in">n</span> = <br>_e = <br><span class="hljs-built_in">phi</span>=wienner_attack(_<span class="hljs-built_in">t</span>,_<span class="hljs-built_in">n</span>)<br><span class="hljs-symbol">d1</span>=invert(_e,<span class="hljs-built_in">phi</span>)<br><span class="hljs-symbol">e1</span>=pow(_c,<span class="hljs-symbol">d1</span>,_<span class="hljs-built_in">n</span>)<br>print(<span class="hljs-symbol">e1</span>)<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨e1æ„é€ çŸ©é˜µå¾—åˆ°phiåœ¨æ±‚å‡ºm</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs stylus">from gmpy2 import invert<br>from Crypto<span class="hljs-selector-class">.Util</span><span class="hljs-selector-class">.number</span> import bytes_to_long, long_to_bytes<br>c = <br>e2 = <br>e1 = <br>N  = <br><span class="hljs-selector-tag">a</span>  = <span class="hljs-number">5</span>./<span class="hljs-number">14</span><br>M1=N**<span class="hljs-number">0.5</span><br>M2= N **(a+<span class="hljs-number">1</span>)<br>D = <span class="hljs-built_in">diagonal_matrix</span>(ZZ,<span class="hljs-selector-attr">[N,M1,M2,1]</span>)<br>M=<span class="hljs-built_in">matrix</span>(ZZ,<span class="hljs-selector-attr">[[1,-N,0,N**2]</span>,<span class="hljs-selector-attr">[0,e1,-e1,-e1*N]</span>,<span class="hljs-selector-attr">[0,0,e2,-e2*N]</span>,<span class="hljs-selector-attr">[0,0,0,e1*e2]</span>])*D<br>L=M<span class="hljs-selector-class">.LLL</span>()<br>t=<span class="hljs-built_in">vector</span>(ZZ,L<span class="hljs-selector-attr">[0]</span>)<br><span class="hljs-attribute">x</span>=t*M**(-<span class="hljs-number">1</span>)<br>phi = <span class="hljs-built_in">int</span>(<span class="hljs-attribute">x</span>[<span class="hljs-number">1</span>]/x[<span class="hljs-number">0</span>]*e1)<br>d = <span class="hljs-built_in">invert</span>(<span class="hljs-number">0</span>x10001,phi)<br>m=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(c,d,N))<br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(long_to_bytes(m)</span></span>)<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>crypto</category>
      
      <category>RSA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
      <tag>RSA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CRTä¸­å›½å‰©ä½™å®šç†å¤ç°</title>
    <link href="/2024/12/29/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86%E5%A4%8D%E7%8E%B0/"/>
    <url>/2024/12/29/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="æå®¢å¤§æŒ‘æˆ˜2024ä¸­å›½å‰©ä½™å®šç†å¤ç°"><a href="#æå®¢å¤§æŒ‘æˆ˜2024ä¸­å›½å‰©ä½™å®šç†å¤ç°" class="headerlink" title="æå®¢å¤§æŒ‘æˆ˜2024ä¸­å›½å‰©ä½™å®šç†å¤ç°"></a>æå®¢å¤§æŒ‘æˆ˜2024ä¸­å›½å‰©ä½™å®šç†å¤ç°</h1><h2 id="CRT-ä¸­å›½å‰©ä½™å®šç†"><a href="#CRT-ä¸­å›½å‰©ä½™å®šç†" class="headerlink" title="CRT(ä¸­å›½å‰©ä½™å®šç†)"></a>CRT(ä¸­å›½å‰©ä½™å®šç†)</h2><h3 id="ä¸€äº›å®šç†çš„è¯æ˜"><a href="#ä¸€äº›å®šç†çš„è¯æ˜" class="headerlink" title="ä¸€äº›å®šç†çš„è¯æ˜"></a>ä¸€äº›å®šç†çš„è¯æ˜</h3><p>1.è¯æ˜è¾—è½¬ç›¸é™¤æ³•</p><blockquote><p>a&#x3D;bq+r</p><p>è¯æ˜gcd(a,b)&#x3D;gcd(b,r)</p><p>å·²çŸ¥gcd(a,b)|a,gcd(a,b)|b</p><p>r&#x3D;a-bq,â€”&gt;gcd(a,b)|r</p><p>æ‰€æœ‰gcd(a,b)&lt;&#x3D;gcd(b,r)</p><p>gcd(b,r)|b,gcd(b,r)|rå¹¶ä¸”gcd(b,r)|a</p><p>æ‰€ä»¥gcd(b,c)&lt;&#x3D;gcd(a,b)</p></blockquote><p>ä»£ç å®ç°</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs PY"><span class="hljs-keyword">def</span> <span class="hljs-title function_">gcd</span>(<span class="hljs-params">a,b</span>):<br>    <span class="hljs-keyword">while</span> b!=<span class="hljs-number">0</span>:<br>        r=a%b<br>        a=b<br>        b=r<br>    <span class="hljs-keyword">return</span> a<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯·è¾“å…¥a&quot;</span>)<br>a=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯·è¾“å…¥b&quot;</span>)<br>b=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br><span class="hljs-built_in">print</span>(gcd(a,b))<br>n=<span class="hljs-number">2</span><br><span class="hljs-keyword">while</span> n!=<span class="hljs-number">0</span>:<br>    n=n-<span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(n)<br><br></code></pre></td></tr></table></figure><ol start="2"><li>è¯æ˜è£´èœ€å®šç†</li></ol><blockquote><p>å¦‚æœaå’Œbæ˜¯ä¸ä¸º0çš„æ•´æ•°ï¼Œåˆ™æœ‰æ•´æ•°x,yï¼Œæ˜¯çš„ax+by&#x3D;gcd(a,b)</p><p>gcd(a,b)&#x3D;gcd(b,a%b&#x3D;r1)&#x3D;gcd(r1,b%r1&#x3D;r2)&#x3D;gcd(r2,r1%r2&#x3D;r3)&#x3D;gcd(r3,r2%r3&#x3D;0),,r3ä¸ºæœ€å¤§å…¬çº¦æ•°</p><p>r3&#x3D;r1-?r2,&#x3D;r1-(b-?r1)&#x3D;?r1+?b&#x3D;?(a-b?)+?b&#x3D;?a+?b(?ä¸ºä»»æ„æ•´æ•°)</p><p>æ¨è®ºï¼š</p><p><strong>a,bäº’è´¨&lt;â€“&gt;ax+by&#x3D;1</strong>(a,bä¸å…¨ä¸º0)</p><p><strong>å¦‚æœaå’Œbæ˜¯ä¸å…¨ä¸º0çš„æ•´æ•°ï¼Œå¹¶ä¸”ax+by&#x3D;cæœ‰è§£ï¼Œé‚£ä¹ˆcä¸€å®šæ˜¯gcd(a,b)çš„æ•´æ•°å€</strong></p><p>aå’Œbä¸¤é¡¹çš„è£´èœ€å®šç†å¯ä»¥æ¨å¹¿åˆ°å¤šé¡¹ï¼ˆax+by+cz&#x3D;gcd(a,b,c)</p></blockquote><ol start="3"><li>æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</li></ol><blockquote></blockquote><p>1.ç”¨äºå¤„ç†ä¸€å…ƒçº¿æ€§åŒä½™æ–¹ç¨‹ç»„é—®é¢˜</p><p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b3e3b83a47f7942fa7337d9157658625d6685ef0"></p><p>ä¸¾ä¾‹ä¸€ä¸ªç±»ä¼¼çš„çº¿æ€§çŸ©é˜µï¼Œæ»¡è¶³mä¹‹é—´äº’è´¨ï¼Œåˆ™å¯¹äºä»»æ„aï¼ŒXæœ‰è§£ã€‚</p><p>Miè¡¨ç¤ºm<sub>1</sub>*m<sub>2</sub>*â€¦*m<sub>n-1</sub></p><p>$$\prod_{i&#x3D;1}^{n} i&#x3D;M$$</p><p>t<sub>i</sub>&#x3D;M<sub>i</sub><sup>-1</sup>å³ä»–ä»¬äº’ä¸ºå€’æ•°</p><p>å¯ä»¥å¾—åˆ°t<sub>i</sub>*m<sub>i</sub>&#x3D;1mod(m<sub>i</sub>)</p><p>å¯ä»¥å¾—åˆ°</p><p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/105e4e1aa217620e7ebfa31a2c894845dd2ca1df" alt="{\displaystyle x=a_{1}t_{1}M_{1}+a_{2}t_{2}M_{2}+\cdots +a_{n}t_{n}M_{n}+kM=kM+\sum _{i=1}^{n}a_{i}t_{i}M_{i},\quad k\in \mathbb {Z} .}"></p><p>å¦‚æœå¯¹xå»æ¨¡Måˆ™å°±æœ‰<img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/56e89d12fd609dc39d5c6919c2d9c47252dbf829" alt="{\displaystyle x=\sum _{i=1}^{n}a_{i}t_{i}M_{i}.}">å”¯ä¸€è§£ï¼Œä¹Ÿæ˜¯æœ€å°è§£</p><p>åšé¢˜WP</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> Crypto.Util.number import *<br><span class="hljs-keyword">from</span><span class="hljs-built_in"> secret </span>import flag<br><br>p = [getPrime(1024) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(4)]<br>A = random_matrix(ZZ,4,4)<br>x = vector(p)<br>C = A*x<br>m = bytes_to_long(flag)<br>C_list = [m^2 % p[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> p]<br><br><span class="hljs-built_in">print</span>(A.list())<br><span class="hljs-built_in">print</span>(C.list())<br><span class="hljs-built_in">print</span>(C_list)<br></code></pre></td></tr></table></figure><p>p &#x3D; [getPrime(1024) for i in range(4)]éšæœºç”Ÿæˆå››ä¸ª1024ä½çš„å¤§ç´ æ•°ã€‚</p><p>A &#x3D; random_matrix(ZZ,4,4)éšæœºç”Ÿæˆä¸€ä¸ª4*4çŸ©é˜µã€‚</p><p>x &#x3D; vector(p)å°†på˜æˆ4ç»´å‘é‡Xã€‚</p><p>C&#x3D;A*X&#x2F;&#x2F;Aä¸XçŸ©é˜µç›¸ä¹˜å¾—åˆ°Cã€‚</p><p>m &#x3D; bytes_to_long(flag)ã€‚å°†flagä»å­—èŠ‚è½¬æ¢æˆä¸€ä¸ªé•¿æ•´æ•°ã€‚</p><p>C_list &#x3D; [m^2 % p[i] for i in p]ã€‚å°†m<sup>2</sup>æ¨¡pä¸­çš„æ¯ä¸ªæ•°ï¼Œå¾—åˆ°æœ‰å››ä¸ªå…ƒç´ çš„åˆ—è¡¨C_listã€‚</p><p>æˆ‘ä»¬åæ¨è¿™ä¸ªé¢˜ï¼Œå·²çŸ¥Cï¼ŒAï¼ŒC_listã€‚å…ˆé€šè¿‡C &#x3D; A*xåæ¨å‡ºXç„¶åå¾—åˆ°Pã€‚ç„¶åé€šè¿‡Påˆ©ç”¨ä¸­å›½å‰©ä½™å®šç†ï¼Œå¾—åˆ°m<sup>2</sup>æœ€åå¾—åˆ°flag</p><p>pythonè§£å¯†ä»£ç å¦‚ä¸‹</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs makefile">from sympy import Matrix, floor, sqrt<br>from sympy.ntheory.modular import solve_congruence<br>from Crypto.Util.number import long_to_bytes<br><br><span class="hljs-comment"># å·²çŸ¥çŸ©é˜µ A å’Œå‘é‡ C</span><br>A = Matrix([[0, 3, 13, -14], [3, 23, 0, -2], [1, 0, -2, -2], [0, 6, 23, -1]])<br>C = Matrix([<br>    240291916026450853326299190970230346016172195881040521282143062887044415649037529786726996601318182310764736460576505905853588791461834136499382728467644441025444276310127878088660033443492552638740545000926442503220444210798223930409598242340803157100462304319147723884276724762657521839584789559871925165760,<br>    2717720293948071692375399406613869670771599238582123998465247515177734926976499453293454850275431149956050441808723146824893873695181057831740557746748569414755121567964485941329619805530387035869417797456365550166284561344481782536841750836701781173446215190576686468572143336023976555984489188188587442599216,<br>    -533548100977056273203151152482369923618163132589214562561487066657940175907095576692149455190734101432827064737665463493053792538736227178020400115918642405290979502807029452417998359787492016936318980930297669652709045919397558996256596914383243332942443302758025216611814306941895320000161610678184972875739,<br>    4222318758561393352580663599337085248915805543151591039306576069590530359211724446951051459283547556643285440266930522614603788902068741368143298763016144907986405290404635699093289327803758616517987063925407686664235188616756483626348375811993157044295992929396465160478520815655459249252288507190574794338922<br>])<br><br><span class="hljs-comment"># æ±‚è§£ x å‘é‡</span><br>x = A.LUsolve(C)  <span class="hljs-comment"># ä½¿ç”¨ sympy çš„ LU åˆ†è§£æ¥è§£çº¿æ€§æ–¹ç¨‹ç»„ï¼Œé¿å…æµ®ç‚¹æ•°æº¢å‡º</span><br><br><span class="hljs-comment"># æ¨¡æ•°å’Œä½™æ•°åˆ—è¡¨</span><br>p = list(x)<br>C_list = [<br>    1480960470329638043680688727038239738930475793098218659683171073192289938334049452419257815941575064684613256921077170955193683633002228493232830695650419041071577617101320586384<br>] * 4<br><br><span class="hljs-comment"># ä½¿ç”¨ solve_congruence æ±‚è§£ m^2</span><br>congruences = [(C_list[i], p[i]) for i in range(4)]<br>m_squared, _ = solve_congruence(*congruences)<br><br><span class="hljs-comment"># æ±‚è§£ m</span><br>m = floor(sqrt(m_squared))<br>flag = long_to_bytes(m)<br><br>print(<span class="hljs-string">&quot;è§£å‡ºçš„ flag:&quot;</span>, flag)<br></code></pre></td></tr></table></figure><p>flag: bâ€™MaybeLinearAlgebraStillNeedYourEffortâ€™</p><h3 id="æ‰©å±•çŸ¥è¯†â€“å¦‚æœæ¨¡æ•°ä¸äº’è´¨"><a href="#æ‰©å±•çŸ¥è¯†â€“å¦‚æœæ¨¡æ•°ä¸äº’è´¨" class="headerlink" title="æ‰©å±•çŸ¥è¯†â€“å¦‚æœæ¨¡æ•°ä¸äº’è´¨"></a>æ‰©å±•çŸ¥è¯†â€“å¦‚æœæ¨¡æ•°ä¸äº’è´¨</h3><h4 id="æ‰©å±•æ¬§å‡ é‡Œå¾—å®šç†å’Œè£´èœ€å®šç†ã€‚"><a href="#æ‰©å±•æ¬§å‡ é‡Œå¾—å®šç†å’Œè£´èœ€å®šç†ã€‚" class="headerlink" title="æ‰©å±•æ¬§å‡ é‡Œå¾—å®šç†å’Œè£´èœ€å®šç†ã€‚"></a>æ‰©å±•æ¬§å‡ é‡Œå¾—å®šç†å’Œè£´èœ€å®šç†ã€‚</h4><p>æè¿°ï¼š<strong>ä¸€å®šå­˜åœ¨æ•´æ•° x, y æ»¡è¶³ç­‰å¼ a * x + b * y &#x3D; gcd(a,b)</strong></p><p>è¯æ˜ï¼Œã€‚</p><blockquote><ul><li>å¦‚æœb&#x3D;0,ï¼Œåˆ™ gcdâ¡(a,b)&#x3D;âˆ£aâˆ£,æ­¤æ—¶æˆ‘ä»¬å–x&#x3D;1æˆ–-1å’Œy&#x3D;0æ˜¾ç„¶æ»¡è¶³a<em>x+b</em>y&#x3D;dã€‚</li><li>å¦‚æœbâ‰ 0,æ ¹æ®æ¬§å‡ é‡Œå¾—å‡ ä½•ç®—æ³•ï¼Œå¯ä»¥å†™å‡ºï¼š</li></ul><p>a&#x3D;b*q+rå³aå…¶ä¸­ q æ˜¯å•†ï¼Œræ˜¯ä½™æ•°ï¼Œä¸” 0â‰¤r&lt;âˆ£bâˆ£ã€‚æ ¹æ®è¿™ä¸€è¡¨ç¤ºæ³•ï¼Œæˆ‘ä»¬æœ‰gcd(a,b)&#x3D;gcd(b,r)</p><p>ç°åœ¨æˆ‘å°†é—®é¢˜è½¬åŒ–ä¸ºè¯æ˜ï¼šå­˜åœ¨æ•´æ•°xâ€™å’Œyâ€™ï¼Œæ˜¯çš„</p><ul><li><strong>b<em>xâ€™+r</em>yâ€™&#x3D;gcd(b,r)</strong></li></ul><p>æ ¹æ®æ•°å­¦å½’çº³æ³•ï¼Œè¿™ä¸ªç­‰å¼æˆç«‹ã€‚</p><ul><li>ç”±äºr&#x3D;a-bq,æˆ‘ä»¬å¯ä»¥å°†rå¸¦å…¥ä¸Šå¼</li></ul><p>*<em>bxâ€™+(a-bq)<em>yâ€™&#x3D;d,</em></em></p><p><strong>ayâ€™+b(xâ€™-qyâ€™)&#x3D;d</strong></p><p>è¿™è¡¨æ˜ï¼Œè‹¥ä»¤x&#x3D;yâ€™å’Œy&#x3D;xâ€™-qyâ€™ï¼Œé‚£ä¹ˆax+by&#x3D;d</p><p>é‚£ä¹ˆæˆ‘ä»¬ä¸€æ­¥æ­¥é€’å½’å°±èƒ½å¾—åˆ°ä½™æ•°ï¼Œæœ‰ç‚¹ç±»ä¼¼è¾—è½¬ç›¸é™¤ï¼Œé€’å½’çš„æ¯ä¸€æ­¥b,q,d,,aéƒ½æ˜¯æ•´æ•°ï¼Œé€’å½’åˆ°æœ€åä¸€æ­¥çš„æ•´é™¤å€æ•°</p><p>r<sub>k-2</sub>&#x3D;r<sub>k-1</sub>*q<sub>k</sub>+r<sub>k</sub></p><p>r<sub>k-1</sub>&#x3D;r<sub>k</sub>*q<sub>k+1</sub>+0</p><p>r<sub>k</sub>&#x3D;r<sub>k-2</sub>-q<sub>k</sub>r<sub>k-1</sub></p><p>d&#x3D;x<sub>k</sub>r<sub>k-2</sub>+y<sub>k</sub>r<sub>k-1</sub></p><p>æ˜æ˜¾x<sub>k</sub>&#x3D;1,y<sub>k</sub>&#x3D;-q<sub>k</sub>ä¸ºæ•´æ•°</p><p>å‘ä¸Šæ­¥æ­¥é€’å½’å¯ä»¥å¾—åˆ°çš„xå’Œyä¹Ÿä¸ºæ•´æ•°ã€‚</p><ul><li>æˆ‘ä»¬é€šè¿‡æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ä¸€èˆ¬å¾—åˆ°çš„æ˜¯ç‰¹è§£(x<sub>0</sub>,y<sub>0</sub>)æ»¡è¶³</li></ul><p>ax+by&#x3D;d.æˆ‘ä»¬éœ€è¦è¯æ˜æ‰€æœ‰æ»¡è¶³æ­¤æ–¹ç¨‹çš„æ•´æ•°è§£ï¼ˆx,y)çš„å½¢å¼æ˜¯ã€‚kä¸ºä»»æ„æ•´æ•°ã€‚</p><p><strong>x&#x3D;x<sub>0</sub>+(b&#x2F;d)k,</strong></p><p><strong>y&#x3D;y<sub>0</sub>-(a&#x2F;d)k;</strong></p><p>æˆ‘ä»¬å°†ä¸¤å¯¹è§£ç›¸å‡å¾—åˆ°</p><p><em><em>a*(x<sub>1</sub>-x<sub>0</sub>)+b</em>(y<sub>1</sub>-y<sub>0</sub>)&#x3D;0</em>*</p><p>a*(x<sub>1</sub>-x<sub>0</sub>)&#x3D;-b*(y<sub>1</sub>-y<sub>0</sub>)</p><p>æ»¡è¶³æ¯”ä¾‹å…³ç³»-b&#x2F;a&#x3D;(x<sub>1</sub>-x<sub>0</sub>)&#x2F;(y<sub>1</sub>-y<sub>0</sub>)</p><p>å¹¶ä¸”gcd(a,b)&#x3D;dï¼Œå¯¹aå’ŒbåŒæ—¶é™¤ä»¥å…¬å› å­,b&#x2F;aå®ŒæˆåŒ–ç®€ã€‚</p><p>å°±èƒ½å¾—åˆ°*<em>x<sub>1</sub>-x<sub>0</sub>&#x3D;(b&#x2F;d)<em>k</em></em>||y<sub>1</sub>-y<sub>0</sub>&#x3D;-(a&#x2F;d)*k</p><p>æœ€åå¾—åˆ°é€šè§£ã€‚</p></blockquote><h4 id="ä¸­å›½å‰©ä½™ä¸äº’è´¨çš„åº”ç”¨ï¼ˆå‡è®¾æ±‚çš„æ•°ä¸ºans"><a href="#ä¸­å›½å‰©ä½™ä¸äº’è´¨çš„åº”ç”¨ï¼ˆå‡è®¾æ±‚çš„æ•°ä¸ºans" class="headerlink" title="ä¸­å›½å‰©ä½™ä¸äº’è´¨çš„åº”ç”¨ï¼ˆå‡è®¾æ±‚çš„æ•°ä¸ºans)"></a>ä¸­å›½å‰©ä½™ä¸äº’è´¨çš„åº”ç”¨ï¼ˆå‡è®¾æ±‚çš„æ•°ä¸ºans)</h4><blockquote><p>ä¸­å›½å‰©ä½™å®šç†æ˜¯ç”¨äºæ±‚ä¸€ä¸ªæœ€å°çš„xxï¼Œæ»¡è¶³$xâ‰¡ci(modmi)cocrt$</p><p>ä¸€èˆ¬çš„ä¸­å›½å‰©ä½™å®šç†éƒ½æ»¡è¶³miä¹‹é—´äº’è´¨ï¼Œè¿™é‡Œæ‰©å±•çš„æ˜¯ä¸äº’è´¨çš„æƒ…å†µ</p><p>å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸¤æ¡æ–¹ç¨‹:</p></blockquote><p>$$<br>\left{<br>\begin{aligned}<br>x &amp; â‰¡ c_1(modm_1) \<br>x &amp;â‰¡ c_2(mod m_2)\<br>\end{aligned}<br>\right.<br>$$</p><p>å±•å¼€åŒä½™<br>$$<br>\left{<br>\begin{aligned}<br>x&#x3D;c_1+m_1k_1 \<br>x&#x3D;c_2+m_2k_2\<br>\end{aligned}<br>\right.<br>$$</p><p>è”ç«‹å¾—è§£:$m_1k_1&#x3D;(c_2-c_1)+m_2k_2$</p><p>è‹¥æ–¹ç¨‹æœ‰è§£,$(m1,m2)|(c2âˆ’c1)$</p><p>ä»¤$d&#x3D;(m1,m2)$</p><p>ä¸¤è¾¹åŒæ—¶é™¤ä»¥d</p><p>$m_1 k_1\over d$&#x3D;$c_2-c_1\over d$(mod $m_2 \over d$)</p><p>k1&#x3D;inv($m_1 \over d$,$m_2 \over d$)*$c_2-c_1\over d$(mod $m_2 \over d$)</p><p>æœ€åå¾—åˆ°ï¼š$xâ‰¡inv(m1&#x2F;d,m2&#x2F;d)Ã—(c2âˆ’c1)&#x2F;dÃ—m1+c1(mod(m1m2)&#x2F;d)$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><br>flag = <span class="hljs-string">b&#x27;SYC&#123;...&#125;&#x27;</span><br>m = bytes_to_long(flag+<span class="hljs-string">b&#x27;\x01&#x27;</span>*<span class="hljs-number">23</span>)<br><br>p = [<span class="hljs-number">0</span>]*<span class="hljs-number">5</span><br>c = [<span class="hljs-number">0</span>]*<span class="hljs-number">5</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>    p0 = random.randint(<span class="hljs-number">2</span>**<span class="hljs-number">100</span>,<span class="hljs-number">2</span>**<span class="hljs-number">101</span>)<br>    p[i] = p0<br>c = [m%p[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>)]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c = <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">p = [1921232050179818686537976490035, 2050175089402111328155892746480, 1960810970476421389691930930824, 1797713136323968089432024221276, 2326915607951286191807212748022]</span><br><span class="hljs-string">c = [1259284928311091851012441581576, 1501691203352712190922548476321, 1660842626322200346728249202857, 657314037433265072289232145909, 2056630082529583499248887436721]</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>mæ¨¡på¾—åˆ°cï¼Œå¹¶ä¸”pä¸æ˜¯äº’è´¨çš„ã€‚è¿™é‡Œè¦ä½¿ç”¨ä¸äº’è´¨çš„ç®—æ³•</p><p>è§£é¢˜ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> gcdex<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">uni</span>(<span class="hljs-params">P,Q</span>):<br>    c1,m1=P<br>    c2,m2=Q<br>    d=gcd(m1,m2)<br>    <span class="hljs-keyword">assert</span> (c2-c1)%d==<span class="hljs-number">0</span><br>    l=inverse(m1//d,m2//d)<br>    <span class="hljs-built_in">print</span>(l)<br>    <span class="hljs-keyword">return</span> (c1 + (c2 - c1) // d * l * m1) % lcm(m1, m2), lcm(m1, m2)<span class="hljs-comment">#è¿”å›çš„æ˜¯ä¸€ä¸ªå…ƒç»„</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">CRT</span>(<span class="hljs-params">eq</span>):<br>    <span class="hljs-keyword">return</span> reduce(uni, eq)<span class="hljs-comment">#</span><br><br><br>ms = [<span class="hljs-number">1921232050179818686537976490035</span>, <span class="hljs-number">2050175089402111328155892746480</span>, <span class="hljs-number">1960810970476421389691930930824</span>,<br>      <span class="hljs-number">1797713136323968089432024221276</span>, <span class="hljs-number">2326915607951286191807212748022</span>]<br>cs = [<span class="hljs-number">1259284928311091851012441581576</span>, <span class="hljs-number">1501691203352712190922548476321</span>, <span class="hljs-number">1660842626322200346728249202857</span>,<br>      <span class="hljs-number">657314037433265072289232145909</span>, <span class="hljs-number">2056630082529583499248887436721</span>]<br>flag, lcm = CRT(<span class="hljs-built_in">zip</span>(cs, ms))<span class="hljs-comment">#æŠŠä¸¤ä¸ªåˆ—è¡¨æ‰“åŒ…ï¼Œä¾æ¬¡å¯¹åº”æœ‰ç‚¹åƒäºŒç»´æ•°ç»„,ä½†å…¶å®è¿”å›çš„æ˜¯å…ƒç»„</span><br><span class="hljs-built_in">print</span>(long_to_bytes(flag))<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">90728466640069861245808807287</span><br><span class="hljs-string">88626484234357944548738818769</span><br><span class="hljs-string">341093009098982253215042305269</span><br><span class="hljs-string">635742831101395206473512021361</span><br><span class="hljs-string">b&#x27;SYC&#123;wha+s_wr0n9!_CRT_bu+_n0+_&lt;0mpr1me!&#125;\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01&#x27;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="rnocrt"><a href="#rnocrt" class="headerlink" title="rnocrt"></a>rnocrt</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> x<br><br>m = [getRandomNBitInteger(<span class="hljs-number">256</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)]<br>u = hashlib.sha256(x).hexdigest()<br><span class="hljs-keyword">assert</span> u[:<span class="hljs-number">5</span>]==<span class="hljs-string">b&#x27;6a651&#x27;</span><br>flag = <span class="hljs-string">b&#x27;SYC&#123;&#x27;</span>+u+<span class="hljs-string">b&#x27;&#125;&#x27;</span><br>c = [x % i  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> m]<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-built_in">print</span>(c)<br><br><span class="hljs-comment">#[207867980504656835313307696396607264603, 245036212212570610987366430554968489325, 270836744824069537438646110613439698666, 319275775495422875474878625752594133023, 254268823435329877199449670714528712873, 213093607196415232366564484229844568444, 246921085368773491003187313772615702950]</span><br><span class="hljs-comment">#[150031581047390726903711035932621949276, 21260202376534810598778595491323328519, 144049733622518360270048059408969512643, 236920143187836025924037873968303507493, 99781504248790469459151935530031893836, 69236016568483424294966410179787943383, 20613188366058016717435734248097940419]</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜è·Ÿä¸Šä¸ªé¢˜å¾ˆåƒï¼Œä½†æ˜¯ä¸Šä¸€ä¸ªè¿”å›çš„æœ€å°å€¼å°±æ˜¯flagè¿™ä¸ªéœ€è¦ä¸€å®šçš„çˆ†ç ´ï¼Œå¹¶ä¸”æ³¨æ„æ•°æ®çš„ç±»å‹</p><p>å› ä¸ºfæ˜¯è¢«modå„ä¸ªmiæœ€å¤§å…¬çº¦æ•°çš„ç»“æœï¼Œå±äºå€¼æœ€å°çš„å¯èƒ½,æˆ‘ä»¬å¯ä»¥æŒ¨ä¸ªf+i&#x2F;*lcmçŸ¥é“å¾—åˆ°æœ€å¤§å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> inverse<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">uni</span>(<span class="hljs-params">P,Q</span>):<br>    c1,m1=P<br>    c2,m2=Q<br>    d=gcd(m1,m2)<br>    <span class="hljs-keyword">assert</span> (c2-c1)%d==<span class="hljs-number">0</span><br>    l=inverse(m1//d,m2//d)<br>    <span class="hljs-built_in">print</span>(l)<br>    <span class="hljs-keyword">return</span> (c1 + (c2 - c1) // d * l * m1) % lcm(m1, m2), lcm(m1, m2)<span class="hljs-comment">#è¿”å›çš„æ˜¯ä¸€ä¸ªå…ƒç»„</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">CRT</span>(<span class="hljs-params">eq</span>):<br>    <span class="hljs-keyword">return</span> reduce(uni, eq)<span class="hljs-comment">#</span><br><br><br>ms = [<span class="hljs-number">207867980504656835313307696396607264603</span>, <span class="hljs-number">245036212212570610987366430554968489325</span>, <span class="hljs-number">270836744824069537438646110613439698666</span>, <span class="hljs-number">319275775495422875474878625752594133023</span>, <span class="hljs-number">254268823435329877199449670714528712873</span>, <span class="hljs-number">213093607196415232366564484229844568444</span>, <span class="hljs-number">246921085368773491003187313772615702950</span>]<br>cs = [<span class="hljs-number">150031581047390726903711035932621949276</span>, <span class="hljs-number">21260202376534810598778595491323328519</span>, <span class="hljs-number">144049733622518360270048059408969512643</span>, <span class="hljs-number">236920143187836025924037873968303507493</span>, <span class="hljs-number">99781504248790469459151935530031893836</span>, <span class="hljs-number">69236016568483424294966410179787943383</span>, <span class="hljs-number">20613188366058016717435734248097940419</span>]<br>f, lcm = CRT(<span class="hljs-built_in">zip</span>(cs, ms))<span class="hljs-comment">#æŠŠä¸¤ä¸ªåˆ—è¡¨æ‰“åŒ…ï¼Œä¾æ¬¡å¯¹åº”æœ‰ç‚¹åƒäºŒç»´æ•°ç»„,ä½†å…¶å®è¿”å›çš„æ˜¯å…ƒç»„</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000000</span>):<br>    x=<span class="hljs-built_in">str</span>(f+i*lcm).encode()<br>    u=hashlib.sha256(x).hexdigest()<br>    flag=<span class="hljs-string">&quot;SYC&#123;&quot;</span>+u+<span class="hljs-string">&quot;&#125;&quot;</span><br>    <span class="hljs-keyword">if</span> u[:<span class="hljs-number">5</span>]==<span class="hljs-string">&quot;6a651&quot;</span>:<br>        <span class="hljs-built_in">print</span>(flag)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">SYC&#123;6a651b7ce47b35cc1aca565028fb633fab9e35ca08e45d5ce987a6caeb500465&#125;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AESåŠ å¯†ä»¥åŠä»£ç å®ç°</title>
    <link href="/2024/12/24/AES%E5%8A%A0%E5%AF%86%E5%9B%9E%E9%A1%BE%E4%BB%A5%E5%8F%8A%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/"/>
    <url>/2024/12/24/AES%E5%8A%A0%E5%AF%86%E5%9B%9E%E9%A1%BE%E4%BB%A5%E5%8F%8A%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="AESåŠ å¯†å›é¡¾ä»¥åŠä»£ç å®ç°"><a href="#AESåŠ å¯†å›é¡¾ä»¥åŠä»£ç å®ç°" class="headerlink" title="AESåŠ å¯†å›é¡¾ä»¥åŠä»£ç å®ç°"></a>AESåŠ å¯†å›é¡¾ä»¥åŠä»£ç å®ç°</h1><p><a href="https://formaestudio.com/rijndaelinspector/archivos/Rijndael_Animation_v4_eng-html5.html">Rijndael_Animation_v4_eng-html5</a></p><p>è¿™é‡Œæ”¾äº†ä¸€ä¸ªåŠ¨æ€æ¼”ç¤ºAESåŠ å¯†è¿‡ç¨‹çš„ç½‘ç«™ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è§‚çœ‹ï¼Œå»ºè®®æŒ‚ä»£ç†é£Ÿç”¨</p><p>Rconæ˜¯è½®å¸¸é‡ï¼š<img src="https://pic4.zhimg.com/v2-1b2965b8a4932014106cee1a392ec980_r.jpg" alt="å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†ç®—æ³•åŸç†è¯¦è§£ï¼ˆå¯¹ç§°åŠ å¯†ç¯‡ï¼‰ - çŸ¥ä¹"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ¥è§¦å¯†ç å­¦ä¹Ÿä¸¤ä¸ªæœˆäº†ï¼Œä¹‹å‰æ˜¯å­¦è¿‡AESçš„ä½†æ˜¯éƒ½æ˜¯ç®€å•çœ‹äº†ä¸‹å¤§æ¦‚ï¼Œæ‰“CTFçš„æ—¶å€™å–œæ¬¢pythonåº“è„šæœ¬ä¸€æŠŠæ¢­ï¼Œå¯¹AESæ¶‰åŠçš„ä¸€äº›æ•°å­¦åŸç†ä¸ç†è§£ï¼Œå¸Œæœ›å°è¯•ç”¨pythonå®ç°AESåŠ å¯†ã€‚</p><h2 id="é‡è¦çš„å‰ç½®çŸ¥è¯†ï¼Œæœ‰é™åŸŸå¤šé¡¹å¼ä¹˜æ³•è¿ç®—ã€‚"><a href="#é‡è¦çš„å‰ç½®çŸ¥è¯†ï¼Œæœ‰é™åŸŸå¤šé¡¹å¼ä¹˜æ³•è¿ç®—ã€‚" class="headerlink" title="é‡è¦çš„å‰ç½®çŸ¥è¯†ï¼Œæœ‰é™åŸŸå¤šé¡¹å¼ä¹˜æ³•è¿ç®—ã€‚"></a>é‡è¦çš„å‰ç½®çŸ¥è¯†ï¼Œæœ‰é™åŸŸå¤šé¡¹å¼ä¹˜æ³•è¿ç®—ã€‚</h2><h3 id="1-GF-28-ä¸­çš„å¤šé¡¹å¼"><a href="#1-GF-28-ä¸­çš„å¤šé¡¹å¼" class="headerlink" title="1.GF(28)ä¸­çš„å¤šé¡¹å¼"></a>1.GF(2<Sup>8</sup>)ä¸­çš„å¤šé¡¹å¼</h3><p>ä¼½ç½—ç“¦åŸŸä¹‹å‰ä»¥åŠäº†è§£è¿‡ï¼Œå¤§å®¶æœ‰å…´è¶£å¯ä»¥è‡ªå·±æœä¸€ä¸‹</p><p>$f(x)&#x3D;a_7x^7+a_6x^6+â€¦+a_1x^1+a_2x^2$</p><p>å…¶ä¸­aiæ˜¯x&#x3D;2çš„ç³»æ•°&#x3D;åªèƒ½ä¸º1æˆ–è€…0ï¼Œè¯¥å¤šé¡¹å¼å¯ä»¥è¡¨ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶æ•´æ•°</p><h3 id="2-ä¸å¯çº¦çš„å¤šé¡¹å¼è§„"><a href="#2-ä¸å¯çº¦çš„å¤šé¡¹å¼è§„" class="headerlink" title="2.ä¸å¯çº¦çš„å¤šé¡¹å¼è§„"></a>2.ä¸å¯çº¦çš„å¤šé¡¹å¼è§„</h3><p>$m(X)&#x3D;x^8+x^4+x^3+x+1$</p><p>ç§°ä¹‹ä¸ºä¸å¯çº¦å¤šé¡¹å¼ï¼Œä¹Ÿå°±æ˜¯è´¨æ•°</p><h3 id="å¤šé¡¹å¼æ¨¡è¿ç®—"><a href="#å¤šé¡¹å¼æ¨¡è¿ç®—" class="headerlink" title="å¤šé¡¹å¼æ¨¡è¿ç®—"></a>å¤šé¡¹å¼æ¨¡è¿ç®—</h3><p>æ¥ä¸‹æ¥ä¼°è®¡åˆæ˜¯é•¿ç¯‡å¤§è®ºäº†ã€‚å¤šé¡¹å¼æ¨¡è¿ç®—æˆ‘å¯ä»¥å†™çš„è¯¦ç»†ç‚¹</p><p>å¤šé¡¹å¼è¿ç®—åˆ†ä¸ºä¸‰ç§</p><ul><li><p>ä½¿ç”¨ä»£æ•°æ–¹æ³•è¿ç®—çš„æ™®é€šå¤šé¡¹å¼</p></li><li><p>ç³»æ•°è¿ç®—æ˜¯æ¨¡Pçš„å¤šé¡¹å¼ï¼Œå³å†ç³»æ•°GF(p)ä¸­</p></li><li><p>ç³»æ•°åœ¨GF(p)ä¸­ï¼Œä¸”å¤šé¡¹å¼è¢«å®šä¹‰ä¸ºæ¨¡ä¸€ä¸ªnæ¬¡å¤šé¡¹å¼m(x)çš„å¤šé¡¹å¼è¿ç®—</p></li></ul><p>æˆ‘ä»¬ä¹˜æ³•é€†å…ƒè¦ç”¨åˆ°ç¬¬ä¸‰ç« ï¼Œç„¶åæ­£å¸¸è¿ç®—åå¯¹M(X)å–ä½™æ•°ï¼Œæ‰æ˜¯æœ€ç»ˆè¿ç®—ç»“æœã€‚</p><blockquote><p>ä¾‹å¦‚f(x)&#x3D;x<sup>6</sup>+x<sup>3</sup>++1ä¸g(x)&#x3D;x<sup>5</sup>+x<sup>4</sup>+x<sup>3</sup>ç›¸åŠ </p><p>f(x)+g(x)&#x3D;x<sup>5</sup>+x<sup>4</sup>+1,å’Œå¼‚æˆ–ä¸€æ ·ã€‚ä½œä¹˜æ³•æ—¶</p><p>f(x)*g(x)&#x3D;</p></blockquote><blockquote><p>è®²ä¸€ä¸‹å¤šé¡¹å¼æœ‰é™åŸŸç›¸ä¹˜ã€‚å…ˆè¿›è¡Œæ­£å¸¸çš„ä»£æ•°ç›¸ä¹˜</p><p>å¾—åˆ°ï¼Œè®°å¾—ç›¸åŠ çš„æ—¶å€™æ˜¯å¼‚æˆ–ç›¸åŠ f(x)*g(x)&#x3D;x11+x10+x9+x8+x7+x6+x5+x4+x3 mod(m(x))</p><h6 id="x11-x3-x8â€”-å¤šé¡¹å¼å¼‚æˆ–x3m-x-x11-x7-x6-x4-x3"><a href="#x11-x3-x8â€”-å¤šé¡¹å¼å¼‚æˆ–x3m-x-x11-x7-x6-x4-x3" class="headerlink" title="x11&#x3D;x3*x8â€”&gt;å¤šé¡¹å¼å¼‚æˆ–x3m(x)&#x3D;x11+x7+x6+x4+x3"></a>x<sup>11</sup>&#x3D;x<sup>3</sup>*x<sup>8</sup>â€”&gt;å¤šé¡¹å¼å¼‚æˆ–x<sup>3</sup>m(x)&#x3D;x11+x7+x6+x4+x3</h6><p>f(x)&#x3D;x10+x9+x10+x9+x8+x5å†å¼‚æˆ–x<sup>2</sup>m(x)&#x3D;x10+x6+x5+x3+x2</p><p>å¾—åˆ°f(x)&#x3D;x9+x6+x3+x2å¼‚æˆ–ç›¸åŠ xm(x)å’Œm(x)æ±‚å‡ºç»“æœ</p><p>f(x)&#x3D;x<sup>7</sup>+x<sup>6</sup>+x<sup>5</sup>+x<sup>4</sup>+x<sup>2</sup>+x</p></blockquote><p>GF(2<sup>8</sup>)è¿˜å®šä¹‰äº†è¿ç®—ï¼Œç§°ä¸ºxä¹˜æ³•ï¼Œå…¶å®šä¹‰ä¸º</p><p>x*b(x)&#x3D;b<sub>7</sub>x<sup>8</sup>+b<sub>6</sub>x<sup>7</sup>+â€¦+b<sub>0</sub>x(mod m(x))</p><p>å¦‚æœb<sub>7</sub>&#x3D;0,æ±‚æ¨¡ç»“æœä¸å˜ï¼Œå¦åˆ™ä¹˜ç§¯å‡å»m(x),å³æ±‚ä¹˜ç§¯çš„ç»“æœä¸m(x)å¼‚æˆ–ã€‚</p><p>ç”±æ­¤çš„å¾—å‡ºåå…­è¿›åˆ¶02ä¹˜b(x)ç›¸å½“äºåœ¨å­—èŠ‚ä¸Šå·¦ç§»ä¸€ä½ï¼ˆæœ€åä¸€ä½è¡¥0ï¼‰ï¼Œè‹¥b<sup>7</sup>&#x3D;1,åˆ™å†ä¸1Bï¼ˆ00011011ï¼‰åšé€æ¯”ç‰¹å¼‚æˆ–æ¥å®ç°ï¼Œè¯¥è¿ç®—è®°ä¸ºb&#x3D;xtime(a)</p><p>ä¸Šè¿°è¿ç®—å°†ä¼šåº”ç”¨åœ¨åˆ—æ··æ·†ä¹‹ä¸­</p><p>æ¥ä¸‹æ¥ç¤ºä¾‹57(16è¿›åˆ¶)åœ¨è¯¥æ¡ä»¶ä¸‹ä¹˜02</p><blockquote><p>57&#x3D;01010111,02&#x3D;00000010ç›¸å½“äºï¼Œç¬¬7ä½å°äº0ï¼Œ57å·¦ç§»ä¸€ä½åé¢è¡¥0ã€‚57&#x3D;10101110&#x3D;AE</p><p>å¦‚æœæ˜¯57*03å¯ä»¥çœ‹ä½œ57*ï¼ˆ01+02)</p><p>å¦‚æœAE*02,å› ä¸ºAE&#x3D;10101110,å…ˆå°†AEå·¦ç§»ä¸€ä½è¡¥0</p><p>01011100*02 mod(00011011),è¿™äº›éƒ½æ˜¯ä¸ºäº†æ»¡è¶³æœ‰é™åŸŸå†…çš„æ¡ä»¶ï¼Œå…·ä½“æ•°å­¦åŸç†ï¼Œæˆ‘ä¹Ÿä¸å¤ªæ˜ç™½</p></blockquote><h2 id="1-AESåŠ å¯†"><a href="#1-AESåŠ å¯†" class="headerlink" title="1. AESåŠ å¯†"></a>1. AESåŠ å¯†</h2><p>é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ï¼ŒAESæœ¬èº«åªèƒ½å¤„ç†128ä½(16å­—èŠ‚)çš„æ˜æ–‡ã€‚åœ¨å¤„ç†æ—¶å°†å…¶æŒ‰å­—èŠ‚åˆ†æˆ16å—ï¼Œ4*4</p><table><thead><tr><th>A</th><th>E</th><th>I</th><th>N</th></tr></thead><tbody><tr><td>B</td><td>F</td><td>J</td><td>O</td></tr><tr><td>C</td><td>G</td><td>K</td><td>P</td></tr><tr><td>D</td><td>H</td><td>M</td><td>Q</td></tr></tbody></table><p>å¦‚æœå°‘äº†åˆ™å¡«å……0Aã€‚å¤šäº†åˆ™é‡æ–°æ’åœ¨å¦ä¸€ä¸ª4*4çš„è¡¨æ ¼ã€‚</p><p>AESæ”¯æŒä¸‰ç§é•¿åº¦çš„å¯†é’¥ï¼š<strong>128ä½ï¼Œ192ä½ï¼Œ256ä½</strong></p><p>128ä½ç»å†10è½®ï¼Œä¹‹åä¸¤ç§å¤š64ä½å¢åŠ ä¸¤è½®ã€‚</p><p><img src="https://rockfox0.github.io/picx-images-hosting/AES.5q7hdo4b6l.webp"></p><p>å¯ä»¥çœ‹å‡ºï¼ŒAESåŠ å¯†æœ‰ä¸‰ä¸ªè¿‡ç¨‹ã€‚åˆå§‹è½®ï¼Œä¸­é—´è½®ï¼Œæœ€åè½®ã€‚ä¸­é—´è½®çš„æ•°é‡åœ¨128Biteså¯†é’¥ä¸­æœ‰</p><p>åŸºç¡€çš„å››ä¸ªè¿‡ç¨‹ã€‚</p><ol><li>å­—èŠ‚æ›¿æ¢ï¼ˆSubBytesï¼‰q</li></ol><p>ä¾æ®ä¸€ä¸ªè¢«ç§°ä¸ºSç›’ï¼ˆSubtitution Boxï¼‰çš„16*16å¤§å°çš„äºŒç»´å¸¸é‡æ•°ç»„ã€‚ç¤ºä¾‹å¦‚å›¾ã€‚</p><p><img src="https://rockfox0.github.io/picx-images-hosting/Shex.8l05jgfe41.webp"></p><p>å¦‚æœæˆ‘ä»¬è¦æ›¿æ¢4då­—èŠ‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ‰¾åˆ°ç¬¬4è¡Œï¼Œç¬¬dåˆ—å³ä¸ºe3ã€‚</p><ol start="2"><li><p>è¡Œä½ç§»ï¼ˆShiftRowsï¼‰</p><p>ç¬¬ä¸€è¡Œä¸å˜ï¼Œç¬¬äºŒè¡Œå·¦ç§»ä¸€ä¸ªå­—èŠ‚ï¼Œç¬¬ä¸‰è¡Œå·¦ç§»ä¸‰ä¸ªå­—èŠ‚ï¼Œç¬¬å››è¡Œå·¦ç§»å››ä¸ªå­—èŠ‚ã€‚</p><table><thead><tr><th>A</th><th>E</th><th>I</th><th>N</th></tr></thead><tbody><tr><td>O</td><td>B</td><td>F</td><td>J</td></tr><tr><td>K</td><td>P</td><td>C</td><td>G</td></tr><tr><td>H</td><td>M</td><td>Q</td><td>D</td></tr></tbody></table><ol start="3"><li>åˆ—æ··æ·†ï¼ˆMixColumnsï¼‰ã€‚</li></ol><p><img src="https://img2018.cnblogs.com/i-beta/1810390/201911/1810390-20191115142019897-587484033.png" alt="img"></p><p>ç”¨ç»™å®šçš„ä¸€æ®µçŸ©é˜µå·¦ä¹˜æˆ‘ä»¬çš„æ•°æ®ï¼Œä½†æ˜¯ä¸å®Œå…¨è·ŸçŸ©é˜µä¹˜æ³•ç›¸åŒï¼Œç¤ºä¾‹ç»“æœå¦‚ä¸‹ï¼Œå·¦ä¹˜çš„æ•°</p><p>ä¾‹å¦‚ç¬¬ä¸€è¡Œç¬¬ä¸€åˆ—ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯<br>$$<br>q1&#x3D;(02<em>p1)âŠ•(03</em>p2)âŠ•(01<em>p3)âŠ•(01</em>p4)<br>$$<br>âŠ•æ˜¯å¼‚æˆ–(^)çš„æ„æ€ã€‚</p><ol start="4"><li>è½®å¯†é’¥åŠ (AddRoundKey)</li></ol><p>ç”¨æ˜æ–‡çŸ©é˜µå’Œç»™å®šçš„è½®å¯†é’¥æ¯ä¸€åˆ—è¿›è¡Œå¼‚æˆ–ã€‚</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2024-12-24-145502.1lbw1l0ect.webp"></p></li></ol><p>ä¾‹å¦‚å¦‚åŒã€‚</p><p>è¿™ä¸ªå¯†é’¥çŸ©é˜µæ¯è½®éƒ½ä¼šæ”¹å˜ã€‚å…³äºæ¯è½®çš„å¯†é’¥æ‰©å±•ï¼Œ</p><ul><li>æ¯ä¸€è½®éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„è½®å¯†é’¥</li></ul><p><img src="https://rockfox0.github.io/picx-images-hosting/Keyadd.1vypuqh6zf.webp"></p><p>åˆå§‹è½®å¯†é’¥ä¸ºa0&#x2F;1&#x2F;2&#x2F;3.ç¬¬<strong>i</strong>åˆ—çš„æ•°æ®ã€‚</p><p>å½“ <strong>i!&#x3D;4</strong>næ—¶ã€‚     **ai&#x3D;a[i-4] ^ a[i-1]**ã€‚</p><p>å½“i&#x3D;4næ—¶ã€‚      <strong>a[i]&#x3D;a[i-4]^T(a[i-1])</strong></p><p>T(a[i-1])éœ€è¦åšå‡ºè§£é‡Šã€‚</p><p>åˆ†ä¸ºä¸‰æ­¥ã€‚ä¾‹å¦‚a4&#x3D;a0^T(a[3])</p><ol><li><p>b3&#x3D;[09,cf,4f,3c]å·¦ç§»ä¸€ä½&lt;&lt;å¾—a3&#x3D;[cf,4f,3c,09]</p></li><li><p>å­—èŠ‚ä»£æ¢</p><p> æ ¹æ®Sç›’ã€‚c3&#x3D;[8a,84,eb,01]</p></li><li><p>å°†å‰ä¸¤æ­¥çš„ç»“æœåŒè½®å¸¸é‡Rcon[j],jè¡¨ç¤ºè½®æ•°ï¼Œ</p></li></ol><p>Rcon[j]æ˜¯ä¸€ä¸ªç»™å®šçš„4*jçš„è¡¨ã€‚</p><p>d3&#x3D;b3^c3^rj</p><p>å°±èƒ½å¾—åˆ°T(a[3])&#x3D;d3</p><h3 id="AESåŠ å¯†çš„ä¸åŒæ¨¡å¼"><a href="#AESåŠ å¯†çš„ä¸åŒæ¨¡å¼" class="headerlink" title="AESåŠ å¯†çš„ä¸åŒæ¨¡å¼"></a>AESåŠ å¯†çš„ä¸åŒæ¨¡å¼</h3><p>AESåŠ å¯†ç®—æ³•çš„æ¨¡å¼ä¸»è¦æœ‰äº”ç§,ä¸»è¦åŒºåˆ«åœ¨äºåŠ å¯†è¿‡ç¨‹ä¸­æ˜æ–‡å’Œå¯†æ–‡çš„å¤„ç†æ–¹å¼ä»¥åŠå®‰å…¨æ€§ç‰¹</p><p>1.ECBæ¨¡å¼</p><blockquote><ol><li>æ¯ä¸ªæ˜æ–‡å—è¢«ç‹¬ç«‹åŠ å¯†ï¼Œç›¸åŒçš„æ˜æ–‡å—å¾—åˆ°ç›¸åŒçš„å¯†æ–‡å—ã€‚</li><li>ä¸é€‚åˆåŠ å¯†å¤§é‡æ•°æ®æˆ–å…·æœ‰é‡å¤æ¨¡å¼çš„æ•°æ®ï¼Œå®¹æ˜“å—åˆ°æ”»å‡»ã€‚</li></ol></blockquote><ol start="2"><li>CBCæ¨¡å¼</li></ol><blockquote><ol><li><p>ä½¿ç”¨å‰ä¸€ä¸ªå¯†æ–‡å—å¯¹å½“å‰æ˜æ–‡å—è¿›è¡ŒåŠ å¯†ï¼Œå¢åŠ äº†éšæœºæ€§ï¼Œç›¸åŒçš„æ˜æ–‡å—åœ¨ä¸åŒä½ç½®å¾—åˆ°</p></li><li><p>éœ€è¦ä½¿ç”¨åˆå§‹åŒ–å‘é‡ï¼ˆIVï¼‰æ¥å¢åŠ å®‰å…¨æ€§ã€‚</p></li></ol></blockquote><ol start="3"><li>CFBæ¨¡å¼ã€‚</li></ol><blockquote><ul><li>ä½¿ç”¨å‰ä¸€ä¸ªå¯†æ–‡å—ä½œä¸ºè¾“å…¥ç”Ÿæˆä¼ªéšæœºå¯†é’¥æµä¸æ˜æ–‡è¿›è¡Œå¼‚æˆ–è¿ç®—å¾—åˆ°å¯†æ–‡ã€‚</li><li>å¯ä»¥æ”¯æŒå®æ—¶åŠ å¯†å’ŒæµåŠ å¯†ã€‚</li></ul></blockquote><ol start="4"><li>OFBæ¨¡å¼</li></ol><blockquote><ul><li>ç±»ä¼¼äºCFBï¼Œä½¿ç”¨å‰ä¸€ä¸ªå¯†æ–‡å—ç”Ÿæˆä¼ªéšæœºå¯†é’¥æµï¼Œç„¶åä¸æ˜æ–‡è¿›è¡Œå¼‚æˆ–è¿ç®—ã€‚</li><li>å¯¹åŠ å¯†å’Œè§£å¯†ä¸­çš„é”™è¯¯æ›´åŠ é²æ£’ï¼Œä½†ä¸æ”¯æŒéƒ¨åˆ†æ›´æ–°ã€‚</li></ul></blockquote><ol start="5"><li>CTRæ¨¡å¼</li></ol><blockquote><ul><li>ä½¿ç”¨ä¸€ä¸ªè®¡æ•°å™¨ä¸å¯†é’¥è¾“å…¥åŠ å¯†ç®—æ³•ç”Ÿæˆä¼ªéšæœºå¯†é’¥æµï¼Œä¸æ˜æ–‡è¿›è¡Œå¼‚æˆ–è¿ç®—ã€‚</li><li>å¯ä»¥å¹¶è¡ŒåŠ å¯†å’Œè§£å¯†ï¼Œé€‚ç”¨äºéœ€è¦é«˜æ•ˆåŠ å¯†çš„åœºæ™¯ã€‚</li></ul></blockquote><h3 id="ä»£ç ç¤ºä¾‹"><a href="#ä»£ç ç¤ºä¾‹" class="headerlink" title="ä»£ç ç¤ºä¾‹"></a>ä»£ç ç¤ºä¾‹</h3><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">import copy<br>def <span class="hljs-keyword">mul</span>(poly1, poly2):   # ä¸¤ä¸ªå¤šé¡¹å¼ç›¸ä¹˜<br>result = <span class="hljs-number">0</span><br>for index <span class="hljs-keyword">in</span> range(poly2<span class="hljs-number">.</span>bit_length()):<br>if poly2 &amp; (<span class="hljs-number">1</span> &lt;&lt; index):<br>result ^= (poly1 &lt;&lt; index)<br>return result<br><br>def mod(poly, mod = <span class="hljs-number">0b100011011</span>):    # å¤šé¡¹å¼polyæ¨¡å¤šé¡¹å¼<span class="hljs-number">100011011</span><br>while poly<span class="hljs-number">.</span>bit_length() &gt; <span class="hljs-number">8</span>:<br>poly ^= (mod &lt;&lt; (poly<span class="hljs-number">.</span>bit_length() - <span class="hljs-number">9</span>))<br>return poly<br><br>def substitute(m_hex, inverse=False):<br>    m_s = []<br>    box = s_box if <span class="hljs-keyword">not</span> inverse else i_s_box<br>    for i <span class="hljs-keyword">in</span> m_hex:<br>        x, y = <span class="hljs-keyword">int</span>(i, <span class="hljs-number">16</span>) // <span class="hljs-number">16</span>, <span class="hljs-keyword">int</span>(i, <span class="hljs-number">16</span>) % <span class="hljs-number">16</span><br>        temp = hex(box[x*<span class="hljs-number">16</span>+y])<br>        m_s<span class="hljs-number">.</span>append(temp)<br>    return m_s<br><br>s_box =   [<span class="hljs-number">0x63</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x16</span>]<br>i_s_box = [<span class="hljs-number">0x52</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x7D</span>]<br>rcon = [<span class="hljs-number">0x1</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x4</span>, <span class="hljs-number">0x8</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x36</span>]<br>mix_column_matrix   = [<span class="hljs-number">0x2</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x2</span>] # åˆ—æ··åˆä¹˜çš„çŸ©é˜µ<br>i_mix_column_matrix = [<span class="hljs-number">0xe</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0xd</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xe</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0xd</span>, <span class="hljs-number">0xd</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xe</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0xd</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xe</span>] # åˆ—æ··åˆä¹˜çš„é€†çŸ©é˜µ<br>def gen_key(key):<br>    key_hex = get_hex(key)<br>    key_rotate = []<br>    w = [[] for i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">44</span>)]<br>    for i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>):<br>        w[i // <span class="hljs-number">4</span>].append(key_hex[i])<br>    for i <span class="hljs-keyword">in</span> range(<span class="hljs-number">4</span>, <span class="hljs-number">44</span>):<br>        gw = copy<span class="hljs-number">.</span>deepcopy(w[i - <span class="hljs-number">1</span>])<br>        if i % <span class="hljs-number">4</span> == <span class="hljs-number">0</span>:<br>            gw[<span class="hljs-number">0</span>], gw[<span class="hljs-number">1</span>], gw[<span class="hljs-number">2</span>], gw[<span class="hljs-number">3</span>] = gw[<span class="hljs-number">1</span>], gw[<span class="hljs-number">2</span>], gw[<span class="hljs-number">3</span>], gw[<span class="hljs-number">0</span>]<br>            gw = substitute(gw) #g(w(i-<span class="hljs-number">1</span>))<br>            gw[<span class="hljs-number">0</span>] = hex(<span class="hljs-keyword">int</span>(gw[<span class="hljs-number">0</span>], <span class="hljs-number">16</span>) ^ rcon[i // <span class="hljs-number">4</span> - <span class="hljs-number">1</span>]) #pptä¸Šè¯´çš„<span class="hljs-number">2</span>^(i-<span class="hljs-number">4</span>)/<span class="hljs-number">4</span>æœ‰è¯¯ï¼Œçœ‹ä¹¦p84<br>        for j <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>):<br>            w[i].append(hex(<span class="hljs-keyword">int</span>(gw[j], <span class="hljs-number">16</span>) ^ <span class="hljs-keyword">int</span>(w[i-<span class="hljs-number">4</span>][j], <span class="hljs-number">16</span>)))<br>    key_rotate = [w[i * <span class="hljs-number">4</span>] + w[i * <span class="hljs-number">4</span> + <span class="hljs-number">1</span>] + w[i * <span class="hljs-number">4</span> + <span class="hljs-number">2</span>] + w[ i* <span class="hljs-number">4</span> + <span class="hljs-number">3</span>] for i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">11</span>)] # è½®å¯†é’¥åˆ—è¡¨,æ¯ä¸ªå…ƒç´ éƒ½æ˜¯æœ‰<span class="hljs-number">16</span>ä¸ªå­—èŠ‚çš„åˆ—è¡¨<br>    return key_rotate<br><br>def <span class="hljs-keyword">xor</span>(a, key): #aå’Œkeyéƒ½æ˜¯åˆ—è¡¨ï¼Œéƒ½å­˜äº†<span class="hljs-number">16</span>å­—èŠ‚<br>    return [hex(<span class="hljs-keyword">int</span>(a[i], <span class="hljs-number">16</span>) ^ <span class="hljs-keyword">int</span>(key[i], <span class="hljs-number">16</span>)) for i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>)]<br><br>def get_hex(s): #å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²çš„åå…­è¿›åˆ¶å€¼ï¼Œä»¥åˆ—è¡¨å½¢å¼è¿”å›<br>    return [hex(ord(i)) for i <span class="hljs-keyword">in</span> s]<br><br>def shiftrows(a, inverse=False): #inverseä¸ºTrueæ—¶è¡¨ç¤ºä¸ºé€†æ“ä½œï¼Œé»˜è®¤ä¸ºFalse<br>    return [ a[<span class="hljs-number">0</span>], a[<span class="hljs-number">5</span>], a[<span class="hljs-number">10</span>], a[<span class="hljs-number">15</span>], a[<span class="hljs-number">4</span>], a[<span class="hljs-number">9</span>], a[<span class="hljs-number">14</span>], a[<span class="hljs-number">3</span>], a[<span class="hljs-number">8</span>], a[<span class="hljs-number">13</span>], a[<span class="hljs-number">2</span>], a[<span class="hljs-number">7</span>], a[<span class="hljs-number">12</span>], a[<span class="hljs-number">1</span>], a[<span class="hljs-number">6</span>], a[<span class="hljs-number">11</span>] ] if <span class="hljs-keyword">not</span> inverse else [ a[<span class="hljs-number">0</span>], a[<span class="hljs-number">13</span>], a[<span class="hljs-number">10</span>], a[<span class="hljs-number">7</span>], a[<span class="hljs-number">4</span>], a[<span class="hljs-number">1</span>], a[<span class="hljs-number">14</span>], a[<span class="hljs-number">11</span>], a[<span class="hljs-number">8</span>], a[<span class="hljs-number">5</span>], a[<span class="hljs-number">2</span>], a[<span class="hljs-number">15</span>], a[<span class="hljs-number">12</span>], a[<span class="hljs-number">9</span>], a[<span class="hljs-number">6</span>], a[<span class="hljs-number">3</span>] ]<br><br>def mixcolumn(m_row, inverse=False):<br>    matrix = mix_column_matrix if <span class="hljs-keyword">not</span> inverse else i_mix_column_matrix<br>    m_col = []<br>    for i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>):<br>        x, y = i % <span class="hljs-number">4</span>, i // <span class="hljs-number">4</span><br>        result = <span class="hljs-number">0</span><br>        for j <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>):<br>            result ^= (<span class="hljs-keyword">mul</span>(matrix[x * <span class="hljs-number">4</span> + j], <span class="hljs-keyword">int</span>(m_row[y * <span class="hljs-number">4</span> + j], <span class="hljs-number">16</span>)))<br>        result = mod(result)<br>        m_col<span class="hljs-number">.</span>append(hex(result))<br>    return m_col<br><br>def aes_encrypt(m, key_rotate):<br>    m_hex = get_hex(m) #å¾—åˆ°æ˜æ–‡çš„hexåˆ—è¡¨<br>    m_xor = <span class="hljs-keyword">xor</span>(m_hex, key_rotate[<span class="hljs-number">0</span>]) #å°†æ˜æ–‡åˆå§‹<span class="hljs-keyword">xor</span>å¯†é’¥ w0 w1 w2 w3<br>    for rotate <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>, <span class="hljs-number">11</span>): #åè½®<br>        m_s = substitute(m_xor) # å­—èŠ‚ä»£æ›¿<br>        m_row = shiftrows(m_s)<br>        m_col = m_row #åˆ—æ··åˆ<br>        if rotate != <span class="hljs-number">10</span>: #æœ€åä¸€è½®ä¸ç”¨åˆ—æ··åˆ<br>            m_col = mixcolumn(m_row)<br>        m_xor = <span class="hljs-keyword">xor</span>(m_col, key_rotate[rotate])<br>    ciphertext = <span class="hljs-string">&quot;&quot;</span> #è¾“å‡ºçš„å¯†æ–‡ä¸ºæ¯ä¸ªåå…­è¿›åˆ¶å­—ç¬¦çš„è”ç»“ï¼Œç±»ä¼¼e365e09962d634a8fbfe8359c57b22c5ã€‚ä¸€å…±<span class="hljs-number">32</span>ä¸ªï¼Œæ¯ä¸¤ä¸ªå­—æ¯å¯¹åº”äº†ä¸€ä¸ªå­—èŠ‚çš„åå…­è¿›åˆ¶ã€‚<span class="hljs-number">16</span>ä¸ªè¿›åˆ¶ï¼Œ<span class="hljs-number">128</span>ä½ã€‚<br>    for i <span class="hljs-keyword">in</span> m_xor:<br>        ciphertext += (i[<span class="hljs-number">2</span>:] if len(i[<span class="hljs-number">2</span>:]) == <span class="hljs-number">2</span> else <span class="hljs-string">&quot;0&quot;</span> + i[<span class="hljs-number">2</span>:]) #å¯¹ç±»ä¼¼<span class="hljs-number">0xf</span>çš„åå…­è¿›åˆ¶æ ¼å¼åŒ–ä¸º<span class="hljs-number">0x0f</span><br>    return ciphertext<br><br>def aes_decrypt(c, key_rotate):<br>    c_hex = [<span class="hljs-string">&#x27;0x&#x27;</span> + c[i * <span class="hljs-number">2</span>] + c[i * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>] for i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>)] #å°†å¯†æ–‡æ¢å¤ä¸ºåˆ—è¡¨<br>    c_xor = <span class="hljs-keyword">xor</span>(c_hex, key_rotate[<span class="hljs-number">10</span>])<br>    c_row = shiftrows(c_xor, inverse=True)<br>    c_s = substitute(c_row, inverse=True)<br>    for rotate <span class="hljs-keyword">in</span> range(<span class="hljs-number">9</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>): #å¾ªç¯<span class="hljs-number">9</span>æ¬¡<br>        c_xor = <span class="hljs-keyword">xor</span>(c_s, key_rotate[rotate])<br>        c_col = mixcolumn(c_xor, inverse=True)<br>        c_row = shiftrows(c_col, inverse=True)<br>        c_s = substitute(c_row, inverse=True)<br>    plaintext = <span class="hljs-string">&quot;&quot;</span><br>    for i <span class="hljs-keyword">in</span> <span class="hljs-keyword">xor</span>(c_s, key_rotate[<span class="hljs-number">0</span>]): #å°†æ˜æ–‡çš„hexåˆ—è¡¨è½¬åŒ–ä¸ºå­—æ¯<br>        plaintext += chr(<span class="hljs-keyword">int</span>(i, <span class="hljs-number">16</span>))<br>    return plaintext<br># åŸå§‹æ˜æ–‡å’Œå¯†é’¥<br>m = <span class="hljs-string">&quot;1234567890abcdef&quot;</span><br>key = <span class="hljs-string">&quot;1234567890abcdef&quot;</span><br><br># ç”Ÿæˆè½®å¯†é’¥<br>key_rotate = gen_key(key)<br><br># åŠ å¯†<br>ciphertext = aes_encrypt(m, key_rotate)<br>print(<span class="hljs-string">&quot;Ciphertext:&quot;</span>, ciphertext)<br><br># è§£å¯†<br>plaintext = aes_decrypt(ciphertext, key_rotate)<br>print(<span class="hljs-string">&quot;Decrypted text:&quot;</span>, plaintext)<br><br></code></pre></td></tr></table></figure><h3 id="ä¸€é“é¢˜"><a href="#ä¸€é“é¢˜" class="headerlink" title="ä¸€é“é¢˜"></a>ä¸€é“é¢˜</h3><h3 id="Knuckle-Buster"><a href="#Knuckle-Buster" class="headerlink" title="Knuckle Buster"></a>Knuckle Buster</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">åœ¨è¿™ä¸ªæŒ‘æˆ˜ä¸­ï¼Œä¸¤ä¸ªäºº Alice å’Œ Bob æ­£åœ¨ç§˜å¯†äº¤æµã€‚ä»–ä»¬ä½¿ç”¨ Diffie-Hellman å¯†é’¥äº¤æ¢åè®®æ¥ä¿æŠ¤ä»–ä»¬çš„é€šä¿¡ã€‚æˆ‘å°†ä¸ºæ‚¨æä¾›è¶³å¤Ÿçš„ä¿¡æ¯æ¥è§£å¯†ä»–ä»¬ä¹‹é—´æˆªè·çš„æ¶ˆæ¯ã€‚æ‚¨éœ€è¦åšçš„å°±æ˜¯è®¡ç®—å…±äº«å¯†é’¥å¹¶å¯¹å…¶è¿›è¡Œè§£å¯†ä»¥è·å–æ ‡å¿—ã€‚<br><br>è¿™æ˜¯åŠ å¯†çš„æ ‡å¿—ã€‚å®ƒä½¿ç”¨ AES-256-CBC åŠ å¯†ï¼Œå…¶ä¸­ SHA-256 ç”¨äºå¯†é’¥æ´¾ç”Ÿï¼Œå¹¶é¢„ç½®äº† 16 å­—èŠ‚ IVã€‚<br><br>publicA<br>-----BEGIN PUBLIC KEY-----<br>MIGaMFMGCSqGSIb3DQEDATBGAkEAiBB/FlC3W8aPLJxYGXzKsnpEmPKIKR4JetlA1ky+TKTYofXUKSFucGxtrmWlVFjnLZUqJFjj0bVDKSiYOfod1wIBAgNDAAJAN3YrjXtIssyugO9tQ3BRy2TN92Qkhkp/VP5zfLEMQg1AE/YofkCIc/KSZOBpuroiQoCK0qTNkD4HzCzDa7ap5Q==<br><span class="hljs-section">-----END PUBLIC KEY</span><br><span class="hljs-section">-----</span><br>privateB<br>-----BEGIN PRIVATE KEY<br>-----MIGcAgEAMFMGCSqGSIb3DQEDATBGAkEAiBB/FlC3W8aPLJxYGXzKsnpEmPKIKR4JetlA1ky<span class="hljs-code">+TKTYofXUKSFucGxtrmWlVFjnLZUqJFjj0bVDKSiYOfod1wIBAgRCAkBSsgvp3xivPK6Wp2X+</span>SIjGllg1MT4zJdEoyUjV6iDLGytdeLpokYOO6xss GIiVb8b6A/5onnopra2iXBb0dS5rn<br><span class="hljs-section">-----END PRIVATE KEY</span><br><span class="hljs-section">-----</span><br>dhparam<br>-----BEGIN DH å‚æ•°-----<br>MEYCQQCIEH8WULdbxo8snFgZfMqyekSY8ogpHgl62UDWTL5MpNih9dQpIW5wbG2uZaVUWOctlSokWOPRtUMpKJg5+h3XAgEC<br><span class="hljs-section">-----END DH å‚æ•°</span><br><span class="hljs-section">-----</span><br></code></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªåŸºç¡€çš„AES-CBCåŠ å¯†çš„DHå¯†é’¥åå•†é€šä¿¡ã€‚</p><p>æ•´æ•°Aï¼Œbå’Œdhpraram&#x3D;påˆ†åˆ«ä»£è¡¨äº†ä¸åŒçš„å†…å®¹ã€‚</p><p>Pä»£è¡¨äº†DHä¸­çš„é‚£ä¸ªå¤§ç´ æ•°</p><p>åå•†å¯†é’¥s&#x3D;A^b^ modpã€‚æˆ‘ä»¬å¯ä»¥ç”¨pythonåº“æˆ–è€…åœ¨çº¿ç½‘ç«™æå–è¯ä¹¦å†…å®¹ï¼Œæˆ‘è¿™é‡Œç›´æ¥ç”¨åœ¨çº¿ç½‘ç«™æå–ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> Crypto.Util.number import long_to_bytes<br><span class="hljs-keyword">from</span> nacl.hash import sha256<br><br><span class="hljs-attribute">A</span>=2904759796559791913432271862881153382405066619449245072640765589088056204557610156688164735437813811038059974077392278848266560053756599200768336365791717<br><br><span class="hljs-attribute">b</span>=4331114469004424101417452893702925534425506579657643668189751982919697469877978008431455296821274876511281317445036625437218508812066778389432224377969383<br><br><span class="hljs-attribute">P</span>=7126272917341517371021493195431918906260195973018916295547365059382419902222692924409321274266211448465008202837786841249505239162738008847348464904445399<br><span class="hljs-attribute">s</span>=pow(A,b,P)<br><span class="hljs-attribute">key</span>=sha256(long_to_bytes(s))<br>with open(<span class="hljs-string">&quot;C:\\Users\\24055\OneDrive\æ–‡æ¡£\Crypto200-1_flag.txt (1).enc&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>) as f:<br>    <span class="hljs-attribute">iv</span>=f.read(16)<br>    <span class="hljs-attribute">cipher</span>=f.read()<br><span class="hljs-attribute">cipher1</span>=cipher.hex()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;IV:&quot;</span>,iv.hex())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Cipher1:&quot;</span>,cipher1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Key:&quot;</span>,key)#ä¹‹åå¯ä»¥æ‹¿åˆ°åœ¨çº¿ç½‘ç«™è§£å¯†å³å¯<br><span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">IV: fe942f31b9579db8905e4202793cd70e</span><br><span class="hljs-string">Cipher1: c206bd30b9339b208876fa125faac03f461db5cd6cf87ddf232ba7ff118d0d25</span><br><span class="hljs-string">Key: b&#x27;</span>bb7d44a422b90bb2b585c1639e46a7a7dff2cca315f564450694295d187b85d8<span class="hljs-string">&#x27;</span><br><span class="hljs-string">&#x27;</span><span class="hljs-string">&#x27;&#x27;</span><br>flag: poctf&#123;uwsp_f1r3_4nd_br1m570n3&#125;<br></code></pre></td></tr></table></figure><h3 id="SU-rsa"><a href="#SU-rsa" class="headerlink" title="SU_rsa"></a>SU_rsa</h3><p>åº”è¯¥ç®—æ˜¯æ¯”è¾ƒå®¹æ˜“åˆ†æçš„ç®€å•rsa</p><p>ç”±äºç»™çš„æ˜¯dçš„é«˜ä½ï¼Œç›´æ¥å¯ä»¥ç”¨å¾—åˆ°k(è¿™ç®—æ˜¯ä¸€ç§æ•´é™¤ï¼Œå½“æ—¶ç¡®å®æ²¡æƒ³åˆ°è¿™ç§æ–¹æ³•ï¼Œå› ä¸ºnå’Œp,q,kå·®å€¼è¿‡å¤§æ‰€ä»¥kå¯ä»¥åˆ©ç”¨æ•´é™¤æ±‚å‡ºæ¥)<br>$$<br>k&#x3D;(e<em>d_m-1)&#x2F;&#x2F;n + 1<br>$$<br>ç”±æ ‡å‡†å…³ç³»å¾—åˆ°<br>$$<br>k</em>(n-p-q+1)+1&#x3D;&#x3D;e*d\<br>(p+q) &#x3D;(n+1+k^{-1})\mod e<br>$$<br>ç›¸å½“äºç»™å‡ºäº†p%eæˆ–è€…q%eçš„å€¼ï¼Œeä¸º256bitsï¼Œæ˜¾ç„¶small_rootsæ±‚è§£ä¸€ä¸‹å°±è¡Œã€‚ </p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œç”±äºå–çš„ä½ä½æ¯”è¾ƒå°ï¼Œå·²çŸ¥ä¿¡æ¯æ¯”è¾ƒå°‘ï¼Œéœ€è¦çˆ†ç ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>d_m =  <span class="hljs-number">54846367460362174332079522877510670032871200032162046677317492493462931044216323394426650814743565762481796045534803612751698364585822047676578654787832771646295054609274740117061370718708622855577527177104905114099420613343527343145928755498638387667064228376160623881856439218281811203793522182599504560128</span><br>n =  <span class="hljs-number">102371500687797342407596664857291734254917985018214775746292433509077140372871717687125679767929573899320192533126974567980143105445007878861163511159294802350697707435107548927953839625147773016776671583898492755338444338394630801056367836711191009369960379855825277626760709076218114602209903833128735441623</span><br>e =  <span class="hljs-number">112238903025225752449505695131644979150784442753977451850362059850426421356123</span><br>k = (e*d_m-<span class="hljs-number">1</span>)//n + <span class="hljs-number">1</span><br>s = (n+<span class="hljs-number">1</span>+inverse_mod(k, e))%e<br>PR.&lt;x&gt; = PolynomialRing(Zmod(e))<br>f = x^<span class="hljs-number">2</span>-s*x+n<br>p0 = <span class="hljs-built_in">int</span>(f.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(p0)<br><span class="hljs-keyword">import</span> multiprocessing<br><span class="hljs-keyword">import</span> tqdm<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">copper_attack</span>(<span class="hljs-params">i</span>):<br>    PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>    f = e*(<span class="hljs-number">2</span>^<span class="hljs-number">12</span>*x + i) + p0<br>    f = f.monic()<br>    res = f.small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">244</span>, beta=<span class="hljs-number">0.499</span>, epsilon=<span class="hljs-number">0.02</span>)<br>    <span class="hljs-keyword">if</span>(res != []):<br>        t = <span class="hljs-built_in">int</span>(res[<span class="hljs-number">0</span>])<br>        p = e*(<span class="hljs-number">2</span>^<span class="hljs-number">12</span>*t + i) + p0<br>        q = n // p<br>        <span class="hljs-keyword">assert</span> p * q == n <span class="hljs-keyword">and</span> isPrime(p) <span class="hljs-keyword">and</span> isPrime(q)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">b&#x27;SUCTF&#123;&#x27;</span>,sha256(<span class="hljs-built_in">str</span>(p).encode()).hexdigest()[:<span class="hljs-number">32</span>],<span class="hljs-string">b&#x27;&#125;&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">b&#x27;SUCTF&#123;&#x27;</span>,sha256(<span class="hljs-built_in">str</span>(q).encode()).hexdigest()[:<span class="hljs-number">32</span>],<span class="hljs-string">b&#x27;&#125;&#x27;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-keyword">with</span> multiprocessing.Pool(processes=<span class="hljs-number">16</span>) <span class="hljs-keyword">as</span> pool:<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> tqdm.tqdm(pool.imap(copper_attack, <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>^<span class="hljs-number">12</span>)), total=<span class="hljs-built_in">int</span>(<span class="hljs-number">2</span>^<span class="hljs-number">12</span>)):<br>        <span class="hljs-keyword">if</span>(_):<br>            <span class="hljs-keyword">break</span><span class="hljs-comment">#å¤šçº¿ç¨‹</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>python</category>
      
      <category>crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
      <tag>python</tag>
      
      <tag>algorithm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DHå¯†é’¥äº¤æ¢åè®®</title>
    <link href="/2024/12/23/DH%20%E5%AF%86%E9%92%A5%E4%BA%A4%E6%8D%A2%E5%8D%8F%E8%AE%AE/"/>
    <url>/2024/12/23/DH%20%E5%AF%86%E9%92%A5%E4%BA%A4%E6%8D%A2%E5%8D%8F%E8%AE%AE/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="DH-å¯†é’¥äº¤æ¢åè®®"><a href="#DH-å¯†é’¥äº¤æ¢åè®®" class="headerlink" title="DH å¯†é’¥äº¤æ¢åè®®"></a>DH å¯†é’¥äº¤æ¢åè®®</h1><p>åœ¨åŸºäº<a href="https://zhida.zhihu.com/search?content_id=221358888&content_type=Article&match_order=1&q=%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86&zhida_source=entity">å¯¹ç§°åŠ å¯†</a>è¿›è¡Œå®‰å…¨é€šä¿¡çš„è¿‡ç¨‹ä¸­ï¼Œé€šä¿¡åŒæ–¹éœ€è¦æŒæœ‰ä¸€ä¸ªå…±äº«çš„å¯†é’¥ã€‚åªæœ‰è¿™æ ·ï¼Œç”±ä»»ä½•ä¸€æ–¹åŠ å¯†çš„ä¿¡æ¯æ‰èƒ½ç”±å¦ä¸€æ–¹ä½¿ç”¨ç›¸åŒçš„å¯†é’¥è§£å¯†ã€‚ä½†æ˜¯<strong>åœ¨èƒ½å¤Ÿå®‰å…¨çš„é€šä¿¡ä¹‹å‰ï¼Œé€šä¿¡åŒæ–¹åº”è¯¥å¦‚ä½•çº¦å®šä¸€ä¸ªå…±äº«çš„å¯†é’¥å‘¢ï¼Ÿè¿™å°±æ˜¯å®‰å…¨ä¸­çš„ç»å…¸é—®é¢˜ï¼šå¯†é’¥é…é€é—®é¢˜ï¼ˆKey Distribution Problem</strong>[<a href="https://zhuanlan.zhihu.com/p/599518034#ref_1">1]</a><strong>ï¼‰</strong>ã€‚</p><p>Diffe-Hellmanå¯†é’¥äº¤æ¢åè®®åªæ˜¯å…¶ä¸­ä¸€ç§çº¦å®šåŠŸèƒ½å…±äº«å¯†é’¥çš„æ–¹å¼ï¼Œ</p><h2 id="DHKEåè®®ç®€ä»‹"><a href="#DHKEåè®®ç®€ä»‹" class="headerlink" title="DHKEåè®®ç®€ä»‹"></a>DHKEåè®®ç®€ä»‹</h2><p><strong>DHKEæ˜¯ä¸€ç§é€šè¿‡å…¬å…±é€šé“å®‰å…¨åœ°äº¤æ¢åŠ å¯†å¯†é’¥çš„æ•°å­¦æ–¹æ³•ï¼Œä»¥Whitfield Diffi</strong>eå’ŒMartin Hellmançš„åå­—å‘½åã€‚</p><h2 id="æ•°å­¦åŸç†"><a href="#æ•°å­¦åŸç†" class="headerlink" title="æ•°å­¦åŸç†"></a>æ•°å­¦åŸç†</h2><blockquote><p>$c&#x3D;G^e mod P(0&lt;&#x3D;c&lt;P)$</p><p>Gæ˜¯Pçš„åŸæ ¹ï¼Œæ»¡è¶³æ¡ä»¶</p><p>{g1modp,g2modp,g3modp,â€¦,gpâˆ’1modp}&#x3D;{1,2,3,â€¦,pâˆ’1}</p></blockquote><h2 id="DHKEåè®®çš„è¿‡ç¨‹"><a href="#DHKEåè®®çš„è¿‡ç¨‹" class="headerlink" title="DHKEåè®®çš„è¿‡ç¨‹"></a>DHKEåè®®çš„è¿‡ç¨‹</h2><p><img src="https://rockfox0.github.io/picx-images-hosting/v2-39cb492c048f5f2a643368c135626925_1440w.175g9ciqha.webp"></p><ol><li><p>å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ç”Ÿæˆåå•†å¤§ç´ æ•°PåŠå…¶åŸæ ¹G</p></li><li><p>å®¢æˆ·ç«¯ç”Ÿæˆç§é’¥å’Œå…¬é’¥aå’ŒA</p><blockquote><p>A&#x3D;G<sup>a</sup> mod p</p></blockquote></li><li><p>å°†å…¬é’¥Aå‘é€ç»™æœåŠ¡ç«¯</p></li><li><p>æœåŠ¡ç«¯ç”Ÿæˆç§é’¥bå’Œå…¬é’¥B</p></li></ol><blockquote><p>$B&#x3D;G^b mod P$</p></blockquote><ol><li><p>æœåŠ¡ç«¯å°†å…¬é’¥Bå‘é€ç»™å®¢æˆ·ç«¯</p></li><li><p>å®¢æˆ·ç«¯å·²çŸ¥G,P,A,a,Bè®¡ç®—å¯†é’¥S1</p></li><li><blockquote><p>$S1&#x3D;B^a mod P$ </p></blockquote></li><li><p>æœåŠ¡ç«¯å·²çŸ¥A B b G Pè®¡ç®—å…±äº«å¯†é’¥</p></li></ol><blockquote><p>$S2&#x3D;A^b mod p$</p></blockquote><ol start="9"><li>å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å…±äº«å¯†é’¥S</li></ol><blockquote><p>$S&#x3D;S1&#x3D;B^a mod P&#x3D;(G^b) mod p&#x3D;A^b mod P&#x3D;S2$</p></blockquote><p>å¯ä»¥çŸ¥é“å…±äº«å¯†é’¥çš„åŸç†ï¼Œ</p>]]></content>
    
    
    <categories>
      
      <category>crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
      <tag>Hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ ¼å¯†ç </title>
    <link href="/2024/12/23/%E6%A0%BC%E6%A0%BC%E6%A0%BC%E5%AF%86%E7%A0%81/"/>
    <url>/2024/12/23/%E6%A0%BC%E6%A0%BC%E6%A0%BC%E5%AF%86%E7%A0%81/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="LLLç®—æ³•"><a href="#LLLç®—æ³•" class="headerlink" title="LLLç®—æ³•"></a>LLLç®—æ³•</h1><ol><li>ç®€ä»‹ï¼šLLLç®—æ³•ç”¨äºè§£å†³æœ€çŸ­å‘é‡é—®é¢˜çš„å¤šé¡¹å¼æ—¶é—´å¤æ‚åº¦ç®—æ³•ã€‚</li></ol><h2 id="LLLç®—æ³•è§£é‡Š"><a href="#LLLç®—æ³•è§£é‡Š" class="headerlink" title="LLLç®—æ³•è§£é‡Š"></a>LLLç®—æ³•è§£é‡Š</h2><h2 id="å¯¹æ ¼çš„è®¤è¯†"><a href="#å¯¹æ ¼çš„è®¤è¯†" class="headerlink" title="å¯¹æ ¼çš„è®¤è¯†"></a>å¯¹æ ¼çš„è®¤è¯†</h2><p><img src="https://github.com/rockfox0/picx-images-hosting/raw/master/0368780808a7e1b750e955cf6b101d73.2yyf2pk3ws.webp" alt="0368780808a7e1b750e955cf6b101d73"></p><p>ä¸åŒçš„åŸºä¹Ÿå¯ä»¥ç”ŸæˆåŒä¸€ä¸ªæ ¼ã€‚</p><p>ä¾‹å¦‚ä¸€ä¸ªåŸºå‘é‡æ˜¯ï¼ˆ1,0)å’Œï¼ˆ0ï¼Œ1ï¼‰æ„æˆçš„æ ¼ã€‚è¯¥æ ¼ç”¨æ•°å­¦ç¬¦å·è¡¨ç¤ºã€‚</p><p><img src="https://github.com/rockfox0/picx-images-hosting/raw/master/846d4e43f4e7cc31174f75c9970be401.5xap69j4x6.webp"></p><p><img src="https://www.helloimg.com/i/2024/12/17/6760eb205ecb2.png"></p><p>æ ¼çš„ç»´æ•°:å³å‘é‡çš„ä¸ªæ•°ï¼Œä¸Šè¿°è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªäºŒç»´çš„æ ¼ã€‚</p><p>ç„¶åæ ¹æ®ç³»æ•°açš„ä¸åŒå°±èƒ½å¾—åˆ°ä¸åŒçš„Lé›†åˆã€‚</p><p>å‡å®šç°åœ¨v1,v2,v3â€¦vn(ç§°ä¸ºå¼ ç©ºé—´) æ˜¯æ ¼Lçš„åŸºï¼Œè®©å­˜åœ¨ä¸åŒä¸ªé›†åˆå±äºL å³w1 w2 â€¦,wmã€‚</p><p><img src="https://github.com/rockfox0/picx-images-hosting/raw/master/846d4e43f4e7cc31174f75c9970be401.99tf0nbkwz.webp" alt="img"></p><p>å¯ä»¥è½¬åŒ–ä½çŸ©é˜µè¿ç®—ã€‚</p><p>AV&#x3D;W</p><blockquote><p>çº¿æ€§æ— å…³ï¼ˆlinearly independenceï¼‰v1 , v2 , â€¦ , vnçº¿æ€§æ— å…³ï¼Œå½“ä¸”ä»…å½“æ–¹ç¨‹a1v1+â€¦+anvn&#x3D;0çš„å”¯ä¸€è§£æ˜¯aå…¨éƒ¨ä¸º0ï¼›å¦åˆ™çº¿æ€§ç›¸å…³ï¼ˆlinearly dependentï¼‰</p><p>æ­£äº¤åŸºï¼ˆorthogonal basisï¼‰v1 , v2 , â€¦ , vn ä¸­ä»»æ„ä¸åŒçš„ä¸¤ä¸ªvç‚¹ç§¯çš„ç»“æœä¸º0</p><p>è§„èŒƒæ­£äº¤ï¼ˆorthonormalï¼‰ ä¸Šé¢çš„æ¯ä¸€ä¸ªvçš„**æ¬§å‡ é‡Œå¾—èŒƒæ•°(ç±»ä¼¼äºæ¨¡ é•¿åº¦)**ä¸º1</p><p>æ®æ­¤åœ¨ä¸Šé¢çš„wçš„||w||2 &#x3D; æ‰€æœ‰ç³»æ•°açš„å¹³æ–¹å’Œ</p></blockquote><p>A(è½¬ç½®)&#x3D;(a1,a2â€¦,an) V&#x3D;(v1,v2â€¦,vn) w&#x3D;(w1,w2..,wn)</p><p>AV&#x3D;W;</p><p>ç¤ºä¾‹ä¸€ä¸ªæœ‰å…³å‘é‡çš„é—®é¢˜</p><p>é€‰å®šåŸºå‘é‡ç”Ÿæˆæ ¼L:</p><p><img src="https://rockfox0.github.io/picx-images-hosting/eaba6027147f175e55cc60cb4c6b0e6c.1lbw05nx6x.webp"></p><p>åŒ–ä½œè¡ŒçŸ©é˜µ<img src="https://rockfox0.github.io/picx-images-hosting/d333e18fcc3fa9fcd7c7939bdc22f328.7ax8bqja7e.webp"></p><p>å°†è®¾Lçš„æŸå‘é‡ç»„ï¼š</p><p><img src="https://rockfox0.github.io/picx-images-hosting/ecdebf47b0420ef33e2e6ff92c32262d.39l8xcg9ch.webp"></p><p>å…¶ç³»æ•°aå½¢æˆå‘é‡ç»„U&#x3D;</p><p><img src="https://rockfox0.github.io/picx-images-hosting/a5f5017c9499507f3eca6345e218dec0.8s3ddhost5.webp"></p><p>W(è½¬ç½®)&#x3D;ï¼ˆw1,w2,w3).</p><p>W&#x3D;A*U</p><p>æ“ä½œä»£ç </p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-id">#sage</span><br>v1 = <span class="hljs-selector-attr">[2, 1, 3]</span><br>v2 = <span class="hljs-selector-attr">[1, 2, 0]</span><br>v3 = <span class="hljs-selector-attr">[2, -3, -5]</span><br><br>A= <span class="hljs-built_in">matrix</span>(<span class="hljs-selector-attr">[v1, v2, v3]</span>)<br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(A)</span></span><br>U=<span class="hljs-built_in">matrix</span>(<span class="hljs-selector-attr">[[1, 0, 1]</span>, <span class="hljs-selector-attr">[1, -1, 2]</span>, <span class="hljs-selector-attr">[1, 2, 0]</span>])<br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(U)</span></span><br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(U.det()</span></span>)<br>W=A*U<br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(W)</span></span><br>int_U=U<span class="hljs-selector-class">.inverse</span>()#æ±‚çŸ©é˜µçš„é€†<br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-string">&quot;.............&quot;</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(int_U)</span></span><br>assert int_U*W==A<br></code></pre></td></tr></table></figure><p>SVP(æœ€çŸ­å‘é‡é—®é¢˜)</p><p>ä¸€ä¸ªæ ¼ä¼šæœ‰æ— æ•°å¤šä¸ªå‘é‡é›†åˆv</p><p>æœ€çŸ­å‘é‡é—®é¢˜ï¼ŒæŒ‡çš„æ ¼Lä¸­æœ€çŸ­çš„éé›¶å‘é‡ï¼Œå³å¯»æ‰¾ä¸€ä¸ªvæ»¡è¶³<em><strong>æ¬§å‡ é‡Œå¾—èŒƒæ•°</strong></em>æœ€å°ï¼ˆæŒ‡çš„è¯¥é›†åˆæ¯ä¸€ä¸ªå…ƒç´ çš„å¹³æ–¹å’Œå†å¼€å¹³æ–¹ï¼Œç±»ä¼¼äºæ¨¡çš„é•¿åº¦ï¼‰èŒƒæ•°å°±æ˜¯é•¿åº¦ã€‚</p><blockquote><ol><li>åŸºï¼š</li></ol><p>åœ¨å‘é‡ç©ºé—´çš„æ¯ä¸€ä¸ªç‚¹ï¼Œéƒ½å¯ä»¥é€šè¿‡å¯¹åŸºçš„çº¿æ€§ç»„åˆå˜åŒ–å¾—åˆ°ï¼Œå«åšåŸºå‘é‡</p><p>ä¸€ä¸ªæ ¼å¯èƒ½ä¼šæœ‰å¾ˆå¤šä¸ªåŸº ä¸å”¯ä¸€</p><ol start="2"><li>æ­£äº¤åŸºï¼š</li></ol><p>åŸºç›¸äº’å‚ç›´ï¼Œå°±æ˜¯æ­£äº¤åŸº</p><ol start="3"><li><strong>æ ¼åŸºçº¦è§„</strong></li></ol><p><img src="https://rockfox0.github.io/picx-images-hosting/32a8129eef81a915f4b4f7ace6f8d010.361mzmnojh.webp"></p><p>random basisä¹Ÿæ˜¯ä¸€ç»„åŸºï¼Œå¯ä»¥æ„æˆè¿™ä¸ªæ ¼å­ä¸­çš„æ‰€æœ‰ç‚¹ ä½†æ˜¯ä¸æ˜¯æ­£äº¤åŸº</p><p>é€šè¿‡LLLæˆ–BKZç®—æ³• å¾—åˆ°æ­£äº¤åŸºæˆ–è€…æ˜¯æœ€æ¥è¿‘æ­£äº¤åŸºï¼Œæˆ‘ä»¬é€šè¿‡åˆ°ä»–ä»¬ï¼Œåœ¨ä¹‹ä¸­</p></blockquote><p>Cvp(æœ€è¿‘å‘é‡é—®é¢˜)â€”ä¸æ˜¯å¾ˆèƒ½ç†è§£è¿™é‡Œå…ˆç•™ç€</p><h2 id="æ¥ä¸‹æ¥å®æˆ˜ä¸€äº›æ ¼çš„é¢˜"><a href="#æ¥ä¸‹æ¥å®æˆ˜ä¸€äº›æ ¼çš„é¢˜" class="headerlink" title="æ¥ä¸‹æ¥å®æˆ˜ä¸€äº›æ ¼çš„é¢˜"></a>æ¥ä¸‹æ¥å®æˆ˜ä¸€äº›æ ¼çš„é¢˜</h2><h3 id="hermite-å®šç†"><a href="#hermite-å®šç†" class="headerlink" title="hermite å®šç†"></a>hermite å®šç†</h3><p><img src="https://rockfox0.github.io/picx-images-hosting/eae24001bbe299decdd775bef1ea1800.73u0gaysyt.webp"></p><p>ç»™å‡ºæœ€çŸ­å‘é‡çš„ä¸Šé™ã€‚</p><p>2024æå®¢å¤§æŒ‘æˆ˜</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs 1c">from Crypto.Util.number import *<br><br>flag <span class="hljs-punctuation">=</span> b&#x27;******&#x27;<br>m <span class="hljs-punctuation">=</span> bytes_to_long<span class="hljs-punctuation">(</span>flag<span class="hljs-punctuation">)</span><br><br>assert m.bit_length<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">=</span><span class="hljs-punctuation">=</span> <span class="hljs-number">327</span><br>p <span class="hljs-punctuation">=</span> getPrime<span class="hljs-punctuation">(</span><span class="hljs-number">1024</span><span class="hljs-punctuation">)</span><br>a <span class="hljs-punctuation">=</span> getPrime<span class="hljs-punctuation">(</span><span class="hljs-number">1024</span><span class="hljs-punctuation">)</span><br>c <span class="hljs-punctuation">=</span> getPrime<span class="hljs-punctuation">(</span><span class="hljs-number">400</span><span class="hljs-punctuation">)</span><br><br>b <span class="hljs-punctuation">=</span> <span class="hljs-punctuation">(</span>a*m <span class="hljs-punctuation">+</span> c<span class="hljs-punctuation">)</span> % p<br><br>print<span class="hljs-punctuation">(</span>f&#x27;a = &#123;a&#125;&#x27;<span class="hljs-punctuation">)</span><br>print<span class="hljs-punctuation">(</span>f&#x27;b = &#123;b&#125;&#x27;<span class="hljs-punctuation">)</span><br>print<span class="hljs-punctuation">(</span>f&#x27;p = &#123;p&#125;&#x27;<span class="hljs-punctuation">)</span><br><br>&#x27;&#x27;&#x27;<br>a = <span class="hljs-number">16979084980432</span><span class="hljs-number">35409461972047</span><span class="hljs-number">08402762862586</span><span class="hljs-number">19760418310258</span><span class="hljs-number">92707418597085</span><span class="hljs-number">50301920348112</span><span class="hljs-number">94130599976409</span><span class="hljs-number">21979969292984</span><span class="hljs-number">74590062625556</span><span class="hljs-number">80679361326852</span><span class="hljs-number">77637740137726</span><span class="hljs-number">85954699561684</span><span class="hljs-number">24494543484365</span><span class="hljs-number">65153078018829</span><span class="hljs-number">95934869499880</span><span class="hljs-number">28859414291938</span><span class="hljs-number">15017964888150</span><span class="hljs-number">33294127591623</span><span class="hljs-number">26089476475021</span><span class="hljs-number">45889934568404</span><span class="hljs-number">04443515671353</span><span class="hljs-number">80261445041171</span>7<br>b = <span class="hljs-number">87985708831523</span><span class="hljs-number">23898094893816</span><span class="hljs-number">54149843183794</span><span class="hljs-number">59926002798504</span><span class="hljs-number">43596453820344</span><span class="hljs-number">38779885998886</span><span class="hljs-number">15810231215118</span><span class="hljs-number">82813830689557</span><span class="hljs-number">20628331079889</span><span class="hljs-number">65151522391460</span><span class="hljs-number">21683769192796</span><span class="hljs-number">02498745118188</span><span class="hljs-number">78134399363147</span><span class="hljs-number">00804256222291</span><span class="hljs-number">02347399406975</span><span class="hljs-number">53852540265617</span><span class="hljs-number">60348299509120</span><span class="hljs-number">31050401874604</span><span class="hljs-number">85673579382171</span><span class="hljs-number">26019729178374</span><span class="hljs-number">88867659293761</span><span class="hljs-number">79151804062085</span><br>p = <span class="hljs-number">13172449451206</span><span class="hljs-number">56588010397665</span><span class="hljs-number">46788821718063</span><span class="hljs-number">96314446781873</span><span class="hljs-number">57680406313670</span><span class="hljs-number">69153816254855</span><span class="hljs-number">22965544955909</span><span class="hljs-number">91886944032600</span><span class="hljs-number">44990366292026</span><span class="hljs-number">91608534025007</span><span class="hljs-number">71987352157741</span><span class="hljs-number">49087025577263</span><span class="hljs-number">76984665072859</span><span class="hljs-number">31801010739405</span><span class="hljs-number">07285459917860</span><span class="hljs-number">72655138522748</span><span class="hljs-number">17158735036126</span><span class="hljs-number">83249433020201</span><span class="hljs-number">72919086243047</span><span class="hljs-number">60548221028654</span><span class="hljs-number">41136763977415</span><span class="hljs-number">82433185880161</span>7<br>&#x27;&#x27;&#x27;<br></code></pre></td></tr></table></figure><p>å·²çŸ¥a,b,pã€‚</p><p>æ¥ä¸‹æ¥æ„é€ å‡½æ•°</p><blockquote><p>b&#x3D;am+c-kp</p><p>c&#x3D;b+kp-am</p><p>m&#x3D;0+m+0</p><p>1&#x3D;[1,0,0]</p><p>[1,m,k]*[1,0,b&#x2F;&#x2F;0,1,-a&#x2F;&#x2F;0,0,p]&#x3D;[1,m,c]</p><p>å¦‚æœmå’Œcè¿œè¿œå°äºa,b,påˆ™[1,m,c]å¯è§†ä¸ºæœ€çŸ­å‘é‡,é€šè¿‡æ±‚å‡ºæœ€çŸ­å‘é‡å³å¯æ±‚å‡ºmå’Œcã€‚ä½†æ˜¯è¿™é‡Œ[1,0,b]ä¸èƒ½ç¡®å®šæ˜¯å¦ä¸€å®šæ¯”[1,m,c]å¤§å¾ˆå¤šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆå°è¯•</p></blockquote><img src="https://www.helloimg.com/i/2024/12/19/67642106d12f7.jpg" style="zoom:33%;" /><p>è¿™é‡Œæ„é€ å‡ºæ¥ï¼Œ$b-a*m +kp &#x3D; c$<br>$$(1\quad m\quad k )\begin{bmatrix}1&amp;0&amp;b\0&amp;1&amp;-<br>a\0&amp;0&amp;p\end{bmatrix}&#x3D;\begin{pmatrix}1&amp;m&amp;c\end{pmatrix}$$<br>$||\mathbf{v}||&#x3D;\sqrt{1+|m|2+|c|2}\approx2^{401}&gt;|p|{1&#x2F;3}&#x3D;2^{341}$<br>è¡¥ä¸ª$2^{200}$<br>|V|&lt;&#x3D;|p|*1&#x2F;3ï¼Œå¹¶ä¸”å¤§å°æ¥è¿‘ï¼Œä½†æ˜¯ä¸ºäº†å®ƒè§£å†³ä¸€äº›é—®é¢˜ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“æ˜¯å•¥ï¼‰ï¼Œä½†æ˜¯åŠ äº†ZZä¹‹åæ—©æ ¼çš„èŒƒå›´å˜å¤§äº†ä¸€äº›ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> Crypto.Util.number import *<br><br><span class="hljs-attribute">a</span> = <span class="hljs-number">169790849804323540946197204708402762862586197604183102589270741859708550301920348112941305999764092197996929298474590062625556806793613268527763774013772685954699561684244945434843656515307801882995934869499880288594142919381501796488815033294127591623260894764750214588993456840404443515671353802614450411717</span><br><span class="hljs-attribute">b</span> = <span class="hljs-number">87985708831523238980948938165414984318379459926002798504435964538203443877988599888615810231215118828138306895572062833107988965151522391460216837691927960249874511818878134399363147008042562222910234739940697553852540265617603482995091203105040187460485673579382171260197291783748886765929376179151804062085</span><br><span class="hljs-attribute">p</span> = <span class="hljs-number">131724494512065658801039766546788821718063963144467818735768040631367069153816254855229655449559099188694403260044990366292026916085340250077198735215774149087025577263769846650728593180101073940507285459917860726551385227481715873503612683249433020201729190862430476054822102865441136763977415824331858801617</span><br><br><br><span class="hljs-attribute">M</span> = matrix([[<span class="hljs-number">2</span>^<span class="hljs-number">377</span>,<span class="hljs-number">0</span>, b],<span class="hljs-meta"> [0,1, -a],[0,0,p]])</span><br><span class="hljs-meta">L = M.LLL()[0]</span><br><br><span class="hljs-attribute">print</span>(long_to_bytes(L[<span class="hljs-number">1</span>]))<br><br><span class="hljs-comment">#b&#x27;SYC&#123;1e989433efffd767589e989ad0f091075c06&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="easyLattice"><a href="#easyLattice" class="headerlink" title="easyLattice"></a>easyLattice</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> gmpy2<br><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag) == <span class="hljs-number">47</span><br><br>f = bytes_to_long(flag)<br>p = getPrime(<span class="hljs-number">512</span>)<br>g = getPrime(<span class="hljs-number">128</span>)<br>h = (gmpy2.invert(f, p) * g %<br>     p)<br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;h =&#x27;</span>, h)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;p =&#x27;</span>, p)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">h = 9848463356094730516607732957888686710609147955724620108704251779566910519170690198684628685762596232124613115691882688827918489297122319416081019121038443</span><br><span class="hljs-string">p = 11403618200995593428747663693860532026261161211931726381922677499906885834766955987247477478421850280928508004160386000301268285541073474589048412962888947     </span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://www.helloimg.com/i/2024/12/20/6765634b5c0e0.jpg"></p><p>é€ æ ¼ï¼Œ(2p)**1&#x2F;2&gt;&#x3D;(f^2+ g^2) ^1&#x2F;2  ä¸æˆç«‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é…å¹³ï¼Œå¯¹hå’ŒpåŒæ—¶ä¹˜256å¦‚ä¸‹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> Crypto.Util.number import *<br>import gmpy2<br>h = 9848463356094730516607732957888686710609147955724620108704251779566910519170690198684628685762596232124613115691882688827918489297122319416081019121038443<br>p = 11403618200995593428747663693860532026261161211931726381922677499906885834766955987247477478421850280928508004160386000301268285541073474589048412962888947     <br><span class="hljs-attribute">b</span>=2^256<br><span class="hljs-attribute">L</span>=matrix(ZZ,[[1,b*h],[0,b*p]])<br><span class="hljs-built_in">print</span>(L.LLL()[0])<br>f,<span class="hljs-attribute">g</span>=L.LLL()[0]<br><span class="hljs-attribute">f</span>=abs(f)<br><span class="hljs-built_in">print</span>(long_to_bytes(f)<br>â€™â€˜â€™<br>(-50073894085033274448337202692453522746880698077702322983028272289946704698284083256500537353714697134260425361796, -29555150073396592208680335494684523983684143293301981158157800432304888982432677680588686983225737089584138075242496)<br>b<span class="hljs-string">&#x27;SICTF&#123;e3fea01c-18f3-4638-9544-9201393940a9&#125;A\xf0\x89\x84&#x27;</span><br>â€˜â€™â€˜<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MD5ç®—æ³•åŸç†ä»¥åŠå®ç°</title>
    <link href="/2024/04/23/MD5%E7%AE%97%E6%B3%95/"/>
    <url>/2024/04/23/MD5%E7%AE%97%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="MD5ç®—æ³•"><a href="#MD5ç®—æ³•" class="headerlink" title="MD5ç®—æ³•"></a>MD5ç®—æ³•</h1><p> MD5ï¼ˆå•å‘æ•£åˆ—ç®—æ³•ï¼‰ çš„å…¨ç§°æ˜¯Message-Digest Algorithm 5ï¼ˆä¿¡æ¯-æ‘˜è¦ç®—æ³•ï¼‰</p><p>MD5çš„åŠŸèƒ½:</p><blockquote><p>è¾“å…¥ä»»æ„é•¿åº¦çš„ä¿¡æ¯ï¼Œç»è¿‡å¤„ç†ï¼Œè¾“å‡ºä½128ä½çš„ä¿¡æ¯ï¼›ä¸åŒçš„è¾“å…¥å¯ä»¥å¾—åˆ°ä¸åŒçš„ç»“æœ(å”¯ä¸€æ€§)</p><p>æ ¹æ®128ä½è¾“å‡ºç»“æœåæ¨å‡ºè¾“å…¥ä¿¡æ¯æ˜¯åŠå…¶å›°éš¾çš„(ä¸å¯é€†)</p></blockquote><ul><li>æ•£åˆ—å‡½æ•°</li></ul><blockquote><p>æ•£åˆ—å‡½æ•°æ˜¯ä¸€ç§å°†è¾“å…¥æ•°æ®æ˜ å°„åˆ°å›ºå®šå¤§å°çš„æ•£åˆ—å€¼çš„å‡½æ•°ã€‚å®ƒé€šè¿‡å¯¹è¾“å…¥æ•°æ®è¿›è¡Œè®¡ç®—ï¼Œç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„æ•£åˆ—å€¼ï¼Œç”¨äºå¿«é€ŸæŸ¥æ‰¾æˆ–éªŒè¯æ•°æ®çš„å®Œæ•´æ€§ã€‚</p></blockquote><p>æ•£åˆ—å‡½æ•°çš„ç‰¹ç‚¹å’Œè¦æ±‚</p><blockquote><ol><li>å‡åŒ€åˆ†å¸ƒ:æ•£åˆ—å‡½æ•°å°†è¾“å…¥æ•°æ®å‡åŒ€åœ°åˆ†å¸ƒåœ¨æ•£åˆ—å€¼çš„èŒƒå›´å†…ï¼Œä»¥é¿å…ç¢°æ’(å³å¤šä¸ªä¸åŒçš„æ•°æ®å¾—åˆ°ç›¸åŒæ•£åˆ—å€¼)çš„å‘ç”Ÿâ€“ä¸è¿‡æ— æ³•å®Œå…¨é¿å…</li><li>ç¢°æ’æ¦‚ç‡æœ€å°åŒ–</li><li></li></ol></blockquote><ul><li>memcpy</li></ul><blockquote><p>å¤åˆ¶å­—ç¬¦ä¸²ï¼ŒåŸç†è‡ªæŸ¥ã€‚</p><p>memcpy(éœ€è¦èµ‹å€¼çš„char [],è¢«å¤åˆ¶çš„char1 []çš„èµ·å§‹ä½ç½®ï¼Œè¢«å¤åˆ¶çš„æ•°æ®å¤šå°‘)ï¼›</p><p><a href="https://www.runoob.com/cprogramming/c-function-memcpy.html">C åº“å‡½æ•° â€“ memcpy() | èœé¸Ÿæ•™ç¨‹</a></p></blockquote><h2 id="å¤§è‡´è¿‡ç¨‹"><a href="#å¤§è‡´è¿‡ç¨‹" class="headerlink" title="å¤§è‡´è¿‡ç¨‹"></a>å¤§è‡´è¿‡ç¨‹</h2><h3 id="å¡«å……è¯¥æ•°æ®"><a href="#å¡«å……è¯¥æ•°æ®" class="headerlink" title="å¡«å……è¯¥æ•°æ®"></a>å¡«å……è¯¥æ•°æ®</h3><p>ç¤ºä¾‹è¾“å…¥ message ,å°†å…¶åŠ ä¸Š64bit ç„¶åè¡¥å……è‡³512çš„ Kå€ã€‚æœ€åçš„64bitæ˜¯è¡¨ç¤ºçš„</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-04-24-170516.2a5aesc1oq.webp"></p><p>å°±åƒè¿™æ ·ã€‚</p><p>ç„¶åæ¯ä¸€ä¸ª512bitè¿›è¡ŒHMD5çš„æ“ä½œ</p><p><img src="https://rockfox0.github.io/picx-images-hosting/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-2025-04-24-170826.4joay9w3ap.webp" alt="image-20250424170829070"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€çŸ¥é“HMD5æ˜¯ä»€ä¹ˆæ“ä½œå°±è¡Œäº†</p><p>è¿™é‡Œçš„IVæ˜¯åˆå§‹çš„æ•°æ®ï¼Œ128Bitæ˜¯å›ºå®šçš„</p><h3 id="åˆå§‹åŒ–ç¼“å†²åŒº"><a href="#åˆå§‹åŒ–ç¼“å†²åŒº" class="headerlink" title="åˆå§‹åŒ–ç¼“å†²åŒº"></a>åˆå§‹åŒ–ç¼“å†²åŒº</h3><p>ç®—æ³•å®éªŒ128bitçš„ç¼“å†²åŒºå­˜æ”¾ä¸­é—´ç»“æœå’Œæœ€ç»ˆå“ˆå¸Œï¼Œ128bit å¯ä»¥çœ‹åšå››ç»„32-bitå­—æ‰€å çš„Bitä½ã€‚$Buffer_A,Buffer_B,Buffer_C,Buffer_D$. æ¯ä¸ªç¼“å†²åŒºéƒ½ä»¥å°ç«¯çš„æ–¹å¼å­˜å‚¨æ•°æ®. å°† 4 å— Buffer ç»„åˆèµ·æ¥è®°ä¸ºé“¾æ¥å‘é‡ CViã€‚</p><h3 id="å¾ªç¯å“ˆå¸Œ"><a href="#å¾ªç¯å“ˆå¸Œ" class="headerlink" title="å¾ªç¯å“ˆå¸Œ"></a>å¾ªç¯å“ˆå¸Œ</h3><p>è°ƒç”¨$H_{MD5}(mi,CVi)$æ•°å¯¹é­…æ—æ¶ˆæ¯åˆ†ç»„è¿›è¡Œå“ˆå¸Œè®¡ç®—</p><p><img src="https://rockfox0.github.io/picx-images-hosting/2724888-20221023140447258-1939332805.83a8o3b8wb.webp" alt="img"></p><p>ç”±ä¸Šå›¾å¯çŸ¥ï¼Œå“ˆå¸Œå‡½æ•°è®¡ç®—åˆ†ä¸º4å¤§æ­¥ï¼Œæ¯ä¸€å¤§æ­¥åˆæœ‰16å°ä¼¦æ¬¡ã€‚ï¼Œå…±è¿›è¡Œ64æ¬¡è¿ç®—ã€‚æˆ‘ä»¬å°†512bitçš„Må­˜å‚¨åœ¨uint_32 X[16]è¿™ä¸ªæ•°ç»„ä¸­ã€‚å¾—åˆ°çš„128bitä¸ä¹‹å‰çš„ç›¸åŠ å°±è¡Œäº†ã€‚</p><h3 id="æ¯ä¸€è½®è½®å‡½æ•°"><a href="#æ¯ä¸€è½®è½®å‡½æ•°" class="headerlink" title="æ¯ä¸€è½®è½®å‡½æ•°"></a>æ¯ä¸€è½®è½®å‡½æ•°</h3><p>æ¯è½®è¿›è¡Œ16æ¬¡è®¡ç®—ï¼Œæ¯æ¬¡è®¡ç®—ç”¨ç‰¹å®šæ–¹å¼è°ƒç”¨Tå’ŒXä¸­çš„æ•°æ®ï¼Œè¯¦æƒ…çœ‹ä»£ç </p><p><img src="https://rockfox0.github.io/picx-images-hosting/2724888-20221023140446865-1970868950.wirarctno.webp" alt="img"></p><p>CLS è¡¨ç¤ºå¾ªç¯å·¦ä½ç§»ã€‚</p><p>è¯¦æƒ…è§ä»£ç ï¼Œå››è½®æ¯ä¸€ä¸ªå‡½æ•°æœ‰åŒºåˆ«çš„è¯¦æƒ…è§ä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span> <span class="hljs-comment">// for uint* type</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;limits.h&gt;</span> <span class="hljs-comment">// for CHAR_BIT</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-type">const</span> <span class="hljs-type">uint32_t</span> T[<span class="hljs-number">64</span>] = &#123;<br><span class="hljs-number">0xd76aa478</span>, <span class="hljs-number">0xe8c7b756</span>, <span class="hljs-number">0x242070db</span>, <span class="hljs-number">0xc1bdceee</span>, <span class="hljs-number">0xf57c0faf</span>, <span class="hljs-number">0x4787c62a</span>, <span class="hljs-number">0xa8304613</span>, <span class="hljs-number">0xfd469501</span>,<br><span class="hljs-number">0x698098d8</span>, <span class="hljs-number">0x8b44f7af</span>, <span class="hljs-number">0xffff5bb1</span>, <span class="hljs-number">0x895cd7be</span>, <span class="hljs-number">0x6b901122</span>, <span class="hljs-number">0xfd987193</span>, <span class="hljs-number">0xa679438e</span>, <span class="hljs-number">0x49b40821</span>,<br><span class="hljs-number">0xf61e2562</span>, <span class="hljs-number">0xc040b340</span>, <span class="hljs-number">0x265e5a51</span>, <span class="hljs-number">0xe9b6c7aa</span>, <span class="hljs-number">0xd62f105d</span>, <span class="hljs-number">0x2441453</span>, <span class="hljs-number">0xd8a1e681</span>, <span class="hljs-number">0xe7d3fbc8</span>,<br><span class="hljs-number">0x21e1cde6</span>, <span class="hljs-number">0xc33707d6</span>, <span class="hljs-number">0xf4d50d87</span>, <span class="hljs-number">0x455a14ed</span>, <span class="hljs-number">0xa9e3e905</span>, <span class="hljs-number">0xfcefa3f8</span>, <span class="hljs-number">0x676f02d9</span>, <span class="hljs-number">0x8d2a4c8a</span>,<br><span class="hljs-number">0xfffa3942</span>, <span class="hljs-number">0x8771f681</span>, <span class="hljs-number">0x6d9d6122</span>, <span class="hljs-number">0xfde5380c</span>, <span class="hljs-number">0xa4beea44</span>, <span class="hljs-number">0x4bdecfa9</span>, <span class="hljs-number">0xf6bb4b60</span>, <span class="hljs-number">0xbebfbc70</span>,<br><span class="hljs-number">0x289b7ec6</span>, <span class="hljs-number">0xeaa127fa</span>, <span class="hljs-number">0xd4ef3085</span>, <span class="hljs-number">0x4881d05</span>, <span class="hljs-number">0xd9d4d039</span>, <span class="hljs-number">0xe6db99e5</span>, <span class="hljs-number">0x1fa27cf8</span>, <span class="hljs-number">0xc4ac5665</span>,<br><span class="hljs-number">0xf4292244</span>, <span class="hljs-number">0x432aff97</span>, <span class="hljs-number">0xab9423a7</span>, <span class="hljs-number">0xfc93a039</span>, <span class="hljs-number">0x655b59c3</span>, <span class="hljs-number">0x8f0ccc92</span>, <span class="hljs-number">0xffeff47d</span>, <span class="hljs-number">0x85845dd1</span>,<br><span class="hljs-number">0x6fa87e4f</span>, <span class="hljs-number">0xfe2ce6e0</span>, <span class="hljs-number">0xa3014314</span>, <span class="hljs-number">0x4e0811a1</span>, <span class="hljs-number">0xf7537e82</span>, <span class="hljs-number">0xbd3af235</span>, <span class="hljs-number">0x2ad7d2bb</span>, <span class="hljs-number">0xeb86d391</span>&#125;;<br><br><span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> SHIFT[<span class="hljs-number">4</span>][<span class="hljs-number">4</span>]&#123;<br>&#123;<span class="hljs-number">7</span>, <span class="hljs-number">12</span>, <span class="hljs-number">17</span>, <span class="hljs-number">22</span>&#125;,<br>&#123;<span class="hljs-number">5</span>, <span class="hljs-number">9</span>, <span class="hljs-number">14</span>, <span class="hljs-number">20</span>&#125;,<br>&#123;<span class="hljs-number">4</span>, <span class="hljs-number">11</span>, <span class="hljs-number">16</span>, <span class="hljs-number">23</span>&#125;,<br>&#123;<span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">21</span>&#125;&#125;;<br><span class="hljs-comment">//æ§åˆ¶æ¯ä¸€è½®ç§»ä½</span><br><span class="hljs-type">const</span> <span class="hljs-type">uint8_t</span> PADDING[] = &#123;<br><span class="hljs-number">0x80</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br><span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br><span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br><span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>&#125;;<br><span class="hljs-comment">// ä½¿ç”¨æŒ‡é’ˆå½¢å¼</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">padmes</span><span class="hljs-params">(string message, <span class="hljs-type">uint8_t</span> *mes1)</span> </span>&#123;<br>    <span class="hljs-type">uint64_t</span> mesL=message.<span class="hljs-built_in">length</span>();<br>    <span class="hljs-type">uint64_t</span> bitmesL=mesL*CHAR_BIT;<br>    <span class="hljs-type">int</span> block =(bitmesL<span class="hljs-number">+64</span>)/<span class="hljs-number">512</span><span class="hljs-number">+1</span>;<span class="hljs-comment">//è®¡ç®—å¡«å……åçš„æ•°æ®é‡æ˜¯512çš„blockå€</span><br>    <span class="hljs-built_in">memcpy</span>(mes1, message.<span class="hljs-built_in">c_str</span>(), mesL);<span class="hljs-comment">//å°†åŸæ•°æ®æ‹·è´åˆ°mes1ä¸­</span><br><span class="hljs-keyword">for</span>( <span class="hljs-type">int</span> i =mesL;i&lt;(block*<span class="hljs-number">64</span><span class="hljs-number">-8</span>);i++)&#123;<br>mes1[i]=PADDING[i-mesL];<br>&#125;<br>    <span class="hljs-built_in">memcpy</span>(mes1+(block*<span class="hljs-number">64</span><span class="hljs-number">-8</span>), &amp;bitmesL, <span class="hljs-number">8</span>);<span class="hljs-comment">//å­˜å‚¨é•¿åº¦æ•°æ®</span><br><br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">Left_Rotate</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> x, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> n)</span> </span>&#123;<br>n&amp;=<span class="hljs-number">31</span>;<br><span class="hljs-keyword">return</span> (x &lt;&lt; n) | (x &gt;&gt; (<span class="hljs-number">32</span>-n));<br>&#125;<br><span class="hljs-function"><span class="hljs-type">uint32_t</span> <span class="hljs-title">FF</span><span class="hljs-params">(<span class="hljs-type">int</span> i ,<span class="hljs-type">uint32_t</span> b, <span class="hljs-type">uint32_t</span> c, <span class="hljs-type">uint32_t</span> d)</span> </span>&#123;<br><span class="hljs-keyword">switch</span> (i)<br>&#123;<br><span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br><span class="hljs-keyword">return</span> (b &amp; c) | (~b &amp; d);<br><span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br><span class="hljs-keyword">return</span> (b &amp; d) | (c &amp; (~d));<br><span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br><span class="hljs-keyword">return</span> b ^ c ^ d;<br><span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br><span class="hljs-keyword">return</span> c ^ (b | (~d));<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> <span class="hljs-title">Subs</span><span class="hljs-params">(<span class="hljs-type">int</span> round_i,<span class="hljs-type">int</span> i)</span></span>&#123;<br><span class="hljs-keyword">switch</span> ( round_i)&#123;<br><span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br><span class="hljs-keyword">return</span> i;<br><span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br><span class="hljs-keyword">return</span> (<span class="hljs-number">5</span>*i<span class="hljs-number">+1</span>)%<span class="hljs-number">16</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br><span class="hljs-keyword">return</span> (<span class="hljs-number">3</span>*i<span class="hljs-number">+5</span>)%<span class="hljs-number">16</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br><span class="hljs-keyword">return</span> (<span class="hljs-number">7</span>*i)%<span class="hljs-number">16</span>;<br><br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<span class="hljs-comment">//æ§åˆ¶è¾“å…¥çš„X[i]çš„ä½ç½®</span><br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Round_F</span><span class="hljs-params">(<span class="hljs-type">int</span> Round_i,<span class="hljs-type">uint32_t</span> buffer[<span class="hljs-number">4</span>],<span class="hljs-type">const</span> <span class="hljs-type">uint32_t</span> X[<span class="hljs-number">16</span>])</span> </span>&#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i =<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">16</span>;i++)&#123;<br>buffer[<span class="hljs-number">0</span>]+=<span class="hljs-built_in">FF</span>(Round_i,buffer[<span class="hljs-number">1</span>],buffer[<span class="hljs-number">2</span>],buffer[<span class="hljs-number">3</span>]);<br>buffer[<span class="hljs-number">0</span>]+=X[<span class="hljs-built_in">Subs</span>(Round_i,i)];<br>buffer[<span class="hljs-number">0</span>]+=T[i+Round_i*<span class="hljs-number">16</span>];<br>buffer[<span class="hljs-number">0</span>]=<span class="hljs-built_in">Left_Rotate</span>(buffer[<span class="hljs-number">0</span>],SHIFT[Round_i][i%<span class="hljs-number">4</span>]);<br>buffer[<span class="hljs-number">0</span>]+=buffer[<span class="hljs-number">1</span>];<br><span class="hljs-type">uint32_t</span> temp=buffer[<span class="hljs-number">3</span>];<br>buffer[<span class="hljs-number">3</span>]=buffer[<span class="hljs-number">2</span>];<br>buffer[<span class="hljs-number">2</span>]=buffer[<span class="hljs-number">1</span>];<br>buffer[<span class="hljs-number">1</span>]=buffer[<span class="hljs-number">0</span>];<br>buffer[<span class="hljs-number">0</span>]=temp;<br>&#125;<br><span class="hljs-keyword">return</span> ;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">oneMD5</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> chain_vetor[<span class="hljs-number">4</span>],<span class="hljs-type">const</span> <span class="hljs-type">uint32_t</span> X[<span class="hljs-number">16</span>])</span> </span>&#123;<br><span class="hljs-type">uint32_t</span> buffer[<span class="hljs-number">4</span>];<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i =<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)&#123;<br>buffer[i]=chain_vetor[i];<br>&#125;<span class="hljs-comment">//chain_vetor[4]ä»£è¡¨åˆå§‹çš„128bitæ•°æ®æ˜¯å›ºå®šçš„</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i =<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)&#123;<br><span class="hljs-built_in">Round_F</span>(i,buffer,X);<span class="hljs-comment">//å®Œæ•´çš„ä¸€æ¬¡è¿›è¡Œå››æ¬¡ä¸åŒçš„æ“ä½œï¼Œæ¯æ¬¡16è½®ã€‚</span><br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i =<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)&#123;<br>chain_vetor[i]+=buffer[i];<br>&#125;<br>&#125;<span class="hljs-comment">/**/</span><br><span class="hljs-function"><span class="hljs-type">__uint128_t</span> <span class="hljs-title">MD5</span><span class="hljs-params">(string message)</span></span>&#123;<br><span class="hljs-type">uint64_t</span> mesL=message.<span class="hljs-built_in">length</span>();<br><span class="hljs-type">uint64_t</span> bitmesL=mesL*CHAR_BIT;<br><span class="hljs-type">uint64_t</span> block =(bitmesL<span class="hljs-number">+64</span>)/<span class="hljs-number">512</span><span class="hljs-number">+1</span>;<span class="hljs-comment">//è®¡ç®—å¡«å……åçš„æ•°æ®é‡æ˜¯512çš„blockå€</span><br><span class="hljs-type">uint8_t</span> mes1[block*<span class="hljs-number">64</span>];<span class="hljs-comment">//å¡«å……åçš„æ•°æ®</span><br><span class="hljs-type">uint32_t</span> chain_vetor[<span class="hljs-number">4</span>]=&#123;<span class="hljs-number">0x67452301</span>,<span class="hljs-number">0xEFCDAB89</span>,<span class="hljs-number">0x98BADCFE</span>,<span class="hljs-number">0x10325476</span>&#125;;<span class="hljs-comment">//åˆå§‹çš„128bitæ•°æ®æ˜¯å›ºå®šçš„</span><br><span class="hljs-built_in">padmes</span>(message, mes1);<span class="hljs-comment">//å¡«å……æ•°æ®</span><br><span class="hljs-type">uint32_t</span> *X=<span class="hljs-keyword">new</span> <span class="hljs-type">uint32_t</span>[<span class="hljs-number">16</span>];<span class="hljs-comment">//æ¯æ¬¡è¿›è¡Œ512bitçš„æ“ä½œ</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i =<span class="hljs-number">0</span>;i&lt;block;i++)&#123;<br><span class="hljs-built_in">memcpy</span>(X,mes1<span class="hljs-number">+64</span>*i,<span class="hljs-number">64</span>);<span class="hljs-comment">//æ¯æ¬¡512bitçš„æ“ä½œ</span><br><span class="hljs-built_in">oneMD5</span>(chain_vetor,X);<span class="hljs-comment">//è¿›è¡Œä¸€æ¬¡hashæ“ä½œ</span><br>&#125;<br><span class="hljs-type">__uint128_t</span> md5 = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)<br>md5 += (<span class="hljs-type">__uint128_t</span>)chain_vetor[i] &lt;&lt; (i * <span class="hljs-number">32</span>);<br><br><span class="hljs-keyword">delete</span>[] X;<br><span class="hljs-keyword">return</span> md5;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MD5_Print</span><span class="hljs-params">(<span class="hljs-type">__uint128_t</span> in)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *ptr = (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *)&amp;in;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++)<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02x&quot;</span>, ptr[i]);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br><br><br><br>cout &lt;&lt; <span class="hljs-string">&quot;----------------- MD5 -----------------\n&quot;</span>;<br>cout &lt;&lt; <span class="hljs-string">&quot;-----------------------\n&quot;</span>;<br>string str;<br><span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<br>&#123;<br>cout &lt;&lt; <span class="hljs-string">&quot;text: &quot;</span>;<br><span class="hljs-built_in">getline</span>(cin, str);<br><span class="hljs-type">__uint128_t</span> md5 = <span class="hljs-built_in">MD5</span>(str);<br><br>cout &lt;&lt; <span class="hljs-string">&quot;result: &quot;</span>;<br><span class="hljs-built_in">MD5_Print</span>(md5);<br><span class="hljs-keyword">if</span>(str == <span class="hljs-string">&quot;Please_let_me_go~&quot;</span>) <span class="hljs-keyword">break</span>;<br>cout &lt;&lt; <span class="hljs-string">&quot;\n-----------------------\n&quot;</span>;<br>&#125;<br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>cpp</category>
      
      <category>crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
      <tag>algorithm</tag>
      
      <tag>cpp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>weil pairing</title>
    <link href="/2024/01/16/ECC_sign_inmd/"/>
    <url>/2024/01/16/ECC_sign_inmd/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Weil-paIring"><a href="#Weil-paIring" class="headerlink" title="Weil paIring"></a>Weil paIring</h1><ul><li>å‰è¨€</li></ul><p>ç¼–è€…å¯¹ç¾¤çš„äº†è§£æ¯”è¾ƒåŸºç¡€ï¼Œå¯èƒ½ä¸€äº›è¯æ˜ä¸å¤ªä¼š</p><p>å€Ÿé‰´<a href="https://link.springer.com/content/pdf/10.1007/s00145-004-0315-8.pdf">crypt03-15.tex.dvi</a></p><h2 id="åŒçº¿æ€§æ˜ å°„"><a href="#åŒçº¿æ€§æ˜ å°„" class="headerlink" title="åŒçº¿æ€§æ˜ å°„"></a>åŒçº¿æ€§æ˜ å°„</h2><ul><li><p>åœ¨æ•°å­¦ä¸­ï¼Œä¸€ä¸ªåŒçº¿æ€§æ˜ å°„æ˜¯ç”±ä¸¤ä¸ª<a href="https://zh.wikipedia.org/wiki/%E5%90%91%E9%87%8F%E7%A9%BA%E9%97%B4">å‘é‡ç©ºé—´</a>ä¸Šçš„å…ƒç´ ï¼Œç”Ÿæˆç¬¬ä¸‰ä¸ªå‘é‡ç©ºé—´ä¸Šä¸€ä¸ªå…ƒç´ ä¹‹å‡½æ•°ï¼Œå¹¶ä¸”è¯¥å‡½æ•°å¯¹æ¯ä¸ªå‚æ•°éƒ½æ˜¯çº¿æ€§çš„ã€‚ä¾‹å¦‚<a href="https://zh.wikipedia.org/wiki/%E7%9F%A9%E9%98%B5">çŸ©é˜µ</a>ä¹˜æ³•å°±æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p></li><li><p>çº¿æ€§æ€§</p></li></ul><p>x,xâ€™âˆˆ<strong>V</strong>,yâ€™âˆˆ<strong>W</strong>,ä»¥åŠæ ‡é‡a,bä¸ºæ•´æ•°ï¼ŒåŒçº¿æ€§æ˜ å°„$f:VÃ—Wâ†’K$</p><p>å¿…é¡»æ»¡è¶³:</p><blockquote><p>$f(ax+bxâ€™,y)&#x3D;af(x,y)+bf(xâ€™,y)$<br>$f(x,ay+byâ€™)&#x3D;af(x,y)+bf(x,yâ€™)$</p></blockquote><p><strong>åŒçº¿æ€§é…å¯¹çš„æ€§è´¨</strong>:è®¾æ˜ å°„e:</p><blockquote><p>åŒçº¿æ€§æ˜ å°„å¯ä»¥ç”¨äº”å…ƒç»„(p,G1,G2,GT,e)æ¥æè¿°ï¼ŒG1ï¼ŒG2ï¼ŒGTæ˜¯ä¸‰ä¸ªç´ æ•°é˜¶ä¹˜æ³•å¾ªç¯ç¾¤ï¼Œé˜¶æ•°çš†ä¸ºpï¼Œå®šä¹‰åœ¨è¿™ä¸‰ä¸ªä¸‰ä¸ªç¾¤ä¸Šçš„ä¸€ä¸ªæ˜ å°„å…³ç³»eï¼šG1*G2 â€”&gt;GTï¼Œæ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼š</p><ul><li>åŒçº¿æ€§æ€§</li></ul><p>å¯¹äºä»»æ„$aï¼ŒbâˆˆZp$ ,æœ‰ï¼Œæœ‰ï¼Œæœ‰$e(Ra, Sb) &#x3D; e(R, S)ab$</p><p>e(P,Q+R)&#x3D;e(P,Q)*e(P,R)</p><ul><li>éé€€åŒ–æ€§ï¼š</li></ul><p>å­˜åœ¨RâˆˆG2ï¼ŒSâˆˆG1ï¼Œä½¿å¾—e(R, S) â‰  1ï¼ˆ1âˆˆG2ä»£è¡¨G2ç¾¤çš„å•ä½å…ƒï¼‰</p><ul><li>å¯è®¡ç®—æ€§è´¨</li></ul><p>å­˜åœ¨æœ‰æ•ˆçš„ç®—æ³•å¯¹ä»»æ„çš„RâˆˆG2ï¼ŒSâˆˆG1ï¼Œè®¡ç®—e(R, S)çš„å€¼ã€‚</p></blockquote><h2 id="Weil-Pairing"><a href="#Weil-Pairing" class="headerlink" title="Weil Pairing"></a>Weil Pairing</h2><blockquote><ul><li><strong>æŒ ç‚¹</strong> æŒ‡åœ¨æ¤­åœ†æ›²çº¿ä¸Šå…·æœ‰æœ‰é™é˜¶çš„ç‚¹ã€‚å³å­˜åœ¨æ­£æ•´æ•° mâ‰¥1<em>m</em>â‰¥1ï¼Œä½¿å¾—å¯¹äºæ¤­åœ†æ›²çº¿ E<em>E</em> ä¸Šçš„ç‚¹ P<em>P</em>ï¼Œæœ‰ mP&#x3D;O<em>m**P</em>&#x3D;<em>O</em>ï¼Œå…¶ä¸­ O<em>O</em> æ˜¯æ›²çº¿çš„å•ä½å…ƒï¼ˆæ— ç©·è¿œç‚¹ï¼‰ã€‚ç‚¹ <em>P</em> çš„é˜¶å³ä¸º    mï¼Œæ­¤æ—¶ P è¢«ç§°ä¸ºæŒ ç‚¹ã€‚</li></ul><p>å°†æ‰€æœ‰é˜¶ä¸ºmçš„å€æ•°çš„ç‚¹é›†åˆèµ·æ¥ï¼Œå°±æ„æˆäº†m-æŒ ç¾¤ï¼Œå®šä¹‰ä¸º</p><p>$E[m]&#x3D;{PâˆˆEï¼šmP&#x3D;O}$</p><p>æŒ ç¾¤ E[m] æ˜¯æ¤­åœ†æ›²çº¿ E çš„ä¸€ä¸ªåŠ æ³•å­ç¾¤ï¼Œå…¶ä¸­å•ä½å…ƒæ˜¯æ— ç©·è¿œç‚¹ Oã€‚å¦‚æœ P,QâˆˆE[m]ï¼Œåˆ™ P+Q å’Œ Qâˆ’P ä¹Ÿå±äº E[m]ï¼Œè¯´æ˜æŒ ç¾¤å…·æœ‰å°é—­æ€§å’Œå­˜åœ¨é€†å…ƒï¼Œå› æ­¤æ„æˆä¸€ä¸ªç¾¤ç»“æ„.</p><p>å½“æ¤­åœ†æ›²çº¿å®šä¹‰åœ¨åŸŸ Kä¸Šæ—¶ï¼Œm-æŒ ç¾¤è®°ä¸º E(K)[m]ã€‚ä¾‹å¦‚ï¼Œå®šä¹‰åœ¨ Fpä¸Šçš„ Eçš„ m-æŒ ç¾¤å†™ä½œ E(Fp)[m]</p></blockquote><blockquote><ul><li>é™¤å­</li></ul><p>æ˜¯æ¤­åœ†æ›²çº¿ä¸Šç‚¹çš„å½¢å¼å’Œï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§â€œåŠ æƒâ€ç‚¹çš„æ¦‚å¿µï¼Œç”¨äºè¿½è¸ªæœ‰ç†å‡½æ•°ä¸Šçš„é›¶ç‚¹å’Œæç‚¹ã€‚å¦‚æœåœ¨ Î±1 å¤„æœ‰ e ä¸ªé›¶ç‚¹ï¼Œå°±è®°ä¸º $e1[Î±1]$ï¼›å¦‚æœåœ¨ Î²1å¤„æœ‰ d1 ä¸ªæç‚¹ï¼Œå°±è®°ä¸º $âˆ’d1[Î²1$ï¼Œç„¶åå†æŠŠå®ƒä»¬å½¢å¼çš„åŠ èµ·æ¥ï¼ˆä¸æ˜¯æ™®é€šçš„åŠ æ³•è¿ç®—ï¼‰ï¼š</p><p>$div(f)&#x3D;e1[Î±1]+â€¦+e_r[Î±_r]-d_1[Î²_1]-â€¦-d_t[Î²_t]$</p></blockquote><p>$E[m]&#x3D;Z&#x2F;mZÃ—Z&#x2F;mZ$</p><p>E[m]è¡¨ç¤ºæœ‰ä¸¤ä¸ªé˜¶ä¸ºmçš„å¾ªç¯å‘¨æœŸç»„æˆã€‚</p><p>é€‰å–ä¸€ç»„åŸº{$T_1,T_2$}ï¼Œå®šä¹‰æ˜ å°„ï¼š</p><p>det:$E[m]Ã—E[m]â†’Z&#x2F;mZ$   det$(aT_1+bT_2,cT_1,dT_2)&#x3D;adâˆ’bc$</p><p>è¿™ä¸€æ®µåŸç†éªŒè¯å€Ÿé‰´çš„åˆ«äººçš„åšå®¢å’Œè®ºæ–‡(æŠ½è±¡ä»£æ•°å¤§æ¦‚çœ‹äº†åŸºç¡€ç¾¤ç¯åŸŸä¹Ÿè¿˜æ˜¯çœ‹ä¸å¤ªæ‡‚ï¼Œä»¥åå­¦åˆ°ä¸€å®šç¨‹åº¦äº†å†çœ‹çœ‹)</p><p>è®¾P,QâˆˆE[m],ä¹Ÿå°±æ˜¯è¯´På’ŒQæ˜¯ç¾¤Eä¸Šé˜¶ä¸ºmçš„ç‚¹ã€‚f<sub>P</sub>å’Œf<sub>QÂ </sub> </p><p>$div(f_p)&#x3D;m[P]-m[O]$,$div(f_Q)&#x3D;m[Q]-m[O]$</p><p>å¯çŸ¥ <em>f</em>âˆ˜[<em>m</em>] ä¸ <em>g**m</em> æœ‰ç›¸åŒçš„é™¤å­, å› æ­¤åœ¨å·®ä¸€ä¸ªå¸¸æ•°çš„æ„ä¹‰ä¸‹ <em>f</em>âˆ˜[<em>m</em>]&#x3D;$g^m$. å¯¹ä»»æ„ <em>S</em>âˆˆ<em>E</em>[<em>m</em>] åŠ <em>X</em>âˆˆ<em>E</em>, æˆ‘ä»¬æœ‰</p><p>$g(X+S)m&#x3D;f([m]X+[m]S)&#x3D;f([m]X)&#x3D;g(X)^m.$</p><p>å› æ­¤å¯¹ä»»æ„ <em>X</em> æœ‰ g(X+S)&#x2F;g(X) éƒ½æ˜¯ <em>m</em>-æ¬¡å•ä½æ ¹, ä¸” <em>E</em>â†’P1 ä¸æ˜¯æ»¡å°„, åªèƒ½æ˜¯å¸¸å€¼æ˜ å°„. å› æ­¤</p><blockquote><p>$e_m:E[m]Ã—E[m]â†’u_m, $</p><p>$*e_m S,T&#x3D;g(X)\over g(X+S)$</p></blockquote><h3 id="Weil-é…å¯¹æœ‰å¦‚ä¸‹æ€§è´¨ï¼š"><a href="#Weil-é…å¯¹æœ‰å¦‚ä¸‹æ€§è´¨ï¼š" class="headerlink" title="Weil é…å¯¹æœ‰å¦‚ä¸‹æ€§è´¨ï¼š"></a>Weil é…å¯¹æœ‰å¦‚ä¸‹æ€§è´¨ï¼š</h3><blockquote><ul><li>åŒçº¿æ€§ï¼š</li></ul><p>$e_m(S_1+S_2,T)&#x3D;e_m(S_1,T)e_m(S2,T),e_m(S,T_1+T_2)&#x3D;e_m(S,T_1)+e_m(S,T_2)$</p><p>$e_m(s_1^a,T^b)^{ab}$</p><ul><li>åå¯¹ç§°:</li></ul><p>$e_m(S,T)&#x3D;e_m (T,S)^{-1}.$</p><ul><li>éé€€åŒ–</li></ul><p>è‹¥å¯¹ä»»æ„ <em>S</em>âˆˆ<em>E</em>[<em>m</em>] æœ‰ $e_m$(S*,*T)&#x3D;1, åˆ™æœ‰ <em>T</em>&#x3D;<em>O</em>.</p><ul><li>Galoisä¸å˜:</li></ul><p>å¯¹ä»»æ„ aâˆˆGKË‰K, æœ‰ $e_m(S,T)^a&#x3D;e_m(S^a,T^a).$</p><ul><li>Compatibility:</li></ul><p>If$ P âˆˆ E[mn]$ and$ Q âˆˆ E[n]$, the$n e_{mn}(P, Q) &#x3D; e_n(mP, Q)$.</p><ul><li>é˜¶çš„æ€§è´¨</li></ul><p>å¦‚æœPå’ŒQçš„é˜¶ä¸º o*o,åˆ™  $e(P,Q)^o&#x3D;1$</p></blockquote><h3 id="SU-signin"><a href="#SU-signin" class="headerlink" title="SU_signin"></a>SU_signin</h3><h1 id="SU-signin-1"><a href="#SU-signin-1" class="headerlink" title="SU_signin"></a>SU_signin</h1><p>é¢˜ç›®æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>bit_length = <span class="hljs-built_in">len</span>(flag) * <span class="hljs-number">8</span><br><br>p = <span class="hljs-number">0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab</span><br>K = GF(p)<br>E = EllipticCurve(K, (<span class="hljs-number">0</span>, <span class="hljs-number">4</span>))<br>o = <span class="hljs-number">793479390729215512516507951283169066088130679960393952059283337873017453583023682367384822284289</span><br>n1, n2 = <span class="hljs-number">859267</span>, <span class="hljs-number">52437899</span><br><br><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):<br>    G1, G2 = E.random_element(), E.random_element()<br>    <span class="hljs-keyword">if</span>(G1.order() == o <span class="hljs-keyword">and</span> G2.order() == o):<br>        P1, P2 = (o//n1)*G1, (o//n2)*G2<br>        <span class="hljs-keyword">break</span><br><br>cs = [(randrange(<span class="hljs-number">0</span>, o) * P1 + randrange(<span class="hljs-number">0</span>, o) * G2).xy() <span class="hljs-keyword">if</span> i == <span class="hljs-string">&quot;1&quot;</span> <span class="hljs-keyword">else</span> (randrange(<span class="hljs-number">0</span>, o) * G1 + randrange(<span class="hljs-number">0</span>, o) * P2).xy() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">bin</span>(bytes_to_long(flag))[<span class="hljs-number">2</span>:].zfill(bit_length)]<br><span class="hljs-built_in">print</span>(cs)<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€çœ¼çœ‹ä¸Šå»å°±æ˜¯æ™®é€šçš„ECCï¼Œä½†æ˜¯è¿™é‡Œç»™äº†ä¸¤ç»„é˜¶ç›¸å®¹çš„G1ï¼ŒG2</p><p>ç„¶åç”ŸæˆP1å’ŒP2çš„é˜¶åˆ†åˆ«ä¸ºn1å’Œn2</p><p>ç„¶åå¦‚æœäºŒè¿›åˆ¶ä½ä¸º1ï¼Œ(randrange(0, o) * P1 + randrange(0, o) * G2)&#x3D;w</p><p>å¦‚æœäºŒè¿›åˆ¶ä½ä¸º0ï¼Œ(randrange(0, o) * G1 + randrange(0, o) * P2)&#x3D;u</p><p>n1*w&#x3D;W,</p><p>n2*u&#x3D;U</p><blockquote><p>E(W,G2)&#x3D;1,E(U,G1)&#x3D;1</p></blockquote><p>æ‰€ä»¥å¯ä»¥åˆ©ç”¨G1å’ŒG2åˆ¤æ–­ï¼Œè¿™é‡ŒG1å’ŒG2ä¹Ÿæ˜¯æœªçŸ¥çš„ï¼Œæˆ‘ä»¬å‡è®¾cs[0]&#x3D;0,cs[1]&#x3D;1</p><blockquote><p>G1&#x3D;n2*Cs[0] *</p><p><em>G2&#x3D;n1</em>Cs[1]</p></blockquote><p>æœ€åå¦‚ä¸‹è„šæœ¬è§£å‡º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> ast<br><span class="hljs-keyword">from</span> binteger <span class="hljs-keyword">import</span> Bin<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>p = <span class="hljs-number">0x1A0111EA397FE69A4B1BA7B6434BACD764774B84F38512BF6730D2A0F6B0F6241EABFFFEB153FFFFB9FEFFFFFFFFAAAB</span><br>K = GF(p)<br>E = EllipticCurve(K, (<span class="hljs-number">0</span>, <span class="hljs-number">4</span>))<br>n1, n2 = <span class="hljs-number">859267</span>, <span class="hljs-number">52437899</span><br>C1=E(<span class="hljs-number">3352313779859460801486003925032655136993856710790727105363441252341552956083285634840018349420910752791594969280380</span>, <span class="hljs-number">2427629935062136228505338781822031098060538648527098540077074467697895064173228853125697497410079713420476853660385</span>)<br>C2=E(<span class="hljs-number">2032510133375718031059693186824253736676017099152335002107480680688541061384422204257433121826049241452388039124165</span>, <span class="hljs-number">2686417581815542117120994330320923056212034586374942390097827699544930213612843423746022765194966762867963235937975</span>)<br>G1=n2*C1<br>G2=n1*C2<br>o=<span class="hljs-number">793479390729215512516507951283169066088130679960393952059283337873017453583023682367384822284289</span><br><br>P1, P2 = (o//n1)*G1, (o//n2)*G2<br>cs = []<br>a = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> q <span class="hljs-keyword">in</span> cs:<br>    x,y=q<br>    Q=E(x,y)<br>    Q1=n1*Q<br>    <span class="hljs-keyword">if</span> Q1.weil_pairing(G2, o)==<span class="hljs-number">1</span>:<br>        a=a+<span class="hljs-string">b&#x27;1&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        a=a+<span class="hljs-string">b&#x27;0&#x27;</span><br><span class="hljs-built_in">print</span>(a)<br>flag = long_to_bytes(<span class="hljs-built_in">int</span>(a,<span class="hljs-number">2</span>))<br><span class="hljs-built_in">print</span>(flag)<br>â€˜â€™â€˜<br><span class="hljs-string">b&#x27;01010011010101010100001101010100010001100111101101010111011001010011000101100011011011110110110101100101010111110101111101010100001100000101111101011111010100110101010101000011010101000100011001011111010111110011001000110000001100100011010101111101&#x27;</span><br><span class="hljs-string">b&#x27;SUCTF&#123;We1come__T0__SUCTF__2025&#125;&#x27;</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">â€™â€˜â€™</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>crypto</category>
      
      <category>ecc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
      <tag>Hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
